var aM=Object.defineProperty;var lM=(L,w,g)=>w in L?aM(L,w,{enumerable:!0,configurable:!0,writable:!0,value:g}):L[w]=g;var vr=(L,w,g)=>(lM(L,typeof w!="symbol"?w+"":w,g),g),iw=(L,w,g)=>{if(!w.has(L))throw TypeError("Cannot "+g)};var co=(L,w,g)=>(iw(L,w,"read from private field"),g?g.call(L):w.get(L)),vs=(L,w,g)=>{if(w.has(L))throw TypeError("Cannot add the same private member more than once");w instanceof WeakSet?w.add(L):w.set(L,g)};var Br=(L,w,g)=>(iw(L,w,"access private method"),g);(function(){const w=document.createElement("link").relList;if(w&&w.supports&&w.supports("modulepreload"))return;for(const S of document.querySelectorAll('link[rel="modulepreload"]'))y(S);new MutationObserver(S=>{for(const k of S)if(k.type==="childList")for(const R of k.addedNodes)R.tagName==="LINK"&&R.rel==="modulepreload"&&y(R)}).observe(document,{childList:!0,subtree:!0});function g(S){const k={};return S.integrity&&(k.integrity=S.integrity),S.referrerPolicy&&(k.referrerPolicy=S.referrerPolicy),S.crossOrigin==="use-credentials"?k.credentials="include":S.crossOrigin==="anonymous"?k.credentials="omit":k.credentials="same-origin",k}function y(S){if(S.ep)return;S.ep=!0;const k=g(S);fetch(S.href,k)}})();var Xu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function uM(L){return L&&L.__esModule&&Object.prototype.hasOwnProperty.call(L,"default")?L.default:L}(()=>{var L=Object.create,w=Object.defineProperty,g=Object.defineProperties,y=Object.getOwnPropertyDescriptor,S=Object.getOwnPropertyDescriptors,k=Object.getOwnPropertyNames,R=Object.getOwnPropertySymbols,F=Object.getPrototypeOf,U=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable,ne=(e,t,i)=>t in e?w(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,C=(e,t)=>{for(var i in t||(t={}))U.call(t,i)&&ne(e,i,t[i]);if(R)for(var i of R(t))Z.call(t,i)&&ne(e,i,t[i]);return e},D=(e,t)=>g(e,S(t)),Re=e=>w(e,"__esModule",{value:!0}),le=(e,t)=>{var i={};for(var r in e)U.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&R)for(var r of R(e))t.indexOf(r)<0&&Z.call(e,r)&&(i[r]=e[r]);return i},lt=(e,t)=>()=>(e&&(t=e(e=0)),t),qe=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Ct=(e,t)=>{for(var i in t)w(e,i,{get:t[i],enumerable:!0})},De=(e,t,i,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of k(t))!U.call(e,n)&&(i||n!=="default")&&w(e,n,{get:()=>t[n],enumerable:!(r=y(t,n))||r.enumerable});return e},je=(e,t)=>De(Re(w(e!=null?L(F(e)):{},"default",!t&&e&&e.__esModule?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e),Yt=(e=>(t,i)=>e&&e.get(t)||(i=De(Re({}),t,1),e&&e.set(t,i),i))(typeof WeakMap<"u"?new WeakMap:0),Ze=(e,t,i)=>(ne(e,typeof t!="symbol"?t+"":t,i),i);function Ht(e,t){for(var i in t)e[i]=t[i];return e}function Si(e){var t=e.parentNode;t&&t.removeChild(e)}function N(e,t,i){var r,n,o,l={};for(o in t)o=="key"?r=t[o]:o=="ref"?n=t[o]:l[o]=t[o];if(arguments.length>2&&(l.children=arguments.length>3?vo.call(arguments,2):i),typeof e=="function"&&e.defaultProps!=null)for(o in e.defaultProps)l[o]===void 0&&(l[o]=e.defaultProps[o]);return $i(e,l,r,n,null)}function $i(e,t,i,r,n){var o={type:e,props:t,key:i,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:n??++Dp};return n==null&&Ce.vnode!=null&&Ce.vnode(o),o}function wr(){return{current:null}}function it(e){return e.children}function ei(e,t){this.props=e,this.context=t}function Nt(e,t){if(t==null)return e.__?Nt(e.__,e.__.__k.indexOf(e)+1):null;for(var i;t<e.__k.length;t++)if((i=e.__k[t])!=null&&i.__e!=null)return i.__e;return typeof e.type=="function"?Nt(e):null}function ji(e){var t,i;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((i=e.__k[t])!=null&&i.__e!=null){e.__e=e.__c.base=i.__e;break}return ji(e)}}function hr(e){(!e.__d&&(e.__d=!0)&&bo.push(e)&&!Zi.__r++||Hp!==Ce.debounceRendering)&&((Hp=Ce.debounceRendering)||Wp)(Zi)}function Zi(){for(var e;Zi.__r=bo.length;)e=bo.sort(function(t,i){return t.__v.__b-i.__v.__b}),bo=[],e.some(function(t){var i,r,n,o,l,u;t.__d&&(l=(o=(i=t).__v).__e,(u=i.__P)&&(r=[],(n=Ht({},o)).__v=o.__v+1,Ei(u,o,n,i.__n,u.ownerSVGElement!==void 0,o.__h!=null?[l]:null,r,l??Nt(o),o.__h),yt(r,o),o.__e!=l&&ji(o)))})}function er(e,t,i,r,n,o,l,u,c,p){var f,v,x,E,_,P,O,I=r&&r.__k||lh,A=I.length;for(i.__k=[],f=0;f<t.length;f++)if((E=i.__k[f]=(E=t[f])==null||typeof E=="boolean"?null:typeof E=="string"||typeof E=="number"||typeof E=="bigint"?$i(null,E,null,null,E):Array.isArray(E)?$i(it,{children:E},null,null,null):E.__b>0?$i(E.type,E.props,E.key,null,E.__v):E)!=null){if(E.__=i,E.__b=i.__b+1,(x=I[f])===null||x&&E.key==x.key&&E.type===x.type)I[f]=void 0;else for(v=0;v<A;v++){if((x=I[v])&&E.key==x.key&&E.type===x.type){I[v]=void 0;break}x=null}Ei(e,E,x=x||wo,n,o,l,u,c,p),_=E.__e,(v=E.ref)&&x.ref!=v&&(O||(O=[]),x.ref&&O.push(x.ref,null,E),O.push(v,E.__c||_,E)),_!=null?(P==null&&(P=_),typeof E.type=="function"&&E.__k===x.__k?E.__d=c=cr(E,c,e):c=K(e,E,x,I,_,c),typeof i.type=="function"&&(i.__d=c)):c&&x.__e==c&&c.parentNode!=e&&(c=Nt(x))}for(i.__e=P,f=A;f--;)I[f]!=null&&(typeof i.type=="function"&&I[f].__e!=null&&I[f].__e==i.__d&&(i.__d=Nt(r,f+1)),Up(I[f],I[f]));if(O)for(f=0;f<O.length;f++)Ra(O[f],O[++f],O[++f])}function cr(e,t,i){for(var r,n=e.__k,o=0;n&&o<n.length;o++)(r=n[o])&&(r.__=e,t=typeof r.type=="function"?cr(r,t,i):K(i,r,r,n,r.__e,t));return t}function me(e,t){return t=t||[],e==null||typeof e=="boolean"||(Array.isArray(e)?e.some(function(i){me(i,t)}):t.push(e)),t}function K(e,t,i,r,n,o){var l,u,c;if(t.__d!==void 0)l=t.__d,t.__d=void 0;else if(i==null||n!=o||n.parentNode==null)e:if(o==null||o.parentNode!==e)e.appendChild(n),l=null;else{for(u=o,c=0;(u=u.nextSibling)&&c<r.length;c+=2)if(u==n)break e;e.insertBefore(n,o),l=o}return l!==void 0?l:n.nextSibling}function se(e,t,i,r,n){var o;for(o in i)o==="children"||o==="key"||o in t||ee(e,o,null,i[o],r);for(o in t)n&&typeof t[o]!="function"||o==="children"||o==="key"||o==="value"||o==="checked"||i[o]===t[o]||ee(e,o,t[o],i[o],r)}function ce(e,t,i){t[0]==="-"?e.setProperty(t,i):e[t]=i==null?"":typeof i!="number"||Qp.test(t)?i:i+"px"}function ee(e,t,i,r,n){var o;e:if(t==="style")if(typeof i=="string")e.style.cssText=i;else{if(typeof r=="string"&&(e.style.cssText=r=""),r)for(t in r)i&&t in i||ce(e.style,t,"");if(i)for(t in i)r&&i[t]===r[t]||ce(e.style,t,i[t])}else if(t[0]==="o"&&t[1]==="n")o=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+o]=i,i?r||e.addEventListener(t,o?nt:Me,o):e.removeEventListener(t,o?nt:Me,o);else if(t!=="dangerouslySetInnerHTML"){if(n)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!=="href"&&t!=="list"&&t!=="form"&&t!=="tabIndex"&&t!=="download"&&t in e)try{e[t]=i??"";break e}catch{}typeof i=="function"||(i!=null&&(i!==!1||t[0]==="a"&&t[1]==="r")?e.setAttribute(t,i):e.removeAttribute(t))}}function Me(e){this.l[e.type+!1](Ce.event?Ce.event(e):e)}function nt(e){this.l[e.type+!0](Ce.event?Ce.event(e):e)}function Ei(e,t,i,r,n,o,l,u,c){var p,f,v,x,E,_,P,O,I,A,$,z=t.type;if(t.constructor!==void 0)return null;i.__h!=null&&(c=i.__h,u=t.__e=i.__e,t.__h=null,o=[u]),(p=Ce.__b)&&p(t);try{e:if(typeof z=="function"){if(O=t.props,I=(p=z.contextType)&&r[p.__c],A=p?I?I.props.value:p.__:r,i.__c?P=(f=t.__c=i.__c).__=f.__E:("prototype"in z&&z.prototype.render?t.__c=f=new z(O,A):(t.__c=f=new ei(O,A),f.constructor=z,f.render=sh),I&&I.sub(f),f.props=O,f.state||(f.state={}),f.context=A,f.__n=r,v=f.__d=!0,f.__h=[]),f.__s==null&&(f.__s=f.state),z.getDerivedStateFromProps!=null&&(f.__s==f.state&&(f.__s=Ht({},f.__s)),Ht(f.__s,z.getDerivedStateFromProps(O,f.__s))),x=f.props,E=f.state,v)z.getDerivedStateFromProps==null&&f.componentWillMount!=null&&f.componentWillMount(),f.componentDidMount!=null&&f.__h.push(f.componentDidMount);else{if(z.getDerivedStateFromProps==null&&O!==x&&f.componentWillReceiveProps!=null&&f.componentWillReceiveProps(O,A),!f.__e&&f.shouldComponentUpdate!=null&&f.shouldComponentUpdate(O,f.__s,A)===!1||t.__v===i.__v){f.props=O,f.state=f.__s,t.__v!==i.__v&&(f.__d=!1),f.__v=t,t.__e=i.__e,t.__k=i.__k,t.__k.forEach(function(B){B&&(B.__=t)}),f.__h.length&&l.push(f);break e}f.componentWillUpdate!=null&&f.componentWillUpdate(O,f.__s,A),f.componentDidUpdate!=null&&f.__h.push(function(){f.componentDidUpdate(x,E,_)})}f.context=A,f.props=O,f.state=f.__s,(p=Ce.__r)&&p(t),f.__d=!1,f.__v=t,f.__P=e,p=f.render(f.props,f.state,f.context),f.state=f.__s,f.getChildContext!=null&&(r=Ht(Ht({},r),f.getChildContext())),v||f.getSnapshotBeforeUpdate==null||(_=f.getSnapshotBeforeUpdate(x,E)),$=p!=null&&p.type===it&&p.key==null?p.props.children:p,er(e,Array.isArray($)?$:[$],t,i,r,n,o,l,u,c),f.base=t.__e,t.__h=null,f.__h.length&&l.push(f),P&&(f.__E=f.__=null),f.__e=!1}else o==null&&t.__v===i.__v?(t.__k=i.__k,t.__e=i.__e):t.__e=Es(i.__e,t,i,r,n,o,l,c);(p=Ce.diffed)&&p(t)}catch(B){t.__v=null,(c||o!=null)&&(t.__e=u,t.__h=!!c,o[o.indexOf(u)]=null),Ce.__e(B,t,i)}}function yt(e,t){Ce.__c&&Ce.__c(t,e),e.some(function(i){try{e=i.__h,i.__h=[],e.some(function(r){r.call(i)})}catch(r){Ce.__e(r,i.__v)}})}function Es(e,t,i,r,n,o,l,u){var c,p,f,v=i.props,x=t.props,E=t.type,_=0;if(E==="svg"&&(n=!0),o!=null){for(;_<o.length;_++)if((c=o[_])&&"setAttribute"in c==!!E&&(E?c.localName===E:c.nodeType===3)){e=c,o[_]=null;break}}if(e==null){if(E===null)return document.createTextNode(x);e=n?document.createElementNS("http://www.w3.org/2000/svg",E):document.createElement(E,x.is&&x),o=null,u=!1}if(E===null)v===x||u&&e.data===x||(e.data=x);else{if(o=o&&vo.call(e.childNodes),p=(v=i.props||wo).dangerouslySetInnerHTML,f=x.dangerouslySetInnerHTML,!u){if(o!=null)for(v={},_=0;_<e.attributes.length;_++)v[e.attributes[_].name]=e.attributes[_].value;(f||p)&&(f&&(p&&f.__html==p.__html||f.__html===e.innerHTML)||(e.innerHTML=f&&f.__html||""))}if(se(e,x,v,n,u),f)t.__k=[];else if(_=t.props.children,er(e,Array.isArray(_)?_:[_],t,i,r,n&&E!=="foreignObject",o,l,o?o[0]:i.__k&&Nt(i,0),u),o!=null)for(_=o.length;_--;)o[_]!=null&&Si(o[_]);u||("value"in x&&(_=x.value)!==void 0&&(_!==e.value||E==="progress"&&!_||E==="option"&&_!==v.value)&&ee(e,"value",_,v.value,!1),"checked"in x&&(_=x.checked)!==void 0&&_!==e.checked&&ee(e,"checked",_,v.checked,!1))}return e}function Ra(e,t,i){try{typeof e=="function"?e(t):e.current=t}catch(r){Ce.__e(r,i)}}function Up(e,t,i){var r,n;if(Ce.unmount&&Ce.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||Ra(r,null,t)),(r=e.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(o){Ce.__e(o,t)}r.base=r.__P=null}if(r=e.__k)for(n=0;n<r.length;n++)r[n]&&Up(r[n],t,typeof e.type!="function");i||e.__e==null||Si(e.__e),e.__e=e.__d=void 0}function sh(e,t,i){return this.constructor(e,i)}function xr(e,t,i){var r,n,o;Ce.__&&Ce.__(e,t),n=(r=typeof i=="function")?null:i&&i.__k||t.__k,o=[],Ei(t,e=(!r&&i||t).__k=N(it,null,[e]),n||wo,wo,t.ownerSVGElement!==void 0,!r&&i?[i]:n?null:t.firstChild?vo.call(t.childNodes):null,o,!r&&i?i:n?n.__e:t.firstChild,r),yt(o,e)}function oh(e,t){xr(e,t,oh)}function ah(e,t,i){var r,n,o,l=Ht({},e.props);for(o in t)o=="key"?r=t[o]:o=="ref"?n=t[o]:l[o]=t[o];return arguments.length>2&&(l.children=arguments.length>3?vo.call(arguments,2):i),$i(e.type,l,r||e.key,n||e.ref,null)}function si(e,t){var i={__c:t="__cC"+qp++,__:e,Consumer:function(r,n){return r.children(n)},Provider:function(r){var n,o;return this.getChildContext||(n=[],(o={})[t]=this,this.getChildContext=function(){return o},this.shouldComponentUpdate=function(l){this.props.value!==l.value&&n.some(hr)},this.sub=function(l){n.push(l);var u=l.componentWillUnmount;l.componentWillUnmount=function(){n.splice(n.indexOf(l),1),u&&u.call(l)}}),r.children}};return i.Provider.__=i.Consumer.contextType=i}var vo,Ce,Dp,bo,Wp,Hp,qp,wo,lh,Qp,et=lt(()=>{wo={},lh=[],Qp=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,vo=lh.slice,Ce={__e:function(e,t,i,r){for(var n,o,l;t=t.__;)if((n=t.__c)&&!n.__)try{if((o=n.constructor)&&o.getDerivedStateFromError!=null&&(n.setState(o.getDerivedStateFromError(e)),l=n.__d),n.componentDidCatch!=null&&(n.componentDidCatch(e,r||{}),l=n.__d),l)return n.__E=n}catch(u){e=u}throw e}},Dp=0,ei.prototype.setState=function(e,t){var i;i=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=Ht({},this.state),typeof e=="function"&&(e=e(Ht({},i),this.props)),e&&Ht(i,e),e!=null&&this.__v&&(t&&this.__h.push(t),hr(this))},ei.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),hr(this))},ei.prototype.render=it,bo=[],Wp=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Zi.__r=0,qp=0});function As(e,t){Ce.__h&&Ce.__h(gi,e,Rn||t),Rn=0;var i=gi.__H||(gi.__H={__:[],__h:[]});return e>=i.__.length&&i.__.push({}),i.__[e]}function Be(e){return Rn=1,ks(Zp,e)}function ks(e,t,i){var r=As(On++,2);return r.t=e,r.__c||(r.__=[i?i(t):Zp(void 0,t),function(n){var o=r.t(r.__[0],n);r.__[0]!==o&&(r.__=[o,r.__[1]],r.__c.setState({}))}],r.__c=gi),r.__}function de(e,t){var i=As(On++,3);!Ce.__s&&hh(i.__H,t)&&(i.__=e,i.__H=t,gi.__H.__h.push(i))}function At(e,t){var i=As(On++,4);!Ce.__s&&hh(i.__H,t)&&(i.__=e,i.__H=t,gi.__h.push(i))}function we(e){return Rn=5,Ae(function(){return{current:e}},[])}function Vp(e,t,i){Rn=6,At(function(){return typeof e=="function"?(e(t()),function(){return e(null)}):e?(e.current=t(),function(){return e.current=null}):void 0},i==null?i:i.concat(e))}function Ae(e,t){var i=As(On++,7);return hh(i.__H,t)&&(i.__=e(),i.__H=t,i.__h=e),i.__}function He(e,t){return Rn=8,Ae(function(){return e},t)}function Kt(e){var t=gi.context[e.__c],i=As(On++,9);return i.c=e,t?(i.__==null&&(i.__=!0,t.sub(gi)),t.props.value):e.__}function Gp(e,t){Ce.useDebugValue&&Ce.useDebugValue(t?t(e):e)}function Fw(e){var t=As(On++,10),i=Be();return t.__=e,gi.componentDidCatch||(gi.componentDidCatch=function(r){t.__&&t.__(r),i[1](r)}),[i[0],function(){i[1](void 0)}]}function Bw(){for(var e;e=ch.shift();)if(e.__P)try{e.__H.__h.forEach(Ma),e.__H.__h.forEach(uh),e.__H.__h=[]}catch(t){e.__H.__h=[],Ce.__e(t,e.__v)}}function Ma(e){var t=gi,i=e.__c;typeof i=="function"&&(e.__c=void 0,i()),gi=t}function uh(e){var t=gi;e.__c=e.__(),gi=t}function hh(e,t){return!e||e.length!==t.length||t.some(function(i,r){return i!==e[r]})}function Zp(e,t){return typeof t=="function"?t(e):t}var On,gi,Xp,Rn,ch,dh,ph,fh,gh,mh,yh,Yp=lt(()=>{et(),Rn=0,ch=[],dh=Ce.__b,ph=Ce.__r,fh=Ce.diffed,gh=Ce.__c,mh=Ce.unmount,Ce.__b=function(e){gi=null,dh&&dh(e)},Ce.__r=function(e){ph&&ph(e),On=0;var t=(gi=e.__c).__H;t&&(t.__h.forEach(Ma),t.__h.forEach(uh),t.__h=[])},Ce.diffed=function(e){fh&&fh(e);var t=e.__c;t&&t.__H&&t.__H.__h.length&&(ch.push(t)!==1&&Xp===Ce.requestAnimationFrame||((Xp=Ce.requestAnimationFrame)||function(i){var r,n=function(){clearTimeout(o),yh&&cancelAnimationFrame(r),setTimeout(i)},o=setTimeout(n,100);yh&&(r=requestAnimationFrame(n))})(Bw)),gi=null},Ce.__c=function(e,t){t.some(function(i){try{i.__h.forEach(Ma),i.__h=i.__h.filter(function(r){return!r.__||uh(r)})}catch(r){t.some(function(n){n.__h&&(n.__h=[])}),t=[],Ce.__e(r,i.__v)}}),gh&&gh(e,t)},Ce.unmount=function(e){mh&&mh(e);var t,i=e.__c;i&&i.__H&&(i.__H.__.forEach(function(r){try{Ma(r)}catch(n){t=n}}),t&&Ce.__e(t,i.__v))},yh=typeof requestAnimationFrame=="function"}),Mn={};Ct(Mn,{Children:()=>nn,Component:()=>ei,Fragment:()=>it,PureComponent:()=>La,StrictMode:()=>pf,Suspense:()=>xo,SuspenseList:()=>Ps,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:()=>Th,cloneElement:()=>$a,createContext:()=>si,createElement:()=>N,createFactory:()=>nf,createPortal:()=>tf,createRef:()=>wr,default:()=>te,findDOMNode:()=>of,flushSync:()=>Oh,forwardRef:()=>mi,hydrate:()=>rf,isValidElement:()=>_o,lazy:()=>ef,memo:()=>bh,render:()=>Cs,unmountComponentAtNode:()=>sf,unstable_batchedUpdates:()=>Ih,useCallback:()=>He,useContext:()=>Kt,useDebugValue:()=>Gp,useEffect:()=>de,useErrorBoundary:()=>Fw,useImperativeHandle:()=>Vp,useLayoutEffect:()=>At,useMemo:()=>Ae,useReducer:()=>ks,useRef:()=>we,useState:()=>Be,version:()=>Ts});function Kp(e,t){for(var i in t)e[i]=t[i];return e}function vh(e,t){for(var i in e)if(i!=="__source"&&!(i in t))return!0;for(var r in t)if(r!=="__source"&&e[r]!==t[r])return!0;return!1}function La(e){this.props=e}function bh(e,t){function i(n){var o=this.props.ref,l=o==n.ref;return!l&&o&&(o.call?o(null):o.current=null),t?!t(this.props,n)||!l:vh(this.props,n)}function r(n){return this.shouldComponentUpdate=i,N(e,n)}return r.displayName="Memo("+(e.displayName||e.name)+")",r.prototype.isReactComponent=!0,r.__f=!0,r}function mi(e){function t(i){var r=Kp({},i);return delete r.ref,e(r,i.ref||null)}return t.$$typeof=af,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}function xo(){this.__u=0,this.t=null,this.__b=null}function Jp(e){var t=e.__.__c;return t&&t.__e&&t.__e(e)}function ef(e){var t,i,r;function n(o){if(t||(t=e()).then(function(l){i=l.default||l},function(l){r=l}),r)throw r;if(!i)throw t;return N(i,o)}return n.displayName="Lazy",n.__f=!0,n}function Ps(){this.u=null,this.o=null}function jw(e){return this.getChildContext=function(){return e.context},e.children}function Uw(e){var t=this,i=e.i;t.componentWillUnmount=function(){xr(null,t.l),t.l=null,t.i=null},t.i&&t.i!==i&&t.componentWillUnmount(),e.__v?(t.l||(t.i=i,t.l={nodeType:1,parentNode:i,childNodes:[],appendChild:function(r){this.childNodes.push(r),t.i.appendChild(r)},insertBefore:function(r,n){this.childNodes.push(r),t.i.appendChild(r)},removeChild:function(r){this.childNodes.splice(this.childNodes.indexOf(r)>>>1,1),t.i.removeChild(r)}}),xr(N(jw,{context:t.context},e.__v),t.l)):t.l&&t.componentWillUnmount()}function tf(e,t){return N(Uw,{__v:e,i:t})}function Cs(e,t,i){return t.__k==null&&(t.textContent=""),xr(e,t),typeof i=="function"&&i(),e?e.__c:null}function rf(e,t,i){return oh(e,t),typeof i=="function"&&i(),e?e.__c:null}function Dw(){}function Ww(){return this.cancelBubble}function Hw(){return this.defaultPrevented}function nf(e){return N.bind(null,e)}function _o(e){return!!e&&e.$$typeof===Eh}function $a(e){return _o(e)?ah.apply(null,arguments):e}function sf(e){return!!e.__k&&(xr(null,e),!0)}function of(e){return e&&(e.base||e.nodeType===1&&e)||null}var wh,af,xh,nn,lf,_h,Sh,Eh,uf,hf,cf,Ah,df,kh,Ph,Ch,Th,Ts,Ih,Oh,pf,te,fe=lt(()=>{Yp(),Yp(),et(),et(),(La.prototype=new ei).isPureReactComponent=!0,La.prototype.shouldComponentUpdate=function(e,t){return vh(this.props,e)||vh(this.state,t)},wh=Ce.__b,Ce.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),wh&&wh(e)},af=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.forward_ref")||3911,xh=function(e,t){return e==null?null:me(me(e).map(t))},nn={map:xh,forEach:xh,count:function(e){return e?me(e).length:0},only:function(e){var t=me(e);if(t.length!==1)throw"Children.only";return t[0]},toArray:me},lf=Ce.__e,Ce.__e=function(e,t,i,r){if(e.then){for(var n,o=t;o=o.__;)if((n=o.__c)&&n.__c)return t.__e==null&&(t.__e=i.__e,t.__k=i.__k),n.__c(e,t)}lf(e,t,i,r)},_h=Ce.unmount,Ce.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&e.__h===!0&&(e.type=null),_h&&_h(e)},(xo.prototype=new ei).__c=function(e,t){var i=t.__c,r=this;r.t==null&&(r.t=[]),r.t.push(i);var n=Jp(r.__v),o=!1,l=function(){o||(o=!0,i.__R=null,n?n(u):u())};i.__R=l;var u=function(){if(!--r.__u){if(r.state.__e){var p=r.state.__e;r.__v.__k[0]=function v(x,E,_){return x&&(x.__v=null,x.__k=x.__k&&x.__k.map(function(P){return v(P,E,_)}),x.__c&&x.__c.__P===E&&(x.__e&&_.insertBefore(x.__e,x.__d),x.__c.__e=!0,x.__c.__P=_)),x}(p,p.__c.__P,p.__c.__O)}var f;for(r.setState({__e:r.__b=null});f=r.t.pop();)f.forceUpdate()}},c=t.__h===!0;r.__u++||c||r.setState({__e:r.__b=r.__v.__k[0]}),e.then(l,l)},xo.prototype.componentWillUnmount=function(){this.t=[]},xo.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var i=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=function o(l,u,c){return l&&(l.__c&&l.__c.__H&&(l.__c.__H.__.forEach(function(p){typeof p.__c=="function"&&p.__c()}),l.__c.__H=null),(l=Kp({},l)).__c!=null&&(l.__c.__P===c&&(l.__c.__P=u),l.__c=null),l.__k=l.__k&&l.__k.map(function(p){return o(p,u,c)})),l}(this.__b,i,r.__O=r.__P)}this.__b=null}var n=t.__e&&N(it,null,e.fallback);return n&&(n.__h=null),[N(it,null,t.__e?null:e.children),n]},Sh=function(e,t,i){if(++i[1]===i[0]&&e.o.delete(t),e.props.revealOrder&&(e.props.revealOrder[0]!=="t"||!e.o.size))for(i=e.u;i;){for(;i.length>3;)i.pop()();if(i[1]<i[0])break;e.u=i=i[2]}},(Ps.prototype=new ei).__e=function(e){var t=this,i=Jp(t.__v),r=t.o.get(e);return r[0]++,function(n){var o=function(){t.props.revealOrder?(r.push(n),Sh(t,e,r)):n()};i?i(o):o()}},Ps.prototype.render=function(e){this.u=null,this.o=new Map;var t=me(e.children);e.revealOrder&&e.revealOrder[0]==="b"&&t.reverse();for(var i=t.length;i--;)this.o.set(t[i],this.u=[1,0,this.u]);return e.children},Ps.prototype.componentDidUpdate=Ps.prototype.componentDidMount=function(){var e=this;this.o.forEach(function(t,i){Sh(e,i,t)})},Eh=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,uf=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|marker(?!H|W|U)|overline|paint|stop|strikethrough|stroke|text(?!L)|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,hf=typeof document<"u",cf=function(e){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/i:/fil|che|ra/i).test(e)},ei.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(ei.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}),Ah=Ce.event,Ce.event=function(e){return Ah&&(e=Ah(e)),e.persist=Dw,e.isPropagationStopped=Ww,e.isDefaultPrevented=Hw,e.nativeEvent=e},kh={configurable:!0,get:function(){return this.class}},Ph=Ce.vnode,Ce.vnode=function(e){var t=e.type,i=e.props,r=i;if(typeof t=="string"){var n=t.indexOf("-")===-1;for(var o in r={},i){var l=i[o];hf&&o==="children"&&t==="noscript"||o==="value"&&"defaultValue"in i&&l==null||(o==="defaultValue"&&"value"in i&&i.value==null?o="value":o==="download"&&l===!0?l="":/ondoubleclick/i.test(o)?o="ondblclick":/^onchange(textarea|input)/i.test(o+t)&&!cf(i.type)?o="oninput":/^onfocus$/i.test(o)?o="onfocusin":/^onblur$/i.test(o)?o="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(o)?o=o.toLowerCase():n&&uf.test(o)?o=o.replace(/[A-Z0-9]/,"-$&").toLowerCase():l===null&&(l=void 0),r[o]=l)}t=="select"&&r.multiple&&Array.isArray(r.value)&&(r.value=me(i.children).forEach(function(u){u.props.selected=r.value.indexOf(u.props.value)!=-1})),t=="select"&&r.defaultValue!=null&&(r.value=me(i.children).forEach(function(u){u.props.selected=r.multiple?r.defaultValue.indexOf(u.props.value)!=-1:r.defaultValue==u.props.value})),e.props=r,i.class!=i.className&&(kh.enumerable="className"in i,i.className!=null&&(r.class=i.className),Object.defineProperty(r,"className",kh))}e.$$typeof=Eh,Ph&&Ph(e)},Ch=Ce.__r,Ce.__r=function(e){Ch&&Ch(e),df=e.__c},Th={ReactCurrentDispatcher:{current:{readContext:function(e){return df.__n[e.__c].props.value}}}},Ts="17.0.2",Ih=function(e,t){return e(t)},Oh=function(e,t){return e(t)},pf=it,te={useState:Be,useReducer:ks,useEffect:de,useLayoutEffect:At,useRef:we,useImperativeHandle:Vp,useMemo:Ae,useCallback:He,useContext:Kt,useDebugValue:Gp,version:"17.0.2",Children:nn,render:Cs,hydrate:rf,unmountComponentAtNode:sf,createPortal:tf,createElement:N,createContext:si,createFactory:nf,cloneElement:$a,createRef:wr,Fragment:it,isValidElement:_o,findDOMNode:of,Component:ei,PureComponent:La,memo:bh,forwardRef:mi,flushSync:Oh,unstable_batchedUpdates:Ih,StrictMode:it,Suspense:xo,SuspenseList:Ps,lazy:ef,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:Th}}),qw=qe(e=>{function t(re,Ie){var Ne=re.length;re.push(Ie);e:for(;0<Ne;){var J=Ne-1>>>1,Oe=re[J];if(0<n(Oe,Ie))re[J]=Ie,re[Ne]=Oe,Ne=J;else break e}}function i(re){return re.length===0?null:re[0]}function r(re){if(re.length===0)return null;var Ie=re[0],Ne=re.pop();if(Ne!==Ie){re[0]=Ne;e:for(var J=0,Oe=re.length,mt=Oe>>>1;J<mt;){var rt=2*(J+1)-1,ti=re[rt],kt=rt+1,li=re[kt];if(0>n(ti,Ne))kt<Oe&&0>n(li,ti)?(re[J]=li,re[kt]=Ne,J=kt):(re[J]=ti,re[rt]=Ne,J=rt);else if(kt<Oe&&0>n(li,Ne))re[J]=li,re[kt]=Ne,J=kt;else break e}}return Ie}function n(re,Ie){var Ne=re.sortIndex-Ie.sortIndex;return Ne!==0?Ne:re.id-Ie.id}typeof performance=="object"&&typeof performance.now=="function"?(o=performance,e.unstable_now=function(){return o.now()}):(l=Date,u=l.now(),e.unstable_now=function(){return l.now()-u});var o,l,u,c=[],p=[],f=1,v=null,x=3,E=!1,_=!1,P=!1,O=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function $(re){for(var Ie=i(p);Ie!==null;){if(Ie.callback===null)r(p);else if(Ie.startTime<=re)r(p),Ie.sortIndex=Ie.expirationTime,t(c,Ie);else break;Ie=i(p)}}function z(re){if(P=!1,$(re),!_)if(i(c)!==null)_=!0,Pe(B);else{var Ie=i(p);Ie!==null&&Ke(z,Ie.startTime-re)}}function B(re,Ie){_=!1,P&&(P=!1,I(V),V=-1),E=!0;var Ne=x;try{for($(Ie),v=i(c);v!==null&&(!(v.expirationTime>Ie)||re&&!ue());){var J=v.callback;if(typeof J=="function"){v.callback=null,x=v.priorityLevel;var Oe=J(v.expirationTime<=Ie);Ie=e.unstable_now(),typeof Oe=="function"?v.callback=Oe:v===i(c)&&r(c),$(Ie)}else r(c);v=i(c)}if(v!==null)var mt=!0;else{var rt=i(p);rt!==null&&Ke(z,rt.startTime-Ie),mt=!1}return mt}finally{v=null,x=Ne,E=!1}}var H=!1,Y=null,V=-1,he=5,Q=-1;function ue(){return!(e.unstable_now()-Q<he)}function pe(){if(Y!==null){var re=e.unstable_now();Q=re;var Ie=!0;try{Ie=Y(!0,re)}finally{Ie?ge():(H=!1,Y=null)}}else H=!1}var ge;typeof A=="function"?ge=function(){A(pe)}:typeof MessageChannel<"u"?(oe=new MessageChannel,Se=oe.port2,oe.port1.onmessage=pe,ge=function(){Se.postMessage(null)}):ge=function(){O(pe,0)};var oe,Se;function Pe(re){Y=re,H||(H=!0,ge())}function Ke(re,Ie){V=O(function(){re(e.unstable_now())},Ie)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(re){re.callback=null},e.unstable_continueExecution=function(){_||E||(_=!0,Pe(B))},e.unstable_forceFrameRate=function(re){0>re||125<re?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):he=0<re?Math.floor(1e3/re):5},e.unstable_getCurrentPriorityLevel=function(){return x},e.unstable_getFirstCallbackNode=function(){return i(c)},e.unstable_next=function(re){switch(x){case 1:case 2:case 3:var Ie=3;break;default:Ie=x}var Ne=x;x=Ie;try{return re()}finally{x=Ne}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(re,Ie){switch(re){case 1:case 2:case 3:case 4:case 5:break;default:re=3}var Ne=x;x=re;try{return Ie()}finally{x=Ne}},e.unstable_scheduleCallback=function(re,Ie,Ne){var J=e.unstable_now();switch(typeof Ne=="object"&&Ne!==null?(Ne=Ne.delay,Ne=typeof Ne=="number"&&0<Ne?J+Ne:J):Ne=J,re){case 1:var Oe=-1;break;case 2:Oe=250;break;case 5:Oe=1073741823;break;case 4:Oe=1e4;break;default:Oe=5e3}return Oe=Ne+Oe,re={id:f++,callback:Ie,priorityLevel:re,startTime:Ne,expirationTime:Oe,sortIndex:-1},Ne>J?(re.sortIndex=Ne,t(p,re),i(c)===null&&re===i(p)&&(P?(I(V),V=-1):P=!0,Ke(z,Ne-J))):(re.sortIndex=Oe,t(c,re),_||E||(_=!0,Pe(B))),re},e.unstable_shouldYield=ue,e.unstable_wrapCallback=function(re){var Ie=x;return function(){var Ne=x;x=Ie;try{return re.apply(this,arguments)}finally{x=Ne}}}}),Qw=qe((e,t)=>{t.exports=qw()}),Vw=qe((e,t)=>{t.exports=function(i){var r={},n=(fe(),Yt(Mn)),o=Qw(),l=Object.assign;function u(s){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+s,h=1;h<arguments.length;h++)a+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+s+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var c=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,p=Symbol.for("react.element"),f=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),_=Symbol.for("react.provider"),P=Symbol.for("react.context"),O=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),$=Symbol.for("react.memo"),z=Symbol.for("react.lazy"),B=Symbol.for("react.offscreen"),H=Symbol.iterator;function Y(s){return s===null||typeof s!="object"?null:(s=H&&s[H]||s["@@iterator"],typeof s=="function"?s:null)}function V(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case v:return"Fragment";case f:return"Portal";case E:return"Profiler";case x:return"StrictMode";case I:return"Suspense";case A:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case P:return(s.displayName||"Context")+".Consumer";case _:return(s._context.displayName||"Context")+".Provider";case O:var a=s.render;return s=s.displayName,s||(s=a.displayName||a.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case $:return a=s.displayName||null,a!==null?a:V(s.type)||"Memo";case z:a=s._payload,s=s._init;try{return V(s(a))}catch{}}return null}function he(s){var a=s.type;switch(s.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=a.render,s=s.displayName||s.name||"",a.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(a);case 8:return a===x?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function Q(s){var a=s,h=s;if(s.alternate)for(;a.return;)a=a.return;else{s=a;do a=s,a.flags&4098&&(h=a.return),s=a.return;while(s)}return a.tag===3?h:null}function ue(s){if(Q(s)!==s)throw Error(u(188))}function pe(s){var a=s.alternate;if(!a){if(a=Q(s),a===null)throw Error(u(188));return a!==s?null:s}for(var h=s,d=a;;){var m=h.return;if(m===null)break;var b=m.alternate;if(b===null){if(d=m.return,d!==null){h=d;continue}break}if(m.child===b.child){for(b=m.child;b;){if(b===h)return ue(m),s;if(b===d)return ue(m),a;b=b.sibling}throw Error(u(188))}if(h.return!==d.return)h=m,d=b;else{for(var T=!1,j=m.child;j;){if(j===h){T=!0,h=m,d=b;break}if(j===d){T=!0,d=m,h=b;break}j=j.sibling}if(!T){for(j=b.child;j;){if(j===h){T=!0,h=b,d=m;break}if(j===d){T=!0,d=b,h=m;break}j=j.sibling}if(!T)throw Error(u(189))}}if(h.alternate!==d)throw Error(u(190))}if(h.tag!==3)throw Error(u(188));return h.stateNode.current===h?s:a}function ge(s){return s=pe(s),s!==null?oe(s):null}function oe(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var a=oe(s);if(a!==null)return a;s=s.sibling}return null}function Se(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){if(s.tag!==4){var a=Se(s);if(a!==null)return a}s=s.sibling}return null}var Pe=Array.isArray,Ke=i.getPublicInstance,re=i.getRootHostContext,Ie=i.getChildHostContext,Ne=i.prepareForCommit,J=i.resetAfterCommit,Oe=i.createInstance,mt=i.appendInitialChild,rt=i.finalizeInitialChildren,ti=i.prepareUpdate,kt=i.shouldSetTextContent,li=i.createTextInstance,Tt=i.scheduleTimeout,Mt=i.cancelTimeout,ui=i.noTimeout,Zt=i.isPrimaryRenderer,wt=i.supportsMutation,ke=i.supportsPersistence,Te=i.supportsHydration,ot=i.getInstanceFromNode,ii=i.preparePortalMount,Xe=i.getCurrentEventPriority,Ye=i.detachDeletedInstance,ht=i.supportsMicrotasks,jt=i.scheduleMicrotask,hi=i.supportsTestSelectors,Zr=i.findFiberRoot,os=i.getBoundingRect,rd=i.getTextContent,as=i.isHiddenSubtree,Di=i.matchAccessibilityRole,iu=i.setFocusIfFocusable,nd=i.setupIntersectionObserver,sd=i.appendChild,Jo=i.appendChildToContainer,Xs=i.commitTextUpdate,ea=i.commitMount,ru=i.commitUpdate,be=i.insertBefore,Ue=i.insertInContainerBefore,xt=i.removeChild,Ut=i.removeChildFromContainer,It=i.resetTextContent,ie=i.hideInstance,$e=i.hideTextInstance,at=i.unhideInstance,_t=i.unhideTextInstance,ft=i.clearContainer,od=i.cloneInstance,fb=i.createContainerChildSet,gb=i.appendChildToContainerChildSet,ZO=i.finalizeContainerChildren,ad=i.replaceContainerChildren,mb=i.cloneHiddenInstance,yb=i.cloneHiddenTextInstance,XO=i.canHydrateInstance,YO=i.canHydrateTextInstance,KO=i.canHydrateSuspenseInstance,vb=i.isSuspenseInstancePending,ld=i.isSuspenseInstanceFallback,JO=i.getSuspenseInstanceFallbackErrorDetails,eR=i.registerSuspenseInstanceRetry,nu=i.getNextHydratableSibling,tR=i.getFirstHydratableChild,iR=i.getFirstHydratableChildWithinContainer,rR=i.getFirstHydratableChildWithinSuspenseInstance,nR=i.hydrateInstance,sR=i.hydrateTextInstance,oR=i.hydrateSuspenseInstance,aR=i.getNextHydratableInstanceAfterSuspenseInstance,lR=i.commitHydratedContainer,uR=i.commitHydratedSuspenseInstance,hR=i.clearSuspenseBoundary,cR=i.clearSuspenseBoundaryFromContainer,dR=i.shouldDeleteUnhydratedTailInstances,pR=i.didNotMatchHydratedContainerTextInstance,fR=i.didNotMatchHydratedTextInstance,ud;function ta(s){if(ud===void 0)try{throw Error()}catch(h){var a=h.stack.trim().match(/\n( *(at )?)/);ud=a&&a[1]||""}return`
`+ud+s}var hd=!1;function cd(s,a){if(!s||hd)return"";hd=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(ae){var d=ae}Reflect.construct(s,[],a)}else{try{a.call()}catch(ae){d=ae}s.call(a.prototype)}else{try{throw Error()}catch(ae){d=ae}s()}}catch(ae){if(ae&&d&&typeof ae.stack=="string"){for(var m=ae.stack.split(`
`),b=d.stack.split(`
`),T=m.length-1,j=b.length-1;1<=T&&0<=j&&m[T]!==b[j];)j--;for(;1<=T&&0<=j;T--,j--)if(m[T]!==b[j]){if(T!==1||j!==1)do if(T--,j--,0>j||m[T]!==b[j]){var G=`
`+m[T].replace(" at new "," at ");return s.displayName&&G.includes("<anonymous>")&&(G=G.replace("<anonymous>",s.displayName)),G}while(1<=T&&0<=j);break}}}finally{hd=!1,Error.prepareStackTrace=h}return(s=s?s.displayName||s.name:"")?ta(s):""}var gR=Object.prototype.hasOwnProperty,dd=[],Ys=-1;function wn(s){return{current:s}}function Ot(s){0>Ys||(s.current=dd[Ys],dd[Ys]=null,Ys--)}function Pt(s,a){Ys++,dd[Ys]=s.current,s.current=a}var xn={},Ii=wn(xn),Wi=wn(!1),ls=xn;function Ks(s,a){var h=s.type.contextTypes;if(!h)return xn;var d=s.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===a)return d.__reactInternalMemoizedMaskedChildContext;var m={},b;for(b in h)m[b]=a[b];return d&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=a,s.__reactInternalMemoizedMaskedChildContext=m),m}function Hi(s){return s=s.childContextTypes,s!=null}function su(){Ot(Wi),Ot(Ii)}function bb(s,a,h){if(Ii.current!==xn)throw Error(u(168));Pt(Ii,a),Pt(Wi,h)}function wb(s,a,h){var d=s.stateNode;if(a=a.childContextTypes,typeof d.getChildContext!="function")return h;d=d.getChildContext();for(var m in d)if(!(m in a))throw Error(u(108,he(s)||"Unknown",m));return l({},h,d)}function ou(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||xn,ls=Ii.current,Pt(Ii,s),Pt(Wi,Wi.current),!0}function xb(s,a,h){var d=s.stateNode;if(!d)throw Error(u(169));h?(s=wb(s,a,ls),d.__reactInternalMemoizedMergedChildContext=s,Ot(Wi),Ot(Ii),Pt(Ii,s)):Ot(Wi),Pt(Wi,h)}var dr=Math.clz32?Math.clz32:vR,mR=Math.log,yR=Math.LN2;function vR(s){return s>>>=0,s===0?32:31-(mR(s)/yR|0)|0}var au=64,lu=4194304;function ia(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function uu(s,a){var h=s.pendingLanes;if(h===0)return 0;var d=0,m=s.suspendedLanes,b=s.pingedLanes,T=h&268435455;if(T!==0){var j=T&~m;j!==0?d=ia(j):(b&=T,b!==0&&(d=ia(b)))}else T=h&~m,T!==0?d=ia(T):b!==0&&(d=ia(b));if(d===0)return 0;if(a!==0&&a!==d&&!(a&m)&&(m=d&-d,b=a&-a,m>=b||m===16&&(b&4194240)!==0))return a;if(d&4&&(d|=h&16),a=s.entangledLanes,a!==0)for(s=s.entanglements,a&=d;0<a;)h=31-dr(a),m=1<<h,d|=s[h],a&=~m;return d}function bR(s,a){switch(s){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wR(s,a){for(var h=s.suspendedLanes,d=s.pingedLanes,m=s.expirationTimes,b=s.pendingLanes;0<b;){var T=31-dr(b),j=1<<T,G=m[T];G===-1?(!(j&h)||j&d)&&(m[T]=bR(j,a)):G<=a&&(s.expiredLanes|=j),b&=~j}}function pd(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function _b(){var s=au;return au<<=1,!(au&4194240)&&(au=64),s}function fd(s){for(var a=[],h=0;31>h;h++)a.push(s);return a}function ra(s,a,h){s.pendingLanes|=a,a!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,a=31-dr(a),s[a]=h}function xR(s,a){var h=s.pendingLanes&~a;s.pendingLanes=a,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=a,s.mutableReadLanes&=a,s.entangledLanes&=a,a=s.entanglements;var d=s.eventTimes;for(s=s.expirationTimes;0<h;){var m=31-dr(h),b=1<<m;a[m]=0,d[m]=-1,s[m]=-1,h&=~b}}function gd(s,a){var h=s.entangledLanes|=a;for(s=s.entanglements;h;){var d=31-dr(h),m=1<<d;m&a|s[d]&a&&(s[d]|=a),h&=~m}}var ct=0;function Sb(s){return s&=-s,1<s?4<s?s&268435455?16:536870912:4:1}var md=o.unstable_scheduleCallback,Eb=o.unstable_cancelCallback,_R=o.unstable_shouldYield,SR=o.unstable_requestPaint,ci=o.unstable_now,yd=o.unstable_ImmediatePriority,ER=o.unstable_UserBlockingPriority,vd=o.unstable_NormalPriority,AR=o.unstable_IdlePriority,hu=null,Or=null;function kR(s){if(Or&&typeof Or.onCommitFiberRoot=="function")try{Or.onCommitFiberRoot(hu,s,void 0,(s.current.flags&128)===128)}catch{}}function PR(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var pr=typeof Object.is=="function"?Object.is:PR,Xr=null,cu=!1,bd=!1;function Ab(s){Xr===null?Xr=[s]:Xr.push(s)}function CR(s){cu=!0,Ab(s)}function Rr(){if(!bd&&Xr!==null){bd=!0;var s=0,a=ct;try{var h=Xr;for(ct=1;s<h.length;s++){var d=h[s];do d=d(!0);while(d!==null)}Xr=null,cu=!1}catch(m){throw Xr!==null&&(Xr=Xr.slice(s+1)),md(yd,Rr),m}finally{ct=a,bd=!1}}return null}var Js=[],eo=0,du=null,pu=0,ir=[],rr=0,us=null,Yr=1,Kr="";function hs(s,a){Js[eo++]=pu,Js[eo++]=du,du=s,pu=a}function kb(s,a,h){ir[rr++]=Yr,ir[rr++]=Kr,ir[rr++]=us,us=s;var d=Yr;s=Kr;var m=32-dr(d)-1;d&=~(1<<m),h+=1;var b=32-dr(a)+m;if(30<b){var T=m-m%5;b=(d&(1<<T)-1).toString(32),d>>=T,m-=T,Yr=1<<32-dr(a)+m|h<<m|d,Kr=b+s}else Yr=1<<b|h<<m|d,Kr=s}function wd(s){s.return!==null&&(hs(s,1),kb(s,1,0))}function xd(s){for(;s===du;)du=Js[--eo],Js[eo]=null,pu=Js[--eo],Js[eo]=null;for(;s===us;)us=ir[--rr],ir[rr]=null,Kr=ir[--rr],ir[rr]=null,Yr=ir[--rr],ir[rr]=null}var Ki=null,nr=null,Lt=!1,na=!1,fr=null;function Pb(s,a){var h=ur(5,null,null,0);h.elementType="DELETED",h.stateNode=a,h.return=s,a=s.deletions,a===null?(s.deletions=[h],s.flags|=16):a.push(h)}function Cb(s,a){switch(s.tag){case 5:return a=XO(a,s.type,s.pendingProps),a!==null?(s.stateNode=a,Ki=s,nr=tR(a),!0):!1;case 6:return a=YO(a,s.pendingProps),a!==null?(s.stateNode=a,Ki=s,nr=null,!0):!1;case 13:if(a=KO(a),a!==null){var h=us!==null?{id:Yr,overflow:Kr}:null;return s.memoizedState={dehydrated:a,treeContext:h,retryLane:1073741824},h=ur(18,null,null,0),h.stateNode=a,h.return=s,s.child=h,Ki=s,nr=null,!0}return!1;default:return!1}}function _d(s){return(s.mode&1)!==0&&(s.flags&128)===0}function Sd(s){if(Lt){var a=nr;if(a){var h=a;if(!Cb(s,a)){if(_d(s))throw Error(u(418));a=nu(h);var d=Ki;a&&Cb(s,a)?Pb(d,h):(s.flags=s.flags&-4097|2,Lt=!1,Ki=s)}}else{if(_d(s))throw Error(u(418));s.flags=s.flags&-4097|2,Lt=!1,Ki=s}}}function Tb(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;Ki=s}function fu(s){if(!Te||s!==Ki)return!1;if(!Lt)return Tb(s),Lt=!0,!1;if(s.tag!==3&&(s.tag!==5||dR(s.type)&&!kt(s.type,s.memoizedProps))){var a=nr;if(a){if(_d(s))throw Ib(),Error(u(418));for(;a;)Pb(s,a),a=nu(a)}}if(Tb(s),s.tag===13){if(!Te)throw Error(u(316));if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(u(317));nr=aR(s)}else nr=Ki?nu(s.stateNode):null;return!0}function Ib(){for(var s=nr;s;)s=nu(s)}function to(){Te&&(nr=Ki=null,na=Lt=!1)}function Ed(s){fr===null?fr=[s]:fr.push(s)}var TR=c.ReactCurrentBatchConfig;function gu(s,a){if(pr(s,a))return!0;if(typeof s!="object"||s===null||typeof a!="object"||a===null)return!1;var h=Object.keys(s),d=Object.keys(a);if(h.length!==d.length)return!1;for(d=0;d<h.length;d++){var m=h[d];if(!gR.call(a,m)||!pr(s[m],a[m]))return!1}return!0}function IR(s){switch(s.tag){case 5:return ta(s.type);case 16:return ta("Lazy");case 13:return ta("Suspense");case 19:return ta("SuspenseList");case 0:case 2:case 15:return s=cd(s.type,!1),s;case 11:return s=cd(s.type.render,!1),s;case 1:return s=cd(s.type,!0),s;default:return""}}function gr(s,a){if(s&&s.defaultProps){a=l({},a),s=s.defaultProps;for(var h in s)a[h]===void 0&&(a[h]=s[h]);return a}return a}var mu=wn(null),yu=null,io=null,Ad=null;function kd(){Ad=io=yu=null}function Ob(s,a,h){Zt?(Pt(mu,a._currentValue),a._currentValue=h):(Pt(mu,a._currentValue2),a._currentValue2=h)}function Pd(s){var a=mu.current;Ot(mu),Zt?s._currentValue=a:s._currentValue2=a}function Cd(s,a,h){for(;s!==null;){var d=s.alternate;if((s.childLanes&a)!==a?(s.childLanes|=a,d!==null&&(d.childLanes|=a)):d!==null&&(d.childLanes&a)!==a&&(d.childLanes|=a),s===h)break;s=s.return}}function ro(s,a){yu=s,Ad=io=null,s=s.dependencies,s!==null&&s.firstContext!==null&&(s.lanes&a&&(qi=!0),s.firstContext=null)}function sr(s){var a=Zt?s._currentValue:s._currentValue2;if(Ad!==s)if(s={context:s,memoizedValue:a,next:null},io===null){if(yu===null)throw Error(u(308));io=s,yu.dependencies={lanes:0,firstContext:s}}else io=io.next=s;return a}var cs=null;function Td(s){cs===null?cs=[s]:cs.push(s)}function Rb(s,a,h,d){var m=a.interleaved;return m===null?(h.next=h,Td(a)):(h.next=m.next,m.next=h),a.interleaved=h,Mr(s,d)}function Mr(s,a){s.lanes|=a;var h=s.alternate;for(h!==null&&(h.lanes|=a),h=s,s=s.return;s!==null;)s.childLanes|=a,h=s.alternate,h!==null&&(h.childLanes|=a),h=s,s=s.return;return h.tag===3?h.stateNode:null}var _n=!1;function Id(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Mb(s,a){s=s.updateQueue,a.updateQueue===s&&(a.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function Jr(s,a){return{eventTime:s,lane:a,tag:0,payload:null,callback:null,next:null}}function Sn(s,a,h){var d=s.updateQueue;if(d===null)return null;if(d=d.shared,(tt&2)!==0){var m=d.pending;return m===null?a.next=a:(a.next=m.next,m.next=a),d.pending=a,Mr(s,h)}return m=d.interleaved,m===null?(a.next=a,Td(d)):(a.next=m.next,m.next=a),d.interleaved=a,Mr(s,h)}function vu(s,a,h){if(a=a.updateQueue,a!==null&&(a=a.shared,(h&4194240)!==0)){var d=a.lanes;d&=s.pendingLanes,h|=d,a.lanes=h,gd(s,h)}}function Lb(s,a){var h=s.updateQueue,d=s.alternate;if(d!==null&&(d=d.updateQueue,h===d)){var m=null,b=null;if(h=h.firstBaseUpdate,h!==null){do{var T={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};b===null?m=b=T:b=b.next=T,h=h.next}while(h!==null);b===null?m=b=a:b=b.next=a}else m=b=a;h={baseState:d.baseState,firstBaseUpdate:m,lastBaseUpdate:b,shared:d.shared,effects:d.effects},s.updateQueue=h;return}s=h.lastBaseUpdate,s===null?h.firstBaseUpdate=a:s.next=a,h.lastBaseUpdate=a}function bu(s,a,h,d){var m=s.updateQueue;_n=!1;var b=m.firstBaseUpdate,T=m.lastBaseUpdate,j=m.shared.pending;if(j!==null){m.shared.pending=null;var G=j,ae=G.next;G.next=null,T===null?b=ae:T.next=ae,T=G;var Ee=s.alternate;Ee!==null&&(Ee=Ee.updateQueue,j=Ee.lastBaseUpdate,j!==T&&(j===null?Ee.firstBaseUpdate=ae:j.next=ae,Ee.lastBaseUpdate=G))}if(b!==null){var Qe=m.baseState;T=0,Ee=ae=G=null,j=b;do{var ye=j.lane,Rt=j.eventTime;if((d&ye)===ye){Ee!==null&&(Ee=Ee.next={eventTime:Rt,lane:0,tag:j.tag,payload:j.payload,callback:j.callback,next:null});e:{var St=s,Gi=j;switch(ye=a,Rt=h,Gi.tag){case 1:if(St=Gi.payload,typeof St=="function"){Qe=St.call(Rt,Qe,ye);break e}Qe=St;break e;case 3:St.flags=St.flags&-65537|128;case 0:if(St=Gi.payload,ye=typeof St=="function"?St.call(Rt,Qe,ye):St,ye==null)break e;Qe=l({},Qe,ye);break e;case 2:_n=!0}}j.callback!==null&&j.lane!==0&&(s.flags|=64,ye=m.effects,ye===null?m.effects=[j]:ye.push(j))}else Rt={eventTime:Rt,lane:ye,tag:j.tag,payload:j.payload,callback:j.callback,next:null},Ee===null?(ae=Ee=Rt,G=Qe):Ee=Ee.next=Rt,T|=ye;if(j=j.next,j===null){if(j=m.shared.pending,j===null)break;ye=j,j=ye.next,ye.next=null,m.lastBaseUpdate=ye,m.shared.pending=null}}while(1);if(Ee===null&&(G=Qe),m.baseState=G,m.firstBaseUpdate=ae,m.lastBaseUpdate=Ee,a=m.shared.interleaved,a!==null){m=a;do T|=m.lane,m=m.next;while(m!==a)}else b===null&&(m.shared.lanes=0);ps|=T,s.lanes=T,s.memoizedState=Qe}}function $b(s,a,h){if(s=a.effects,a.effects=null,s!==null)for(a=0;a<s.length;a++){var d=s[a],m=d.callback;if(m!==null){if(d.callback=null,d=h,typeof m!="function")throw Error(u(191,m));m.call(d)}}}var Nb=new n.Component().refs;function Od(s,a,h,d){a=s.memoizedState,h=h(d,a),h=h==null?a:l({},a,h),s.memoizedState=h,s.lanes===0&&(s.updateQueue.baseState=h)}var wu={isMounted:function(s){return(s=s._reactInternals)?Q(s)===s:!1},enqueueSetState:function(s,a,h){s=s._reactInternals;var d=Li(),m=kn(s),b=Jr(d,m);b.payload=a,h!=null&&(b.callback=h),a=Sn(s,b,m),a!==null&&(lr(a,s,m,d),vu(a,s,m))},enqueueReplaceState:function(s,a,h){s=s._reactInternals;var d=Li(),m=kn(s),b=Jr(d,m);b.tag=1,b.payload=a,h!=null&&(b.callback=h),a=Sn(s,b,m),a!==null&&(lr(a,s,m,d),vu(a,s,m))},enqueueForceUpdate:function(s,a){s=s._reactInternals;var h=Li(),d=kn(s),m=Jr(h,d);m.tag=2,a!=null&&(m.callback=a),a=Sn(s,m,d),a!==null&&(lr(a,s,d,h),vu(a,s,d))}};function zb(s,a,h,d,m,b,T){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(d,b,T):a.prototype&&a.prototype.isPureReactComponent?!gu(h,d)||!gu(m,b):!0}function Fb(s,a,h){var d=!1,m=xn,b=a.contextType;return typeof b=="object"&&b!==null?b=sr(b):(m=Hi(a)?ls:Ii.current,d=a.contextTypes,b=(d=d!=null)?Ks(s,m):xn),a=new a(h,b),s.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=wu,s.stateNode=a,a._reactInternals=s,d&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=m,s.__reactInternalMemoizedMaskedChildContext=b),a}function Bb(s,a,h,d){s=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(h,d),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(h,d),a.state!==s&&wu.enqueueReplaceState(a,a.state,null)}function Rd(s,a,h,d){var m=s.stateNode;m.props=h,m.state=s.memoizedState,m.refs=Nb,Id(s);var b=a.contextType;typeof b=="object"&&b!==null?m.context=sr(b):(b=Hi(a)?ls:Ii.current,m.context=Ks(s,b)),m.state=s.memoizedState,b=a.getDerivedStateFromProps,typeof b=="function"&&(Od(s,a,b,h),m.state=s.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(a=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),a!==m.state&&wu.enqueueReplaceState(m,m.state,null),bu(s,h,m,d),m.state=s.memoizedState),typeof m.componentDidMount=="function"&&(s.flags|=4194308)}function sa(s,a,h){if(s=h.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(u(309));var d=h.stateNode}if(!d)throw Error(u(147,s));var m=d,b=""+s;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===b?a.ref:(a=function(T){var j=m.refs;j===Nb&&(j=m.refs={}),T===null?delete j[b]:j[b]=T},a._stringRef=b,a)}if(typeof s!="string")throw Error(u(284));if(!h._owner)throw Error(u(290,s))}return s}function xu(s,a){throw s=Object.prototype.toString.call(a),Error(u(31,s==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":s))}function jb(s){var a=s._init;return a(s._payload)}function Ub(s){function a(q,W){if(s){var X=q.deletions;X===null?(q.deletions=[W],q.flags|=16):X.push(W)}}function h(q,W){if(!s)return null;for(;W!==null;)a(q,W),W=W.sibling;return null}function d(q,W){for(q=new Map;W!==null;)W.key!==null?q.set(W.key,W):q.set(W.index,W),W=W.sibling;return q}function m(q,W){return q=Cn(q,W),q.index=0,q.sibling=null,q}function b(q,W,X){return q.index=X,s?(X=q.alternate,X!==null?(X=X.index,X<W?(q.flags|=2,W):X):(q.flags|=2,W)):(q.flags|=1048576,W)}function T(q){return s&&q.alternate===null&&(q.flags|=2),q}function j(q,W,X,ve){return W===null||W.tag!==6?(W=vp(X,q.mode,ve),W.return=q,W):(W=m(W,X),W.return=q,W)}function G(q,W,X,ve){var Fe=X.type;return Fe===v?Ee(q,W,X.props.children,ve,X.key):W!==null&&(W.elementType===Fe||typeof Fe=="object"&&Fe!==null&&Fe.$$typeof===z&&jb(Fe)===W.type)?(ve=m(W,X.props),ve.ref=sa(q,W,X),ve.return=q,ve):(ve=Vu(X.type,X.key,X.props,null,q.mode,ve),ve.ref=sa(q,W,X),ve.return=q,ve)}function ae(q,W,X,ve){return W===null||W.tag!==4||W.stateNode.containerInfo!==X.containerInfo||W.stateNode.implementation!==X.implementation?(W=bp(X,q.mode,ve),W.return=q,W):(W=m(W,X.children||[]),W.return=q,W)}function Ee(q,W,X,ve,Fe){return W===null||W.tag!==7?(W=ys(X,q.mode,ve,Fe),W.return=q,W):(W=m(W,X),W.return=q,W)}function Qe(q,W,X){if(typeof W=="string"&&W!==""||typeof W=="number")return W=vp(""+W,q.mode,X),W.return=q,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case p:return X=Vu(W.type,W.key,W.props,null,q.mode,X),X.ref=sa(q,null,W),X.return=q,X;case f:return W=bp(W,q.mode,X),W.return=q,W;case z:var ve=W._init;return Qe(q,ve(W._payload),X)}if(Pe(W)||Y(W))return W=ys(W,q.mode,X,null),W.return=q,W;xu(q,W)}return null}function ye(q,W,X,ve){var Fe=W!==null?W.key:null;if(typeof X=="string"&&X!==""||typeof X=="number")return Fe!==null?null:j(q,W,""+X,ve);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case p:return X.key===Fe?G(q,W,X,ve):null;case f:return X.key===Fe?ae(q,W,X,ve):null;case z:return Fe=X._init,ye(q,W,Fe(X._payload),ve)}if(Pe(X)||Y(X))return Fe!==null?null:Ee(q,W,X,ve,null);xu(q,X)}return null}function Rt(q,W,X,ve,Fe){if(typeof ve=="string"&&ve!==""||typeof ve=="number")return q=q.get(X)||null,j(W,q,""+ve,Fe);if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case p:return q=q.get(ve.key===null?X:ve.key)||null,G(W,q,ve,Fe);case f:return q=q.get(ve.key===null?X:ve.key)||null,ae(W,q,ve,Fe);case z:var Je=ve._init;return Rt(q,W,X,Je(ve._payload),Fe)}if(Pe(ve)||Y(ve))return q=q.get(X)||null,Ee(W,q,ve,Fe,null);xu(W,ve)}return null}function St(q,W,X,ve){for(var Fe=null,Je=null,Ve=W,dt=W=0,fi=null;Ve!==null&&dt<X.length;dt++){Ve.index>dt?(fi=Ve,Ve=null):fi=Ve.sibling;var pt=ye(q,Ve,X[dt],ve);if(pt===null){Ve===null&&(Ve=fi);break}s&&Ve&&pt.alternate===null&&a(q,Ve),W=b(pt,W,dt),Je===null?Fe=pt:Je.sibling=pt,Je=pt,Ve=fi}if(dt===X.length)return h(q,Ve),Lt&&hs(q,dt),Fe;if(Ve===null){for(;dt<X.length;dt++)Ve=Qe(q,X[dt],ve),Ve!==null&&(W=b(Ve,W,dt),Je===null?Fe=Ve:Je.sibling=Ve,Je=Ve);return Lt&&hs(q,dt),Fe}for(Ve=d(q,Ve);dt<X.length;dt++)fi=Rt(Ve,q,dt,X[dt],ve),fi!==null&&(s&&fi.alternate!==null&&Ve.delete(fi.key===null?dt:fi.key),W=b(fi,W,dt),Je===null?Fe=fi:Je.sibling=fi,Je=fi);return s&&Ve.forEach(function(Tn){return a(q,Tn)}),Lt&&hs(q,dt),Fe}function Gi(q,W,X,ve){var Fe=Y(X);if(typeof Fe!="function")throw Error(u(150));if(X=Fe.call(X),X==null)throw Error(u(151));for(var Je=Fe=null,Ve=W,dt=W=0,fi=null,pt=X.next();Ve!==null&&!pt.done;dt++,pt=X.next()){Ve.index>dt?(fi=Ve,Ve=null):fi=Ve.sibling;var Tn=ye(q,Ve,pt.value,ve);if(Tn===null){Ve===null&&(Ve=fi);break}s&&Ve&&Tn.alternate===null&&a(q,Ve),W=b(Tn,W,dt),Je===null?Fe=Tn:Je.sibling=Tn,Je=Tn,Ve=fi}if(pt.done)return h(q,Ve),Lt&&hs(q,dt),Fe;if(Ve===null){for(;!pt.done;dt++,pt=X.next())pt=Qe(q,pt.value,ve),pt!==null&&(W=b(pt,W,dt),Je===null?Fe=pt:Je.sibling=pt,Je=pt);return Lt&&hs(q,dt),Fe}for(Ve=d(q,Ve);!pt.done;dt++,pt=X.next())pt=Rt(Ve,q,dt,pt.value,ve),pt!==null&&(s&&pt.alternate!==null&&Ve.delete(pt.key===null?dt:pt.key),W=b(pt,W,dt),Je===null?Fe=pt:Je.sibling=pt,Je=pt);return s&&Ve.forEach(function(oM){return a(q,oM)}),Lt&&hs(q,dt),Fe}function rn(q,W,X,ve){if(typeof X=="object"&&X!==null&&X.type===v&&X.key===null&&(X=X.props.children),typeof X=="object"&&X!==null){switch(X.$$typeof){case p:e:{for(var Fe=X.key,Je=W;Je!==null;){if(Je.key===Fe){if(Fe=X.type,Fe===v){if(Je.tag===7){h(q,Je.sibling),W=m(Je,X.props.children),W.return=q,q=W;break e}}else if(Je.elementType===Fe||typeof Fe=="object"&&Fe!==null&&Fe.$$typeof===z&&jb(Fe)===Je.type){h(q,Je.sibling),W=m(Je,X.props),W.ref=sa(q,Je,X),W.return=q,q=W;break e}h(q,Je);break}else a(q,Je);Je=Je.sibling}X.type===v?(W=ys(X.props.children,q.mode,ve,X.key),W.return=q,q=W):(ve=Vu(X.type,X.key,X.props,null,q.mode,ve),ve.ref=sa(q,W,X),ve.return=q,q=ve)}return T(q);case f:e:{for(Je=X.key;W!==null;){if(W.key===Je)if(W.tag===4&&W.stateNode.containerInfo===X.containerInfo&&W.stateNode.implementation===X.implementation){h(q,W.sibling),W=m(W,X.children||[]),W.return=q,q=W;break e}else{h(q,W);break}else a(q,W);W=W.sibling}W=bp(X,q.mode,ve),W.return=q,q=W}return T(q);case z:return Je=X._init,rn(q,W,Je(X._payload),ve)}if(Pe(X))return St(q,W,X,ve);if(Y(X))return Gi(q,W,X,ve);xu(q,X)}return typeof X=="string"&&X!==""||typeof X=="number"?(X=""+X,W!==null&&W.tag===6?(h(q,W.sibling),W=m(W,X),W.return=q,q=W):(h(q,W),W=vp(X,q.mode,ve),W.return=q,q=W),T(q)):h(q,W)}return rn}var no=Ub(!0),Db=Ub(!1),oa={},or=wn(oa),aa=wn(oa),so=wn(oa);function Lr(s){if(s===oa)throw Error(u(174));return s}function Md(s,a){Pt(so,a),Pt(aa,s),Pt(or,oa),s=re(a),Ot(or),Pt(or,s)}function oo(){Ot(or),Ot(aa),Ot(so)}function Wb(s){var a=Lr(so.current),h=Lr(or.current);a=Ie(h,s.type,a),h!==a&&(Pt(aa,s),Pt(or,a))}function Ld(s){aa.current===s&&(Ot(or),Ot(aa))}var Dt=wn(0);function _u(s){for(var a=s;a!==null;){if(a.tag===13){var h=a.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||vb(h)||ld(h)))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if(a.flags&128)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var $d=[];function Nd(){for(var s=0;s<$d.length;s++){var a=$d[s];Zt?a._workInProgressVersionPrimary=null:a._workInProgressVersionSecondary=null}$d.length=0}var Su=c.ReactCurrentDispatcher,zd=c.ReactCurrentBatchConfig,ds=0,Wt=null,ri=null,di=null,Eu=!1,la=!1,ua=0,OR=0;function Oi(){throw Error(u(321))}function Fd(s,a){if(a===null)return!1;for(var h=0;h<a.length&&h<s.length;h++)if(!pr(s[h],a[h]))return!1;return!0}function Bd(s,a,h,d,m,b){if(ds=b,Wt=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,Su.current=s===null||s.memoizedState===null?$R:NR,s=h(d,m),la){b=0;do{if(la=!1,ua=0,25<=b)throw Error(u(301));b+=1,di=ri=null,a.updateQueue=null,Su.current=zR,s=h(d,m)}while(la)}if(Su.current=Pu,a=ri!==null&&ri.next!==null,ds=0,di=ri=Wt=null,Eu=!1,a)throw Error(u(300));return s}function jd(){var s=ua!==0;return ua=0,s}function $r(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return di===null?Wt.memoizedState=di=s:di=di.next=s,di}function ar(){if(ri===null){var s=Wt.alternate;s=s!==null?s.memoizedState:null}else s=ri.next;var a=di===null?Wt.memoizedState:di.next;if(a!==null)di=a,ri=s;else{if(s===null)throw Error(u(310));ri=s,s={memoizedState:ri.memoizedState,baseState:ri.baseState,baseQueue:ri.baseQueue,queue:ri.queue,next:null},di===null?Wt.memoizedState=di=s:di=di.next=s}return di}function ha(s,a){return typeof a=="function"?a(s):a}function Ud(s){var a=ar(),h=a.queue;if(h===null)throw Error(u(311));h.lastRenderedReducer=s;var d=ri,m=d.baseQueue,b=h.pending;if(b!==null){if(m!==null){var T=m.next;m.next=b.next,b.next=T}d.baseQueue=m=b,h.pending=null}if(m!==null){b=m.next,d=d.baseState;var j=T=null,G=null,ae=b;do{var Ee=ae.lane;if((ds&Ee)===Ee)G!==null&&(G=G.next={lane:0,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null}),d=ae.hasEagerState?ae.eagerState:s(d,ae.action);else{var Qe={lane:Ee,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null};G===null?(j=G=Qe,T=d):G=G.next=Qe,Wt.lanes|=Ee,ps|=Ee}ae=ae.next}while(ae!==null&&ae!==b);G===null?T=d:G.next=j,pr(d,a.memoizedState)||(qi=!0),a.memoizedState=d,a.baseState=T,a.baseQueue=G,h.lastRenderedState=d}if(s=h.interleaved,s!==null){m=s;do b=m.lane,Wt.lanes|=b,ps|=b,m=m.next;while(m!==s)}else m===null&&(h.lanes=0);return[a.memoizedState,h.dispatch]}function Dd(s){var a=ar(),h=a.queue;if(h===null)throw Error(u(311));h.lastRenderedReducer=s;var d=h.dispatch,m=h.pending,b=a.memoizedState;if(m!==null){h.pending=null;var T=m=m.next;do b=s(b,T.action),T=T.next;while(T!==m);pr(b,a.memoizedState)||(qi=!0),a.memoizedState=b,a.baseQueue===null&&(a.baseState=b),h.lastRenderedState=b}return[b,d]}function Hb(){}function qb(s,a){var h=Wt,d=ar(),m=a(),b=!pr(d.memoizedState,m);if(b&&(d.memoizedState=m,qi=!0),d=d.queue,Wd(Gb.bind(null,h,d,s),[s]),d.getSnapshot!==a||b||di!==null&&di.memoizedState.tag&1){if(h.flags|=2048,ca(9,Vb.bind(null,h,d,m,a),void 0,null),pi===null)throw Error(u(349));ds&30||Qb(h,a,m)}return m}function Qb(s,a,h){s.flags|=16384,s={getSnapshot:a,value:h},a=Wt.updateQueue,a===null?(a={lastEffect:null,stores:null},Wt.updateQueue=a,a.stores=[s]):(h=a.stores,h===null?a.stores=[s]:h.push(s))}function Vb(s,a,h,d){a.value=h,a.getSnapshot=d,Zb(a)&&Xb(s)}function Gb(s,a,h){return h(function(){Zb(a)&&Xb(s)})}function Zb(s){var a=s.getSnapshot;s=s.value;try{var h=a();return!pr(s,h)}catch{return!0}}function Xb(s){var a=Mr(s,1);a!==null&&lr(a,s,1,-1)}function Yb(s){var a=$r();return typeof s=="function"&&(s=s()),a.memoizedState=a.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ha,lastRenderedState:s},a.queue=s,s=s.dispatch=LR.bind(null,Wt,s),[a.memoizedState,s]}function ca(s,a,h,d){return s={tag:s,create:a,destroy:h,deps:d,next:null},a=Wt.updateQueue,a===null?(a={lastEffect:null,stores:null},Wt.updateQueue=a,a.lastEffect=s.next=s):(h=a.lastEffect,h===null?a.lastEffect=s.next=s:(d=h.next,h.next=s,s.next=d,a.lastEffect=s)),s}function Kb(){return ar().memoizedState}function Au(s,a,h,d){var m=$r();Wt.flags|=s,m.memoizedState=ca(1|a,h,void 0,d===void 0?null:d)}function ku(s,a,h,d){var m=ar();d=d===void 0?null:d;var b=void 0;if(ri!==null){var T=ri.memoizedState;if(b=T.destroy,d!==null&&Fd(d,T.deps)){m.memoizedState=ca(a,h,b,d);return}}Wt.flags|=s,m.memoizedState=ca(1|a,h,b,d)}function Jb(s,a){return Au(8390656,8,s,a)}function Wd(s,a){return ku(2048,8,s,a)}function e1(s,a){return ku(4,2,s,a)}function t1(s,a){return ku(4,4,s,a)}function i1(s,a){if(typeof a=="function")return s=s(),a(s),function(){a(null)};if(a!=null)return s=s(),a.current=s,function(){a.current=null}}function r1(s,a,h){return h=h!=null?h.concat([s]):null,ku(4,4,i1.bind(null,a,s),h)}function Hd(){}function n1(s,a){var h=ar();a=a===void 0?null:a;var d=h.memoizedState;return d!==null&&a!==null&&Fd(a,d[1])?d[0]:(h.memoizedState=[s,a],s)}function s1(s,a){var h=ar();a=a===void 0?null:a;var d=h.memoizedState;return d!==null&&a!==null&&Fd(a,d[1])?d[0]:(s=s(),h.memoizedState=[s,a],s)}function o1(s,a,h){return ds&21?(pr(h,a)||(h=_b(),Wt.lanes|=h,ps|=h,s.baseState=!0),a):(s.baseState&&(s.baseState=!1,qi=!0),s.memoizedState=h)}function RR(s,a){var h=ct;ct=h!==0&&4>h?h:4,s(!0);var d=zd.transition;zd.transition={};try{s(!1),a()}finally{ct=h,zd.transition=d}}function a1(){return ar().memoizedState}function MR(s,a,h){var d=kn(s);if(h={lane:d,action:h,hasEagerState:!1,eagerState:null,next:null},l1(s))u1(a,h);else if(h=Rb(s,a,h,d),h!==null){var m=Li();lr(h,s,d,m),h1(h,a,d)}}function LR(s,a,h){var d=kn(s),m={lane:d,action:h,hasEagerState:!1,eagerState:null,next:null};if(l1(s))u1(a,m);else{var b=s.alternate;if(s.lanes===0&&(b===null||b.lanes===0)&&(b=a.lastRenderedReducer,b!==null))try{var T=a.lastRenderedState,j=b(T,h);if(m.hasEagerState=!0,m.eagerState=j,pr(j,T)){var G=a.interleaved;G===null?(m.next=m,Td(a)):(m.next=G.next,G.next=m),a.interleaved=m;return}}catch{}finally{}h=Rb(s,a,m,d),h!==null&&(m=Li(),lr(h,s,d,m),h1(h,a,d))}}function l1(s){var a=s.alternate;return s===Wt||a!==null&&a===Wt}function u1(s,a){la=Eu=!0;var h=s.pending;h===null?a.next=a:(a.next=h.next,h.next=a),s.pending=a}function h1(s,a,h){if(h&4194240){var d=a.lanes;d&=s.pendingLanes,h|=d,a.lanes=h,gd(s,h)}}var Pu={readContext:sr,useCallback:Oi,useContext:Oi,useEffect:Oi,useImperativeHandle:Oi,useInsertionEffect:Oi,useLayoutEffect:Oi,useMemo:Oi,useReducer:Oi,useRef:Oi,useState:Oi,useDebugValue:Oi,useDeferredValue:Oi,useTransition:Oi,useMutableSource:Oi,useSyncExternalStore:Oi,useId:Oi,unstable_isNewReconciler:!1},$R={readContext:sr,useCallback:function(s,a){return $r().memoizedState=[s,a===void 0?null:a],s},useContext:sr,useEffect:Jb,useImperativeHandle:function(s,a,h){return h=h!=null?h.concat([s]):null,Au(4194308,4,i1.bind(null,a,s),h)},useLayoutEffect:function(s,a){return Au(4194308,4,s,a)},useInsertionEffect:function(s,a){return Au(4,2,s,a)},useMemo:function(s,a){var h=$r();return a=a===void 0?null:a,s=s(),h.memoizedState=[s,a],s},useReducer:function(s,a,h){var d=$r();return a=h!==void 0?h(a):a,d.memoizedState=d.baseState=a,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:a},d.queue=s,s=s.dispatch=MR.bind(null,Wt,s),[d.memoizedState,s]},useRef:function(s){var a=$r();return s={current:s},a.memoizedState=s},useState:Yb,useDebugValue:Hd,useDeferredValue:function(s){return $r().memoizedState=s},useTransition:function(){var s=Yb(!1),a=s[0];return s=RR.bind(null,s[1]),$r().memoizedState=s,[a,s]},useMutableSource:function(){},useSyncExternalStore:function(s,a,h){var d=Wt,m=$r();if(Lt){if(h===void 0)throw Error(u(407));h=h()}else{if(h=a(),pi===null)throw Error(u(349));ds&30||Qb(d,a,h)}m.memoizedState=h;var b={value:h,getSnapshot:a};return m.queue=b,Jb(Gb.bind(null,d,b,s),[s]),d.flags|=2048,ca(9,Vb.bind(null,d,b,h,a),void 0,null),h},useId:function(){var s=$r(),a=pi.identifierPrefix;if(Lt){var h=Kr,d=Yr;h=(d&~(1<<32-dr(d)-1)).toString(32)+h,a=":"+a+"R"+h,h=ua++,0<h&&(a+="H"+h.toString(32)),a+=":"}else h=OR++,a=":"+a+"r"+h.toString(32)+":";return s.memoizedState=a},unstable_isNewReconciler:!1},NR={readContext:sr,useCallback:n1,useContext:sr,useEffect:Wd,useImperativeHandle:r1,useInsertionEffect:e1,useLayoutEffect:t1,useMemo:s1,useReducer:Ud,useRef:Kb,useState:function(){return Ud(ha)},useDebugValue:Hd,useDeferredValue:function(s){var a=ar();return o1(a,ri.memoizedState,s)},useTransition:function(){var s=Ud(ha)[0],a=ar().memoizedState;return[s,a]},useMutableSource:Hb,useSyncExternalStore:qb,useId:a1,unstable_isNewReconciler:!1},zR={readContext:sr,useCallback:n1,useContext:sr,useEffect:Wd,useImperativeHandle:r1,useInsertionEffect:e1,useLayoutEffect:t1,useMemo:s1,useReducer:Dd,useRef:Kb,useState:function(){return Dd(ha)},useDebugValue:Hd,useDeferredValue:function(s){var a=ar();return ri===null?a.memoizedState=s:o1(a,ri.memoizedState,s)},useTransition:function(){var s=Dd(ha)[0],a=ar().memoizedState;return[s,a]},useMutableSource:Hb,useSyncExternalStore:qb,useId:a1,unstable_isNewReconciler:!1};function ao(s,a){try{var h="",d=a;do h+=IR(d),d=d.return;while(d);var m=h}catch(b){m=`
Error generating stack: `+b.message+`
`+b.stack}return{value:s,source:a,stack:m,digest:null}}function qd(s,a,h){return{value:s,source:null,stack:h??null,digest:a??null}}function Qd(s,a){try{console.error(a.value)}catch(h){setTimeout(function(){throw h})}}var FR=typeof WeakMap=="function"?WeakMap:Map;function c1(s,a,h){h=Jr(-1,h),h.tag=3,h.payload={element:null};var d=a.value;return h.callback=function(){Uu||(Uu=!0,cp=d),Qd(s,a)},h}function d1(s,a,h){h=Jr(-1,h),h.tag=3;var d=s.type.getDerivedStateFromError;if(typeof d=="function"){var m=a.value;h.payload=function(){return d(m)},h.callback=function(){Qd(s,a)}}var b=s.stateNode;return b!==null&&typeof b.componentDidCatch=="function"&&(h.callback=function(){Qd(s,a),typeof d!="function"&&(En===null?En=new Set([this]):En.add(this));var T=a.stack;this.componentDidCatch(a.value,{componentStack:T!==null?T:""})}),h}function p1(s,a,h){var d=s.pingCache;if(d===null){d=s.pingCache=new FR;var m=new Set;d.set(a,m)}else m=d.get(a),m===void 0&&(m=new Set,d.set(a,m));m.has(h)||(m.add(h),s=KR.bind(null,s,a,h),a.then(s,s))}function f1(s){do{var a;if((a=s.tag===13)&&(a=s.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return s;s=s.return}while(s!==null);return null}function g1(s,a,h,d,m){return s.mode&1?(s.flags|=65536,s.lanes=m,s):(s===a?s.flags|=65536:(s.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(a=Jr(-1,1),a.tag=2,Sn(h,a,1))),h.lanes|=1),s)}var BR=c.ReactCurrentOwner,qi=!1;function Bi(s,a,h,d){a.child=s===null?Db(a,null,h,d):no(a,s.child,h,d)}function m1(s,a,h,d,m){h=h.render;var b=a.ref;return ro(a,m),d=Bd(s,a,h,d,b,m),h=jd(),s!==null&&!qi?(a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~m,en(s,a,m)):(Lt&&h&&wd(a),a.flags|=1,Bi(s,a,d,m),a.child)}function y1(s,a,h,d,m){if(s===null){var b=h.type;return typeof b=="function"&&!yp(b)&&b.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(a.tag=15,a.type=b,v1(s,a,b,d,m)):(s=Vu(h.type,null,d,a,a.mode,m),s.ref=a.ref,s.return=a,a.child=s)}if(b=s.child,(s.lanes&m)===0){var T=b.memoizedProps;if(h=h.compare,h=h!==null?h:gu,h(T,d)&&s.ref===a.ref)return en(s,a,m)}return a.flags|=1,s=Cn(b,d),s.ref=a.ref,s.return=a,a.child=s}function v1(s,a,h,d,m){if(s!==null){var b=s.memoizedProps;if(gu(b,d)&&s.ref===a.ref)if(qi=!1,a.pendingProps=d=b,(s.lanes&m)!==0)s.flags&131072&&(qi=!0);else return a.lanes=s.lanes,en(s,a,m)}return Vd(s,a,h,d,m)}function b1(s,a,h){var d=a.pendingProps,m=d.children,b=s!==null?s.memoizedState:null;if(d.mode==="hidden")if(!(a.mode&1))a.memoizedState={baseLanes:0,cachePool:null,transitions:null},Pt(uo,Ji),Ji|=h;else{if(!(h&1073741824))return s=b!==null?b.baseLanes|h:h,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:s,cachePool:null,transitions:null},a.updateQueue=null,Pt(uo,Ji),Ji|=s,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},d=b!==null?b.baseLanes:h,Pt(uo,Ji),Ji|=d}else b!==null?(d=b.baseLanes|h,a.memoizedState=null):d=h,Pt(uo,Ji),Ji|=d;return Bi(s,a,m,h),a.child}function w1(s,a){var h=a.ref;(s===null&&h!==null||s!==null&&s.ref!==h)&&(a.flags|=512,a.flags|=2097152)}function Vd(s,a,h,d,m){var b=Hi(h)?ls:Ii.current;return b=Ks(a,b),ro(a,m),h=Bd(s,a,h,d,b,m),d=jd(),s!==null&&!qi?(a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~m,en(s,a,m)):(Lt&&d&&wd(a),a.flags|=1,Bi(s,a,h,m),a.child)}function x1(s,a,h,d,m){if(Hi(h)){var b=!0;ou(a)}else b=!1;if(ro(a,m),a.stateNode===null)Tu(s,a),Fb(a,h,d),Rd(a,h,d,m),d=!0;else if(s===null){var T=a.stateNode,j=a.memoizedProps;T.props=j;var G=T.context,ae=h.contextType;typeof ae=="object"&&ae!==null?ae=sr(ae):(ae=Hi(h)?ls:Ii.current,ae=Ks(a,ae));var Ee=h.getDerivedStateFromProps,Qe=typeof Ee=="function"||typeof T.getSnapshotBeforeUpdate=="function";Qe||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(j!==d||G!==ae)&&Bb(a,T,d,ae),_n=!1;var ye=a.memoizedState;T.state=ye,bu(a,d,T,m),G=a.memoizedState,j!==d||ye!==G||Wi.current||_n?(typeof Ee=="function"&&(Od(a,h,Ee,d),G=a.memoizedState),(j=_n||zb(a,h,j,d,ye,G,ae))?(Qe||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(a.flags|=4194308)):(typeof T.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=d,a.memoizedState=G),T.props=d,T.state=G,T.context=ae,d=j):(typeof T.componentDidMount=="function"&&(a.flags|=4194308),d=!1)}else{T=a.stateNode,Mb(s,a),j=a.memoizedProps,ae=a.type===a.elementType?j:gr(a.type,j),T.props=ae,Qe=a.pendingProps,ye=T.context,G=h.contextType,typeof G=="object"&&G!==null?G=sr(G):(G=Hi(h)?ls:Ii.current,G=Ks(a,G));var Rt=h.getDerivedStateFromProps;(Ee=typeof Rt=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(j!==Qe||ye!==G)&&Bb(a,T,d,G),_n=!1,ye=a.memoizedState,T.state=ye,bu(a,d,T,m);var St=a.memoizedState;j!==Qe||ye!==St||Wi.current||_n?(typeof Rt=="function"&&(Od(a,h,Rt,d),St=a.memoizedState),(ae=_n||zb(a,h,ae,d,ye,St,G)||!1)?(Ee||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(d,St,G),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(d,St,G)),typeof T.componentDidUpdate=="function"&&(a.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof T.componentDidUpdate!="function"||j===s.memoizedProps&&ye===s.memoizedState||(a.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||j===s.memoizedProps&&ye===s.memoizedState||(a.flags|=1024),a.memoizedProps=d,a.memoizedState=St),T.props=d,T.state=St,T.context=G,d=ae):(typeof T.componentDidUpdate!="function"||j===s.memoizedProps&&ye===s.memoizedState||(a.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||j===s.memoizedProps&&ye===s.memoizedState||(a.flags|=1024),d=!1)}return Gd(s,a,h,d,b,m)}function Gd(s,a,h,d,m,b){w1(s,a);var T=(a.flags&128)!==0;if(!d&&!T)return m&&xb(a,h,!1),en(s,a,b);d=a.stateNode,BR.current=a;var j=T&&typeof h.getDerivedStateFromError!="function"?null:d.render();return a.flags|=1,s!==null&&T?(a.child=no(a,s.child,null,b),a.child=no(a,null,j,b)):Bi(s,a,j,b),a.memoizedState=d.state,m&&xb(a,h,!0),a.child}function _1(s){var a=s.stateNode;a.pendingContext?bb(s,a.pendingContext,a.pendingContext!==a.context):a.context&&bb(s,a.context,!1),Md(s,a.containerInfo)}function S1(s,a,h,d,m){return to(),Ed(m),a.flags|=256,Bi(s,a,h,d),a.child}var Zd={dehydrated:null,treeContext:null,retryLane:0};function Xd(s){return{baseLanes:s,cachePool:null,transitions:null}}function E1(s,a,h){var d=a.pendingProps,m=Dt.current,b=!1,T=(a.flags&128)!==0,j;if((j=T)||(j=s!==null&&s.memoizedState===null?!1:(m&2)!==0),j?(b=!0,a.flags&=-129):(s===null||s.memoizedState!==null)&&(m|=1),Pt(Dt,m&1),s===null)return Sd(a),s=a.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?(a.mode&1?ld(s)?a.lanes=8:a.lanes=1073741824:a.lanes=1,null):(T=d.children,s=d.fallback,b?(d=a.mode,b=a.child,T={mode:"hidden",children:T},!(d&1)&&b!==null?(b.childLanes=0,b.pendingProps=T):b=Gu(T,d,0,null),s=ys(s,d,h,null),b.return=a,s.return=a,b.sibling=s,a.child=b,a.child.memoizedState=Xd(h),a.memoizedState=Zd,s):Yd(a,T));if(m=s.memoizedState,m!==null&&(j=m.dehydrated,j!==null))return jR(s,a,T,d,j,m,h);if(b){b=d.fallback,T=a.mode,m=s.child,j=m.sibling;var G={mode:"hidden",children:d.children};return!(T&1)&&a.child!==m?(d=a.child,d.childLanes=0,d.pendingProps=G,a.deletions=null):(d=Cn(m,G),d.subtreeFlags=m.subtreeFlags&14680064),j!==null?b=Cn(j,b):(b=ys(b,T,h,null),b.flags|=2),b.return=a,d.return=a,d.sibling=b,a.child=d,d=b,b=a.child,T=s.child.memoizedState,T=T===null?Xd(h):{baseLanes:T.baseLanes|h,cachePool:null,transitions:T.transitions},b.memoizedState=T,b.childLanes=s.childLanes&~h,a.memoizedState=Zd,d}return b=s.child,s=b.sibling,d=Cn(b,{mode:"visible",children:d.children}),!(a.mode&1)&&(d.lanes=h),d.return=a,d.sibling=null,s!==null&&(h=a.deletions,h===null?(a.deletions=[s],a.flags|=16):h.push(s)),a.child=d,a.memoizedState=null,d}function Yd(s,a){return a=Gu({mode:"visible",children:a},s.mode,0,null),a.return=s,s.child=a}function Cu(s,a,h,d){return d!==null&&Ed(d),no(a,s.child,null,h),s=Yd(a,a.pendingProps.children),s.flags|=2,a.memoizedState=null,s}function jR(s,a,h,d,m,b,T){if(h)return a.flags&256?(a.flags&=-257,d=qd(Error(u(422))),Cu(s,a,T,d)):a.memoizedState!==null?(a.child=s.child,a.flags|=128,null):(b=d.fallback,m=a.mode,d=Gu({mode:"visible",children:d.children},m,0,null),b=ys(b,m,T,null),b.flags|=2,d.return=a,b.return=a,d.sibling=b,a.child=d,a.mode&1&&no(a,s.child,null,T),a.child.memoizedState=Xd(T),a.memoizedState=Zd,b);if(!(a.mode&1))return Cu(s,a,T,null);if(ld(m))return d=JO(m).digest,b=Error(u(419)),d=qd(b,d,void 0),Cu(s,a,T,d);if(h=(T&s.childLanes)!==0,qi||h){if(d=pi,d!==null){switch(T&-T){case 4:m=2;break;case 16:m=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:m=32;break;case 536870912:m=268435456;break;default:m=0}m=m&(d.suspendedLanes|T)?0:m,m!==0&&m!==b.retryLane&&(b.retryLane=m,Mr(s,m),lr(d,s,m,-1))}return mp(),d=qd(Error(u(421))),Cu(s,a,T,d)}return vb(m)?(a.flags|=128,a.child=s.child,a=JR.bind(null,s),eR(m,a),null):(s=b.treeContext,Te&&(nr=rR(m),Ki=a,Lt=!0,fr=null,na=!1,s!==null&&(ir[rr++]=Yr,ir[rr++]=Kr,ir[rr++]=us,Yr=s.id,Kr=s.overflow,us=a)),a=Yd(a,d.children),a.flags|=4096,a)}function A1(s,a,h){s.lanes|=a;var d=s.alternate;d!==null&&(d.lanes|=a),Cd(s.return,a,h)}function Kd(s,a,h,d,m){var b=s.memoizedState;b===null?s.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:d,tail:h,tailMode:m}:(b.isBackwards=a,b.rendering=null,b.renderingStartTime=0,b.last=d,b.tail=h,b.tailMode=m)}function k1(s,a,h){var d=a.pendingProps,m=d.revealOrder,b=d.tail;if(Bi(s,a,d.children,h),d=Dt.current,(d&2)!==0)d=d&1|2,a.flags|=128;else{if(s!==null&&s.flags&128)e:for(s=a.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&A1(s,h,a);else if(s.tag===19)A1(s,h,a);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}d&=1}if(Pt(Dt,d),(a.mode&1)===0)a.memoizedState=null;else switch(m){case"forwards":for(h=a.child,m=null;h!==null;)s=h.alternate,s!==null&&_u(s)===null&&(m=h),h=h.sibling;h=m,h===null?(m=a.child,a.child=null):(m=h.sibling,h.sibling=null),Kd(a,!1,m,h,b);break;case"backwards":for(h=null,m=a.child,a.child=null;m!==null;){if(s=m.alternate,s!==null&&_u(s)===null){a.child=m;break}s=m.sibling,m.sibling=h,h=m,m=s}Kd(a,!0,h,null,b);break;case"together":Kd(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function Tu(s,a){!(a.mode&1)&&s!==null&&(s.alternate=null,a.alternate=null,a.flags|=2)}function en(s,a,h){if(s!==null&&(a.dependencies=s.dependencies),ps|=a.lanes,(h&a.childLanes)===0)return null;if(s!==null&&a.child!==s.child)throw Error(u(153));if(a.child!==null){for(s=a.child,h=Cn(s,s.pendingProps),a.child=h,h.return=a;s.sibling!==null;)s=s.sibling,h=h.sibling=Cn(s,s.pendingProps),h.return=a;h.sibling=null}return a.child}function UR(s,a,h){switch(a.tag){case 3:_1(a),to();break;case 5:Wb(a);break;case 1:Hi(a.type)&&ou(a);break;case 4:Md(a,a.stateNode.containerInfo);break;case 10:Ob(a,a.type._context,a.memoizedProps.value);break;case 13:var d=a.memoizedState;if(d!==null)return d.dehydrated!==null?(Pt(Dt,Dt.current&1),a.flags|=128,null):h&a.child.childLanes?E1(s,a,h):(Pt(Dt,Dt.current&1),s=en(s,a,h),s!==null?s.sibling:null);Pt(Dt,Dt.current&1);break;case 19:if(d=(h&a.childLanes)!==0,(s.flags&128)!==0){if(d)return k1(s,a,h);a.flags|=128}var m=a.memoizedState;if(m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),Pt(Dt,Dt.current),d)break;return null;case 22:case 23:return a.lanes=0,b1(s,a,h)}return en(s,a,h)}function Nr(s){s.flags|=4}function P1(s,a){if(s!==null&&s.child===a.child)return!0;if(a.flags&16)return!1;for(s=a.child;s!==null;){if(s.flags&12854||s.subtreeFlags&12854)return!1;s=s.sibling}return!0}var da,pa,Iu,Ou;if(wt)da=function(s,a){for(var h=a.child;h!==null;){if(h.tag===5||h.tag===6)mt(s,h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===a)break;for(;h.sibling===null;){if(h.return===null||h.return===a)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},pa=function(){},Iu=function(s,a,h,d,m){if(s=s.memoizedProps,s!==d){var b=a.stateNode,T=Lr(or.current);h=ti(b,h,s,d,m,T),(a.updateQueue=h)&&Nr(a)}},Ou=function(s,a,h,d){h!==d&&Nr(a)};else if(ke){da=function(s,a,h,d){for(var m=a.child;m!==null;){if(m.tag===5){var b=m.stateNode;h&&d&&(b=mb(b,m.type,m.memoizedProps,m)),mt(s,b)}else if(m.tag===6)b=m.stateNode,h&&d&&(b=yb(b,m.memoizedProps,m)),mt(s,b);else if(m.tag!==4){if(m.tag===22&&m.memoizedState!==null)b=m.child,b!==null&&(b.return=m),da(s,m,!0,!0);else if(m.child!==null){m.child.return=m,m=m.child;continue}}if(m===a)break;for(;m.sibling===null;){if(m.return===null||m.return===a)return;m=m.return}m.sibling.return=m.return,m=m.sibling}};var C1=function(s,a,h,d){for(var m=a.child;m!==null;){if(m.tag===5){var b=m.stateNode;h&&d&&(b=mb(b,m.type,m.memoizedProps,m)),gb(s,b)}else if(m.tag===6)b=m.stateNode,h&&d&&(b=yb(b,m.memoizedProps,m)),gb(s,b);else if(m.tag!==4){if(m.tag===22&&m.memoizedState!==null)b=m.child,b!==null&&(b.return=m),C1(s,m,!0,!0);else if(m.child!==null){m.child.return=m,m=m.child;continue}}if(m===a)break;for(;m.sibling===null;){if(m.return===null||m.return===a)return;m=m.return}m.sibling.return=m.return,m=m.sibling}};pa=function(s,a){var h=a.stateNode;if(!P1(s,a)){s=h.containerInfo;var d=fb(s);C1(d,a,!1,!1),h.pendingChildren=d,Nr(a),ZO(s,d)}},Iu=function(s,a,h,d,m){var b=s.stateNode,T=s.memoizedProps;if((s=P1(s,a))&&T===d)a.stateNode=b;else{var j=a.stateNode,G=Lr(or.current),ae=null;T!==d&&(ae=ti(j,h,T,d,m,G)),s&&ae===null?a.stateNode=b:(b=od(b,ae,h,T,d,a,s,j),rt(b,h,d,m,G)&&Nr(a),a.stateNode=b,s?Nr(a):da(b,a,!1,!1))}},Ou=function(s,a,h,d){h!==d?(s=Lr(so.current),h=Lr(or.current),a.stateNode=li(d,s,h,a),Nr(a)):a.stateNode=s.stateNode}}else pa=function(){},Iu=function(){},Ou=function(){};function fa(s,a){if(!Lt)switch(s.tailMode){case"hidden":a=s.tail;for(var h=null;a!==null;)a.alternate!==null&&(h=a),a=a.sibling;h===null?s.tail=null:h.sibling=null;break;case"collapsed":h=s.tail;for(var d=null;h!==null;)h.alternate!==null&&(d=h),h=h.sibling;d===null?a||s.tail===null?s.tail=null:s.tail.sibling=null:d.sibling=null}}function Ri(s){var a=s.alternate!==null&&s.alternate.child===s.child,h=0,d=0;if(a)for(var m=s.child;m!==null;)h|=m.lanes|m.childLanes,d|=m.subtreeFlags&14680064,d|=m.flags&14680064,m.return=s,m=m.sibling;else for(m=s.child;m!==null;)h|=m.lanes|m.childLanes,d|=m.subtreeFlags,d|=m.flags,m.return=s,m=m.sibling;return s.subtreeFlags|=d,s.childLanes=h,a}function DR(s,a,h){var d=a.pendingProps;switch(xd(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ri(a),null;case 1:return Hi(a.type)&&su(),Ri(a),null;case 3:return h=a.stateNode,oo(),Ot(Wi),Ot(Ii),Nd(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(s===null||s.child===null)&&(fu(a)?Nr(a):s===null||s.memoizedState.isDehydrated&&!(a.flags&256)||(a.flags|=1024,fr!==null&&(fp(fr),fr=null))),pa(s,a),Ri(a),null;case 5:Ld(a),h=Lr(so.current);var m=a.type;if(s!==null&&a.stateNode!=null)Iu(s,a,m,d,h),s.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!d){if(a.stateNode===null)throw Error(u(166));return Ri(a),null}if(s=Lr(or.current),fu(a)){if(!Te)throw Error(u(175));s=nR(a.stateNode,a.type,a.memoizedProps,h,s,a,!na),a.updateQueue=s,s!==null&&Nr(a)}else{var b=Oe(m,d,h,s,a);da(b,a,!1,!1),a.stateNode=b,rt(b,m,d,h,s)&&Nr(a)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return Ri(a),null;case 6:if(s&&a.stateNode!=null)Ou(s,a,s.memoizedProps,d);else{if(typeof d!="string"&&a.stateNode===null)throw Error(u(166));if(s=Lr(so.current),h=Lr(or.current),fu(a)){if(!Te)throw Error(u(176));if(s=a.stateNode,h=a.memoizedProps,(d=sR(s,h,a,!na))&&(m=Ki,m!==null))switch(m.tag){case 3:pR(m.stateNode.containerInfo,s,h,(m.mode&1)!==0);break;case 5:fR(m.type,m.memoizedProps,m.stateNode,s,h,(m.mode&1)!==0)}d&&Nr(a)}else a.stateNode=li(d,s,h,a)}return Ri(a),null;case 13:if(Ot(Dt),d=a.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(Lt&&nr!==null&&a.mode&1&&!(a.flags&128))Ib(),to(),a.flags|=98560,m=!1;else if(m=fu(a),d!==null&&d.dehydrated!==null){if(s===null){if(!m)throw Error(u(318));if(!Te)throw Error(u(344));if(m=a.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(u(317));oR(m,a)}else to(),!(a.flags&128)&&(a.memoizedState=null),a.flags|=4;Ri(a),m=!1}else fr!==null&&(fp(fr),fr=null),m=!0;if(!m)return a.flags&65536?a:null}return a.flags&128?(a.lanes=h,a):(h=d!==null,h!==(s!==null&&s.memoizedState!==null)&&h&&(a.child.flags|=8192,a.mode&1&&(s===null||Dt.current&1?ni===0&&(ni=3):mp())),a.updateQueue!==null&&(a.flags|=4),Ri(a),null);case 4:return oo(),pa(s,a),s===null&&ii(a.stateNode.containerInfo),Ri(a),null;case 10:return Pd(a.type._context),Ri(a),null;case 17:return Hi(a.type)&&su(),Ri(a),null;case 19:if(Ot(Dt),m=a.memoizedState,m===null)return Ri(a),null;if(d=(a.flags&128)!==0,b=m.rendering,b===null)if(d)fa(m,!1);else{if(ni!==0||s!==null&&s.flags&128)for(s=a.child;s!==null;){if(b=_u(s),b!==null){for(a.flags|=128,fa(m,!1),s=b.updateQueue,s!==null&&(a.updateQueue=s,a.flags|=4),a.subtreeFlags=0,s=h,h=a.child;h!==null;)d=h,m=s,d.flags&=14680066,b=d.alternate,b===null?(d.childLanes=0,d.lanes=m,d.child=null,d.subtreeFlags=0,d.memoizedProps=null,d.memoizedState=null,d.updateQueue=null,d.dependencies=null,d.stateNode=null):(d.childLanes=b.childLanes,d.lanes=b.lanes,d.child=b.child,d.subtreeFlags=0,d.deletions=null,d.memoizedProps=b.memoizedProps,d.memoizedState=b.memoizedState,d.updateQueue=b.updateQueue,d.type=b.type,m=b.dependencies,d.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext}),h=h.sibling;return Pt(Dt,Dt.current&1|2),a.child}s=s.sibling}m.tail!==null&&ci()>hp&&(a.flags|=128,d=!0,fa(m,!1),a.lanes=4194304)}else{if(!d)if(s=_u(b),s!==null){if(a.flags|=128,d=!0,s=s.updateQueue,s!==null&&(a.updateQueue=s,a.flags|=4),fa(m,!0),m.tail===null&&m.tailMode==="hidden"&&!b.alternate&&!Lt)return Ri(a),null}else 2*ci()-m.renderingStartTime>hp&&h!==1073741824&&(a.flags|=128,d=!0,fa(m,!1),a.lanes=4194304);m.isBackwards?(b.sibling=a.child,a.child=b):(s=m.last,s!==null?s.sibling=b:a.child=b,m.last=b)}return m.tail!==null?(a=m.tail,m.rendering=a,m.tail=a.sibling,m.renderingStartTime=ci(),a.sibling=null,s=Dt.current,Pt(Dt,d?s&1|2:s&1),a):(Ri(a),null);case 22:case 23:return gp(),h=a.memoizedState!==null,s!==null&&s.memoizedState!==null!==h&&(a.flags|=8192),h&&a.mode&1?Ji&1073741824&&(Ri(a),wt&&a.subtreeFlags&6&&(a.flags|=8192)):Ri(a),null;case 24:return null;case 25:return null}throw Error(u(156,a.tag))}function WR(s,a){switch(xd(a),a.tag){case 1:return Hi(a.type)&&su(),s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 3:return oo(),Ot(Wi),Ot(Ii),Nd(),s=a.flags,s&65536&&!(s&128)?(a.flags=s&-65537|128,a):null;case 5:return Ld(a),null;case 13:if(Ot(Dt),s=a.memoizedState,s!==null&&s.dehydrated!==null){if(a.alternate===null)throw Error(u(340));to()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 19:return Ot(Dt),null;case 4:return oo(),null;case 10:return Pd(a.type._context),null;case 22:case 23:return gp(),null;case 24:return null;default:return null}}var Ru=!1,Mi=!1,HR=typeof WeakSet=="function"?WeakSet:Set,xe=null;function lo(s,a){var h=s.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(d){$t(s,a,d)}else h.current=null}function T1(s,a,h){try{h()}catch(d){$t(s,a,d)}}var I1=!1;function qR(s,a){for(Ne(s.containerInfo),xe=a;xe!==null;)if(s=xe,a=s.child,(s.subtreeFlags&1028)!==0&&a!==null)a.return=s,xe=a;else for(;xe!==null;){s=xe;try{var h=s.alternate;if(s.flags&1024)switch(s.tag){case 0:case 11:case 15:break;case 1:if(h!==null){var d=h.memoizedProps,m=h.memoizedState,b=s.stateNode,T=b.getSnapshotBeforeUpdate(s.elementType===s.type?d:gr(s.type,d),m);b.__reactInternalSnapshotBeforeUpdate=T}break;case 3:wt&&ft(s.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(u(163))}}catch(j){$t(s,s.return,j)}if(a=s.sibling,a!==null){a.return=s.return,xe=a;break}xe=s.return}return h=I1,I1=!1,h}function ga(s,a,h){var d=a.updateQueue;if(d=d!==null?d.lastEffect:null,d!==null){var m=d=d.next;do{if((m.tag&s)===s){var b=m.destroy;m.destroy=void 0,b!==void 0&&T1(a,h,b)}m=m.next}while(m!==d)}}function Mu(s,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var h=a=a.next;do{if((h.tag&s)===s){var d=h.create;h.destroy=d()}h=h.next}while(h!==a)}}function Jd(s){var a=s.ref;if(a!==null){var h=s.stateNode;switch(s.tag){case 5:s=Ke(h);break;default:s=h}typeof a=="function"?a(s):a.current=s}}function O1(s){var a=s.alternate;a!==null&&(s.alternate=null,O1(a)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(a=s.stateNode,a!==null&&Ye(a)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function R1(s){return s.tag===5||s.tag===3||s.tag===4}function M1(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||R1(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function ep(s,a,h){var d=s.tag;if(d===5||d===6)s=s.stateNode,a?Ue(h,s,a):Jo(h,s);else if(d!==4&&(s=s.child,s!==null))for(ep(s,a,h),s=s.sibling;s!==null;)ep(s,a,h),s=s.sibling}function tp(s,a,h){var d=s.tag;if(d===5||d===6)s=s.stateNode,a?be(h,s,a):sd(h,s);else if(d!==4&&(s=s.child,s!==null))for(tp(s,a,h),s=s.sibling;s!==null;)tp(s,a,h),s=s.sibling}var xi=null,mr=!1;function zr(s,a,h){for(h=h.child;h!==null;)ip(s,a,h),h=h.sibling}function ip(s,a,h){if(Or&&typeof Or.onCommitFiberUnmount=="function")try{Or.onCommitFiberUnmount(hu,h)}catch{}switch(h.tag){case 5:Mi||lo(h,a);case 6:if(wt){var d=xi,m=mr;xi=null,zr(s,a,h),xi=d,mr=m,xi!==null&&(mr?Ut(xi,h.stateNode):xt(xi,h.stateNode))}else zr(s,a,h);break;case 18:wt&&xi!==null&&(mr?cR(xi,h.stateNode):hR(xi,h.stateNode));break;case 4:wt?(d=xi,m=mr,xi=h.stateNode.containerInfo,mr=!0,zr(s,a,h),xi=d,mr=m):(ke&&(d=h.stateNode.containerInfo,m=fb(d),ad(d,m)),zr(s,a,h));break;case 0:case 11:case 14:case 15:if(!Mi&&(d=h.updateQueue,d!==null&&(d=d.lastEffect,d!==null))){m=d=d.next;do{var b=m,T=b.destroy;b=b.tag,T!==void 0&&(b&2||b&4)&&T1(h,a,T),m=m.next}while(m!==d)}zr(s,a,h);break;case 1:if(!Mi&&(lo(h,a),d=h.stateNode,typeof d.componentWillUnmount=="function"))try{d.props=h.memoizedProps,d.state=h.memoizedState,d.componentWillUnmount()}catch(j){$t(h,a,j)}zr(s,a,h);break;case 21:zr(s,a,h);break;case 22:h.mode&1?(Mi=(d=Mi)||h.memoizedState!==null,zr(s,a,h),Mi=d):zr(s,a,h);break;default:zr(s,a,h)}}function L1(s){var a=s.updateQueue;if(a!==null){s.updateQueue=null;var h=s.stateNode;h===null&&(h=s.stateNode=new HR),a.forEach(function(d){var m=eM.bind(null,s,d);h.has(d)||(h.add(d),d.then(m,m))})}}function yr(s,a){var h=a.deletions;if(h!==null)for(var d=0;d<h.length;d++){var m=h[d];try{var b=s,T=a;if(wt){var j=T;e:for(;j!==null;){switch(j.tag){case 5:xi=j.stateNode,mr=!1;break e;case 3:xi=j.stateNode.containerInfo,mr=!0;break e;case 4:xi=j.stateNode.containerInfo,mr=!0;break e}j=j.return}if(xi===null)throw Error(u(160));ip(b,T,m),xi=null,mr=!1}else ip(b,T,m);var G=m.alternate;G!==null&&(G.return=null),m.return=null}catch(ae){$t(m,a,ae)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)$1(a,s),a=a.sibling}function $1(s,a){var h=s.alternate,d=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(yr(a,s),Fr(s),d&4){try{ga(3,s,s.return),Mu(3,s)}catch(ye){$t(s,s.return,ye)}try{ga(5,s,s.return)}catch(ye){$t(s,s.return,ye)}}break;case 1:yr(a,s),Fr(s),d&512&&h!==null&&lo(h,h.return);break;case 5:if(yr(a,s),Fr(s),d&512&&h!==null&&lo(h,h.return),wt){if(s.flags&32){var m=s.stateNode;try{It(m)}catch(ye){$t(s,s.return,ye)}}if(d&4&&(m=s.stateNode,m!=null)){var b=s.memoizedProps;if(h=h!==null?h.memoizedProps:b,d=s.type,a=s.updateQueue,s.updateQueue=null,a!==null)try{ru(m,a,d,h,b,s)}catch(ye){$t(s,s.return,ye)}}}break;case 6:if(yr(a,s),Fr(s),d&4&&wt){if(s.stateNode===null)throw Error(u(162));m=s.stateNode,b=s.memoizedProps,h=h!==null?h.memoizedProps:b;try{Xs(m,h,b)}catch(ye){$t(s,s.return,ye)}}break;case 3:if(yr(a,s),Fr(s),d&4){if(wt&&Te&&h!==null&&h.memoizedState.isDehydrated)try{lR(a.containerInfo)}catch(ye){$t(s,s.return,ye)}if(ke){m=a.containerInfo,b=a.pendingChildren;try{ad(m,b)}catch(ye){$t(s,s.return,ye)}}}break;case 4:if(yr(a,s),Fr(s),d&4&&ke){b=s.stateNode,m=b.containerInfo,b=b.pendingChildren;try{ad(m,b)}catch(ye){$t(s,s.return,ye)}}break;case 13:yr(a,s),Fr(s),m=s.child,m.flags&8192&&(b=m.memoizedState!==null,m.stateNode.isHidden=b,!b||m.alternate!==null&&m.alternate.memoizedState!==null||(up=ci())),d&4&&L1(s);break;case 22:var T=h!==null&&h.memoizedState!==null;if(s.mode&1?(Mi=(h=Mi)||T,yr(a,s),Mi=h):yr(a,s),Fr(s),d&8192){if(h=s.memoizedState!==null,(s.stateNode.isHidden=h)&&!T&&(s.mode&1)!==0)for(xe=s,d=s.child;d!==null;){for(a=xe=d;xe!==null;){T=xe;var j=T.child;switch(T.tag){case 0:case 11:case 14:case 15:ga(4,T,T.return);break;case 1:lo(T,T.return);var G=T.stateNode;if(typeof G.componentWillUnmount=="function"){var ae=T,Ee=T.return;try{var Qe=ae;G.props=Qe.memoizedProps,G.state=Qe.memoizedState,G.componentWillUnmount()}catch(ye){$t(ae,Ee,ye)}}break;case 5:lo(T,T.return);break;case 22:if(T.memoizedState!==null){F1(a);continue}}j!==null?(j.return=T,xe=j):F1(a)}d=d.sibling}if(wt){e:if(d=null,wt)for(a=s;;){if(a.tag===5){if(d===null){d=a;try{m=a.stateNode,h?ie(m):at(a.stateNode,a.memoizedProps)}catch(ye){$t(s,s.return,ye)}}}else if(a.tag===6){if(d===null)try{b=a.stateNode,h?$e(b):_t(b,a.memoizedProps)}catch(ye){$t(s,s.return,ye)}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===s)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;d===a&&(d=null),a=a.return}d===a&&(d=null),a.sibling.return=a.return,a=a.sibling}}}break;case 19:yr(a,s),Fr(s),d&4&&L1(s);break;case 21:break;default:yr(a,s),Fr(s)}}function Fr(s){var a=s.flags;if(a&2){try{if(wt){e:{for(var h=s.return;h!==null;){if(R1(h)){var d=h;break e}h=h.return}throw Error(u(160))}switch(d.tag){case 5:var m=d.stateNode;d.flags&32&&(It(m),d.flags&=-33);var b=M1(s);tp(s,b,m);break;case 3:case 4:var T=d.stateNode.containerInfo,j=M1(s);ep(s,j,T);break;default:throw Error(u(161))}}}catch(G){$t(s,s.return,G)}s.flags&=-3}a&4096&&(s.flags&=-4097)}function QR(s,a,h){xe=s,N1(s)}function N1(s,a,h){for(var d=(s.mode&1)!==0;xe!==null;){var m=xe,b=m.child;if(m.tag===22&&d){var T=m.memoizedState!==null||Ru;if(!T){var j=m.alternate,G=j!==null&&j.memoizedState!==null||Mi;j=Ru;var ae=Mi;if(Ru=T,(Mi=G)&&!ae)for(xe=m;xe!==null;)T=xe,G=T.child,T.tag===22&&T.memoizedState!==null?B1(m):G!==null?(G.return=T,xe=G):B1(m);for(;b!==null;)xe=b,N1(b),b=b.sibling;xe=m,Ru=j,Mi=ae}z1(s)}else m.subtreeFlags&8772&&b!==null?(b.return=m,xe=b):z1(s)}}function z1(s){for(;xe!==null;){var a=xe;if(a.flags&8772){var h=a.alternate;try{if(a.flags&8772)switch(a.tag){case 0:case 11:case 15:Mi||Mu(5,a);break;case 1:var d=a.stateNode;if(a.flags&4&&!Mi)if(h===null)d.componentDidMount();else{var m=a.elementType===a.type?h.memoizedProps:gr(a.type,h.memoizedProps);d.componentDidUpdate(m,h.memoizedState,d.__reactInternalSnapshotBeforeUpdate)}var b=a.updateQueue;b!==null&&$b(a,b,d);break;case 3:var T=a.updateQueue;if(T!==null){if(h=null,a.child!==null)switch(a.child.tag){case 5:h=Ke(a.child.stateNode);break;case 1:h=a.child.stateNode}$b(a,T,h)}break;case 5:var j=a.stateNode;h===null&&a.flags&4&&ea(j,a.type,a.memoizedProps,a);break;case 6:break;case 4:break;case 12:break;case 13:if(Te&&a.memoizedState===null){var G=a.alternate;if(G!==null){var ae=G.memoizedState;if(ae!==null){var Ee=ae.dehydrated;Ee!==null&&uR(Ee)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(u(163))}Mi||a.flags&512&&Jd(a)}catch(Qe){$t(a,a.return,Qe)}}if(a===s){xe=null;break}if(h=a.sibling,h!==null){h.return=a.return,xe=h;break}xe=a.return}}function F1(s){for(;xe!==null;){var a=xe;if(a===s){xe=null;break}var h=a.sibling;if(h!==null){h.return=a.return,xe=h;break}xe=a.return}}function B1(s){for(;xe!==null;){var a=xe;try{switch(a.tag){case 0:case 11:case 15:var h=a.return;try{Mu(4,a)}catch(G){$t(a,h,G)}break;case 1:var d=a.stateNode;if(typeof d.componentDidMount=="function"){var m=a.return;try{d.componentDidMount()}catch(G){$t(a,m,G)}}var b=a.return;try{Jd(a)}catch(G){$t(a,b,G)}break;case 5:var T=a.return;try{Jd(a)}catch(G){$t(a,T,G)}}}catch(G){$t(a,a.return,G)}if(a===s){xe=null;break}var j=a.sibling;if(j!==null){j.return=a.return,xe=j;break}xe=a.return}}var Lu=0,$u=1,Nu=2,zu=3,Fu=4;if(typeof Symbol=="function"&&Symbol.for){var ma=Symbol.for;Lu=ma("selector.component"),$u=ma("selector.has_pseudo_class"),Nu=ma("selector.role"),zu=ma("selector.test_id"),Fu=ma("selector.text")}function rp(s){var a=ot(s);if(a!=null){if(typeof a.memoizedProps["data-testname"]!="string")throw Error(u(364));return a}if(s=Zr(s),s===null)throw Error(u(362));return s.stateNode.current}function np(s,a){switch(a.$$typeof){case Lu:if(s.type===a.value)return!0;break;case $u:e:{a=a.value,s=[s,0];for(var h=0;h<s.length;){var d=s[h++],m=s[h++],b=a[m];if(d.tag!==5||!as(d)){for(;b!=null&&np(d,b);)m++,b=a[m];if(m===a.length){a=!0;break e}else for(d=d.child;d!==null;)s.push(d,m),d=d.sibling}}a=!1}return a;case Nu:if(s.tag===5&&Di(s.stateNode,a.value))return!0;break;case Fu:if((s.tag===5||s.tag===6)&&(s=rd(s),s!==null&&0<=s.indexOf(a.value)))return!0;break;case zu:if(s.tag===5&&(s=s.memoizedProps["data-testname"],typeof s=="string"&&s.toLowerCase()===a.value.toLowerCase()))return!0;break;default:throw Error(u(365))}return!1}function sp(s){switch(s.$$typeof){case Lu:return"<"+(V(s.value)||"Unknown")+">";case $u:return":has("+(sp(s)||"")+")";case Nu:return'[role="'+s.value+'"]';case Fu:return'"'+s.value+'"';case zu:return'[data-testname="'+s.value+'"]';default:throw Error(u(365))}}function j1(s,a){var h=[];s=[s,0];for(var d=0;d<s.length;){var m=s[d++],b=s[d++],T=a[b];if(m.tag!==5||!as(m)){for(;T!=null&&np(m,T);)b++,T=a[b];if(b===a.length)h.push(m);else for(m=m.child;m!==null;)s.push(m,b),m=m.sibling}}return h}function op(s,a){if(!hi)throw Error(u(363));s=rp(s),s=j1(s,a),a=[],s=Array.from(s);for(var h=0;h<s.length;){var d=s[h++];if(d.tag===5)as(d)||a.push(d.stateNode);else for(d=d.child;d!==null;)s.push(d),d=d.sibling}return a}var VR=Math.ceil,Bu=c.ReactCurrentDispatcher,ap=c.ReactCurrentOwner,Xt=c.ReactCurrentBatchConfig,tt=0,pi=null,Jt=null,_i=0,Ji=0,uo=wn(0),ni=0,ya=null,ps=0,ju=0,lp=0,va=null,Qi=null,up=0,hp=1/0,tn=null;function ho(){hp=ci()+500}var Uu=!1,cp=null,En=null,Du=!1,An=null,Wu=0,ba=0,dp=null,Hu=-1,qu=0;function Li(){return tt&6?ci():Hu!==-1?Hu:Hu=ci()}function kn(s){return s.mode&1?tt&2&&_i!==0?_i&-_i:TR.transition!==null?(qu===0&&(qu=_b()),qu):(s=ct,s!==0?s:Xe()):1}function lr(s,a,h,d){if(50<ba)throw ba=0,dp=null,Error(u(185));ra(s,h,d),(!(tt&2)||s!==pi)&&(s===pi&&(!(tt&2)&&(ju|=h),ni===4&&Pn(s,_i)),Vi(s,d),h===1&&tt===0&&!(a.mode&1)&&(ho(),cu&&Rr()))}function Vi(s,a){var h=s.callbackNode;wR(s,a);var d=uu(s,s===pi?_i:0);if(d===0)h!==null&&Eb(h),s.callbackNode=null,s.callbackPriority=0;else if(a=d&-d,s.callbackPriority!==a){if(h!=null&&Eb(h),a===1)s.tag===0?CR(D1.bind(null,s)):Ab(D1.bind(null,s)),ht?jt(function(){!(tt&6)&&Rr()}):md(yd,Rr),h=null;else{switch(Sb(d)){case 1:h=yd;break;case 4:h=ER;break;case 16:h=vd;break;case 536870912:h=AR;break;default:h=vd}h=Y1(h,U1.bind(null,s))}s.callbackPriority=a,s.callbackNode=h}}function U1(s,a){if(Hu=-1,qu=0,(tt&6)!==0)throw Error(u(327));var h=s.callbackNode;if(ms()&&s.callbackNode!==h)return null;var d=uu(s,s===pi?_i:0);if(d===0)return null;if(d&30||d&s.expiredLanes||a)a=Qu(s,d);else{a=d;var m=tt;tt|=2;var b=q1();(pi!==s||_i!==a)&&(tn=null,ho(),fs(s,a));do try{XR();break}catch(j){H1(s,j)}while(1);kd(),Bu.current=b,tt=m,Jt!==null?a=0:(pi=null,_i=0,a=ni)}if(a!==0){if(a===2&&(m=pd(s),m!==0&&(d=m,a=pp(s,m))),a===1)throw h=ya,fs(s,0),Pn(s,d),Vi(s,ci()),h;if(a===6)Pn(s,d);else{if(m=s.current.alternate,(d&30)===0&&!GR(m)&&(a=Qu(s,d),a===2&&(b=pd(s),b!==0&&(d=b,a=pp(s,b))),a===1))throw h=ya,fs(s,0),Pn(s,d),Vi(s,ci()),h;switch(s.finishedWork=m,s.finishedLanes=d,a){case 0:case 1:throw Error(u(345));case 2:gs(s,Qi,tn);break;case 3:if(Pn(s,d),(d&130023424)===d&&(a=up+500-ci(),10<a)){if(uu(s,0)!==0)break;if(m=s.suspendedLanes,(m&d)!==d){Li(),s.pingedLanes|=s.suspendedLanes&m;break}s.timeoutHandle=Tt(gs.bind(null,s,Qi,tn),a);break}gs(s,Qi,tn);break;case 4:if(Pn(s,d),(d&4194240)===d)break;for(a=s.eventTimes,m=-1;0<d;){var T=31-dr(d);b=1<<T,T=a[T],T>m&&(m=T),d&=~b}if(d=m,d=ci()-d,d=(120>d?120:480>d?480:1080>d?1080:1920>d?1920:3e3>d?3e3:4320>d?4320:1960*VR(d/1960))-d,10<d){s.timeoutHandle=Tt(gs.bind(null,s,Qi,tn),d);break}gs(s,Qi,tn);break;case 5:gs(s,Qi,tn);break;default:throw Error(u(329))}}}return Vi(s,ci()),s.callbackNode===h?U1.bind(null,s):null}function pp(s,a){var h=va;return s.current.memoizedState.isDehydrated&&(fs(s,a).flags|=256),s=Qu(s,a),s!==2&&(a=Qi,Qi=h,a!==null&&fp(a)),s}function fp(s){Qi===null?Qi=s:Qi.push.apply(Qi,s)}function GR(s){for(var a=s;;){if(a.flags&16384){var h=a.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var d=0;d<h.length;d++){var m=h[d],b=m.getSnapshot;m=m.value;try{if(!pr(b(),m))return!1}catch{return!1}}}if(h=a.child,a.subtreeFlags&16384&&h!==null)h.return=a,a=h;else{if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Pn(s,a){for(a&=~lp,a&=~ju,s.suspendedLanes|=a,s.pingedLanes&=~a,s=s.expirationTimes;0<a;){var h=31-dr(a),d=1<<h;s[h]=-1,a&=~d}}function D1(s){if(tt&6)throw Error(u(327));ms();var a=uu(s,0);if(!(a&1))return Vi(s,ci()),null;var h=Qu(s,a);if(s.tag!==0&&h===2){var d=pd(s);d!==0&&(a=d,h=pp(s,d))}if(h===1)throw h=ya,fs(s,0),Pn(s,a),Vi(s,ci()),h;if(h===6)throw Error(u(345));return s.finishedWork=s.current.alternate,s.finishedLanes=a,gs(s,Qi,tn),Vi(s,ci()),null}function W1(s){An!==null&&An.tag===0&&!(tt&6)&&ms();var a=tt;tt|=1;var h=Xt.transition,d=ct;try{if(Xt.transition=null,ct=1,s)return s()}finally{ct=d,Xt.transition=h,tt=a,!(tt&6)&&Rr()}}function gp(){Ji=uo.current,Ot(uo)}function fs(s,a){s.finishedWork=null,s.finishedLanes=0;var h=s.timeoutHandle;if(h!==ui&&(s.timeoutHandle=ui,Mt(h)),Jt!==null)for(h=Jt.return;h!==null;){var d=h;switch(xd(d),d.tag){case 1:d=d.type.childContextTypes,d!=null&&su();break;case 3:oo(),Ot(Wi),Ot(Ii),Nd();break;case 5:Ld(d);break;case 4:oo();break;case 13:Ot(Dt);break;case 19:Ot(Dt);break;case 10:Pd(d.type._context);break;case 22:case 23:gp()}h=h.return}if(pi=s,Jt=s=Cn(s.current,null),_i=Ji=a,ni=0,ya=null,lp=ju=ps=0,Qi=va=null,cs!==null){for(a=0;a<cs.length;a++)if(h=cs[a],d=h.interleaved,d!==null){h.interleaved=null;var m=d.next,b=h.pending;if(b!==null){var T=b.next;b.next=m,d.next=T}h.pending=d}cs=null}return s}function H1(s,a){do{var h=Jt;try{if(kd(),Su.current=Pu,Eu){for(var d=Wt.memoizedState;d!==null;){var m=d.queue;m!==null&&(m.pending=null),d=d.next}Eu=!1}if(ds=0,di=ri=Wt=null,la=!1,ua=0,ap.current=null,h===null||h.return===null){ni=1,ya=a,Jt=null;break}e:{var b=s,T=h.return,j=h,G=a;if(a=_i,j.flags|=32768,G!==null&&typeof G=="object"&&typeof G.then=="function"){var ae=G,Ee=j,Qe=Ee.tag;if(!(Ee.mode&1)&&(Qe===0||Qe===11||Qe===15)){var ye=Ee.alternate;ye?(Ee.updateQueue=ye.updateQueue,Ee.memoizedState=ye.memoizedState,Ee.lanes=ye.lanes):(Ee.updateQueue=null,Ee.memoizedState=null)}var Rt=f1(T);if(Rt!==null){Rt.flags&=-257,g1(Rt,T,j,b,a),Rt.mode&1&&p1(b,ae,a),a=Rt,G=ae;var St=a.updateQueue;if(St===null){var Gi=new Set;Gi.add(G),a.updateQueue=Gi}else St.add(G);break e}else{if(!(a&1)){p1(b,ae,a),mp();break e}G=Error(u(426))}}else if(Lt&&j.mode&1){var rn=f1(T);if(rn!==null){!(rn.flags&65536)&&(rn.flags|=256),g1(rn,T,j,b,a),Ed(ao(G,j));break e}}b=G=ao(G,j),ni!==4&&(ni=2),va===null?va=[b]:va.push(b),b=T;do{switch(b.tag){case 3:b.flags|=65536,a&=-a,b.lanes|=a;var q=c1(b,G,a);Lb(b,q);break e;case 1:j=G;var W=b.type,X=b.stateNode;if(!(b.flags&128)&&(typeof W.getDerivedStateFromError=="function"||X!==null&&typeof X.componentDidCatch=="function"&&(En===null||!En.has(X)))){b.flags|=65536,a&=-a,b.lanes|=a;var ve=d1(b,j,a);Lb(b,ve);break e}}b=b.return}while(b!==null)}V1(h)}catch(Fe){a=Fe,Jt===h&&h!==null&&(Jt=h=h.return);continue}break}while(1)}function q1(){var s=Bu.current;return Bu.current=Pu,s===null?Pu:s}function mp(){(ni===0||ni===3||ni===2)&&(ni=4),pi===null||!(ps&268435455)&&!(ju&268435455)||Pn(pi,_i)}function Qu(s,a){var h=tt;tt|=2;var d=q1();(pi!==s||_i!==a)&&(tn=null,fs(s,a));do try{ZR();break}catch(m){H1(s,m)}while(1);if(kd(),tt=h,Bu.current=d,Jt!==null)throw Error(u(261));return pi=null,_i=0,ni}function ZR(){for(;Jt!==null;)Q1(Jt)}function XR(){for(;Jt!==null&&!_R();)Q1(Jt)}function Q1(s){var a=X1(s.alternate,s,Ji);s.memoizedProps=s.pendingProps,a===null?V1(s):Jt=a,ap.current=null}function V1(s){var a=s;do{var h=a.alternate;if(s=a.return,(a.flags&32768)===0){if(h=DR(h,a,Ji),h!==null){Jt=h;return}}else{if(h=WR(h,a),h!==null){h.flags&=32767,Jt=h;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{ni=6,Jt=null;return}}if(a=a.sibling,a!==null){Jt=a;return}Jt=a=s}while(a!==null);ni===0&&(ni=5)}function gs(s,a,h){var d=ct,m=Xt.transition;try{Xt.transition=null,ct=1,YR(s,a,h,d)}finally{Xt.transition=m,ct=d}return null}function YR(s,a,h,d){do ms();while(An!==null);if(tt&6)throw Error(u(327));h=s.finishedWork;var m=s.finishedLanes;if(h===null)return null;if(s.finishedWork=null,s.finishedLanes=0,h===s.current)throw Error(u(177));s.callbackNode=null,s.callbackPriority=0;var b=h.lanes|h.childLanes;if(xR(s,b),s===pi&&(Jt=pi=null,_i=0),!(h.subtreeFlags&2064)&&!(h.flags&2064)||Du||(Du=!0,Y1(vd,function(){return ms(),null})),b=(h.flags&15990)!==0,(h.subtreeFlags&15990)!==0||b){b=Xt.transition,Xt.transition=null;var T=ct;ct=1;var j=tt;tt|=4,ap.current=null,qR(s,h),$1(h,s),J(s.containerInfo),s.current=h,QR(h),SR(),tt=j,ct=T,Xt.transition=b}else s.current=h;if(Du&&(Du=!1,An=s,Wu=m),b=s.pendingLanes,b===0&&(En=null),kR(h.stateNode),Vi(s,ci()),a!==null)for(d=s.onRecoverableError,h=0;h<a.length;h++)m=a[h],d(m.value,{componentStack:m.stack,digest:m.digest});if(Uu)throw Uu=!1,s=cp,cp=null,s;return Wu&1&&s.tag!==0&&ms(),b=s.pendingLanes,b&1?s===dp?ba++:(ba=0,dp=s):ba=0,Rr(),null}function ms(){if(An!==null){var s=Sb(Wu),a=Xt.transition,h=ct;try{if(Xt.transition=null,ct=16>s?16:s,An===null)var d=!1;else{if(s=An,An=null,Wu=0,(tt&6)!==0)throw Error(u(331));var m=tt;for(tt|=4,xe=s.current;xe!==null;){var b=xe,T=b.child;if(xe.flags&16){var j=b.deletions;if(j!==null){for(var G=0;G<j.length;G++){var ae=j[G];for(xe=ae;xe!==null;){var Ee=xe;switch(Ee.tag){case 0:case 11:case 15:ga(8,Ee,b)}var Qe=Ee.child;if(Qe!==null)Qe.return=Ee,xe=Qe;else for(;xe!==null;){Ee=xe;var ye=Ee.sibling,Rt=Ee.return;if(O1(Ee),Ee===ae){xe=null;break}if(ye!==null){ye.return=Rt,xe=ye;break}xe=Rt}}}var St=b.alternate;if(St!==null){var Gi=St.child;if(Gi!==null){St.child=null;do{var rn=Gi.sibling;Gi.sibling=null,Gi=rn}while(Gi!==null)}}xe=b}}if(b.subtreeFlags&2064&&T!==null)T.return=b,xe=T;else e:for(;xe!==null;){if(b=xe,(b.flags&2048)!==0)switch(b.tag){case 0:case 11:case 15:ga(9,b,b.return)}var q=b.sibling;if(q!==null){q.return=b.return,xe=q;break e}xe=b.return}}var W=s.current;for(xe=W;xe!==null;){T=xe;var X=T.child;if(T.subtreeFlags&2064&&X!==null)X.return=T,xe=X;else e:for(T=W;xe!==null;){if(j=xe,(j.flags&2048)!==0)try{switch(j.tag){case 0:case 11:case 15:Mu(9,j)}}catch(Fe){$t(j,j.return,Fe)}if(j===T){xe=null;break e}var ve=j.sibling;if(ve!==null){ve.return=j.return,xe=ve;break e}xe=j.return}}if(tt=m,Rr(),Or&&typeof Or.onPostCommitFiberRoot=="function")try{Or.onPostCommitFiberRoot(hu,s)}catch{}d=!0}return d}finally{ct=h,Xt.transition=a}}return!1}function G1(s,a,h){a=ao(h,a),a=c1(s,a,1),s=Sn(s,a,1),a=Li(),s!==null&&(ra(s,1,a),Vi(s,a))}function $t(s,a,h){if(s.tag===3)G1(s,s,h);else for(;a!==null;){if(a.tag===3){G1(a,s,h);break}else if(a.tag===1){var d=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(En===null||!En.has(d))){s=ao(h,s),s=d1(a,s,1),a=Sn(a,s,1),s=Li(),a!==null&&(ra(a,1,s),Vi(a,s));break}}a=a.return}}function KR(s,a,h){var d=s.pingCache;d!==null&&d.delete(a),a=Li(),s.pingedLanes|=s.suspendedLanes&h,pi===s&&(_i&h)===h&&(ni===4||ni===3&&(_i&130023424)===_i&&500>ci()-up?fs(s,0):lp|=h),Vi(s,a)}function Z1(s,a){a===0&&(s.mode&1?(a=lu,lu<<=1,!(lu&130023424)&&(lu=4194304)):a=1);var h=Li();s=Mr(s,a),s!==null&&(ra(s,a,h),Vi(s,h))}function JR(s){var a=s.memoizedState,h=0;a!==null&&(h=a.retryLane),Z1(s,h)}function eM(s,a){var h=0;switch(s.tag){case 13:var d=s.stateNode,m=s.memoizedState;m!==null&&(h=m.retryLane);break;case 19:d=s.stateNode;break;default:throw Error(u(314))}d!==null&&d.delete(a),Z1(s,h)}var X1;X1=function(s,a,h){if(s!==null)if(s.memoizedProps!==a.pendingProps||Wi.current)qi=!0;else{if(!(s.lanes&h)&&!(a.flags&128))return qi=!1,UR(s,a,h);qi=(s.flags&131072)!==0}else qi=!1,Lt&&a.flags&1048576&&kb(a,pu,a.index);switch(a.lanes=0,a.tag){case 2:var d=a.type;Tu(s,a),s=a.pendingProps;var m=Ks(a,Ii.current);ro(a,h),m=Bd(null,a,d,s,m,h);var b=jd();return a.flags|=1,typeof m=="object"&&m!==null&&typeof m.render=="function"&&m.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,Hi(d)?(b=!0,ou(a)):b=!1,a.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,Id(a),m.updater=wu,a.stateNode=m,m._reactInternals=a,Rd(a,d,s,h),a=Gd(null,a,d,!0,b,h)):(a.tag=0,Lt&&b&&wd(a),Bi(null,a,m,h),a=a.child),a;case 16:d=a.elementType;e:{switch(Tu(s,a),s=a.pendingProps,m=d._init,d=m(d._payload),a.type=d,m=a.tag=iM(d),s=gr(d,s),m){case 0:a=Vd(null,a,d,s,h);break e;case 1:a=x1(null,a,d,s,h);break e;case 11:a=m1(null,a,d,s,h);break e;case 14:a=y1(null,a,d,gr(d.type,s),h);break e}throw Error(u(306,d,""))}return a;case 0:return d=a.type,m=a.pendingProps,m=a.elementType===d?m:gr(d,m),Vd(s,a,d,m,h);case 1:return d=a.type,m=a.pendingProps,m=a.elementType===d?m:gr(d,m),x1(s,a,d,m,h);case 3:e:{if(_1(a),s===null)throw Error(u(387));d=a.pendingProps,b=a.memoizedState,m=b.element,Mb(s,a),bu(a,d,null,h);var T=a.memoizedState;if(d=T.element,Te&&b.isDehydrated)if(b={element:d,isDehydrated:!1,cache:T.cache,pendingSuspenseBoundaries:T.pendingSuspenseBoundaries,transitions:T.transitions},a.updateQueue.baseState=b,a.memoizedState=b,a.flags&256){m=ao(Error(u(423)),a),a=S1(s,a,d,h,m);break e}else if(d!==m){m=ao(Error(u(424)),a),a=S1(s,a,d,h,m);break e}else for(Te&&(nr=iR(a.stateNode.containerInfo),Ki=a,Lt=!0,fr=null,na=!1),h=Db(a,null,d,h),a.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(to(),d===m){a=en(s,a,h);break e}Bi(s,a,d,h)}a=a.child}return a;case 5:return Wb(a),s===null&&Sd(a),d=a.type,m=a.pendingProps,b=s!==null?s.memoizedProps:null,T=m.children,kt(d,m)?T=null:b!==null&&kt(d,b)&&(a.flags|=32),w1(s,a),Bi(s,a,T,h),a.child;case 6:return s===null&&Sd(a),null;case 13:return E1(s,a,h);case 4:return Md(a,a.stateNode.containerInfo),d=a.pendingProps,s===null?a.child=no(a,null,d,h):Bi(s,a,d,h),a.child;case 11:return d=a.type,m=a.pendingProps,m=a.elementType===d?m:gr(d,m),m1(s,a,d,m,h);case 7:return Bi(s,a,a.pendingProps,h),a.child;case 8:return Bi(s,a,a.pendingProps.children,h),a.child;case 12:return Bi(s,a,a.pendingProps.children,h),a.child;case 10:e:{if(d=a.type._context,m=a.pendingProps,b=a.memoizedProps,T=m.value,Ob(a,d,T),b!==null)if(pr(b.value,T)){if(b.children===m.children&&!Wi.current){a=en(s,a,h);break e}}else for(b=a.child,b!==null&&(b.return=a);b!==null;){var j=b.dependencies;if(j!==null){T=b.child;for(var G=j.firstContext;G!==null;){if(G.context===d){if(b.tag===1){G=Jr(-1,h&-h),G.tag=2;var ae=b.updateQueue;if(ae!==null){ae=ae.shared;var Ee=ae.pending;Ee===null?G.next=G:(G.next=Ee.next,Ee.next=G),ae.pending=G}}b.lanes|=h,G=b.alternate,G!==null&&(G.lanes|=h),Cd(b.return,h,a),j.lanes|=h;break}G=G.next}}else if(b.tag===10)T=b.type===a.type?null:b.child;else if(b.tag===18){if(T=b.return,T===null)throw Error(u(341));T.lanes|=h,j=T.alternate,j!==null&&(j.lanes|=h),Cd(T,h,a),T=b.sibling}else T=b.child;if(T!==null)T.return=b;else for(T=b;T!==null;){if(T===a){T=null;break}if(b=T.sibling,b!==null){b.return=T.return,T=b;break}T=T.return}b=T}Bi(s,a,m.children,h),a=a.child}return a;case 9:return m=a.type,d=a.pendingProps.children,ro(a,h),m=sr(m),d=d(m),a.flags|=1,Bi(s,a,d,h),a.child;case 14:return d=a.type,m=gr(d,a.pendingProps),m=gr(d.type,m),y1(s,a,d,m,h);case 15:return v1(s,a,a.type,a.pendingProps,h);case 17:return d=a.type,m=a.pendingProps,m=a.elementType===d?m:gr(d,m),Tu(s,a),a.tag=1,Hi(d)?(s=!0,ou(a)):s=!1,ro(a,h),Fb(a,d,m),Rd(a,d,m,h),Gd(null,a,d,!0,s,h);case 19:return k1(s,a,h);case 22:return b1(s,a,h)}throw Error(u(156,a.tag))};function Y1(s,a){return md(s,a)}function tM(s,a,h,d){this.tag=s,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ur(s,a,h,d){return new tM(s,a,h,d)}function yp(s){return s=s.prototype,!(!s||!s.isReactComponent)}function iM(s){if(typeof s=="function")return yp(s)?1:0;if(s!=null){if(s=s.$$typeof,s===O)return 11;if(s===$)return 14}return 2}function Cn(s,a){var h=s.alternate;return h===null?(h=ur(s.tag,a,s.key,s.mode),h.elementType=s.elementType,h.type=s.type,h.stateNode=s.stateNode,h.alternate=s,s.alternate=h):(h.pendingProps=a,h.type=s.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=s.flags&14680064,h.childLanes=s.childLanes,h.lanes=s.lanes,h.child=s.child,h.memoizedProps=s.memoizedProps,h.memoizedState=s.memoizedState,h.updateQueue=s.updateQueue,a=s.dependencies,h.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},h.sibling=s.sibling,h.index=s.index,h.ref=s.ref,h}function Vu(s,a,h,d,m,b){var T=2;if(d=s,typeof s=="function")yp(s)&&(T=1);else if(typeof s=="string")T=5;else e:switch(s){case v:return ys(h.children,m,b,a);case x:T=8,m|=8;break;case E:return s=ur(12,h,a,m|2),s.elementType=E,s.lanes=b,s;case I:return s=ur(13,h,a,m),s.elementType=I,s.lanes=b,s;case A:return s=ur(19,h,a,m),s.elementType=A,s.lanes=b,s;case B:return Gu(h,m,b,a);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case _:T=10;break e;case P:T=9;break e;case O:T=11;break e;case $:T=14;break e;case z:T=16,d=null;break e}throw Error(u(130,s==null?s:typeof s,""))}return a=ur(T,h,a,m),a.elementType=s,a.type=d,a.lanes=b,a}function ys(s,a,h,d){return s=ur(7,s,d,a),s.lanes=h,s}function Gu(s,a,h,d){return s=ur(22,s,d,a),s.elementType=B,s.lanes=h,s.stateNode={isHidden:!1},s}function vp(s,a,h){return s=ur(6,s,null,a),s.lanes=h,s}function bp(s,a,h){return a=ur(4,s.children!==null?s.children:[],s.key,a),a.lanes=h,a.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},a}function rM(s,a,h,d,m){this.tag=a,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=ui,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=fd(0),this.expirationTimes=fd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=fd(0),this.identifierPrefix=d,this.onRecoverableError=m,Te&&(this.mutableSourceEagerHydrationData=null)}function K1(s,a,h,d,m,b,T,j,G){return s=new rM(s,a,h,j,G),a===1?(a=1,b===!0&&(a|=8)):a=0,b=ur(3,null,null,a),s.current=b,b.stateNode=s,b.memoizedState={element:d,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},Id(b),s}function J1(s){if(!s)return xn;s=s._reactInternals;e:{if(Q(s)!==s||s.tag!==1)throw Error(u(170));var a=s;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(Hi(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(u(171))}if(s.tag===1){var h=s.type;if(Hi(h))return wb(s,h,a)}return a}function ew(s){var a=s._reactInternals;if(a===void 0)throw typeof s.render=="function"?Error(u(188)):(s=Object.keys(s).join(","),Error(u(268,s)));return s=ge(a),s===null?null:s.stateNode}function tw(s,a){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var h=s.retryLane;s.retryLane=h!==0&&h<a?h:a}}function Zu(s,a){tw(s,a),(s=s.alternate)&&tw(s,a)}function nM(s){return s=ge(s),s===null?null:s.stateNode}function sM(){return null}return r.attemptContinuousHydration=function(s){if(s.tag===13){var a=Mr(s,134217728);if(a!==null){var h=Li();lr(a,s,134217728,h)}Zu(s,134217728)}},r.attemptDiscreteHydration=function(s){if(s.tag===13){var a=Mr(s,1);if(a!==null){var h=Li();lr(a,s,1,h)}Zu(s,1)}},r.attemptHydrationAtCurrentPriority=function(s){if(s.tag===13){var a=kn(s),h=Mr(s,a);if(h!==null){var d=Li();lr(h,s,a,d)}Zu(s,a)}},r.attemptSynchronousHydration=function(s){switch(s.tag){case 3:var a=s.stateNode;if(a.current.memoizedState.isDehydrated){var h=ia(a.pendingLanes);h!==0&&(gd(a,h|1),Vi(a,ci()),!(tt&6)&&(ho(),Rr()))}break;case 13:W1(function(){var d=Mr(s,1);if(d!==null){var m=Li();lr(d,s,1,m)}}),Zu(s,1)}},r.batchedUpdates=function(s,a){var h=tt;tt|=1;try{return s(a)}finally{tt=h,tt===0&&(ho(),cu&&Rr())}},r.createComponentSelector=function(s){return{$$typeof:Lu,value:s}},r.createContainer=function(s,a,h,d,m,b,T){return K1(s,a,!1,null,h,d,m,b,T)},r.createHasPseudoClassSelector=function(s){return{$$typeof:$u,value:s}},r.createHydrationContainer=function(s,a,h,d,m,b,T,j,G){return s=K1(h,d,!0,s,m,b,T,j,G),s.context=J1(null),h=s.current,d=Li(),m=kn(h),b=Jr(d,m),b.callback=a??null,Sn(h,b,m),s.current.lanes=m,ra(s,m,d),Vi(s,d),s},r.createPortal=function(s,a,h){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:f,key:d==null?null:""+d,children:s,containerInfo:a,implementation:h}},r.createRoleSelector=function(s){return{$$typeof:Nu,value:s}},r.createTestNameSelector=function(s){return{$$typeof:zu,value:s}},r.createTextSelector=function(s){return{$$typeof:Fu,value:s}},r.deferredUpdates=function(s){var a=ct,h=Xt.transition;try{return Xt.transition=null,ct=16,s()}finally{ct=a,Xt.transition=h}},r.discreteUpdates=function(s,a,h,d,m){var b=ct,T=Xt.transition;try{return Xt.transition=null,ct=1,s(a,h,d,m)}finally{ct=b,Xt.transition=T,tt===0&&ho()}},r.findAllNodes=op,r.findBoundingRects=function(s,a){if(!hi)throw Error(u(363));a=op(s,a),s=[];for(var h=0;h<a.length;h++)s.push(os(a[h]));for(a=s.length-1;0<a;a--){h=s[a];for(var d=h.x,m=d+h.width,b=h.y,T=b+h.height,j=a-1;0<=j;j--)if(a!==j){var G=s[j],ae=G.x,Ee=ae+G.width,Qe=G.y,ye=Qe+G.height;if(d>=ae&&b>=Qe&&m<=Ee&&T<=ye){s.splice(a,1);break}else if(d!==ae||h.width!==G.width||ye<b||Qe>T){if(!(b!==Qe||h.height!==G.height||Ee<d||ae>m)){ae>d&&(G.width+=ae-d,G.x=d),Ee<m&&(G.width=m-ae),s.splice(a,1);break}}else{Qe>b&&(G.height+=Qe-b,G.y=b),ye<T&&(G.height=T-Qe),s.splice(a,1);break}}}return s},r.findHostInstance=ew,r.findHostInstanceWithNoPortals=function(s){return s=pe(s),s=s!==null?Se(s):null,s===null?null:s.stateNode},r.findHostInstanceWithWarning=function(s){return ew(s)},r.flushControlled=function(s){var a=tt;tt|=1;var h=Xt.transition,d=ct;try{Xt.transition=null,ct=1,s()}finally{ct=d,Xt.transition=h,tt=a,tt===0&&(ho(),Rr())}},r.flushPassiveEffects=ms,r.flushSync=W1,r.focusWithin=function(s,a){if(!hi)throw Error(u(363));for(s=rp(s),a=j1(s,a),a=Array.from(a),s=0;s<a.length;){var h=a[s++];if(!as(h)){if(h.tag===5&&iu(h.stateNode))return!0;for(h=h.child;h!==null;)a.push(h),h=h.sibling}}return!1},r.getCurrentUpdatePriority=function(){return ct},r.getFindAllNodesFailureDescription=function(s,a){if(!hi)throw Error(u(363));var h=0,d=[];s=[rp(s),0];for(var m=0;m<s.length;){var b=s[m++],T=s[m++],j=a[T];if((b.tag!==5||!as(b))&&(np(b,j)&&(d.push(sp(j)),T++,T>h&&(h=T)),T<a.length))for(b=b.child;b!==null;)s.push(b,T),b=b.sibling}if(h<a.length){for(s=[];h<a.length;h++)s.push(sp(a[h]));return`findAllNodes was able to match part of the selector:
  `+(d.join(" > ")+`

No matching component was found for:
  `)+s.join(" > ")}return null},r.getPublicRootInstance=function(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return Ke(s.child.stateNode);default:return s.child.stateNode}},r.injectIntoDevTools=function(s){if(s={bundleType:s.bundleType,version:s.version,rendererPackageName:s.rendererPackageName,rendererConfig:s.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:c.ReactCurrentDispatcher,findHostInstanceByFiber:nM,findFiberByHostInstance:s.findFiberByHostInstance||sM,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")s=!1;else{var a=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(a.isDisabled||!a.supportsFiber)s=!0;else{try{hu=a.inject(s),Or=a}catch{}s=!!a.checkDCE}}return s},r.isAlreadyRendering=function(){return!1},r.observeVisibleRects=function(s,a,h,d){if(!hi)throw Error(u(363));s=op(s,a);var m=nd(s,h,d).disconnect;return{disconnect:function(){m()}}},r.registerMutableSourceForHydration=function(s,a){var h=a._getVersion;h=h(a._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[a,h]:s.mutableSourceEagerHydrationData.push(a,h)},r.runWithPriority=function(s,a){var h=ct;try{return ct=s,a()}finally{ct=h}},r.shouldError=function(){return null},r.shouldSuspend=function(){return!1},r.updateContainer=function(s,a,h,d){var m=a.current,b=Li(),T=kn(m);return h=J1(h),a.context===null?a.context=h:a.pendingContext=h,a=Jr(b,T),a.payload={element:s},d=d===void 0?null:d,d!==null&&(a.callback=d),s=Sn(m,a,T),s!==null&&(lr(s,m,T,b),vu(s,m,T)),T},r}}),ff=qe((e,t)=>{t.exports=Vw()}),Rh=qe(e=>{var t=(fe(),Yt(Mn));e.createRoot=t.createRoot,e.hydrateRoot=t.hydrateRoot}),Mh=qe((e,t)=>{(function(i,r){r(typeof e=="object"&&typeof t<"u"?e:(i=i||self).TypesafeActions={})})(e,function(i){function r(A){return A==null}function n(A){throw new Error("Argument "+A+" is empty.")}function o(A){return typeof A=="function"&&"getType"in A}function l(A){throw new Error("Argument "+A+' is invalid, it should be an action-creator instance from "typesafe-actions"')}function u(A,$){if(A==null)throw new Error("Argument contains array with empty element at index "+$);if(A.getType==null)throw new Error("Argument contains array with invalid element at index "+$+', it should be an action-creator instance from "typesafe-actions"')}function c(A){return typeof A=="string"||typeof A=="symbol"}function p(A){return!c(A)}function f(A){throw new Error("Argument "+A+" is invalid, it should be an action type of type: string | symbol")}function v(A,$){if(A==null)throw new Error("Argument contains array with empty element at index "+$);if(typeof A!="string"&&typeof A!="symbol")throw new Error("Argument contains array with invalid element at index "+$+", it should be of type: string | symbol")}function x(A,$,z,B){return r(A)&&n(1),p(A)&&l(1),{type:A,payload:$,meta:z,error:B}}function E(A,$){return r(A)&&n(1),p(A)&&f(1),Object.assign(function(){var z=$!=null?$.apply(void 0,arguments):void 0;return Object.assign({type:A},z)},{getType:function(){return A},toString:function(){return A}})}function _(A,$,z){return r(A)&&n(1),p(A)&&f(1),function(){return E(A,function(){var B=arguments.length<=0?void 0:arguments[0],H=arguments.length<=1?void 0:arguments[1];return $==null&&z==null||(B=$!=null?$.apply(void 0,arguments):void 0,H=z!=null?z.apply(void 0,arguments):void 0),Object.assign({},B!==void 0&&{payload:B},{},H!==void 0&&{meta:H})})}}function P(A){return r(A)&&n(1),o(A)||l(1),A.getType()}function O(A,$){r(A)&&n(1),p(A)&&f(1);var z=$!=null?$(A):function(){return{type:A}};return Object.assign(z,{getType:function(){return A},toString:function(){return A}})}var I={createAction:function(A,$){var z=$==null?function(){return x(A)}:$(x.bind(null,A));return Object.assign(z,{getType:function(){return A},toString:function(){return A}})},createCustomAction:O,createStandardAction:function(A){return r(A)&&n(1),p(A)&&f(1),Object.assign(function(){return O(A,function($){return function(z,B){return{type:$,payload:z,meta:B}}})},{map:function($){return O(A,function(z){return function(B,H){return Object.assign($(B,H),{type:z})}})}})}};i.action=x,i.createAction=_,i.createAsyncAction=function(A,$,z,B){return function(){var H=[A,$,z,B].map(function(Y,V){return Array.isArray(Y)?_(Y[0],Y[1],Y[2])():typeof Y=="string"||typeof Y=="symbol"?_(Y)():void(V<3&&function(he){throw new Error("Argument "+he+' is invalid, it should be an action type of "string | symbol" or a tuple of "[string | symbol, Function, Function?]"')}(V))});return{request:H[0],success:H[1],failure:H[2],cancel:H[3]}}},i.createCustomAction=E,i.createReducer=function A($,z){z===void 0&&(z={});var B=Object.assign({},z),H=function(Y,V){var he=Array.isArray(Y)?Y:[Y],Q={};return he.map(function(ue,pe){return o(ue)?P(ue):c(ue)?ue:function(ge){throw new Error("Argument "+ge+' is invalid, it should be an action-creator instance from "typesafe-actions" or action type of type: string | symbol')}(pe+1)}).forEach(function(ue){return Q[ue]=V}),A($,Object.assign({},B,{},Q))};return Object.assign(function(Y,V){if(Y===void 0&&(Y=$),B.hasOwnProperty(V.type)){var he=B[V.type];if(typeof he!="function")throw Error('Reducer under "'+V.type+'" key is not a valid reducer');return he(Y,V)}return Y},{handlers:Object.assign({},B),handleAction:H,handleType:H})},i.deprecated=I,i.getType=P,i.isActionOf=function(A,$){r(A)&&n(1);var z=Array.isArray(A)?A:[A];z.forEach(u);var B=function(H){return z.some(function(Y){return H.type===Y.getType()})};return $===void 0?B:B($)},i.isOfType=function(A,$){r(A)&&n(1);var z=Array.isArray(A)?A:[A];z.forEach(v);var B=function(H){return z.includes(H.type)};return $===void 0?B:B($)}})}),Gw=qe((e,t)=>{var i=!1,r,n,o,l,u,c,p,f,v,x,E,_,P,O,I;function A(){if(!i){i=!0;var z=navigator.userAgent,B=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(z),H=/(Mac OS X)|(Windows)|(Linux)/.exec(z);if(_=/\b(iPhone|iP[ao]d)/.exec(z),P=/\b(iP[ao]d)/.exec(z),x=/Android/i.exec(z),O=/FBAN\/\w+;/i.exec(z),I=/Mobile/i.exec(z),E=!!/Win64/.exec(z),B){r=B[1]?parseFloat(B[1]):B[5]?parseFloat(B[5]):NaN,r&&document&&document.documentMode&&(r=document.documentMode);var Y=/(?:Trident\/(\d+.\d+))/.exec(z);c=Y?parseFloat(Y[1])+4:r,n=B[2]?parseFloat(B[2]):NaN,o=B[3]?parseFloat(B[3]):NaN,l=B[4]?parseFloat(B[4]):NaN,l?(B=/(?:Chrome\/(\d+\.\d+))/.exec(z),u=B&&B[1]?parseFloat(B[1]):NaN):u=NaN}else r=n=o=u=l=NaN;if(H){if(H[1]){var V=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(z);p=V?parseFloat(V[1].replace("_",".")):!0}else p=!1;f=!!H[2],v=!!H[3]}else p=f=v=!1}}var $={ie:function(){return A()||r},ieCompatibilityMode:function(){return A()||c>r},ie64:function(){return $.ie()&&E},firefox:function(){return A()||n},opera:function(){return A()||o},webkit:function(){return A()||l},safari:function(){return $.webkit()},chrome:function(){return A()||u},windows:function(){return A()||f},osx:function(){return A()||p},linux:function(){return A()||v},iphone:function(){return A()||_},mobile:function(){return A()||_||P||x||I},nativeApp:function(){return A()||O},android:function(){return A()||x},ipad:function(){return A()||P}};t.exports=$}),Zw=qe((e,t)=>{var i=!!(typeof window<"u"&&window.document&&window.document.createElement),r={canUseDOM:i,canUseWorkers:typeof Worker<"u",canUseEventListeners:i&&!!(window.addEventListener||window.attachEvent),canUseViewport:i&&!!window.screen,isInWorker:!i};t.exports=r}),Xw=qe((e,t)=>{var i=Zw(),r;i.canUseDOM&&(r=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);function n(o,l){if(!i.canUseDOM||l&&!("addEventListener"in document))return!1;var u="on"+o,c=u in document;if(!c){var p=document.createElement("div");p.setAttribute(u,"return;"),c=typeof p[u]=="function"}return!c&&r&&o==="wheel"&&(c=document.implementation.hasFeature("Events.wheel","3.0")),c}t.exports=n}),Yw=qe((e,t)=>{var i=Gw(),r=Xw(),n=10,o=40,l=800;function u(c){var p=0,f=0,v=0,x=0;return"detail"in c&&(f=c.detail),"wheelDelta"in c&&(f=-c.wheelDelta/120),"wheelDeltaY"in c&&(f=-c.wheelDeltaY/120),"wheelDeltaX"in c&&(p=-c.wheelDeltaX/120),"axis"in c&&c.axis===c.HORIZONTAL_AXIS&&(p=f,f=0),v=p*n,x=f*n,"deltaY"in c&&(x=c.deltaY),"deltaX"in c&&(v=c.deltaX),(v||x)&&c.deltaMode&&(c.deltaMode==1?(v*=o,x*=o):(v*=l,x*=l)),v&&!p&&(p=v<1?-1:1),x&&!f&&(f=x<1?-1:1),{spinX:p,spinY:f,pixelX:v,pixelY:x}}u.getEventType=function(){return i.firefox()?"DOMMouseScroll":r("wheel")?"wheel":"mousewheel"},t.exports=u}),Kw=qe((e,t)=>{t.exports=Yw()}),Jw=qe((e,t)=>{function i(r,n,o){var l,u,c,p,f;n==null&&(n=100);function v(){var E=Date.now()-p;E<n&&E>=0?l=setTimeout(v,n-E):(l=null,o||(f=r.apply(c,u),c=u=null))}var x=function(){c=this,u=arguments,p=Date.now();var E=o&&!l;return l||(l=setTimeout(v,n)),E&&(f=r.apply(c,u),c=u=null),f};return x.clear=function(){l&&(clearTimeout(l),l=null)},x.flush=function(){l&&(f=r.apply(c,u),c=u=null,clearTimeout(l),l=null)},x}i.debounce=i,t.exports=i}),gf=qe((e,t)=>{(function(i,r){typeof e=="object"&&typeof t<"u"?r(e,(fe(),Yt(Mn))):(i=typeof globalThis<"u"?globalThis:i||self,r(i.ReactErrorBoundary={},i.React))})(e,function(i,r){function n(E){if(E&&E.__esModule)return E;var _=Object.create(null);return E&&Object.keys(E).forEach(function(P){if(P!=="default"){var O=Object.getOwnPropertyDescriptor(E,P);Object.defineProperty(_,P,O.get?O:{enumerable:!0,get:function(){return E[P]}})}}),_.default=E,Object.freeze(_)}var o=n(r);function l(E,_){return l=Object.setPrototypeOf||function(P,O){return P.__proto__=O,P},l(E,_)}function u(E,_){E.prototype=Object.create(_.prototype),E.prototype.constructor=E,l(E,_)}var c=function(E,_){return E===void 0&&(E=[]),_===void 0&&(_=[]),E.length!==_.length||E.some(function(P,O){return!Object.is(P,_[O])})},p={error:null},f=function(E){u(_,E);function _(){for(var O,I=arguments.length,A=new Array(I),$=0;$<I;$++)A[$]=arguments[$];return O=E.call.apply(E,[this].concat(A))||this,O.state=p,O.resetErrorBoundary=function(){for(var z,B=arguments.length,H=new Array(B),Y=0;Y<B;Y++)H[Y]=arguments[Y];O.props.onReset==null||(z=O.props).onReset.apply(z,H),O.reset()},O}_.getDerivedStateFromError=function(O){return{error:O}};var P=_.prototype;return P.reset=function(){this.setState(p)},P.componentDidCatch=function(O,I){var A,$;(A=($=this.props).onError)==null||A.call($,O,I)},P.componentDidUpdate=function(O,I){var A=this.state.error,$=this.props.resetKeys;if(A!==null&&I.error!==null&&c(O.resetKeys,$)){var z,B;(z=(B=this.props).onResetKeysChange)==null||z.call(B,O.resetKeys,$),this.reset()}},P.render=function(){var O=this.state.error,I=this.props,A=I.fallbackRender,$=I.FallbackComponent,z=I.fallback;if(O!==null){var B={error:O,resetErrorBoundary:this.resetErrorBoundary};if(o.isValidElement(z))return z;if(typeof A=="function")return A(B);if($)return o.createElement($,B);throw new Error("react-error-boundary requires either a fallback, fallbackRender, or FallbackComponent prop")}return this.props.children},_}(o.Component);function v(E,_){var P=function(I){return o.createElement(f,_,o.createElement(E,I))},O=E.displayName||E.name||"Unknown";return P.displayName="withErrorBoundary("+O+")",P}function x(E){var _=o.useState(null),P=_[0],O=_[1];if(E!=null)throw E;if(P!=null)throw P;return O}i.ErrorBoundary=f,i.useErrorHandler=x,i.withErrorBoundary=v,Object.defineProperty(i,"__esModule",{value:!0})})});et();function Ln(e,t,i,r){function n(){let l=Reflect.construct(HTMLElement,[],n);return l._vdomComponent=e,l._shadowEnabled=r&&r.shadow,l._root=l._shadowEnabled?l.attachShadow({mode:"open"}):l,r.onConstruct&&r.onConstruct(l),l.ready=!1,l.whenReady=u=>{l.ready?u():l.addEventListener("ready",u)},l}n.prototype=Object.create(HTMLElement.prototype),n.prototype.constructor=n,n.prototype.connectedCallback=tx,n.prototype.attributeChangedCallback=ix,n.prototype.disconnectedCallback=rx,i=i||e.observedAttributes||Object.keys(e.propTypes||{}),n.observedAttributes=i,i.forEach(l=>{Object.defineProperty(n.prototype,l,{get(){return this._vdom?this._vdom.props[l]:(this._props||(this._props={}),this._props[l])},set(u){this._vdom?(this._props[l]=u,this.attributeChangedCallback(l,null,u)):(this._props||(this._props={}),this._props[l]=u,this._props[Lh(l)]=u);let c=typeof u;(u==null||c==="string"||c==="boolean"||c==="number")&&this.setAttribute(l,u)}})}),r.beforeCreate&&r.beforeCreate(n);let o=t||e.tagName||e.displayName||e.name;if(!customElements.get(o))return customElements.define(t||e.tagName||e.displayName||e.name,n)}function ex(e){this.getChildContext=()=>e.context;let t=e,{context:i,children:r}=t,n=le(t,["context","children"]);return ah(r,n)}function tx(){let e=new CustomEvent("_preact",{detail:{},bubbles:!0,cancelable:!0});this.dispatchEvent(e);let t=e.detail.context;this._vdom=N(ex,D(C({},this._props),{context:t}),yf(this,this._vdomComponent,this._shadowEnabled)),(this.hasAttribute("hydrate")?oh:xr)(this._vdom,this._root),this.ready||(this.ready=!0,this.dispatchEvent(new CustomEvent("ready",{detail:{},bubbles:!1,cancelable:!1})))}function Lh(e){return e.replace(/-(\w)/g,(t,i)=>i?i.toUpperCase():"")}function ix(e,t,i){if(!this._vdom)return;i=i??void 0;let r={};r[e]=i,r[Lh(e)]=i,this._vdom=ah(this._vdom,r),xr(this._vdom,this._root)}function rx(){xr(this._vdom=null,this._root)}function mf(e,t){let i=e,{shadow:r,addContextListener:n,removeContextListener:o}=i,l=le(i,["shadow","addContextListener","removeContextListener"]),u=c=>{c?(this.ref=c,this._listener||(this._listener=p=>{p.stopPropagation(),p.detail.context=t},n(this._listener,this.ref))):o(this._listener,this.ref)};return!r&&!this._listener&&(this._listener=c=>{c.stopPropagation(),c.detail.context=t},n(this._listener)),N(r?"slot":it,D(C({},l),{ref:u}))}function yf(e,t,i){if(e.nodeType===3)return e.data;if(e.nodeType!==1)return null;let r=[],n={},o=0,l=e.attributes,u=e.childNodes;for(o=l.length;o--;)l[o].name!=="slot"&&(n[l[o].name]=l[o].value,n[Lh(l[o].name)]=l[o].value);for(o=u.length;o--;){let p=u[o],f=yf(p,null,i),v=p.slot;v?n[v]=N(mf,{name:v,shadow:i,addContextListener(x,E=p){E.addEventListener("_preact",x)},removeContextListener(x,E=p){E.removeEventListener("_preact",x)}},f):r[o]=f}let c=t?N(mf,{shadow:i,addContextListener(p,f=e){f.addEventListener("_preact",p)},removeContextListener(p,f=e){f.removeEventListener("_preact",p)}},r):r;return!i&&t&&(e.innerHTML=""),N(t||e.nodeName.toLowerCase(),n,c)}fe(),fe(),fe(),fe(),fe();var nx=je(ff(),1),vf,bf,Na=["onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut","onScroll","onWheel","onClick","onDragStart","onDragEnd","onDragEnter","onDragExit","onDrag","onDragOver"];function sx(){return Na.reduce((e,t)=>(e[t]=[],e),{})}var $h=Na.reduce((e,t)=>(e[t.slice(2).toLowerCase()]=t,e[t]=t,e),{}),So=(e,t,i)=>{let r=e.length,n=i||ze(r);for(let o=0;o<r;o++)n[o]=o%5===0?e[o+1]<t[3]&&e[o+3]>t[1]&&e[o+2]<t[4]&&e[o+4]>t[2]?1:0:e[o];return n};function ze(e,t,i){return new Float32Array(e,t,i)}var ox=(e,t,i)=>{let r=e[1]<=t[3]&&e[3]>=t[1]&&e[2]<=t[4]&&e[4]>=t[2],n=i||ze(5);return r?(n[0]=1,n[1]=Math.max(e[1],t[1]),n[2]=Math.max(e[2],t[2]),n[3]=Math.min(e[3],t[3]),n[4]=Math.min(e[4],t[4]),n):(n[0]=0,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n)},ax=e=>e.length/5,sn=(e,t,i)=>{let r=i||ze(9);return r[0]=e[0]*t[0]+e[1]*t[3]+e[2]*t[6],r[1]=e[0]*t[1]+e[1]*t[4]+e[2]*t[7],r[2]=e[0]*t[2]+e[1]*t[5]+e[2]*t[8],r[3]=e[3]*t[0]+e[4]*t[3]+e[5]*t[6],r[4]=e[3]*t[1]+e[4]*t[4]+e[5]*t[7],r[5]=e[3]*t[2]+e[4]*t[5]+e[5]*t[8],r[6]=e[6]*t[0]+e[7]*t[3]+e[8]*t[6],r[7]=e[6]*t[1]+e[7]*t[4]+e[8]*t[7],r[8]=e[6]*t[2]+e[7]*t[5]+e[8]*t[8],r},ut=class{constructor(e){this.index=0,this.length=e,this.points=ze(this.length)}static grid(e=1,t=1){return new ut(5*e*t)}static point(e,t){let i=ze(5);return i[0]=1,i[1]=e,i[2]=t,i[3]=e,i[4]=t,i}static positionPair(e){let t=ze(5);return t[0]=1,t[1]=e.x1,t[2]=e.y1,t[3]=e.x2,t[4]=e.y2,t}static projection(e){return ut.singleBox(e.width,e.height,e.x,e.y)}static singleBox(e,t,i=0,r=0){let n=ze(5);return n[0]=1,n[1]=i,n[2]=r,n[3]=e+i,n[4]=t+r,n}row(e){return e(this)}addPoints(e,t,i,r){return this.points[this.index]=1,this.points[1+this.index]=e,this.points[2+this.index]=t,this.points[3+this.index]=i,this.points[4+this.index]=r,this.index+=5,this}addBox(e,t,i,r){return this.addPoints(e,t,e+i,t+r),this}build(){return this.points}},_r=(e,t)=>{let i=e.length;for(let r=0;r<i;r++)e[r]=r%5===0?t[6]*e[r+1]+t[7]*e[r+2]+t[8]*e[r]:r%5%2===1?t[0]*e[r]+t[1]*e[r+1]+t[2]:t[3]*e[r-1]+t[4]*e[r]+t[5];return e},$n=e=>{let t=ze(9);return t[0]=e,t[4]=e,t[8]=1,t},Xi=(e,t)=>{let i=ze(9);return i[0]=1,i[2]=e,i[4]=1,i[5]=t,i[8]=1,i},za=(e,t,i)=>sn(Xi((1-e)*t,(1-e)*i),$n(e)),Nn=(e,t,i)=>{let r=e.length,n=i&&i.length>=r?i.slice(0,r):ze(r);for(let o=0;o<r;o++)n[o]=o%5===0?t[6]*e[o+1]+t[7]*e[o+2]+t[8]*e[o]:o%5%2===1?t[0]*e[o]+t[1]*e[o+1]+t[2]:t[3]*e[o-1]+t[4]*e[o]+t[5];return n},Fa=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((t,i)=>(i&=63,i<36?t+=i.toString(36):i<62?t+=(i-26).toString(36).toUpperCase():i>62?t+="-":t+="_",t),""),Sr=class{constructor(){this.__revision=0,this.__owner={value:void 0},this.__state={},this.scale=1,this.layers=[],this.time=[],this.addEventListener=(e,t,i)=>{let r=$h[e];if(!this.eventHandlers[r])throw new Error(`Unknown event ${r}`);this.eventHandlers[r].indexOf(t)===-1&&this.eventHandlers[r].push(t)},this.removeEventListener=(e,t)=>{let i=$h[e];if(!this.eventHandlers[i]){console.warn(`Unknown event ${i}`);return}this.eventHandlers[i].indexOf(t)!==-1&&(this.eventHandlers[i]=this.eventHandlers[i].filter(r=>r!==t))},this.id=this.__id=Fa(),this.eventHandlers=sx()}get crop(){return this._crop}set crop(e){this._crop=e}getObjectsAt(e){return[]}getAllPointsAt(e,t,i){return[]}getScheduledUpdates(e,t){return[]}dispatchEvent(e,t){let i=this.eventHandlers[e],r=i?i.length:0,n=!1;if(r)for(let o=0;o<r;o++)try{i[o](t),n=!0}catch(l){console.error(e,l)}return n}get x(){return this.points[1]}get y(){return this.points[2]}get width(){return this.points[3]-this.points[1]}get height(){return this.points[4]-this.points[2]}translate(e,t){_r(this.points,Xi(e,t))}atScale(e){_r(this.points,za(e,this.x,this.y)),this.scale*=e}transform(e){_r(this.points,e)}applyProps(e){this.__revision++}appendChild(e){}removeChild(e){}insertBefore(e,t){}hideInstance(){}},Eo=class extends Sr{constructor(e){if(super(),this.type="spacial-content",this.style={opacity:1},!e)this.id="",this.uri="",this.display={x:0,y:0,scale:1,width:0,height:0,points:ze(5)},this.points=ze(5);else{let t=e.scale||1;this.id=e.id||e.uri,this.uri=e.uri,this.points=ut.singleBox(e.width,e.height,e.x,e.y),this.display={x:0,y:0,scale:t,width:e.width/t,height:e.height/t,points:ut.singleBox(e.width/t,e.height/t),rotation:e==null?void 0:e.rotation}}}applyProps(e){let t=e.display?e.display.width:e.target.width,i=e.target.width/t;if(this.id=e.id||e.uri,this.uri=e.uri,this.points.set(ut.singleBox(e.target.width,e.target.height,e.target.x,e.target.y)),e.style&&typeof e.style.opacity<"u"&&(this.style.opacity=e.style.opacity),e.crop){this.cropData=e.crop;let r=ut.singleBox(e.crop.width,e.crop.height,e.crop.x,e.crop.y);_r(r,Xi(-e.crop.x,-e.crop.y)),this.crop?this.crop.set(r):this.crop=ze(r)}e.display?(this.display.scale=i,this.display.width=e.display.width,this.display.height=e.display.height,this.display.rotation=e.display.rotation,this.display.points=ut.singleBox(e.display.width,e.display.height)):(this.display.scale=i,this.display.width=e.target.width/i,this.display.height=e.target.height/i,this.display.points=ut.singleBox(e.target.width/i,e.target.height/i))}getAllPointsAt(e,t,i){return[[this,this.crop||this.points,t]]}static fromSvg(e,t,i,r){return Eo.fromImage("data:image/svg+xml;base64,"+btoa(e),t,i,r)}static fromImage(e,t,i,r){let n=new Eo;return n.applyProps({uri:e,id:r,display:i,target:t}),n}getImageUrl(){return this.uri}},lx=class extends Sr{constructor(e){if(super(),this.type="spacial-content",this.getTexture=()=>({source:void 0,hash:-1}),!e)this.id="",this.uri="",this.display={x:0,y:0,scale:1,width:0,height:0,points:ze(5)},this.points=ze(5);else{let t=e.scale||1;this.id=e.id||e.uri,this.uri=e.uri,this.points=ut.singleBox(e.width,e.height),this.display={x:0,y:0,scale:t,width:e.width/t,height:e.height/t,points:t!==1?ut.singleBox(e.width/t,e.height/t):this.points}}}applyProps(e){let t=e.display?e.display.width:e.target.width,i=e.target.width/t;this.id=e.id,this.points.set(ut.singleBox(e.target.width,e.target.height)),this.display.scale=i,this.display.width=e.target.width/i,this.display.height=e.target.height/i,this.getTexture=e.getTexture,this.display.points=i!==1?ut.singleBox(e.target.width/i,e.target.height/i):this.points}getAllPointsAt(e,t,i){return[[this,this.points,t]]}};function ux(e,t,i=1){let r=t.length;if(r===0)throw new Error("No resources passed in.");let n=0;for(let o=0;o<r&&!(!t[o]||!t[o].display);o++)n=Math.abs(t[o].display.scale-e)*i<Math.abs(t[n].display.scale-e)?o:n;return n}function hx(e){let t=e.length;return e.indexOf("/info.json")===t-10?e.slice(0,-10):e}function wf(...e){return t=>e.forEach(i=>function(r,n){typeof r=="function"?r(n):r!=null&&(r.current=n)}(i,t))}function Ba(...e){return He(wf(...e),e)}function Ai(){return Ai=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},Ai.apply(this,arguments)}var xf=mi((e,t)=>{let i=e,{children:r}=i,n=le(i,["children"]);return nn.toArray(r).some(Sf)?N(it,null,nn.map(r,o=>Sf(o)?N(Nh,Ai({},n,{ref:t}),o.props.children):o)):N(Nh,Ai({},n,{ref:t}),r)});xf.displayName="Slot";var Nh=mi((e,t)=>{let i=e,{children:r}=i,n=le(i,["children"]);return _o(r)?$a(r,D(C({},cx(n,r.props)),{ref:wf(t,r.ref)})):nn.count(r)>1?nn.only(null):null});Nh.displayName="SlotClone";var _f=({children:e})=>N(it,null,e);function Sf(e){return _o(e)&&e.type===_f}function cx(e,t){let i=C({},t);for(let r in t){let n=e[r],o=t[r];/^on[A-Z]/.test(r)?i[r]=(...l)=>{o==null||o(...l),n==null||n(...l)}:r==="style"?i[r]=C(C({},n),o):r==="className"&&(i[r]=[n,o].filter(Boolean).join(" "))}return C(C({},e),i)}var ja=globalThis!=null&&globalThis.document?At:()=>{},Ua=function(e,t,i,r){this.name=e,this.fn=t,this.args=i,this.modifiers=r};Ua.prototype._test=function(e){var t=this.fn;try{Is(this.modifiers.slice(),t,this)(e)}catch{t=function(){return!1}}try{return Is(this.modifiers.slice(),t,this)(e)}catch{return!1}},Ua.prototype._check=function(e){try{Is(this.modifiers.slice(),this.fn,this)(e)}catch{if(Is(this.modifiers.slice(),function(i){return i},this)(!1))return}if(!Is(this.modifiers.slice(),this.fn,this)(e))throw null},Ua.prototype._testAsync=function(e){var t=this;return new Promise(function(i,r){Af(t.modifiers.slice(),t.fn,t)(e).then(function(n){n?i(e):r(null)}).catch(function(n){return r(n)})})};function Ef(e,t){return t===void 0&&(t="simple"),typeof e=="object"?e[t]:e}function Is(e,t,i){if(e.length){var r=e.shift(),n=Is(e,t,i);return r.perform(n,i)}else return Ef(t)}function Af(e,t,i){if(e.length){var r=e.shift(),n=Af(e,t,i);return r.performAsync(n,i)}else return function(o){return Promise.resolve(Ef(t,"async")(o))}}var dx=function(e,t,i){this.name=e,this.perform=t,this.performAsync=i},zh=function(e){function t(i,r,n,o){for(var l=[],u=arguments.length-4;u-- >0;)l[u]=arguments[u+4];e.call(this,l),e.captureStackTrace&&e.captureStackTrace(this,t),this.rule=i,this.value=r,this.cause=n,this.target=o}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Error),Er=function(e,t){e===void 0&&(e=[]),t===void 0&&(t=[]),this.chain=e,this.nextRuleModifiers=t};Er.prototype._applyRule=function(e,t){var i=this;return function(){for(var r=[],n=arguments.length;n--;)r[n]=arguments[n];return i.chain.push(new Ua(t,e.apply(i,r),r,i.nextRuleModifiers)),i.nextRuleModifiers=[],i}},Er.prototype._applyModifier=function(e,t){return this.nextRuleModifiers.push(new dx(t,e.simple,e.async)),this},Er.prototype._clone=function(){return new Er(this.chain.slice(),this.nextRuleModifiers.slice())},Er.prototype.test=function(e){return this.chain.every(function(t){return t._test(e)})},Er.prototype.testAll=function(e){var t=[];return this.chain.forEach(function(i){try{i._check(e)}catch(r){t.push(new zh(i,e,r))}}),t},Er.prototype.check=function(e){this.chain.forEach(function(t){try{t._check(e)}catch(i){throw new zh(t,e,i)}})},Er.prototype.testAsync=function(e){var t=this;return new Promise(function(i,r){kf(e,t.chain.slice(),i,r)})};function kf(e,t,i,r){if(t.length){var n=t.shift();n._testAsync(e).then(function(){kf(e,t,i,r)},function(o){r(new zh(n,e,o))})}else i(e)}var Pf=function(e,t){return t&&typeof e=="string"&&e.trim().length===0?!0:e==null};function px(e,t){return t===void 0&&(t=!1),{simple:function(i){return Pf(i,t)||e.check(i)===void 0},async:function(i){return Pf(i,t)||e.testAsync(i)}}}function on(){return typeof Proxy<"u"?Cf(new Er):Fh(new Er)}var Ao={};on.extend=function(e){Object.assign(Ao,e)},on.clearCustomRules=function(){Ao={}};function Cf(e){return new Proxy(e,{get:function(t,i){if(i in t)return t[i];var r=Cf(e._clone());if(i in Da)return r._applyModifier(Da[i],i);if(i in Ao)return r._applyRule(Ao[i],i);if(i in Bh)return r._applyRule(Bh[i],i)}})}function Fh(e){var t=function(n,o){return Object.keys(n).forEach(function(l){o[l]=function(){for(var u=[],c=arguments.length;c--;)u[c]=arguments[c];var p=Fh(o._clone()),f=p._applyRule(n[l],l).apply(void 0,u);return f}}),o},i=t(Bh,e),r=t(Ao,i);return Object.keys(Da).forEach(function(n){Object.defineProperty(r,n,{get:function(){var o=Fh(r._clone());return o._applyModifier(Da[n],n)}})}),r}var Da={not:{simple:function(e){return function(t){return!e(t)}},async:function(e){return function(t){return Promise.resolve(e(t)).then(function(i){return!i}).catch(function(){return!0})}}},some:{simple:function(e){return function(t){return Wa(t).some(function(i){try{return e(i)}catch{return!1}})}},async:function(e){return function(t){return Promise.all(Wa(t).map(function(i){try{return e(i).catch(function(){return!1})}catch{return!1}})).then(function(i){return i.some(Boolean)})}}},every:{simple:function(e){return function(t){return t!==!1&&Wa(t).every(e)}},async:function(e){return function(t){return Promise.all(Wa(t).map(e)).then(function(i){return i.every(Boolean)})}}},strict:{simple:function(e,t){return function(i){return Tf(t)&&i&&typeof i=="object"?Object.keys(t.args[0]).length===Object.keys(i).length&&e(i):e(i)}},async:function(e,t){return function(i){return Promise.resolve(e(i)).then(function(r){return Tf(t)&&i&&typeof i=="object"?Object.keys(t.args[0]).length===Object.keys(i).length&&r:r}).catch(function(){return!1})}}}};function Tf(e){return e&&e.name==="schema"&&e.args.length>0&&typeof e.args[0]=="object"}function Wa(e){return typeof e=="string"?e.split(""):e}var Bh={equal:function(e){return function(t){return t==e}},exact:function(e){return function(t){return t===e}},number:function(e){return e===void 0&&(e=!0),function(t){return typeof t=="number"&&(e||isFinite(t))}},integer:function(){return function(e){var t=Number.isInteger||fx;return t(e)}},numeric:function(){return function(e){return!isNaN(parseFloat(e))&&isFinite(e)}},string:function(){return Os("string")},boolean:function(){return Os("boolean")},undefined:function(){return Os("undefined")},null:function(){return Os("null")},array:function(){return Os("array")},object:function(){return Os("object")},instanceOf:function(e){return function(t){return t instanceof e}},pattern:function(e){return function(t){return e.test(t)}},lowercase:function(){return function(e){return typeof e=="boolean"||e===e.toLowerCase()&&e.trim()!==""}},uppercase:function(){return function(e){return e===e.toUpperCase()&&e.trim()!==""}},vowel:function(){return function(e){return/^[aeiou]+$/i.test(e)}},consonant:function(){return function(e){return/^(?=[^aeiou])([a-z]+)$/i.test(e)}},first:function(e){return function(t){return t[0]==e}},last:function(e){return function(t){return t[t.length-1]==e}},empty:function(){return function(e){return e.length===0}},length:function(e,t){return function(i){return i.length>=e&&i.length<=(t||e)}},minLength:function(e){return function(t){return t.length>=e}},maxLength:function(e){return function(t){return t.length<=e}},negative:function(){return function(e){return e<0}},positive:function(){return function(e){return e>=0}},between:function(e,t){return function(i){return i>=e&&i<=t}},range:function(e,t){return function(i){return i>=e&&i<=t}},lessThan:function(e){return function(t){return t<e}},lessThanOrEqual:function(e){return function(t){return t<=e}},greaterThan:function(e){return function(t){return t>e}},greaterThanOrEqual:function(e){return function(t){return t>=e}},even:function(){return function(e){return e%2===0}},odd:function(){return function(e){return e%2!==0}},includes:function(e){return function(t){return~t.indexOf(e)}},schema:function(e){return gx(e)},passesAnyOf:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return function(i){return e.some(function(r){return r.test(i)})}},optional:px};function Os(e){return function(t){return Array.isArray(t)&&e==="array"||t===null&&e==="null"||typeof t===e}}function fx(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e}function gx(e){return{simple:function(t){var i=[];if(Object.keys(e).forEach(function(r){var n=e[r];try{n.check((t||{})[r])}catch(o){o.target=r,i.push(o)}}),i.length>0)throw i;return!0},async:function(t){var i=[],r=Object.keys(e).map(function(n){var o=e[n];return o.testAsync((t||{})[n]).catch(function(l){l.target=n,i.push(l)})});return Promise.all(r).then(function(){if(i.length>0)throw i;return!0})}}}var bt="colors",Ni="sizes",_e="space",mx={gap:_e,gridGap:_e,columnGap:_e,gridColumnGap:_e,rowGap:_e,gridRowGap:_e,inset:_e,insetBlock:_e,insetBlockEnd:_e,insetBlockStart:_e,insetInline:_e,insetInlineEnd:_e,insetInlineStart:_e,margin:_e,marginTop:_e,marginRight:_e,marginBottom:_e,marginLeft:_e,marginBlock:_e,marginBlockEnd:_e,marginBlockStart:_e,marginInline:_e,marginInlineEnd:_e,marginInlineStart:_e,padding:_e,paddingTop:_e,paddingRight:_e,paddingBottom:_e,paddingLeft:_e,paddingBlock:_e,paddingBlockEnd:_e,paddingBlockStart:_e,paddingInline:_e,paddingInlineEnd:_e,paddingInlineStart:_e,top:_e,right:_e,bottom:_e,left:_e,scrollMargin:_e,scrollMarginTop:_e,scrollMarginRight:_e,scrollMarginBottom:_e,scrollMarginLeft:_e,scrollMarginX:_e,scrollMarginY:_e,scrollMarginBlock:_e,scrollMarginBlockEnd:_e,scrollMarginBlockStart:_e,scrollMarginInline:_e,scrollMarginInlineEnd:_e,scrollMarginInlineStart:_e,scrollPadding:_e,scrollPaddingTop:_e,scrollPaddingRight:_e,scrollPaddingBottom:_e,scrollPaddingLeft:_e,scrollPaddingX:_e,scrollPaddingY:_e,scrollPaddingBlock:_e,scrollPaddingBlockEnd:_e,scrollPaddingBlockStart:_e,scrollPaddingInline:_e,scrollPaddingInlineEnd:_e,scrollPaddingInlineStart:_e,fontSize:"fontSizes",background:bt,backgroundColor:bt,backgroundImage:bt,borderImage:bt,border:bt,borderBlock:bt,borderBlockEnd:bt,borderBlockStart:bt,borderBottom:bt,borderBottomColor:bt,borderColor:bt,borderInline:bt,borderInlineEnd:bt,borderInlineStart:bt,borderLeft:bt,borderLeftColor:bt,borderRight:bt,borderRightColor:bt,borderTop:bt,borderTopColor:bt,caretColor:bt,color:bt,columnRuleColor:bt,fill:bt,outline:bt,outlineColor:bt,stroke:bt,textDecorationColor:bt,fontFamily:"fonts",fontWeight:"fontWeights",lineHeight:"lineHeights",letterSpacing:"letterSpacings",blockSize:Ni,minBlockSize:Ni,maxBlockSize:Ni,inlineSize:Ni,minInlineSize:Ni,maxInlineSize:Ni,width:Ni,minWidth:Ni,maxWidth:Ni,height:Ni,minHeight:Ni,maxHeight:Ni,flexBasis:Ni,gridTemplateColumns:Ni,gridTemplateRows:Ni,borderWidth:"borderWidths",borderTopWidth:"borderWidths",borderRightWidth:"borderWidths",borderBottomWidth:"borderWidths",borderLeftWidth:"borderWidths",borderStyle:"borderStyles",borderTopStyle:"borderStyles",borderRightStyle:"borderStyles",borderBottomStyle:"borderStyles",borderLeftStyle:"borderStyles",borderRadius:"radii",borderTopLeftRadius:"radii",borderTopRightRadius:"radii",borderBottomRightRadius:"radii",borderBottomLeftRadius:"radii",boxShadow:"shadows",textShadow:"shadows",transition:"transitions",zIndex:"zIndices"},yx=(e,t)=>typeof t=="function"?{"()":Function.prototype.toString.call(t)}:t,Rs=()=>{let e=Object.create(null);return(t,i,...r)=>{let n=(o=>JSON.stringify(o,yx))(t);return n in e?e[n]:e[n]=i(t,...r)}},zn=Symbol.for("sxs.internal"),jh=(e,t)=>Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)),If=e=>{for(let t in e)return!0;return!1},{hasOwnProperty:vx}=Object.prototype,Uh=e=>e.includes("-")?e:e.replace(/[A-Z]/g,t=>"-"+t.toLowerCase()),bx=/\s+(?![^()]*\))/,Ms=e=>t=>e(...typeof t=="string"?String(t).split(bx):[t]),Of={appearance:e=>({WebkitAppearance:e,appearance:e}),backfaceVisibility:e=>({WebkitBackfaceVisibility:e,backfaceVisibility:e}),backdropFilter:e=>({WebkitBackdropFilter:e,backdropFilter:e}),backgroundClip:e=>({WebkitBackgroundClip:e,backgroundClip:e}),boxDecorationBreak:e=>({WebkitBoxDecorationBreak:e,boxDecorationBreak:e}),clipPath:e=>({WebkitClipPath:e,clipPath:e}),content:e=>({content:e.includes('"')||e.includes("'")||/^([A-Za-z]+\([^]*|[^]*-quote|inherit|initial|none|normal|revert|unset)$/.test(e)?e:`"${e}"`}),hyphens:e=>({WebkitHyphens:e,hyphens:e}),maskImage:e=>({WebkitMaskImage:e,maskImage:e}),maskSize:e=>({WebkitMaskSize:e,maskSize:e}),tabSize:e=>({MozTabSize:e,tabSize:e}),textSizeAdjust:e=>({WebkitTextSizeAdjust:e,textSizeAdjust:e}),userSelect:e=>({WebkitUserSelect:e,userSelect:e}),marginBlock:Ms((e,t)=>({marginBlockStart:e,marginBlockEnd:t||e})),marginInline:Ms((e,t)=>({marginInlineStart:e,marginInlineEnd:t||e})),maxSize:Ms((e,t)=>({maxBlockSize:e,maxInlineSize:t||e})),minSize:Ms((e,t)=>({minBlockSize:e,minInlineSize:t||e})),paddingBlock:Ms((e,t)=>({paddingBlockStart:e,paddingBlockEnd:t||e})),paddingInline:Ms((e,t)=>({paddingInlineStart:e,paddingInlineEnd:t||e}))},Dh=/([\d.]+)([^]*)/,wx=(e,t)=>e.length?e.reduce((i,r)=>(i.push(...t.map(n=>n.includes("&")?n.replace(/&/g,/[ +>|~]/.test(r)&&/&.*&/.test(n)?`:is(${r})`:r):r+" "+n)),i),[]):t,xx=(e,t)=>e in _x&&typeof t=="string"?t.replace(/^((?:[^]*[^\w-])?)(fit-content|stretch)((?:[^\w-][^]*)?)$/,(i,r,n,o)=>r+(n==="stretch"?`-moz-available${o};${Uh(e)}:${r}-webkit-fill-available`:`-moz-fit-content${o};${Uh(e)}:${r}fit-content`)+o):String(t),_x={blockSize:1,height:1,inlineSize:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,width:1},jr=e=>e?e+"-":"",Rf=(e,t,i)=>e.replace(/([+-])?((?:\d+(?:\.\d*)?|\.\d+)(?:[Ee][+-]?\d+)?)?(\$|--)([$\w-]+)/g,(r,n,o,l,u)=>l=="$"==!!o?r:(n||l=="--"?"calc(":"")+"var(--"+(l==="$"?jr(t)+(u.includes("$")?"":jr(i))+u.replace(/\$/g,"-"):u)+")"+(n||l=="--"?"*"+(n||"")+(o||"1")+")":"")),Sx=/\s*,\s*(?![^()]*\))/,Ex=Object.prototype.toString,Ls=(e,t,i,r,n)=>{let o,l,u,c=(p,f,v)=>{let x,E,_=P=>{for(x in P){let A=x.charCodeAt(0)===64,$=A&&Array.isArray(P[x])?P[x]:[P[x]];for(E of $){let z=/[A-Z]/.test(I=x)?I:I.replace(/-[^]/g,H=>H[1].toUpperCase()),B=typeof E=="object"&&E&&E.toString===Ex&&(!r.utils[z]||!f.length);if(z in r.utils&&!B){let H=r.utils[z];if(H!==l){l=H,_(H(E)),l=null;continue}}else if(z in Of){let H=Of[z];if(H!==u){u=H,_(H(E)),u=null;continue}}if(A&&(O=x.slice(1)in r.media?"@media "+r.media[x.slice(1)]:x,x=O.replace(/\(\s*([\w-]+)\s*(=|<|<=|>|>=)\s*([\w-]+)\s*(?:(<|<=|>|>=)\s*([\w-]+)\s*)?\)/g,(H,Y,V,he,Q,ue)=>{let pe=Dh.test(Y),ge=.0625*(pe?-1:1),[oe,Se]=pe?[he,Y]:[Y,he];return"("+(V[0]==="="?"":V[0]===">"===pe?"max-":"min-")+oe+":"+(V[0]!=="="&&V.length===1?Se.replace(Dh,(Pe,Ke,re)=>Number(Ke)+ge*(V===">"?1:-1)+re):Se)+(Q?") and ("+(Q[0]===">"?"min-":"max-")+oe+":"+(Q.length===1?ue.replace(Dh,(Pe,Ke,re)=>Number(Ke)+ge*(Q===">"?-1:1)+re):ue):"")+")"})),B){let H=A?v.concat(x):[...v],Y=A?[...f]:wx(f,x.split(Sx));o!==void 0&&n(Mf(...o)),o=void 0,c(E,Y,H)}else o===void 0&&(o=[[],f,v]),x=A||x.charCodeAt(0)!==36?x:`--${jr(r.prefix)}${x.slice(1).replace(/\$/g,"-")}`,E=B?E:typeof E=="number"?E&&z in Ax?String(E)+"px":String(E):Rf(xx(z,E??""),r.prefix,r.themeMap[z]),o[0].push(`${A?`${x} `:`${Uh(x)}:`}${E}`)}}var O,I};_(p),o!==void 0&&n(Mf(...o)),o=void 0};c(e,t,i)},Mf=(e,t,i)=>`${i.map(r=>`${r}{`).join("")}${t.length?`${t.join(",")}{`:""}${e.join(";")}${t.length?"}":""}${Array(i.length?i.length+1:0).join("}")}`,Ax={animationDelay:1,animationDuration:1,backgroundSize:1,blockSize:1,border:1,borderBlock:1,borderBlockEnd:1,borderBlockEndWidth:1,borderBlockStart:1,borderBlockStartWidth:1,borderBlockWidth:1,borderBottom:1,borderBottomLeftRadius:1,borderBottomRightRadius:1,borderBottomWidth:1,borderEndEndRadius:1,borderEndStartRadius:1,borderInlineEnd:1,borderInlineEndWidth:1,borderInlineStart:1,borderInlineStartWidth:1,borderInlineWidth:1,borderLeft:1,borderLeftWidth:1,borderRadius:1,borderRight:1,borderRightWidth:1,borderSpacing:1,borderStartEndRadius:1,borderStartStartRadius:1,borderTop:1,borderTopLeftRadius:1,borderTopRightRadius:1,borderTopWidth:1,borderWidth:1,bottom:1,columnGap:1,columnRule:1,columnRuleWidth:1,columnWidth:1,containIntrinsicSize:1,flexBasis:1,fontSize:1,gap:1,gridAutoColumns:1,gridAutoRows:1,gridTemplateColumns:1,gridTemplateRows:1,height:1,inlineSize:1,inset:1,insetBlock:1,insetBlockEnd:1,insetBlockStart:1,insetInline:1,insetInlineEnd:1,insetInlineStart:1,left:1,letterSpacing:1,margin:1,marginBlock:1,marginBlockEnd:1,marginBlockStart:1,marginBottom:1,marginInline:1,marginInlineEnd:1,marginInlineStart:1,marginLeft:1,marginRight:1,marginTop:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,offsetDistance:1,offsetRotate:1,outline:1,outlineOffset:1,outlineWidth:1,overflowClipMargin:1,padding:1,paddingBlock:1,paddingBlockEnd:1,paddingBlockStart:1,paddingBottom:1,paddingInline:1,paddingInlineEnd:1,paddingInlineStart:1,paddingLeft:1,paddingRight:1,paddingTop:1,perspective:1,right:1,rowGap:1,scrollMargin:1,scrollMarginBlock:1,scrollMarginBlockEnd:1,scrollMarginBlockStart:1,scrollMarginBottom:1,scrollMarginInline:1,scrollMarginInlineEnd:1,scrollMarginInlineStart:1,scrollMarginLeft:1,scrollMarginRight:1,scrollMarginTop:1,scrollPadding:1,scrollPaddingBlock:1,scrollPaddingBlockEnd:1,scrollPaddingBlockStart:1,scrollPaddingBottom:1,scrollPaddingInline:1,scrollPaddingInlineEnd:1,scrollPaddingInlineStart:1,scrollPaddingLeft:1,scrollPaddingRight:1,scrollPaddingTop:1,shapeMargin:1,textDecoration:1,textDecorationThickness:1,textIndent:1,textUnderlineOffset:1,top:1,transitionDelay:1,transitionDuration:1,verticalAlign:1,width:1,wordSpacing:1},Lf=e=>String.fromCharCode(e+(e>25?39:97)),Fn=e=>(t=>{let i,r="";for(i=Math.abs(t);i>52;i=i/52|0)r=Lf(i%52)+r;return Lf(i%52)+r})(((t,i)=>{let r=i.length;for(;r;)t=33*t^i.charCodeAt(--r);return t})(5381,JSON.stringify(e))>>>0),ko=["themed","global","styled","onevar","resonevar","allvar","inline"],kx=e=>{if(e.href&&!e.href.startsWith(location.origin))return!1;try{return!!e.cssRules}catch{return!1}},Px=e=>{let t,i=()=>{let{cssRules:n}=t.sheet;return[].map.call(n,(o,l)=>{let{cssText:u}=o,c="";if(u.startsWith("--sxs"))return"";if(n[l-1]&&(c=n[l-1].cssText).startsWith("--sxs")){if(!o.cssRules.length)return"";for(let p in t.rules)if(t.rules[p].group===o)return`--sxs{--sxs:${[...t.rules[p].cache].join(" ")}}${u}`;return o.cssRules.length?`${c}${u}`:""}return u}).join("")},r=()=>{if(t){let{rules:u,sheet:c}=t;if(!c.deleteRule){for(;Object(Object(c.cssRules)[0]).type===3;)c.cssRules.splice(0,1);c.cssRules=[]}for(let p in u)delete u[p]}let n=Object(e).styleSheets||[];for(let u of n)if(kx(u)){for(let c=0,p=u.cssRules;p[c];++c){let f=Object(p[c]);if(f.type!==1)continue;let v=Object(p[c+1]);if(v.type!==4)continue;++c;let{cssText:x}=f;if(!x.startsWith("--sxs"))continue;let E=x.slice(14,-3).trim().split(/\s+/),_=ko[E[0]];_&&(t||(t={sheet:u,reset:r,rules:{},toString:i}),t.rules[_]={group:v,index:c,cache:new Set(E)})}if(t)break}if(!t){let u=(c,p)=>({type:p,cssRules:[],insertRule(f,v){this.cssRules.splice(v,0,u(f,{import:3,undefined:1}[(f.toLowerCase().match(/^@([a-z]+)/)||[])[1]]||4))},get cssText(){return c==="@media{}"?`@media{${[].map.call(this.cssRules,f=>f.cssText).join("")}}`:c}});t={sheet:e?(e.head||e).appendChild(document.createElement("style")).sheet:u("","text/css"),rules:{},reset:r,toString:i}}let{sheet:o,rules:l}=t;for(let u=ko.length-1;u>=0;--u){let c=ko[u];if(!l[c]){let p=ko[u+1],f=l[p]?l[p].index:o.cssRules.length;o.insertRule("@media{}",f),o.insertRule(`--sxs{--sxs:${u}}`,f),l[c]={group:o.cssRules[f+1],index:f,cache:new Set([u])}}Cx(l[c])}};return r(),t},Cx=e=>{let t=e.group,i=t.cssRules.length;e.apply=r=>{try{t.insertRule(r,i),++i}catch{}}},Po=Symbol(),Tx=Rs(),$f=(e,t)=>Tx(e,()=>(...i)=>{let r={type:null,composers:new Set};for(let n of i)if(n!=null)if(n[zn]){r.type==null&&(r.type=n[zn].type);for(let o of n[zn].composers)r.composers.add(o)}else n.constructor!==Object||n.$$typeof?r.type==null&&(r.type=n):r.composers.add(Ix(n,e));return r.type==null&&(r.type="span"),r.composers.size||r.composers.add(["PJLV",{},[],[],{},[]]),Ox(e,r,t)}),Ix=(e,t)=>{var i=e,{variants:r,compoundVariants:n,defaultVariants:o}=i,l=le(i,["variants","compoundVariants","defaultVariants"]);let u=`${jr(t.prefix)}c-${Fn(l)}`,c=[],p=[],f=Object.create(null),v=[];for(let _ in o)f[_]=String(o[_]);if(typeof r=="object"&&r)for(let _ in r){x=f,E=_,vx.call(x,E)||(f[_]="undefined");let P=r[_];for(let O in P){let I={[_]:String(O)};String(O)==="undefined"&&v.push(_);let A=P[O],$=[I,A,!If(A)];c.push($)}}var x,E;if(typeof n=="object"&&n)for(let _ of n){let P=_,{css:O}=P,I=le(P,["css"]);O=typeof O=="object"&&O||{};for(let $ in I)I[$]=String(I[$]);let A=[I,O,!If(O)];p.push(A)}return[u,l,c,p,f,v]},Ox=(e,t,i)=>{let[r,n,o,l]=Rx(t.composers),u=typeof t.type=="function"||t.type.$$typeof?(v=>{function x(){for(let E=0;E<x[Po].length;E++){let[_,P]=x[Po][E];v.rules[_].apply(P)}return x[Po]=[],null}return x[Po]=[],x.rules={},ko.forEach(E=>x.rules[E]={apply:_=>x[Po].push([E,_])}),x})(i):null,c=(u||i).rules,p=`.${r}${n.length>1?`:where(.${n.slice(1).join(".")})`:""}`,f=v=>{v=typeof v=="object"&&v||Mx;let x=v,{css:E}=x,_=le(x,["css"]),P={};for(let A in o)if(delete _[A],A in v){let $=v[A];typeof $=="object"&&$?P[A]=C({"@initial":o[A]},$):($=String($),P[A]=$!=="undefined"||l.has(A)?$:o[A])}else P[A]=o[A];let O=new Set([...n]);for(let[A,$,z,B]of t.composers){i.rules.styled.cache.has(A)||(i.rules.styled.cache.add(A),Ls($,[`.${A}`],[],e,V=>{c.styled.apply(V)}));let H=Nf(z,P,e.media),Y=Nf(B,P,e.media,!0);for(let V of H)if(V!==void 0)for(let[he,Q,ue]of V){let pe=`${A}-${Fn(Q)}-${he}`;O.add(pe);let ge=(ue?i.rules.resonevar:i.rules.onevar).cache,oe=ue?c.resonevar:c.onevar;ge.has(pe)||(ge.add(pe),Ls(Q,[`.${pe}`],[],e,Se=>{oe.apply(Se)}))}for(let V of Y)if(V!==void 0)for(let[he,Q]of V){let ue=`${A}-${Fn(Q)}-${he}`;O.add(ue),i.rules.allvar.cache.has(ue)||(i.rules.allvar.cache.add(ue),Ls(Q,[`.${ue}`],[],e,pe=>{c.allvar.apply(pe)}))}}if(typeof E=="object"&&E){let A=`${r}-i${Fn(E)}-css`;O.add(A),i.rules.inline.cache.has(A)||(i.rules.inline.cache.add(A),Ls(E,[`.${A}`],[],e,$=>{c.inline.apply($)}))}for(let A of String(v.className||"").trim().split(/\s+/))A&&O.add(A);let I=_.className=[...O].join(" ");return{type:t.type,className:I,selector:p,props:_,toString:()=>I,deferredInjector:u}};return jh(f,{className:r,selector:p,[zn]:t,toString:()=>(i.rules.styled.cache.has(r)||f(),r)})},Rx=e=>{let t="",i=[],r={},n=[];for(let[o,,,,l,u]of e){t===""&&(t=o),i.push(o),n.push(...u);for(let c in l){let p=l[c];(r[c]===void 0||p!=="undefined"||u.includes(p))&&(r[c]=p)}}return[t,i,r,new Set(n)]},Nf=(e,t,i,r)=>{let n=[];e:for(let[o,l,u]of e){if(u)continue;let c,p=0,f=!1;for(c in o){let v=o[c],x=t[c];if(x!==v){if(typeof x!="object"||!x)continue e;{let E,_,P=0;for(let O in x){if(v===String(x[O])){if(O!=="@initial"){let I=O.slice(1);(_=_||[]).push(I in i?i[I]:O.replace(/^@media ?/,"")),f=!0}p+=P,E=!0}++P}if(_&&_.length&&(l={["@media "+_.join(", ")]:l}),!E)continue e}}}(n[p]=n[p]||[]).push([r?"cv":`${c}-${o[c]}`,l,f])}return n},Mx={},Lx=Rs(),$x=(e,t)=>Lx(e,()=>(...i)=>{let r=()=>{for(let n of i){n=typeof n=="object"&&n||{};let o=Fn(n);if(!t.rules.global.cache.has(o)){if(t.rules.global.cache.add(o),"@import"in n){let l=[].indexOf.call(t.sheet.cssRules,t.rules.themed.group)-1;for(let u of[].concat(n["@import"]))u=u.includes('"')||u.includes("'")?u:`"${u}"`,t.sheet.insertRule(`@import ${u};`,l++);delete n["@import"]}Ls(n,[],[],e,l=>{t.rules.global.apply(l)})}}return""};return jh(r,{toString:r})}),Nx=Rs(),zx=(e,t)=>Nx(e,()=>i=>{let r=`${jr(e.prefix)}k-${Fn(i)}`,n=()=>{if(!t.rules.global.cache.has(r)){t.rules.global.cache.add(r);let o=[];Ls(i,[],[],e,u=>o.push(u));let l=`@keyframes ${r}{${o.join("")}}`;t.rules.global.apply(l)}return r};return jh(n,{get name(){return n()},toString:n})}),Fx=class{constructor(e,t,i,r){this.token=e==null?"":String(e),this.value=t==null?"":String(t),this.scale=i==null?"":String(i),this.prefix=r==null?"":String(r)}get computedValue(){return"var("+this.variable+")"}get variable(){return"--"+jr(this.prefix)+jr(this.scale)+this.token}toString(){return this.computedValue}},Bx=Rs(),jx=(e,t)=>Bx(e,()=>(i,r)=>{r=typeof i=="object"&&i||Object(r);let n=`.${i=(i=typeof i=="string"?i:"")||`${jr(e.prefix)}t-${Fn(r)}`}`,o={},l=[];for(let c in r){o[c]={};for(let p in r[c]){let f=`--${jr(e.prefix)}${c}-${p}`,v=Rf(String(r[c][p]),e.prefix,c);o[c][p]=new Fx(p,v,c,e.prefix),l.push(`${f}:${v}`)}}let u=()=>{if(l.length&&!t.rules.themed.cache.has(i)){t.rules.themed.cache.add(i);let c=`${r===e.theme?":root,":""}.${i}{${l.join(";")}}`;t.rules.themed.apply(c)}return i};return D(C({},o),{get className(){return u()},selector:n,toString:u})}),Ux=Rs(),Dx=Rs(),Wx=e=>{let t=(i=>{let r=!1,n=Ux(i,o=>{r=!0;let l="prefix"in(o=typeof o=="object"&&o||{})?String(o.prefix):"",u=typeof o.media=="object"&&o.media||{},c=typeof o.root=="object"?o.root||null:globalThis.document||null,p=typeof o.theme=="object"&&o.theme||{},f={prefix:l,media:u,theme:p,themeMap:typeof o.themeMap=="object"&&o.themeMap||C({},mx),utils:typeof o.utils=="object"&&o.utils||{}},v=Px(c),x={css:$f(f,v),globalCss:$x(f,v),keyframes:zx(f,v),createTheme:jx(f,v),reset(){v.reset(),x.theme.toString()},theme:{},sheet:v,config:f,prefix:l,getCssText:v.toString,toString:v.toString};return String(x.theme=x.createTheme(p)),x});return r||n.reset(),n})(e);return t.styled=(({config:i,sheet:r})=>Dx(i,()=>{let n=$f(i,r);return(...o)=>{let l=n(...o),u=l[zn].type,c=te.forwardRef((p,f)=>{let v=p&&p.as||u,{props:x,deferredInjector:E}=l(p);return delete x.as,x.ref=f,E?te.createElement(te.Fragment,null,te.createElement(v,x),te.createElement(E,null)):te.createElement(v,x)});return c.className=l.className,c.displayName=`Styled.${u.displayName||u.name||u}`,c.selector=l.selector,c.toString=()=>l.selector,c[zn]=l[zn],c}}))(t),t};function Hx(e,t,i){return Math.max(t,Math.min(e,i))}var ki={toVector(e,t){return e===void 0&&(e=t),Array.isArray(e)?e:[e,e]},add(e,t){return[e[0]+t[0],e[1]+t[1]]},sub(e,t){return[e[0]-t[0],e[1]-t[1]]},addTo(e,t){e[0]+=t[0],e[1]+=t[1]},subTo(e,t){e[0]-=t[0],e[1]-=t[1]}};function zf(e,t,i){return t===0||Math.abs(t)===1/0?Math.pow(e,i*5):e*t*i/(t+i*e)}function Ff(e,t,i,r=.15){return r===0?Hx(e,t,i):e<t?-zf(t-e,i-t,r)+t:e>i?+zf(e-i,i-t,r)+i:e}function qx(e,[t,i],[r,n]){let[[o,l],[u,c]]=e;return[Ff(t,o,l,r),Ff(i,u,c,n)]}function Qx(e,t){if(typeof e!="object"||e===null)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vx(e){var t=Qx(e,"string");return typeof t=="symbol"?t:String(t)}function Ui(e,t,i){return t=Vx(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Bf(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),i.push.apply(i,r)}return i}function zt(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Bf(Object(i),!0).forEach(function(r){Ui(e,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Bf(Object(i)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(i,r))})}return e}var jf={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function Uf(e){return e?e[0].toUpperCase()+e.slice(1):""}var Gx=["enter","leave"];function Zx(e=!1,t){return e&&!Gx.includes(t)}function Xx(e,t="",i=!1){let r=jf[e],n=r&&r[t]||t;return"on"+Uf(e)+Uf(n)+(Zx(i,n)?"Capture":"")}var Yx=["gotpointercapture","lostpointercapture"];function Kx(e){let t=e.substring(2).toLowerCase(),i=!!~t.indexOf("passive");i&&(t=t.replace("passive",""));let r=Yx.includes(t)?"capturecapture":"capture",n=!!~t.indexOf(r);return n&&(t=t.replace("capture","")),{device:t,capture:n,passive:i}}function Jx(e,t=""){let i=jf[e],r=i&&i[t]||t;return e+r}function Ha(e){return"touches"in e}function Df(e){return Ha(e)?"touch":"pointerType"in e?e.pointerType:"mouse"}function e_(e){return Array.from(e.touches).filter(t=>{var i,r;return t.target===e.currentTarget||((i=e.currentTarget)===null||i===void 0||(r=i.contains)===null||r===void 0?void 0:r.call(i,t.target))})}function t_(e){return e.type==="touchend"||e.type==="touchcancel"?e.changedTouches:e.targetTouches}function Wf(e){return Ha(e)?t_(e)[0]:e}function i_(e){return e_(e).map(t=>t.identifier)}function Wh(e){let t=Wf(e);return Ha(e)?t.identifier:t.pointerId}function Hf(e){let t=Wf(e);return[t.clientX,t.clientY]}function r_(e){let t={};if("buttons"in e&&(t.buttons=e.buttons),"shiftKey"in e){let{shiftKey:i,altKey:r,metaKey:n,ctrlKey:o}=e;Object.assign(t,{shiftKey:i,altKey:r,metaKey:n,ctrlKey:o})}return t}function qa(e,...t){return typeof e=="function"?e(...t):e}function n_(){}function s_(...e){return e.length===0?n_:e.length===1?e[0]:function(){let t;for(let i of e)t=i.apply(this,arguments)||t;return t}}function qf(e,t){return Object.assign({},t,e||{})}var o_=32,a_=class{constructor(e,t,i){this.ctrl=e,this.args=t,this.key=i,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(e){this.ctrl.state[this.key]=e}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){let{state:e,shared:t,ingKey:i,args:r}=this;t[i]=e._active=e.active=e._blocked=e._force=!1,e._step=[!1,!1],e.intentional=!1,e._movement=[0,0],e._distance=[0,0],e._direction=[0,0],e._delta=[0,0],e._bounds=[[-1/0,1/0],[-1/0,1/0]],e.args=r,e.axis=void 0,e.memo=void 0,e.elapsedTime=0,e.direction=[0,0],e.distance=[0,0],e.overflow=[0,0],e._movementBound=[!1,!1],e.velocity=[0,0],e.movement=[0,0],e.delta=[0,0],e.timeStamp=0}start(e){let t=this.state,i=this.config;t._active||(this.reset(),this.computeInitial(),t._active=!0,t.target=e.target,t.currentTarget=e.currentTarget,t.lastOffset=i.from?qa(i.from,t):t.offset,t.offset=t.lastOffset),t.startTime=t.timeStamp=e.timeStamp}computeValues(e){let t=this.state;t._values=e,t.values=this.config.transform(e)}computeInitial(){let e=this.state;e._initial=e._values,e.initial=e.values}compute(e){let{state:t,config:i,shared:r}=this;t.args=this.args;let n=0;if(e&&(t.event=e,i.preventDefault&&e.cancelable&&t.event.preventDefault(),t.type=e.type,r.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,r.locked=!!document.pointerLockElement,Object.assign(r,r_(e)),r.down=r.pressed=r.buttons%2===1||r.touches>0,n=e.timeStamp-t.timeStamp,t.timeStamp=e.timeStamp,t.elapsedTime=t.timeStamp-t.startTime),t._active){let B=t._delta.map(Math.abs);ki.addTo(t._distance,B)}this.axisIntent&&this.axisIntent(e);let[o,l]=t._movement,[u,c]=i.threshold,{_step:p,values:f}=t;if(i.hasCustomTransform?(p[0]===!1&&(p[0]=Math.abs(o)>=u&&f[0]),p[1]===!1&&(p[1]=Math.abs(l)>=c&&f[1])):(p[0]===!1&&(p[0]=Math.abs(o)>=u&&Math.sign(o)*u),p[1]===!1&&(p[1]=Math.abs(l)>=c&&Math.sign(l)*c)),t.intentional=p[0]!==!1||p[1]!==!1,!t.intentional)return;let v=[0,0];if(i.hasCustomTransform){let[B,H]=f;v[0]=p[0]!==!1?B-p[0]:0,v[1]=p[1]!==!1?H-p[1]:0}else v[0]=p[0]!==!1?o-p[0]:0,v[1]=p[1]!==!1?l-p[1]:0;this.restrictToAxis&&!t._blocked&&this.restrictToAxis(v);let x=t.offset,E=t._active&&!t._blocked||t.active;E&&(t.first=t._active&&!t.active,t.last=!t._active&&t.active,t.active=r[this.ingKey]=t._active,e&&(t.first&&("bounds"in i&&(t._bounds=qa(i.bounds,t)),this.setup&&this.setup()),t.movement=v,this.computeOffset()));let[_,P]=t.offset,[[O,I],[A,$]]=t._bounds;t.overflow=[_<O?-1:_>I?1:0,P<A?-1:P>$?1:0],t._movementBound[0]=t.overflow[0]?t._movementBound[0]===!1?t._movement[0]:t._movementBound[0]:!1,t._movementBound[1]=t.overflow[1]?t._movementBound[1]===!1?t._movement[1]:t._movementBound[1]:!1;let z=t._active?i.rubberband||[0,0]:[0,0];if(t.offset=qx(t._bounds,t.offset,z),t.delta=ki.sub(t.offset,x),this.computeMovement(),E&&(!t.last||n>o_)){t.delta=ki.sub(t.offset,x);let B=t.delta.map(Math.abs);ki.addTo(t.distance,B),t.direction=t.delta.map(Math.sign),t._direction=t._delta.map(Math.sign),!t.first&&n>0&&(t.velocity=[B[0]/n,B[1]/n])}}emit(){let e=this.state,t=this.shared,i=this.config;if(e._active||this.clean(),(e._blocked||!e.intentional)&&!e._force&&!i.triggerAllEvents)return;let r=this.handler(zt(zt(zt({},t),e),{},{[this.aliasKey]:e.values}));r!==void 0&&(e.memo=r)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}};function l_([e,t],i){let r=Math.abs(e),n=Math.abs(t);if(r>n&&r>i)return"x";if(n>r&&n>i)return"y"}var u_=class extends a_{constructor(...e){super(...e),Ui(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=ki.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=ki.sub(this.state.offset,this.state.lastOffset)}axisIntent(e){let t=this.state,i=this.config;if(!t.axis&&e){let r=typeof i.axisThreshold=="object"?i.axisThreshold[Df(e)]:i.axisThreshold;t.axis=l_(t._movement,r)}t._blocked=(i.lockDirection||!!i.axis)&&!t.axis||!!i.axis&&i.axis!==t.axis}restrictToAxis(e){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":e[1]=0;break;case"y":e[0]=0;break}}},h_=e=>e,Qf=.15,Vf={enabled(e=!0){return e},eventOptions(e,t,i){return zt(zt({},i.shared.eventOptions),e)},preventDefault(e=!1){return e},triggerAllEvents(e=!1){return e},rubberband(e=0){switch(e){case!0:return[Qf,Qf];case!1:return[0,0];default:return ki.toVector(e)}},from(e){if(typeof e=="function")return e;if(e!=null)return ki.toVector(e)},transform(e,t,i){let r=e||i.shared.transform;return this.hasCustomTransform=!!r,r||h_},threshold(e){return ki.toVector(e,0)}},c_=0,Co=zt(zt({},Vf),{},{axis(e,t,{axis:i}){if(this.lockDirection=i==="lock",!this.lockDirection)return i},axisThreshold(e=c_){return e},bounds(e={}){if(typeof e=="function")return o=>Co.bounds(e(o));if("current"in e)return()=>e.current;if(typeof HTMLElement=="function"&&e instanceof HTMLElement)return e;let{left:t=-1/0,right:i=1/0,top:r=-1/0,bottom:n=1/0}=e;return[[t,i],[r,n]]}}),Gf={ArrowRight:(e,t=1)=>[e*t,0],ArrowLeft:(e,t=1)=>[-1*e*t,0],ArrowUp:(e,t=1)=>[0,-1*e*t],ArrowDown:(e,t=1)=>[0,e*t]},d_=class extends u_{constructor(...e){super(...e),Ui(this,"ingKey","dragging")}reset(){super.reset();let e=this.state;e._pointerId=void 0,e._pointerActive=!1,e._keyboardActive=!1,e._preventScroll=!1,e._delayed=!1,e.swipe=[0,0],e.tap=!1,e.canceled=!1,e.cancel=this.cancel.bind(this)}setup(){let e=this.state;if(e._bounds instanceof HTMLElement){let t=e._bounds.getBoundingClientRect(),i=e.currentTarget.getBoundingClientRect(),r={left:t.left-i.left+e.offset[0],right:t.right-i.right+e.offset[0],top:t.top-i.top+e.offset[1],bottom:t.bottom-i.bottom+e.offset[1]};e._bounds=Co.bounds(r)}}cancel(){let e=this.state;e.canceled||(e.canceled=!0,e._active=!1,setTimeout(()=>{this.compute(),this.emit()},0))}setActive(){this.state._active=this.state._pointerActive||this.state._keyboardActive}clean(){this.pointerClean(),this.state._pointerActive=!1,this.state._keyboardActive=!1,super.clean()}pointerDown(e){let t=this.config,i=this.state;if(e.buttons!=null&&(Array.isArray(t.pointerButtons)?!t.pointerButtons.includes(e.buttons):t.pointerButtons!==-1&&t.pointerButtons!==e.buttons))return;let r=this.ctrl.setEventIds(e);t.pointerCapture&&e.target.setPointerCapture(e.pointerId),!(r&&r.size>1&&i._pointerActive)&&(this.start(e),this.setupPointer(e),i._pointerId=Wh(e),i._pointerActive=!0,this.computeValues(Hf(e)),this.computeInitial(),t.preventScrollAxis&&Df(e)!=="mouse"?(i._active=!1,this.setupScrollPrevention(e)):t.delay>0?(this.setupDelayTrigger(e),t.triggerAllEvents&&(this.compute(e),this.emit())):this.startPointerDrag(e))}startPointerDrag(e){let t=this.state;t._active=!0,t._preventScroll=!0,t._delayed=!1,this.compute(e),this.emit()}pointerMove(e){let t=this.state,i=this.config;if(!t._pointerActive||t.type===e.type&&e.timeStamp===t.timeStamp)return;let r=Wh(e);if(t._pointerId!==void 0&&r!==t._pointerId)return;let n=Hf(e);if(document.pointerLockElement===e.target?t._delta=[e.movementX,e.movementY]:(t._delta=ki.sub(n,t._values),this.computeValues(n)),ki.addTo(t._movement,t._delta),this.compute(e),t._delayed&&t.intentional){this.timeoutStore.remove("dragDelay"),t.active=!1,this.startPointerDrag(e);return}if(i.preventScrollAxis&&!t._preventScroll)if(t.axis)if(t.axis===i.preventScrollAxis||i.preventScrollAxis==="xy"){t._active=!1,this.clean();return}else{this.timeoutStore.remove("startPointerDrag"),this.startPointerDrag(e);return}else return;this.emit()}pointerUp(e){this.ctrl.setEventIds(e);try{this.config.pointerCapture&&e.target.hasPointerCapture(e.pointerId)&&e.target.releasePointerCapture(e.pointerId)}catch{}let t=this.state,i=this.config;if(!t._active||!t._pointerActive)return;let r=Wh(e);if(t._pointerId!==void 0&&r!==t._pointerId)return;this.state._pointerActive=!1,this.setActive(),this.compute(e);let[n,o]=t._distance;if(t.tap=n<=i.tapsThreshold&&o<=i.tapsThreshold,t.tap&&i.filterTaps)t._force=!0;else{let[l,u]=t.direction,[c,p]=t.velocity,[f,v]=t.movement,[x,E]=i.swipe.velocity,[_,P]=i.swipe.distance,O=i.swipe.duration;t.elapsedTime<O&&(Math.abs(c)>x&&Math.abs(f)>_&&(t.swipe[0]=l),Math.abs(p)>E&&Math.abs(v)>P&&(t.swipe[1]=u))}this.emit()}pointerClick(e){!this.state.tap&&e.detail>0&&(e.preventDefault(),e.stopPropagation())}setupPointer(e){let t=this.config,i=t.device;t.pointerLock&&e.currentTarget.requestPointerLock(),t.pointerCapture||(this.eventStore.add(this.sharedConfig.window,i,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,i,"end",this.pointerUp.bind(this)),this.eventStore.add(this.sharedConfig.window,i,"cancel",this.pointerUp.bind(this)))}pointerClean(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}preventScroll(e){this.state._preventScroll&&e.cancelable&&e.preventDefault()}setupScrollPrevention(e){this.state._preventScroll=!1,p_(e);let t=this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1});this.eventStore.add(this.sharedConfig.window,"touch","end",t),this.eventStore.add(this.sharedConfig.window,"touch","cancel",t),this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScrollDelay,e)}setupDelayTrigger(e){this.state._delayed=!0,this.timeoutStore.add("dragDelay",()=>{this.state._step=[0,0],this.startPointerDrag(e)},this.config.delay)}keyDown(e){let t=Gf[e.key];if(t){let i=this.state,r=e.shiftKey?10:e.altKey?.1:1;this.start(e),i._delta=t(this.config.keyboardDisplacement,r),i._keyboardActive=!0,ki.addTo(i._movement,i._delta),this.compute(e),this.emit()}}keyUp(e){e.key in Gf&&(this.state._keyboardActive=!1,this.setActive(),this.compute(e),this.emit())}bind(e){let t=this.config.device;e(t,"start",this.pointerDown.bind(this)),this.config.pointerCapture&&(e(t,"change",this.pointerMove.bind(this)),e(t,"end",this.pointerUp.bind(this)),e(t,"cancel",this.pointerUp.bind(this)),e("lostPointerCapture","",this.pointerUp.bind(this))),this.config.keys&&(e("key","down",this.keyDown.bind(this)),e("key","up",this.keyUp.bind(this))),this.config.filterTaps&&e("click","",this.pointerClick.bind(this),{capture:!0,passive:!1})}};function p_(e){"persist"in e&&typeof e.persist=="function"&&e.persist()}var To=typeof window<"u"&&window.document&&window.document.createElement;function f_(){return To&&"ontouchstart"in window}function Zf(){return f_()||To&&window.navigator.maxTouchPoints>1}function g_(){return To&&"onpointerdown"in window}function m_(){return To&&"exitPointerLock"in window.document}function y_(){try{return"constructor"in GestureEvent}catch{return!1}}var tr={isBrowser:To,gesture:y_(),touch:Zf(),touchscreen:Zf(),pointer:g_(),pointerLock:m_()},v_=250,b_=180,w_=.5,x_=50,__=250,S_=10,Xf={mouse:0,touch:0,pen:8},E_=zt(zt({},Co),{},{device(e,t,{pointer:{touch:i=!1,lock:r=!1,mouse:n=!1}={}}){return this.pointerLock=r&&tr.pointerLock,tr.touch&&i?"touch":this.pointerLock?"mouse":tr.pointer&&!n?"pointer":tr.touch?"touch":"mouse"},preventScrollAxis(e,t,{preventScroll:i}){if(this.preventScrollDelay=typeof i=="number"?i:i||i===void 0&&e?v_:void 0,!(!tr.touchscreen||i===!1))return e||(i!==void 0?"y":void 0)},pointerCapture(e,t,{pointer:{capture:i=!0,buttons:r=1,keys:n=!0}={}}){return this.pointerButtons=r,this.keys=n,!this.pointerLock&&this.device==="pointer"&&i},threshold(e,t,{filterTaps:i=!1,tapsThreshold:r=3,axis:n=void 0}){let o=ki.toVector(e,i?r:n?1:0);return this.filterTaps=i,this.tapsThreshold=r,o},swipe({velocity:e=w_,distance:t=x_,duration:i=__}={}){return{velocity:this.transform(ki.toVector(e)),distance:this.transform(ki.toVector(t)),duration:i}},delay(e=0){switch(e){case!0:return b_;case!1:return 0;default:return e}},axisThreshold(e){return e?zt(zt({},Xf),e):Xf},keyboardDisplacement(e=S_){return e}});zt(zt({},Vf),{},{device(e,t,{shared:i,pointer:{touch:r=!1}={}}){if(i.target&&!tr.touch&&tr.gesture)return"gesture";if(tr.touch&&r)return"touch";if(tr.touchscreen){if(tr.pointer)return"pointer";if(tr.touch)return"touch"}},bounds(e,t,{scaleBounds:i={},angleBounds:r={}}){let n=l=>{let u=qf(qa(i,l),{min:-1/0,max:1/0});return[u.min,u.max]},o=l=>{let u=qf(qa(r,l),{min:-1/0,max:1/0});return[u.min,u.max]};return typeof i!="function"&&typeof r!="function"?[n(),o()]:l=>[n(l),o(l)]},threshold(e,t,i){return this.lockDirection=i.axis==="lock",ki.toVector(e,this.lockDirection?[.1,3]:0)},modifierKey(e){return e===void 0?"ctrlKey":e},pinchOnWheel(e=!0){return e}}),zt(zt({},Co),{},{mouseOnly:(e=!0)=>e}),zt(zt({},Co),{},{mouseOnly:(e=!0)=>e});var Yf=new Map,Hh=new Map;function A_(e){Yf.set(e.key,e.engine),Hh.set(e.key,e.resolver)}var k_={key:"drag",engine:d_,resolver:E_};function P_(e,t){if(e==null)return{};var i={},r=Object.keys(e),n,o;for(o=0;o<r.length;o++)n=r[o],!(t.indexOf(n)>=0)&&(i[n]=e[n]);return i}function C_(e,t){if(e==null)return{};var i=P_(e,t),r,n;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],!(t.indexOf(r)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,r)||(i[r]=e[r]))}return i}var T_={target(e){if(e)return()=>"current"in e?e.current:e},enabled(e=!0){return e},window(e=tr.isBrowser?window:void 0){return e},eventOptions({passive:e=!0,capture:t=!1}={}){return{passive:e,capture:t}},transform(e){return e}},I_=["target","eventOptions","window","enabled","transform"];function Qa(e={},t){let i={};for(let[r,n]of Object.entries(t))switch(typeof n){case"function":i[r]=n.call(i,e[r],r,e);break;case"object":i[r]=Qa(e[r],n);break;case"boolean":n&&(i[r]=e[r]);break}return i}function O_(e,t,i={}){let r=e,{target:n,eventOptions:o,window:l,enabled:u,transform:c}=r,p=C_(r,I_);if(i.shared=Qa({target:n,eventOptions:o,window:l,enabled:u,transform:c},T_),t){let f=Hh.get(t);i[t]=Qa(zt({shared:i.shared},p),f)}else for(let f in p){let v=Hh.get(f);v&&(i[f]=Qa(zt({shared:i.shared},p[f]),v))}return i}var Kf=class{constructor(e,t){Ui(this,"_listeners",new Set),this._ctrl=e,this._gestureKey=t}add(e,t,i,r,n){let o=this._listeners,l=Jx(t,i),u=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},c=zt(zt({},u),n);e.addEventListener(l,r,c);let p=()=>{e.removeEventListener(l,r,c),o.delete(p)};return o.add(p),p}clean(){this._listeners.forEach(e=>e()),this._listeners.clear()}},R_=class{constructor(){Ui(this,"_timeouts",new Map)}add(e,t,i=140,...r){this.remove(e),this._timeouts.set(e,window.setTimeout(t,i,...r))}remove(e){let t=this._timeouts.get(e);t&&window.clearTimeout(t)}clean(){this._timeouts.forEach(e=>void window.clearTimeout(e)),this._timeouts.clear()}},M_=class{constructor(e){Ui(this,"gestures",new Set),Ui(this,"_targetEventStore",new Kf(this)),Ui(this,"gestureEventStores",{}),Ui(this,"gestureTimeoutStores",{}),Ui(this,"handlers",{}),Ui(this,"config",{}),Ui(this,"pointerIds",new Set),Ui(this,"touchIds",new Set),Ui(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),L_(this,e)}setEventIds(e){if(Ha(e))return this.touchIds=new Set(i_(e)),this.touchIds;if("pointerId"in e)return e.type==="pointerup"||e.type==="pointercancel"?this.pointerIds.delete(e.pointerId):e.type==="pointerdown"&&this.pointerIds.add(e.pointerId),this.pointerIds}applyHandlers(e,t){this.handlers=e,this.nativeHandlers=t}applyConfig(e,t){this.config=O_(e,t,this.config)}clean(){this._targetEventStore.clean();for(let e of this.gestures)this.gestureEventStores[e].clean(),this.gestureTimeoutStores[e].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...e){let t=this.config.shared,i={},r;if(!(t.target&&(r=t.target(),!r))){if(t.enabled){for(let o of this.gestures){let l=this.config[o],u=Jf(i,l.eventOptions,!!r);if(l.enabled){let c=Yf.get(o);new c(this,e,o).bind(u)}}let n=Jf(i,t.eventOptions,!!r);for(let o in this.nativeHandlers)n(o,"",l=>this.nativeHandlers[o](zt(zt({},this.state.shared),{},{event:l,args:e})),void 0,!0)}for(let n in i)i[n]=s_(...i[n]);if(!r)return i;for(let n in i){let{device:o,capture:l,passive:u}=Kx(n);this._targetEventStore.add(r,o,"",i[n],{capture:l,passive:u})}}}};function $s(e,t){e.gestures.add(t),e.gestureEventStores[t]=new Kf(e,t),e.gestureTimeoutStores[t]=new R_}function L_(e,t){t.drag&&$s(e,"drag"),t.wheel&&$s(e,"wheel"),t.scroll&&$s(e,"scroll"),t.move&&$s(e,"move"),t.pinch&&$s(e,"pinch"),t.hover&&$s(e,"hover")}var Jf=(e,t,i)=>(r,n,o,l={},u=!1)=>{var c,p;let f=(c=l.capture)!==null&&c!==void 0?c:t.capture,v=(p=l.passive)!==null&&p!==void 0?p:t.passive,x=u?r:Xx(r,n,f);i&&v&&(x+="Passive"),e[x]=e[x]||[],e[x].push(o)};function $_(e,t={},i,r){let n=te.useMemo(()=>new M_(e),[]);if(n.applyHandlers(e,r),n.applyConfig(t,i),te.useEffect(n.effect.bind(n)),te.useEffect(()=>n.clean.bind(n),[]),t.target===void 0)return n.bind.bind(n)}function N_(e,t){return A_(k_),$_({drag:e},t||{},"drag")}var z_=Mn["useId".toString()]||(()=>{}),F_=0;function B_(e){let[t,i]=Be(z_());return ja(()=>{e||i(r=>r??String(F_++))},[e]),e||(t?`radix-${t}`:"")}var Ns=["a","button","div","h2","h3","img","li","nav","p","span","svg","ul"].reduce((e,t)=>D(C({},e),{[t]:mi((i,r)=>{let n=i,{asChild:o}=n,l=le(n,["asChild"]),u=o?xf:t;return de(()=>{window[Symbol.for("radix-ui")]=!0},[]),i.as&&console.error(j_),N(u,Ai({},l,{ref:r}))})}),{}),j_="Warning: The `as` prop has been removed in favour of `asChild`. For details, see https://radix-ui.com/docs/primitives/overview/styling#changing-the-rendered-element",U_=mi((e,t)=>N(Ns.span,Ai({},e,{ref:t,style:D(C({},e.style),{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"})}))),D_=U_,W_=mi((e,t)=>{var i,r;let n=e,{containerRef:o,style:l}=n,u=le(n,["containerRef","style"]),c=(i=o==null?void 0:o.current)!==null&&i!==void 0?i:globalThis==null||(r=globalThis.document)===null||r===void 0?void 0:r.body,[,p]=Be({});return ja(()=>{p({})},[]),c?te.createPortal(N(Ns.div,Ai({"data-radix-portal":""},u,{ref:t,style:c===document.body?C({position:"absolute",top:0,left:0,zIndex:2147483647},l):void 0})),c):null}),H_=mi((e,t)=>{let i=e,{children:r,width:n=10,height:o=5}=i,l=le(i,["children","width","height"]);return N(Ns.svg,Ai({},l,{ref:t,width:n,height:o,viewBox:"0 0 30 10",preserveAspectRatio:"none"}),e.asChild?r:N("polygon",{points:"0,0 30,0 15,10"}))}),q_=H_;function eg(e){let[t,i]=Be(void 0);return de(()=>{if(e){let r=new ResizeObserver(n=>{if(!Array.isArray(n)||!n.length)return;let o=n[0],l,u;if("borderBoxSize"in o){let c=o.borderBoxSize,p=Array.isArray(c)?c[0]:c;l=p.inlineSize,u=p.blockSize}else{let c=e.getBoundingClientRect();l=c.width,u=c.height}i({width:l,height:u})});return r.observe(e,{box:"border-box"}),()=>{i(void 0),r.unobserve(e)}}},[e]),t}function Q_(e,t){let i=Bn.get(e);return i===void 0?(Bn.set(e,{rect:{},callbacks:[t]}),Bn.size===1&&(qh=requestAnimationFrame(tg))):(i.callbacks.push(t),t(e.getBoundingClientRect())),()=>{let r=Bn.get(e);if(r===void 0)return;let n=r.callbacks.indexOf(t);n>-1&&r.callbacks.splice(n,1),r.callbacks.length===0&&(Bn.delete(e),Bn.size===0&&cancelAnimationFrame(qh))}}var qh,Bn=new Map;function tg(){let e=[];Bn.forEach((t,i)=>{let r=i.getBoundingClientRect();var n,o;n=t.rect,o=r,(n.width!==o.width||n.height!==o.height||n.top!==o.top||n.right!==o.right||n.bottom!==o.bottom||n.left!==o.left)&&(t.rect=r,e.push(t))}),e.forEach(t=>{t.callbacks.forEach(i=>i(t.rect))}),qh=requestAnimationFrame(tg)}function ig(e){let[t,i]=Be();return de(()=>{if(e){let r=Q_(e,i);return()=>{i(void 0),r()}}},[e]),t}function rg(e,t=[]){let i=[],r=()=>{let n=i.map(o=>si(o));return function(o){let l=(o==null?void 0:o[e])||n;return Ae(()=>({[`__scope${e}`]:D(C({},o),{[e]:l})}),[o,l])}};return r.scopeName=e,[function(n,o){let l=si(o),u=i.length;function c(p){let f=p,{scope:v,children:x}=f,E=le(f,["scope","children"]),_=(v==null?void 0:v[e][u])||l,P=Ae(()=>E,Object.values(E));return N(_.Provider,{value:P},x)}return i=[...i,o],c.displayName=n+"Provider",[c,function(p,f){let v=(f==null?void 0:f[e][u])||l,x=Kt(v);if(x)return x;if(o!==void 0)return o;throw new Error(`\`${p}\` must be used within \`${n}\``)}]},V_(r,...t)]}function V_(...e){let t=e[0];if(e.length===1)return t;let i=()=>{let r=e.map(n=>({useScope:n(),scopeName:n.scopeName}));return function(n){let o=r.reduce((l,{useScope:u,scopeName:c})=>C(C({},l),u(n)[`__scope${c}`]),{});return Ae(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return i.scopeName=t.scopeName,i}function G_({anchorRect:e,popperSize:t,arrowSize:i,arrowOffset:r=0,side:n,sideOffset:o=0,align:l,alignOffset:u=0,shouldAvoidCollisions:c=!0,collisionBoundariesRect:p,collisionTolerance:f=0}){if(!e||!t||!p)return{popperStyles:Z_,arrowStyles:Qh};let v=function(Y,V,he=0,Q=0,ue){let pe=ue?ue.height:0,ge=ng(V,Y,"x"),oe=ng(V,Y,"y"),Se=oe.before-he-pe,Pe=oe.after+he+pe,Ke=ge.before-he-pe,re=ge.after+he+pe;return{top:{start:{x:ge.start+Q,y:Se},center:{x:ge.center,y:Se},end:{x:ge.end-Q,y:Se}},right:{start:{x:re,y:oe.start+Q},center:{x:re,y:oe.center},end:{x:re,y:oe.end-Q}},bottom:{start:{x:ge.start+Q,y:Pe},center:{x:ge.center,y:Pe},end:{x:ge.end-Q,y:Pe}},left:{start:{x:Ke,y:oe.start+Q},center:{x:Ke,y:oe.center},end:{x:Ke,y:oe.end-Q}}}}(t,e,o,u,i),x=v[n][l];if(c===!1){let Y=sg(x),V=Qh;return i&&(V=ag({popperSize:t,arrowSize:i,arrowOffset:r,side:n,align:l})),{popperStyles:D(C({},Y),{"--radix-popper-transform-origin":og(t,n,l,r,i)}),arrowStyles:V,placedSide:n,placedAlign:l}}let E=DOMRect.fromRect(C(C({},t),x)),_=(P=p,O=f,DOMRect.fromRect({width:P.width-2*O,height:P.height-2*O,x:P.left+O,y:P.top+O}));var P,O;let I=ug(E,_),A=v[lg(n)][l],$=function(Y,V,he){let Q=lg(Y);return V[Y]&&!he[Q]?Q:Y}(n,I,ug(DOMRect.fromRect(C(C({},t),A)),_)),z=function(Y,V,he,Q,ue){let pe=he==="top"||he==="bottom",ge=pe?"left":"top",oe=pe?"right":"bottom",Se=pe?"width":"height",Pe=V[Se]>Y[Se];return(Q==="start"||Q==="center")&&(ue[ge]&&Pe||ue[oe]&&!Pe)?"end":(Q==="end"||Q==="center")&&(ue[oe]&&Pe||ue[ge]&&!Pe)?"start":Q}(t,e,n,l,I),B=sg(v[$][z]),H=Qh;return i&&(H=ag({popperSize:t,arrowSize:i,arrowOffset:r,side:$,align:z})),{popperStyles:D(C({},B),{"--radix-popper-transform-origin":og(t,$,z,r,i)}),arrowStyles:H,placedSide:$,placedAlign:z}}function ng(e,t,i){let r=e[i==="x"?"left":"top"],n=i==="x"?"width":"height",o=e[n],l=t[n];return{before:r-l,start:r,center:r+(o-l)/2,end:r+o-l,after:r+o}}function sg(e){return{position:"absolute",top:0,left:0,minWidth:"max-content",willChange:"transform",transform:`translate3d(${Math.round(e.x+window.scrollX)}px, ${Math.round(e.y+window.scrollY)}px, 0)`}}function og(e,t,i,r,n){let o=t==="top"||t==="bottom",l=n?n.width:0,u=n?n.height:0,c=l/2+r,p="",f="";return o?(p={start:`${c}px`,center:"center",end:e.width-c+"px"}[i],f=t==="top"?`${e.height+u}px`:-u+"px"):(p=t==="left"?`${e.width+u}px`:-u+"px",f={start:`${c}px`,center:"center",end:e.height-c+"px"}[i]),`${p} ${f}`}var Z_={position:"fixed",top:0,left:0,opacity:0,transform:"translate3d(0, -200%, 0)"},Qh={position:"absolute",opacity:0};function ag({popperSize:e,arrowSize:t,arrowOffset:i,side:r,align:n}){let o=(e.width-t.width)/2,l=(e.height-t.width)/2,u={top:0,right:90,bottom:180,left:-90}[r],c=Math.max(t.width,t.height),p={width:`${c}px`,height:`${c}px`,transform:`rotate(${u}deg)`,willChange:"transform",position:"absolute",[r]:"100%",direction:X_(r,n)};return r!=="top"&&r!=="bottom"||(n==="start"&&(p.left=`${i}px`),n==="center"&&(p.left=`${o}px`),n==="end"&&(p.right=`${i}px`)),r!=="left"&&r!=="right"||(n==="start"&&(p.top=`${i}px`),n==="center"&&(p.top=`${l}px`),n==="end"&&(p.bottom=`${i}px`)),p}function X_(e,t){return(e!=="top"&&e!=="right"||t!=="end")&&(e!=="bottom"&&e!=="left"||t==="end")?"ltr":"rtl"}function lg(e){return{top:"bottom",right:"left",bottom:"top",left:"right"}[e]}function ug(e,t){return{top:e.top<t.top,right:e.right>t.right,bottom:e.bottom>t.bottom,left:e.left<t.left}}var[hg,cg]=rg("Popper"),[Y_,dg]=hg("Popper"),K_=e=>{let{__scopePopper:t,children:i}=e,[r,n]=Be(null);return N(Y_,{scope:t,anchor:r,onAnchorChange:n},i)},J_=mi((e,t)=>{let i=e,{__scopePopper:r,virtualRef:n}=i,o=le(i,["__scopePopper","virtualRef"]),l=dg("PopperAnchor",r),u=we(null),c=Ba(t,u);return de(()=>{l.onAnchorChange((n==null?void 0:n.current)||u.current)}),n?null:N(Ns.div,Ai({},o,{ref:c}))}),[eS,tS]=hg("PopperContent"),iS=mi((e,t)=>{let i=e,{__scopePopper:r,side:n="bottom",sideOffset:o,align:l="center",alignOffset:u,collisionTolerance:c,avoidCollisions:p=!0}=i,f=le(i,["__scopePopper","side","sideOffset","align","alignOffset","collisionTolerance","avoidCollisions"]),v=dg("PopperContent",r),[x,E]=Be(),_=ig(v.anchor),[P,O]=Be(null),I=eg(P),[A,$]=Be(null),z=eg(A),B=Ba(t,ge=>O(ge)),H=function(){let[ge,oe]=Be(void 0);return de(()=>{let Se;function Pe(){oe({width:window.innerWidth,height:window.innerHeight})}function Ke(){window.clearTimeout(Se),Se=window.setTimeout(Pe,100)}return Pe(),window.addEventListener("resize",Ke),()=>window.removeEventListener("resize",Ke)},[]),ge}(),Y=H?DOMRect.fromRect(D(C({},H),{x:0,y:0})):void 0,{popperStyles:V,arrowStyles:he,placedSide:Q,placedAlign:ue}=G_({anchorRect:_,popperSize:I,arrowSize:z,arrowOffset:x,side:n,sideOffset:o,align:l,alignOffset:u,shouldAvoidCollisions:p,collisionBoundariesRect:Y,collisionTolerance:c}),pe=Q!==void 0;return N("div",{style:V,"data-radix-popper-content-wrapper":""},N(eS,{scope:r,arrowStyles:he,onArrowChange:$,onArrowOffsetChange:E},N(Ns.div,Ai({"data-side":Q,"data-align":ue},f,{style:D(C({},f.style),{animation:pe?void 0:"none"}),ref:B}))))}),rS=mi(function(e,t){let i=e,{__scopePopper:r,offset:n}=i,o=le(i,["__scopePopper","offset"]),l=tS("PopperArrow",r),{onArrowOffsetChange:u}=l;return de(()=>u(n),[u,n]),N("span",{style:D(C({},l.arrowStyles),{pointerEvents:"none"})},N("span",{ref:l.onArrowChange,style:{display:"inline-block",verticalAlign:"top",pointerEvents:"auto"}},N(q_,Ai({},o,{ref:t,style:D(C({},o.style),{display:"block"})}))))}),nS=K_,sS=J_,oS=iS,aS=rS,pg=e=>{let{present:t,children:i}=e,r=function(l){let[u,c]=Be(),p=we({}),f=we(l),v=we("none"),x=l?"mounted":"unmounted",[E,_]=function(P,O){return ks((I,A)=>{let $=O[I][A];return $??I},P)}(x,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return de(()=>{let P=Va(p.current);v.current=E==="mounted"?P:"none"},[E]),ja(()=>{let P=p.current,O=f.current;if(O!==l){let I=v.current,A=Va(P);l?_("MOUNT"):A==="none"||(P==null?void 0:P.display)==="none"?_("UNMOUNT"):_(O&&I!==A?"ANIMATION_OUT":"UNMOUNT"),f.current=l}},[l,_]),ja(()=>{if(u){let P=I=>{let A=Va(p.current).includes(I.animationName);I.target===u&&A&&_("ANIMATION_END")},O=I=>{I.target===u&&(v.current=Va(p.current))};return u.addEventListener("animationstart",O),u.addEventListener("animationcancel",P),u.addEventListener("animationend",P),()=>{u.removeEventListener("animationstart",O),u.removeEventListener("animationcancel",P),u.removeEventListener("animationend",P)}}},[u,_]),{isPresent:["mounted","unmountSuspended"].includes(E),ref:He(P=>{P&&(p.current=getComputedStyle(P)),c(P)},[])}}(t),n=typeof i=="function"?i({present:r.isPresent}):nn.only(i),o=Ba(r.ref,n.ref);return typeof i=="function"||r.isPresent?$a(n,{ref:o}):null};function Va(e){return(e==null?void 0:e.animationName)||"none"}pg.displayName="Presence";function fg(e){let t=we(e);return de(()=>{t.current=e},[e]),t.current}function Vh(e){let t=we(e);return de(()=>{t.current=e}),Ae(()=>(...i)=>{var r;return(r=t.current)===null||r===void 0?void 0:r.call(t,...i)},[])}function lS(e){let t=Vh(e);de(()=>{let i=r=>{r.key==="Escape"&&t(r)};return document.addEventListener("keydown",i),()=>document.removeEventListener("keydown",i)},[t])}function uS({prop:e,defaultProp:t,onChange:i=()=>{}}){let[r,n]=function({defaultProp:c,onChange:p}){let f=Be(c),[v]=f,x=we(v),E=Vh(p);return de(()=>{x.current!==v&&(E(v),x.current=v)},[v,x,E]),f}({defaultProp:t,onChange:i}),o=e!==void 0,l=o?e:r,u=Vh(i);return[l,He(c=>{if(o){let p=c,f=typeof c=="function"?p(e):c;f!==e&&u(f)}else n(c)},[o,e,n,u])]}function zs(e,t,{checkForDefaultPrevented:i=!0}={}){return function(r){if(e==null||e(r),i===!1||!r.defaultPrevented)return t==null?void 0:t(r)}}var[gg,JM]=rg("Tooltip",[cg]),Ga=cg(),hS=700,[eL,cS]=gg("TooltipProvider",{isOpenDelayed:!0,delayDuration:hS,onOpen:()=>{},onClose:()=>{}}),[dS,Za]=gg("Tooltip"),pS=e=>{let{__scopeTooltip:t,children:i,open:r,defaultOpen:n=!1,onOpenChange:o,delayDuration:l}=e,u=cS("Tooltip",t),c=Ga(t),[p,f]=Be(null),v=B_(),x=we(0),E=l??u.delayDuration,_=we(!1),{onOpen:P,onClose:O}=u,[I=!1,A]=uS({prop:r,defaultProp:n,onChange:H=>{H&&(document.dispatchEvent(new CustomEvent("tooltip.open")),P()),o==null||o(H)}}),$=Ae(()=>I?_.current?"delayed-open":"instant-open":"closed",[I]),z=He(()=>{window.clearTimeout(x.current),_.current=!1,A(!0)},[A]),B=He(()=>{window.clearTimeout(x.current),x.current=window.setTimeout(()=>{_.current=!0,A(!0)},E)},[E,A]);return de(()=>()=>window.clearTimeout(x.current),[]),N(nS,c,N(dS,{scope:t,contentId:v,open:I,stateAttribute:$,trigger:p,onTriggerChange:f,onTriggerEnter:He(()=>{u.isOpenDelayed?B():z()},[u.isOpenDelayed,B,z]),onOpen:He(z,[z]),onClose:He(()=>{window.clearTimeout(x.current),A(!1),O()},[A,O])},i))},fS=mi((e,t)=>{let i=e,{__scopeTooltip:r}=i,n=le(i,["__scopeTooltip"]),o=Za("TooltipTrigger",r),l=Ga(r),u=Ba(t,o.onTriggerChange),c=we(!1),p=He(()=>c.current=!1,[]);return de(()=>()=>document.removeEventListener("mouseup",p),[p]),N(sS,Ai({asChild:!0},l),N(Ns.button,Ai({"aria-describedby":o.open?o.contentId:void 0,"data-state":o.stateAttribute},n,{ref:u,onMouseEnter:zs(e.onMouseEnter,o.onTriggerEnter),onMouseLeave:zs(e.onMouseLeave,o.onClose),onMouseDown:zs(e.onMouseDown,()=>{o.onClose(),c.current=!0,document.addEventListener("mouseup",p,{once:!0})}),onFocus:zs(e.onFocus,()=>{c.current||o.onOpen()}),onBlur:zs(e.onBlur,o.onClose),onClick:zs(e.onClick,o.onClose)})))}),gS=mi((e,t)=>{let i=e,{forceMount:r}=i,n=le(i,["forceMount"]),o=Za("TooltipContent",e.__scopeTooltip);return N(pg,{present:r||o.open},N(mS,Ai({ref:t},n)))}),mS=mi((e,t)=>{let i=e,{__scopeTooltip:r,children:n,"aria-label":o,portalled:l=!0}=i,u=le(i,["__scopeTooltip","children","aria-label","portalled"]),c=Za("TooltipContent",r),p=Ga(r),f=l?W_:it,{onClose:v}=c;return lS(()=>v()),de(()=>(document.addEventListener("tooltip.open",v),()=>document.removeEventListener("tooltip.open",v)),[v]),N(f,null,N(vS,{__scopeTooltip:r}),N(oS,Ai({"data-state":c.stateAttribute},p,u,{ref:t,style:D(C({},u.style),{"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)"})}),N(_f,null,n),N(D_,{id:c.contentId,role:"tooltip"},o||n)))}),yS=mi((e,t)=>{let i=e,{__scopeTooltip:r}=i,n=le(i,["__scopeTooltip"]),o=Ga(r);return N(aS,Ai({},o,n,{ref:t}))});function vS(e){let{__scopeTooltip:t}=e,i=Za("CheckTriggerMoved",t),r=ig(i.trigger),n=r==null?void 0:r.left,o=fg(n),l=r==null?void 0:r.top,u=fg(l),c=i.onClose;return de(()=>{(o!==void 0&&o!==n||u!==void 0&&u!==l)&&c()},[c,o,u,n,l]),null}var bS=pS,wS=fS,xS=gS,_S=yS;function SS(e,t){if(e==null)return{};var i={},r=Object.keys(e),n,o;for(o=0;o<r.length;o++)n=r[o],!(t.indexOf(n)>=0)&&(i[n]=e[n]);return i}function Ur(e,t){if(e==null)return{};var i=SS(e,t),r,n;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],!(t.indexOf(r)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,r)||(i[r]=e[r]))}return i}var zi;(function(e){e[e.UNSUPPORTED_INPUT=0]="UNSUPPORTED_INPUT",e[e.NO_COMPONENT_FOR_TYPE=1]="NO_COMPONENT_FOR_TYPE",e[e.UNKNOWN_INPUT=2]="UNKNOWN_INPUT",e[e.DUPLICATE_KEYS=3]="DUPLICATE_KEYS",e[e.ALREADY_REGISTERED_TYPE=4]="ALREADY_REGISTERED_TYPE",e[e.CLIPBOARD_ERROR=5]="CLIPBOARD_ERROR",e[e.THEME_ERROR=6]="THEME_ERROR",e[e.PATH_DOESNT_EXIST=7]="PATH_DOESNT_EXIST",e[e.INPUT_TYPE_OVERRIDE=8]="INPUT_TYPE_OVERRIDE",e[e.EMPTY_KEY=9]="EMPTY_KEY"})(zi||(zi={}));var ES={[zi.UNSUPPORTED_INPUT]:(e,t)=>[`An input with type \`${e}\` input was found at path \`${t}\` but it's not supported yet.`],[zi.NO_COMPONENT_FOR_TYPE]:(e,t)=>[`Type \`${e}\` found at path \`${t}\` can't be displayed in panel because no component supports it yet.`],[zi.UNKNOWN_INPUT]:(e,t)=>[`input at path \`${e}\` is not recognized.`,t],[zi.DUPLICATE_KEYS]:(e,t,i)=>[`Key \`${e}\` of path \`${t}\` already exists at path \`${i}\`. Even nested keys need to be unique. Rename one of the keys.`],[zi.ALREADY_REGISTERED_TYPE]:e=>[`Type ${e} has already been registered. You can't register a component with the same type.`],[zi.CLIPBOARD_ERROR]:e=>["Error copying the value",e],[zi.THEME_ERROR]:(e,t)=>[`Error accessing the theme \`${e}.${t}\` value.`],[zi.PATH_DOESNT_EXIST]:e=>[`Error getting the value at path \`${e}\`. There is probably an error in your \`render\` function.`],[zi.PATH_DOESNT_EXIST]:e=>[`Error accessing the value at path \`${e}\``],[zi.INPUT_TYPE_OVERRIDE]:(e,t,i)=>[`Input at path \`${e}\` already exists with type: \`${t}\`. Its type cannot be overridden with type \`${i}\`.`],[zi.EMPTY_KEY]:()=>["Keys can not be empty, if you want to hide a label use whitespace."]};function mg(e,t,...i){let[r,...n]=ES[t](...i);console[e]("LEVA: "+r,...n)}var yg=mg.bind(null,"warn");mg.bind(null,"log");function AS(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function vg(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),i.push.apply(i,r)}return i}function jn(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?vg(Object(i),!0).forEach(function(r){AS(e,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):vg(Object(i)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(i,r))})}return e}var an=(e,t,i)=>e>i?i:e<t?t:e,kS=e=>{if(e===""||typeof e=="number")return e;try{let t=ln(e);if(!isNaN(t))return t}catch{}return parseFloat(e)},PS=Math.log(10);function bg(e){let t=Math.abs(+String(e).replace(".",""));if(t===0)return .01;for(;t!==0&&t%10===0;)t/=10;let i=Math.floor(Math.log(t)/PS)+1,r=Math.floor(Math.log10(Math.abs(e))),n=Math.pow(10,r-i);return Math.max(n,.001)}var CS=(e,t,i)=>i===t?0:(an(e,t,i)-t)/(i-t),wg=(e,t,i)=>e*(i-t)+t,xg=/\(([0-9+\-*/^ .]+)\)/,_g=/(\d+(?:\.\d+)?) ?\^ ?(\d+(?:\.\d+)?)/,Sg=/(\d+(?:\.\d+)?) ?\* ?(\d+(?:\.\d+)?)/,Eg=/(\d+(?:\.\d+)?) ?\/ ?(\d+(?:\.\d+)?)/,Ag=/(\d+(?:\.\d+)?) ?\+ ?(\d+(?:\.\d+)?)/,kg=/(\d+(?:\.\d+)?) ?- ?(\d+(?:\.\d+)?)/;function ln(e){if(isNaN(Number(e)))if(xg.test(e)){let t=e.replace(xg,(i,r)=>String(ln(r)));return ln(t)}else if(_g.test(e)){let t=e.replace(_g,(i,r,n)=>String(Math.pow(Number(r),Number(n))));return ln(t)}else if(Sg.test(e)){let t=e.replace(Sg,(i,r,n)=>String(Number(r)*Number(n)));return ln(t)}else if(Eg.test(e)){let t=e.replace(Eg,(i,r,n)=>{if(n!=0)return String(Number(r)/Number(n));throw new Error("Division by zero")});return ln(t)}else if(Ag.test(e)){let t=e.replace(Ag,(i,r,n)=>String(Number(r)+Number(n)));return ln(t)}else if(kg.test(e)){let t=e.replace(kg,(i,r,n)=>String(Number(r)-Number(n)));return ln(t)}else return Number(e);return Number(e)}var Pg;(function(e){e.BUTTON="BUTTON",e.BUTTON_GROUP="BUTTON_GROUP",e.MONITOR="MONITOR",e.FOLDER="FOLDER"})(Pg||(Pg={}));var Cg;(function(e){e.SELECT="SELECT",e.IMAGE="IMAGE",e.NUMBER="NUMBER",e.COLOR="COLOR",e.STRING="STRING",e.BOOLEAN="BOOLEAN",e.INTERVAL="INTERVAL",e.VECTOR3D="VECTOR3D",e.VECTOR2D="VECTOR2D"})(Cg||(Cg={}));var TS=e=>e.shiftKey?5:e.altKey?1/5:1,IS=["value"],OS=["min","max"],RS=e=>{if(typeof e=="number")return!0;if(typeof e=="string"){let t=parseFloat(e);return isNaN(t)?!1:e.substring((""+t).length).trim().length<4}return!1},MS=(e,{min:t=-1/0,max:i=1/0,suffix:r})=>{let n=parseFloat(e);if(e===""||isNaN(n))throw Error("Invalid number");let o=an(n,t,i);return r?o+r:o},LS=(e,{pad:t=0,suffix:i})=>{let r=parseFloat(e).toFixed(t);return i?r+i:r},$S=e=>{let{value:t}=e,i=Ur(e,IS),{min:r=-1/0,max:n=1/0}=i,o=Ur(i,OS),l=parseFloat(t),u=typeof t=="string"?t.substring((""+l).length):void 0;l=an(l,r,n);let c=i.step;c||(Number.isFinite(r)?Number.isFinite(n)?c=+(Math.abs(n-r)/100).toPrecision(1):c=+(Math.abs(l-r)/100).toPrecision(1):Number.isFinite(n)&&(c=+(Math.abs(n-l)/100).toPrecision(1)));let p=c?bg(c)*10:bg(l);c=c||p/10;let f=Math.round(an(Math.log10(1/p),0,2));return{value:u?l+u:l,settings:jn({initialValue:l,step:c,pad:f,min:r,max:n,suffix:u},o)}},Tg=(e,{step:t,initialValue:i})=>{let r=Math.round((e-i)/t);return i+r*t},NS=Object.freeze({__proto__:null,schema:RS,sanitize:MS,format:LS,normalize:$S,sanitizeStep:Tg});function Yi(){return Yi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},Yi.apply(this,arguments)}var zS=si({});function Dr(){return Kt(zS)}var FS=si(null);si(null);var BS=si(null);function jS(){return Kt(BS)}var US=()=>({colors:{elevation1:"#292d39",elevation2:"#181c20",elevation3:"#373c4b",accent1:"#0066dc",accent2:"#007bff",accent3:"#3c93ff",highlight1:"#535760",highlight2:"#8c92a4",highlight3:"#fefefe",vivid1:"#ffcc00",folderWidgetColor:"$highlight2",folderTextColor:"$highlight3",toolTipBackground:"$highlight3",toolTipText:"$elevation2"},radii:{xs:"2px",sm:"3px",lg:"10px"},space:{xs:"3px",sm:"6px",md:"10px",rowGap:"7px",colGap:"7px"},fonts:{mono:"ui-monospace, SFMono-Regular, Menlo, 'Roboto Mono', monospace",sans:"system-ui, sans-serif"},fontSizes:{root:"11px",toolTip:"$root"},sizes:{rootWidth:"280px",controlWidth:"160px",numberInputMinWidth:"38px",scrubberWidth:"8px",scrubberHeight:"16px",rowHeight:"24px",folderTitleHeight:"20px",checkboxSize:"16px",joystickWidth:"100px",joystickHeight:"100px",colorPickerWidth:"$controlWidth",colorPickerHeight:"100px",imagePreviewWidth:"$controlWidth",imagePreviewHeight:"100px",monitorHeight:"60px",titleBarHeight:"39px"},shadows:{level1:"0 0 9px 0 #00000088",level2:"0 4px 14px #00000033"},borderWidths:{root:"0px",input:"1px",focus:"1px",hover:"1px",active:"1px",folder:"1px"},fontWeights:{label:"normal",folder:"normal",button:"normal"}});function Xa(e,t){let[i,r]=e.split(" "),n={};return i!=="none"&&(n.boxShadow=`${t.inset?"inset ":""}0 0 0 $borderWidths${[t.key]} $colors${i!=="default"&&i||t.borderColor}`),r&&(n.backgroundColor=r),n}var Io={$inputStyle:()=>e=>Xa(e,{key:"$input",borderColor:"$highlight1",inset:!0}),$focusStyle:()=>e=>Xa(e,{key:"$focus",borderColor:"$accent2"}),$hoverStyle:()=>e=>Xa(e,{key:"$hover",borderColor:"$accent1",inset:!0}),$activeStyle:()=>e=>Xa(e,{key:"$active",borderColor:"$accent1",inset:!0})},{styled:vt,css:tL,createTheme:iL,globalCss:DS,keyframes:rL}=Wx({prefix:"leva",theme:US(),utils:jn(jn({},Io),{},{$flex:()=>({display:"flex",alignItems:"center"}),$flexCenter:()=>({display:"flex",alignItems:"center",justifyContent:"center"}),$reset:()=>({outline:"none",fontSize:"inherit",fontWeight:"inherit",color:"inherit",fontFamily:"inherit",border:"none",backgroundColor:"transparent",appearance:"none"}),$draggable:()=>({touchAction:"none",WebkitUserDrag:"none",userSelect:"none"}),$focus:e=>({"&:focus":Io.$focusStyle()(e)}),$focusWithin:e=>({"&:focus-within":Io.$focusStyle()(e)}),$hover:e=>({"&:hover":Io.$hoverStyle()(e)}),$active:e=>({"&:active":Io.$activeStyle()(e)})})});DS({".leva__panel__dragged":{WebkitUserDrag:"none",userSelect:"none",input:{userSelect:"none"},"*":{cursor:"ew-resize !important"}}});function WS(e,t){let{theme:i}=Kt(FS);if(!(e in i)||!(t in i[e]))return yg(zi.THEME_ERROR,e,t),"";let r=t;for(;;){let n=i[e][r];if(typeof n=="string"&&n.charAt(0)==="$")r=n.substr(1);else return n}}var Ig=vt("input",{$reset:"",padding:"0 $sm",width:0,minWidth:0,flex:1,height:"100%",variants:{levaType:{number:{textAlign:"right"}},as:{textarea:{padding:"$sm"}}}}),Og=vt("div",{$draggable:"",height:"100%",$flexCenter:"",position:"relative",padding:"0 $xs",fontSize:"0.8em",opacity:.8,cursor:"default",touchAction:"none",[`& + ${Ig}`]:{paddingLeft:0}}),HS=vt(Og,{cursor:"ew-resize",marginRight:"-$xs",textTransform:"uppercase",opacity:.3,"&:hover":{opacity:1},variants:{dragging:{true:{backgroundColor:"$accent2",opacity:1}}}}),qS=vt("div",{$flex:"",position:"relative",borderRadius:"$sm",overflow:"hidden",color:"inherit",height:"$rowHeight",backgroundColor:"$elevation3",$inputStyle:"$elevation1",$hover:"",$focusWithin:"",variants:{textArea:{true:{height:"auto"}}}}),QS=["innerLabel","value","onUpdate","onChange","onKeyDown","type","id","inputType","rows"],VS=["onUpdate"];function Rg(e){let{innerLabel:t,value:i,onUpdate:r,onChange:n,onKeyDown:o,type:l,id:u,inputType:c="text",rows:p=0}=e,f=Ur(e,QS),{id:v,emitOnEditStart:x,emitOnEditEnd:E,disabled:_}=Dr(),P=u||v,O=we(null),I=p>0,A=I?"textarea":"input",$=He(H=>Y=>{let V=Y.currentTarget.value;H(V)},[]);te.useEffect(()=>{let H=O.current,Y=$(V=>{r(V),E()});return H==null||H.addEventListener("blur",Y),()=>H==null?void 0:H.removeEventListener("blur",Y)},[$,r,E]);let z=He(H=>{H.key==="Enter"&&$(r)(H)},[$,r]),B=Object.assign({as:A},I?{rows:p}:{},f);return te.createElement(qS,{textArea:I},t&&typeof t=="string"?te.createElement(Og,null,t):t,te.createElement(Ig,Yi({levaType:l,ref:O,id:P,type:c,autoComplete:"off",spellCheck:"false",value:i,onChange:$(n),onFocus:()=>x(),onKeyPress:z,onKeyDown:o,disabled:_},B)))}function GS(e){let{onUpdate:t}=e,i=Ur(e,VS),r=He(o=>t(kS(o)),[t]),n=He(o=>{let l=o.key==="ArrowUp"?1:o.key==="ArrowDown"?-1:0;if(l){o.preventDefault();let u=o.altKey?.1:o.shiftKey?10:1;t(c=>parseFloat(c)+l*u)}},[t]);return te.createElement(Rg,Yi({},i,{onUpdate:r,onKeyDown:n,type:"number"}))}var Gh=vt("div",{}),Mg=vt("div",{position:"relative",background:"$elevation2",transition:"height 300ms ease",variants:{fill:{true:{},false:{}},flat:{false:{},true:{}},isRoot:{true:{},false:{paddingLeft:"$md","&::after":{content:'""',position:"absolute",left:0,top:0,width:"$borderWidths$folder",height:"100%",backgroundColor:"$folderWidgetColor",opacity:.4,transform:"translateX(-50%)"}}}},compoundVariants:[{isRoot:!0,fill:!1,css:{overflowY:"auto",maxHeight:"calc(100vh - 20px - $$titleBarHeight)"}},{isRoot:!0,flat:!1,css:{borderRadius:"$lg"}}]});vt("div",{$flex:"",color:"$folderTextColor",userSelect:"none",cursor:"pointer",height:"$folderTitleHeight",fontWeight:"$folder","> svg":{marginLeft:-4,marginRight:4,cursor:"pointer",fill:"$folderWidgetColor",opacity:.6},"&:hover > svg":{fill:"$folderWidgetColor"},[`&:hover + ${Mg}::after`]:{opacity:.6},[`${Gh}:hover > & + ${Mg}::after`]:{opacity:.6},[`${Gh}:hover > & > svg`]:{opacity:1}});var ZS=vt("div",{position:"relative",display:"grid",gridTemplateColumns:"100%",rowGap:"$rowGap",transition:"opacity 250ms ease",variants:{toggled:{true:{opacity:1,transitionDelay:"250ms"},false:{opacity:0,transitionDelay:"0ms",pointerEvents:"none"}},isRoot:{true:{"& > div":{paddingLeft:"$md",paddingRight:"$md"},"& > div:first-of-type":{paddingTop:"$sm"},"& > div:last-of-type":{paddingBottom:"$sm"},[`> ${Gh}:not(:first-of-type)`]:{paddingTop:"$sm",marginTop:"$md",borderTop:"$borderWidths$folder solid $colors$elevation1"}}}}}),Lg=vt("div",{position:"relative",zIndex:100,display:"grid",rowGap:"$rowGap",gridTemplateRows:"minmax($sizes$rowHeight, max-content)",alignItems:"center",color:"$highlight2",[`${ZS} > &`]:{"&:first-of-type":{marginTop:"$rowGap"},"&:last-of-type":{marginBottom:"$rowGap"}},variants:{disabled:{true:{pointerEvents:"none"},false:{"&:hover,&:focus-within":{color:"$highlight3"}}}}}),XS=vt(Lg,{gridTemplateColumns:"auto $sizes$controlWidth",columnGap:"$colGap"}),YS=vt("div",{$flex:"",height:"100%",position:"relative",overflow:"hidden","& > div":{marginLeft:"$colGap",padding:"0 $xs",opacity:.4},"& > div:hover":{opacity:.8},"& > div > svg":{display:"none",cursor:"pointer",width:13,minWidth:13,height:13,backgroundColor:"$elevation2"},"&:hover > div > svg":{display:"block"},variants:{align:{top:{height:"100%",alignItems:"flex-start",paddingTop:"$sm"}}}}),KS=vt("input",{$reset:"",height:0,width:0,opacity:0,margin:0,"& + label":{position:"relative",$flexCenter:"",height:"100%",userSelect:"none",cursor:"pointer",paddingLeft:2,paddingRight:"$sm",pointerEvents:"auto"},"& + label:after":{content:'""',width:6,height:6,backgroundColor:"$elevation3",borderRadius:"50%",$activeStyle:""},"&:focus + label:after":{$focusStyle:""},"& + label:active:after":{backgroundColor:"$accent1",$focusStyle:""},"&:checked + label:after":{backgroundColor:"$accent1"}}),Zh=vt("label",{fontWeight:"$label",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap","& > svg":{display:"block"}});vt("div",{opacity:1,variants:{disabled:{true:{opacity:.6,pointerEvents:"none",[`& ${Zh}`]:{pointerEvents:"auto"}}}}}),vt("div",{position:"fixed",top:0,bottom:0,right:0,left:0,zIndex:1e3,userSelect:"none"});var JS=vt("div",{background:"$toolTipBackground",fontFamily:"$sans",fontSize:"$toolTip",padding:"$xs $sm",color:"$toolTipText",borderRadius:"$xs",boxShadow:"$level2",maxWidth:260}),eE=vt(_S,{fill:"$toolTipBackground"}),tE=["align"];function iE(){let{id:e,disable:t,disabled:i}=Dr();return te.createElement(te.Fragment,null,te.createElement(KS,{id:e+"__disable",type:"checkbox",checked:!i,onChange:()=>t(!i)}),te.createElement("label",{htmlFor:e+"__disable"}))}function rE(e){let{id:t,optional:i,hint:r}=Dr(),n=e.htmlFor||(t?{htmlFor:t}:null),o=!r&&typeof e.children=="string"?{title:e.children}:null;return te.createElement(te.Fragment,null,i&&te.createElement(iE,null),r!==void 0?te.createElement(bS,null,te.createElement(wS,{asChild:!0},te.createElement(Zh,Yi({},n,e))),te.createElement(xS,{side:"top",sideOffset:2},te.createElement(JS,null,r,te.createElement(eE,null)))):te.createElement(Zh,Yi({},n,o,e)))}function Ya(e){let{align:t}=e,i=Ur(e,tE),{value:r,label:n,key:o,disabled:l}=Dr(),{hideCopyButton:u}=jS(),c=!u&&o!==void 0,[p,f]=Be(!1),v=async()=>{try{await navigator.clipboard.writeText(JSON.stringify({[o]:r??""})),f(!0)}catch{yg(zi.CLIPBOARD_ERROR,{[o]:r})}};return te.createElement(YS,{align:t,onPointerLeave:()=>f(!1)},te.createElement(rE,i),c&&!l&&te.createElement("div",{title:`Click to copy ${typeof n=="string"?n:o} value`},p?te.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},te.createElement("path",{d:"M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"}),te.createElement("path",{fillRule:"evenodd",d:"M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm9.707 5.707a1 1 0 00-1.414-1.414L9 12.586l-1.293-1.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})):te.createElement("svg",{onClick:v,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},te.createElement("path",{d:"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z"}),te.createElement("path",{d:"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z"}))))}var nE=["toggled"],sE=vt("svg",{fill:"currentColor",transition:"transform 350ms ease, fill 250ms ease"});function oE(e){let{toggled:t}=e,i=Ur(e,nE);return te.createElement(sE,Yi({width:"9",height:"5",viewBox:"0 0 9 5",xmlns:"http://www.w3.org/2000/svg",style:{transform:`rotate(${t?0:-90}deg)`}},i),te.createElement("path",{d:"M3.8 4.4c.4.3 1 .3 1.4 0L8 1.7A1 1 0 007.4 0H1.6a1 1 0 00-.7 1.7l3 2.7z"}))}var aE=["input"];function Ka(e){let{input:t}=e,i=Ur(e,aE);return t?te.createElement(XS,i):te.createElement(Lg,i)}function $g(e,t){let{emitOnEditStart:i,emitOnEditEnd:r}=Dr();return N_(n=>{n.first&&(document.body.classList.add("leva__panel__dragged"),i==null||i());let o=e(n);return n.last&&(document.body.classList.remove("leva__panel__dragged"),r==null||r()),o},t)}var lE=vt("div",{variants:{hasRange:{true:{position:"relative",display:"grid",gridTemplateColumns:"auto $sizes$numberInputMinWidth",columnGap:"$colGap",alignItems:"center"}}}}),uE=vt("div",{position:"relative",width:"100%",height:2,borderRadius:"$xs",backgroundColor:"$elevation1"}),hE=vt("div",{position:"absolute",width:"$scrubberWidth",height:"$scrubberHeight",borderRadius:"$xs",boxShadow:"0 0 0 2px $colors$elevation2",backgroundColor:"$accent2",cursor:"pointer",$active:"none $accent1",$hover:"none $accent3",variants:{position:{left:{borderTopRightRadius:0,borderBottomRightRadius:0,transform:"translateX(calc(-0.5 * ($sizes$scrubberWidth + 4px)))"},right:{borderTopLeftRadius:0,borderBottomLeftRadius:0,transform:"translateX(calc(0.5 * ($sizes$scrubberWidth + 4px)))"}}}}),cE=vt("div",{position:"relative",$flex:"",height:"100%",cursor:"pointer",touchAction:"none"}),dE=vt("div",{position:"absolute",height:"100%",backgroundColor:"$accent2"});function pE({value:e,min:t,max:i,onDrag:r,step:n,initialValue:o}){let l=we(null),u=we(null),c=we(0),p=WS("sizes","scrubberWidth"),f=$g(({event:x,first:E,xy:[_],movement:[P],memo:O})=>{if(E){let{width:A,left:$}=l.current.getBoundingClientRect();c.current=A-parseFloat(p),O=(x==null?void 0:x.target)===u.current?e:wg((_-$)/A,t,i)}let I=O+wg(P/c.current,0,i-t);return r(Tg(I,{step:n,initialValue:o})),O}),v=CS(e,t,i);return te.createElement(cE,Yi({ref:l},f()),te.createElement(uE,null,te.createElement(dE,{style:{left:0,right:`${(1-v)*100}%`}})),te.createElement(hE,{ref:u,style:{left:`calc(${v} * (100% - ${p}))`}}))}var fE=te.memo(({label:e,onUpdate:t,step:i,innerLabelTrim:r})=>{let[n,o]=Be(!1),l=$g(({active:u,delta:[c],event:p,memo:f=0})=>(o(u),f+=c/2,Math.abs(f)>=1&&(t(v=>parseFloat(v)+Math.floor(f)*i*TS(p)),f=0),f));return te.createElement(HS,Yi({dragging:n,title:e.length>1?e:""},l()),e.slice(0,r))});function gE({label:e,id:t,displayValue:i,onUpdate:r,onChange:n,settings:o,innerLabelTrim:l=1}){let u=l>0&&te.createElement(fE,{label:e,step:o.step,onUpdate:r,innerLabelTrim:l});return te.createElement(GS,{id:t,value:String(i),onUpdate:r,onChange:n,innerLabel:u})}function mE(){let e=Dr(),{label:t,value:i,onUpdate:r,settings:n,id:o}=e,{min:l,max:u}=n,c=u!==1/0&&l!==-1/0;return te.createElement(Ka,{input:!0},te.createElement(Ya,null,t),te.createElement(lE,{hasRange:c},c&&te.createElement(pE,Yi({value:parseFloat(i),onDrag:r},n)),te.createElement(gE,Yi({},e,{id:o,label:"value",innerLabelTrim:c?0:1}))))}var yE=Ur(NS,["sanitizeStep"]);jn({component:mE},yE);var vE=(e,t)=>on().schema({options:on().passesAnyOf(on().object(),on().array())}).test(t),bE=(e,{values:t})=>{if(t.indexOf(e)<0)throw Error("Selected value doesn't match Select options");return e},wE=(e,{values:t})=>t.indexOf(e),xE=e=>{let{value:t,options:i}=e,r,n;return Array.isArray(i)?(n=i,r=i.map(o=>String(o))):(n=Object.values(i),r=Object.keys(i)),"value"in e?n.includes(t)||(r.unshift(String(t)),n.unshift(t)):t=n[0],Object.values(i).includes(t)||(i[String(t)]=t),{value:t,settings:{keys:r,values:n}}},_E=Object.freeze({__proto__:null,schema:vE,sanitize:bE,format:wE,normalize:xE}),SE=vt("div",{$flexCenter:"",position:"relative","> svg":{pointerEvents:"none",position:"absolute",right:"$md"}}),Xh=vt("select",{position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:0}),EE=vt("div",{display:"flex",alignItems:"center",width:"100%",height:"$rowHeight",backgroundColor:"$elevation3",borderRadius:"$sm",padding:"0 $sm",cursor:"pointer",[`${Xh}:focus + &`]:{$focusStyle:""},[`${Xh}:hover + &`]:{$hoverStyle:""}});function AE({displayValue:e,value:t,onUpdate:i,id:r,settings:n,disabled:o}){let{keys:l,values:u}=n,c=we();return t===u[e]&&(c.current=l[e]),te.createElement(SE,null,te.createElement(Xh,{id:r,value:e,onChange:p=>i(u[Number(p.currentTarget.value)]),disabled:o},l.map((p,f)=>te.createElement("option",{key:p,value:f},p))),te.createElement(EE,null,c.current),te.createElement(oE,{toggled:!0}))}function kE(){let{label:e,value:t,displayValue:i,onUpdate:r,id:n,disabled:o,settings:l}=Dr();return te.createElement(Ka,{input:!0},te.createElement(Ya,null,e),te.createElement(AE,{id:n,value:t,displayValue:i,onUpdate:r,settings:l,disabled:o}))}jn({component:kE},_E);var PE=e=>on().string().test(e),CE=e=>{if(typeof e!="string")throw Error("Invalid string");return e},TE=({value:e,editable:t=!0,rows:i=!1})=>({value:e,settings:{editable:t,rows:typeof i=="number"?i:i?5:0}}),IE=Object.freeze({__proto__:null,schema:PE,sanitize:CE,normalize:TE}),OE=["displayValue","onUpdate","onChange","editable"],RE=vt("div",{whiteSpace:"pre-wrap"});function ME(e){let{displayValue:t,onUpdate:i,onChange:r,editable:n=!0}=e,o=Ur(e,OE);return n?te.createElement(Rg,Yi({value:t,onUpdate:i,onChange:r},o)):te.createElement(RE,null,t)}function LE(){let{label:e,settings:t,displayValue:i,onUpdate:r,onChange:n}=Dr();return te.createElement(Ka,{input:!0},te.createElement(Ya,null,e),te.createElement(ME,Yi({displayValue:i,onUpdate:r,onChange:n},t)))}jn({component:LE},IE);var $E=e=>on().boolean().test(e),NE=e=>{if(typeof e!="boolean")throw Error("Invalid boolean");return e},zE=Object.freeze({__proto__:null,schema:$E,sanitize:NE}),FE=vt("div",{position:"relative",$flex:"",height:"$rowHeight",input:{$reset:"",height:0,width:0,opacity:0,margin:0},label:{position:"relative",$flexCenter:"",userSelect:"none",cursor:"pointer",height:"$checkboxSize",width:"$checkboxSize",backgroundColor:"$elevation3",borderRadius:"$sm",$hover:""},"input:focus + label":{$focusStyle:""},"input:focus:checked + label, input:checked + label:hover":{$hoverStyle:"$accent3"},"input + label:active":{backgroundColor:"$accent1"},"input:checked + label:active":{backgroundColor:"$accent1"},"label > svg":{display:"none",width:"90%",height:"90%",stroke:"$highlight3"},"input:checked + label":{backgroundColor:"$accent2"},"input:checked + label > svg":{display:"block"}});function BE({value:e,onUpdate:t,id:i,disabled:r}){return te.createElement(FE,null,te.createElement("input",{id:i,type:"checkbox",checked:e,onChange:n=>t(n.currentTarget.checked),disabled:r}),te.createElement("label",{htmlFor:i},te.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},te.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"}))))}function jE(){let{label:e,value:t,onUpdate:i,disabled:r,id:n}=Dr();return te.createElement(Ka,{input:!0},te.createElement(Ya,null,e),te.createElement(BE,{value:t,onUpdate:i,id:n,disabled:r}))}jn({component:jE},zE),vt("div",{display:"grid",columnGap:"$colGap",gridAutoFlow:"column dense",alignItems:"center",variants:{withLock:{true:{gridTemplateColumns:"10px auto","> svg":{cursor:"pointer"}}}}});var Ng=class extends Sr{constructor(e){super(),this.type="spacial-content",this.style={opacity:1},this.format="jpg",this.tileUrl=hx(e.url),this.id=e.id||`${this.tileUrl}--${e.scaleFactor}`,this.points=e.displayPoints?e.displayPoints:Nn(e.points,$n(e.scaleFactor)),this.tileWidth=e.tileWidth,this.display={x:0,y:0,width:e.width/e.scaleFactor,height:e.height/e.scaleFactor,points:e.points,scale:e.scaleFactor},e.format&&(this.format=e.format)}applyProps(e){if(e.style&&typeof e.style.opacity<"u"&&(this.style.opacity=e.style.opacity),e.service!==this.service&&(this.service=e.service),e.format?this.format=e.format:this.format="jpg",e.crop){this.cropData=e.crop;let t=ze([...this.points]),i=t.length/5,r=e.crop.x||0,n=e.crop.y||0,o=e.crop.x+e.crop.width,l=e.crop.y+e.crop.height;for(let u=0;u<i;u++){let c=u*5;t[c+1]<o&&t[c+3]>r&&t[c+2]<l&&t[c+4]>n?(t[c+1]=an(t[c+1],r,o),t[c+3]=an(t[c+3],r,o),t[c+2]=an(t[c+2],n,l),t[c+4]=an(t[c+4],n,l)):t[c]=0}_r(t,Xi(-e.crop.x,-e.crop.y)),this.crop?this.crop.set(t):this.crop=t}}static fromTile(e,t,i,r,n,o){i.height=i.height?i.height:i.width;let l=Math.ceil(t.width/r),u=Math.ceil(t.height/r),c=Math.ceil(l/i.width),p=Math.ceil(u/i.height),f=ut.grid(c,p),v=ut.grid(c,p);for(let E=0;E<p;E++)for(let _=0;_<c;_++){let P=_*i.width,O=E*i.height;v.addPoints(P*r,O*r,_===c-1?t.width:(P+i.width)*r,E===p-1?t.height:(O+i.height)*r),f.addPoints(P,O,_===c-1?l:P+i.width,E===p-1?u:O+i.height)}let x=new Ng({url:e,scaleFactor:r,points:f.build(),displayPoints:v.build(),width:t.width,height:t.height,tileWidth:i.width,format:o});return x.applyProps({service:n}),x}getImageUrl(e){let t=this.points.slice(e*5,e*5+5),i=t[3]-t[1],r=t[4]-t[2],n=Math.ceil(i/this.display.scale);return`${this.tileUrl}/${t[1]},${t[2]},${i},${r}/${n>this.tileWidth?this.tileWidth:n},/0/default.${this.format||"jpg"}`}getAllPointsAt(e,t,i){let r=So(this.crop||this.points,e);return[[this,r,t]]}transform(e){_r(this.points,e)}getScheduledUpdates(e,t){return[]}},UE=class extends Sr{constructor(){super(...arguments),this.type="spacial-content"}getAllPointsAt(e,t,i){return[[this,this.points,t]]}},DE=class extends UE{constructor(e){super(),this.images=[],this.allImages=[],this.scaleFactors=[],this.aggregateBuffer=ze(9),this.isFullyLoaded=!1,this.maxScaleFactor=0,this._scheduleSortByScales=!1,this._sortByScales=()=>{this._scheduleSortByScales=!1,this.allImages.sort((i,r)=>r.display.width-i.display.width),this.images=[];let t=.1;for(let i of this.allImages)if(!(i.display.width<this.renderOptions.minSize&&i.display.height<this.renderOptions.minSize&&!i.priority||i instanceof Eo&&(i.display.width>this.renderOptions.maxImageSize||i.display.height>this.renderOptions.maxImageSize)&&!i.priority)){if(Math.abs(i.display.scale-t)<.25||i.priority){let r=this.images.pop();r&&(r instanceof Eo||r.priority)?(i.priority&&this.images.push(i),this.images.push(r)):i&&this.images.push(i)}else i&&this.images.push(i);t=i.display.scale}this.images.length===0&&(this.images=[...this.allImages]),this.scaleFactors=this.images.map(i=>i.display.scale),this.maxScaleFactor=Math.max(...this.scaleFactors)},this.loadFullResource=async()=>{if(!this.isFullyLoaded&&this.lazyLoader){this.isFullyLoaded=!0;let t=await this.lazyLoader();this.addImages(t)}},this.fallback=[this.loadFullResource],this.id=e.id,this.points=ut.singleBox(e.width,e.height),this.lazyLoader=e.loadFullImages,e.loadFullImages||(this.isFullyLoaded=!0),this.display={x:0,y:0,points:ut.singleBox(e.width,e.height),height:e.height,width:e.width,scale:1},this.renderOptions=C({renderSmallestFallback:!0,renderLayers:2,minSize:255,maxImageSize:1024,quality:1.75},e.renderOptions||{}),this.addImages(e.images)}applyProps(e){typeof e.renderSmallestFallback<"u"&&e.renderSmallestFallback!==this.renderOptions.renderSmallestFallback&&(this.renderOptions.renderSmallestFallback=e.renderSmallestFallback),typeof e.renderLayers<"u"&&e.renderLayers!==this.renderOptions.renderLayers&&(this.renderOptions.renderLayers=e.renderLayers),typeof e.minSize<"u"&&e.minSize!==this.renderOptions.minSize&&(this.renderOptions.minSize=e.minSize),typeof e.maxImageSize<"u"&&e.maxImageSize!==this.renderOptions.maxImageSize&&(this.renderOptions.maxImageSize=e.maxImageSize),typeof e.quality<"u"&&e.quality!==this.renderOptions.quality&&(this.renderOptions.quality=e.quality)}appendChild(e){this.addImages([e])}removeChild(e){this.images.indexOf(e)!==-1&&(this.images=this.images.filter(t=>t!==e),this.sortByScales())}insertBefore(e,t){this.addImages([e])}hideInstance(){}addImages(e){for(let t of e)t.__parent=this,t.__owner=this.__owner;this.allImages.push(...e.filter(Boolean)),this.sortByScales()}sortByScales(){this._scheduleSortByScales=!0}getScheduledUpdates(e,t){return this._scheduleSortByScales?[this._sortByScales]:this.isFullyLoaded?[]:t>1/this.maxScaleFactor?this.fallback:[]}getAllPointsAt(e,t,i){if(this.images.length===0)return[];let r=ux(1/(i||1)/(window.devicePixelRatio||1),this.images,this.renderOptions.quality),n=this.images.length,o=t?sn(t,Xi(this.x,this.y)):Xi(this.x,this.y);if(r!==this.images.length-1&&this.images[r+1]){let l=[];for(let p=n-1;p>=r;p--)l.push(p);let u=l[0];this.renderOptions.renderLayers&&(l=l.slice(-Math.min(l.length,this.renderOptions.renderLayers))),this.renderOptions.renderSmallestFallback&&l.indexOf(u)===-1&&l.unshift(u);let c=[];for(let p=0;p<l.length;p++)c.push(...this.images[l[p]].getAllPointsAt(e,o,i));return c}return this.images[r].getAllPointsAt(e,o,i)}};function Ja(e,t,i,r,n){let o=Math.PI/180*n,l=Math.cos(o),u=Math.sin(o),c=l*(i-e)+u*(r-t)+e,p=l*(r-t)-u*(i-e)+t;return[c,p]}var el=class extends Sr{constructor(e,t){super(),this.type="world-object",this.intersectionBuffer=ze(5),this.aggregateBuffer=ze(9),this.invertedBuffer=ze(9),this.rotation=0,this._updatedList=[];let{x:i=0,y:r=0}=t||{};e?(this.id=e.id||"",this.scale=1,this.layers=e.layers,this.points=ze([1,i,r,i+e.width,r+e.height]),this.worldPoints=ze([1,i,r,i+e.width,r+e.height]),this.filteredPointsBuffer=ze(e.layers.length*5)):(this.id="",this.scale=1,this.layers=[],this.points=ze(5),this.worldPoints=ze(5),this.filteredPointsBuffer=ze(5))}static createWithProps(e){let t=new el;return t.applyProps(e),t}applyProps(e){let t=e.x||0,i=e.y||0;this.id=e.id;let r=typeof e.scale<"u"?e.scale:this.scale;this.points[0]=1,this.points[1]=t,this.points[2]=i,this.points[3]=t+e.width,this.points[4]=i+e.height,this.rotation=e.rotation||0,this.worldPoints[3]=this.worldPoints[1]+e.width,this.worldPoints[4]=this.worldPoints[2]+e.height,e.scale&&e.scale!==1&&this.atScale(r),this.scale=r}appendChild(e){e.points[0]===0&&e.points.set(this.points),e.__owner.value=this,this.addLayers([e])}removeChild(e){this.layers=this.layers.filter(t=>t!==e),this.filteredPointsBuffer=ze(this.layers.length*5)}insertBefore(e,t){let i=this.layers.indexOf(t);if(i===-1||this.layers.indexOf(e)!==-1)return;let r=this.layers.slice(0,i),n=this.layers.slice(i);this.layers=[...r,e,...n]}hideInstance(){console.warn("hideInstance: not yet implemented")}getObjectsAt(e,t){if(this.rotation&&(e=this.applyRotation(e)),So(this.points,e,this.filteredPointsBuffer)[0]===0)return[];let i=this.layers.length,r=[];for(let n=0;n<i;n++){let o=this.layers[n];if(t&&o.isShape){let l=Nn(o.points,Xi(this.x,this.y));if(!o.intersects([e[1]-l[1],e[2]-l[2]]))continue}if(So(Nn(o.points,Xi(this.x,this.y)),e,this.filteredPointsBuffer)[0]!==0&&r.push(o),t){let l=o;r.push(...l.getObjectsAt(e,t))}}return r}applyRotation(e){if(this.rotation){let t={x:e[1],y:e[2]},i={x:e[1],y:e[4]},r={x:e[3],y:e[2]},n={x:e[3],y:e[4]},o=this.points[1]+(this.points[3]-this.points[1])/2,l=this.points[2]+(this.points[4]-this.points[2])/2,[u,c]=Ja(o,l,t.x,t.y,this.rotation),[p,f]=Ja(o,l,i.x,i.y,this.rotation),[v,x]=Ja(o,l,r.x,r.y,this.rotation),[E,_]=Ja(o,l,n.x,n.y,this.rotation),P=Math.min(u,p,v,E),O=Math.max(u,p,v,E),I=Math.min(c,f,x,_),A=Math.max(c,f,x,_);return ze([e[0],P,I,O,A])}return e}getAllPointsAt(e,t,i){let r=sn(Xi(this.x,this.y),$n(this.scale),this.aggregateBuffer);this.rotation&&(e=this.applyRotation(e));let n=ox(e,this.points,this.intersectionBuffer),o=this.layers.length,l=[],u=Nn(n,sn($n(1/this.scale),Xi(-this.x,-this.y),this.invertedBuffer)),c=t?sn(t,r,this.aggregateBuffer):r,p=i*this.scale;for(let f=0;f<o;f++)l.push(...this.layers[f].getAllPointsAt(u,c,p));return l}addLayers(e){let t=[];for(let i of e)this.layers.indexOf(i)===-1&&(t.push(i),i.points.length===5&&(i.points[1]<this.worldPoints[1]/this.scale||i.points[2]<this.worldPoints[2]/this.scale||i.points[3]>this.worldPoints[3]/this.scale||i.points[4]>this.worldPoints[4]/this.scale)&&(i.crop=i.crop||ze([1,Math.max(this.worldPoints[1]/this.scale,i.points[1]),Math.max(this.worldPoints[2]/this.scale,i.points[2]),Math.min(this.worldPoints[3]/this.scale,i.points[3]),Math.min(this.worldPoints[4]/this.scale,i.points[4])])));this.layers=this.layers.concat(t),this.filteredPointsBuffer=ze(this.layers.length*5)}getScheduledUpdates(e,t){let i=this.layers.length;this._updatedList=[];let r=t*this.scale;for(let n=0;n<i;n++){let o=this.layers[n].getScheduledUpdates(e,r);o&&this._updatedList.push(...o)}return this._updatedList}},Yh=class extends Sr{constructor(e=0,t=0,i=100,r="left-to-right"){super(),this.id="world",this.aggregateBuffer=ze(9),this.isDirty=!1,this.zones=[],this.triggerQueue=[],this.activatedEvents=[],this._updatedList=[],this.translationBuffer=ze(9),this.needsRecalculate=!0,this.emptyPaintables=[],this.renderOrder=[],this.objects=[],this.subscriptions=[],this._propagateEventTargets=[],this._alreadyFlushed=[],this._width=e,this._height=t,this.aspectRatio=Number.isNaN(e/t)?1:e/t,this.viewingDirection=r,this.points=ze(i*5),this.filteredPointsBuffer=ze(i*5)}get x(){return 0}get y(){return 0}get width(){return this._width}get height(){return this._height}static withProps(e){let t=new Yh;return t.applyProps(e),t}applyProps(e){typeof e.width<"u"&&typeof e.height<"u"&&(e.width!==this._width||e.height!==this._height)&&this.resize(e.width,e.height),e.viewingDirection!==this.viewingDirection&&(this.viewingDirection=e.viewingDirection,this.triggerRepaint())}propagateTouchEvent(e,t,i){let r=[];for(let n of i)if(n.x&&n.y){let o=ut.singleBox(1,1,n.x,n.y);r.push(this.getObjectsAt(o,!0).reverse())}return r.map(n=>this.propagateEvent(e,t,n,{bubbles:!0,cancelable:!0}))}propagatePointerEvent(e,t,i,r,n={}){let o=ut.singleBox(1,1,i,r),l=this.getObjectsAt(o,!0).reverse();return this.propagateEvent(e,t,l,n)}propagateEvent(e,t,i,{bubbles:r=!1,cancelable:n=!1}={}){t.atlasTarget=this,this._propagateEventTargets.length=1,this._propagateEventTargets[0]=this;let o=!1;t.stopPropagation=()=>{o=!0};let l=i.length;for(let p=l-1;p>=0;p--){this._propagateEventTargets.unshift(i[p][0]);let f=i[p][1].length;if(f)for(let v=0;v<f;v++)this._propagateEventTargets.unshift(i[p][1][v])}let u=this._propagateEventTargets.length,c=!1;for(let p=0;p<u&&(t.atlasTarget=this._propagateEventTargets[p],t.atlasWorld=this,c=this._propagateEventTargets[p].dispatchEvent(e,t)||c,!o);p++);return c&&this.triggerRepaint(),this._propagateEventTargets}appendChild(e){let t=this.appendWorldObject(e);this.renderOrder.push(t/5)}removeChild(e){let t=this.objects.indexOf(e);if(t===-1){for(let i of this.objects)if(i&&i.id===e.id){this.removeChild(i);return}return}this.objects[t]=null,this.renderOrder=this.renderOrder.filter(i=>i!==t),this.points[t*5]=0,this.triggerRepaint(),this.needsRecalculate=!0}insertBefore(e,t){let i=this.objects.indexOf(t);if(i===-1)return;let r=this.appendWorldObject(e);this.renderOrder.splice(i-1,0,r/5)}hideInstance(){}asWorldObject(){return null}addZone(e){this.zones.push(e)}selectZone(e){if(typeof e=="string"){let t=this.zones.length;for(let i=0;i<t;i++)if(this.zones[i].id===e){this.selectedZone=i,this.trigger("zone-changed");return}}else this.zones[e]&&(this.selectedZone=e,this.trigger("zone-changed"))}deselectZone(){this.selectedZone=void 0}getActiveZone(){if(this.selectedZone)return this.zones[this.selectedZone]}hasActiveZone(){return typeof this.selectedZone<"u"}checkResizeInternalBuffer(){if(ax(this.points)===this.objects.length){let e=this.points,t=ze(this.points.length*2);t.set(e,0),this.points=t}}appendWorldObject(e){this.checkResizeInternalBuffer();let t=this.objects.length*5,i=e.points;return e.points=this.points.subarray(this.objects.length*5,this.objects.length*5+5),e.points[1]=i[1],e.points[2]=i[2],e.points[3]=i[3],e.points[4]=i[4],this.objects.push(e),this.filteredPointsBuffer=ze(this.objects.length*5),this.needsRecalculate=!0,this.triggerRepaint(),t}recalculateWorldSize(){let e=!1;if(this.needsRecalculate){let t=new Int32Array(this.objects.length),i=new Int32Array(this.objects.length),r=this.renderOrder.length;for(let l=0;l<r;l++){let u=this.renderOrder[l];this.objects[u]&&(t[l]=this.points[u*5+3],i[l]=this.points[u*5+4])}let n=Math.max(...t);n!==this._width&&(this._width=n,e=!0);let o=Math.max(...i);o!==this._height&&(this._height=o,e=!0),e&&this.trigger("recalculate-world-size",{width:n,height:o}),this.needsRecalculate=!1}return e}addObjectAt(e,t){t.width&&!t.height?t.height=t.width/e.width*e.height:t.height&&!t.width&&(t.width=t.height/e.height*e.width),(!t||!t.width||!t.height)&&(t.width=e.width,t.height=e.height);let{width:i,x:r,y:n}=t,o=i/e.width;this.checkResizeInternalBuffer(),this.points.set(ut.singleBox(e.width,e.height,0,0),this.objects.length*5);let l=new el(e);return l.points=this.points.subarray(this.objects.length*5,this.objects.length*5+5),this.objects.push(l),this.scaleWorldObject(this.objects.length-1,o),this.translateWorldObject(this.objects.length-1,r,n),this.filteredPointsBuffer=ze(this.points.length*2),this.triggerRepaint(),this.needsRecalculate=!0,l}scaleWorldObject(e,t){_r(this.points.subarray(e*5,e*5+5),za(t,this.points[e*5+1],this.points[e*5+2]));let i=this.objects[e];i&&(i.atScale(t),this.triggerRepaint())}translateWorldObject(e,t,i){_r(this.points.subarray(e*5,e*5+5),Xi(t,i));let r=this.objects[e];r&&(r.translate(t,i),this.triggerRepaint())}resize(e,t){return this._width=e,this._height=t,this.aspectRatio=e/t,this.triggerRepaint(),this}getObjects(){return this.objects}getPoints(){return this.points}getPointsFromViewer(e,t){let i=ut.singleBox(e.width,e.height,e.x,e.y);return this.getPointsAt(i,t,e.scale)}addLayoutSubscriber(e){return this.subscriptions.push(e),()=>{this.subscriptions.splice(this.subscriptions.indexOf(e),1)}}getScheduledUpdates(e,t){let i=So(this.points,e,this.filteredPointsBuffer),r=this.objects.length;this._updatedList=[];for(let n=0;n<r;n++)if(i[n*5]!==0){if(!this.objects[n])continue;this._updatedList.push(...this.objects[n].getScheduledUpdates(e,t))}return this._updatedList}getObjectsAt(e,t=!1){let i=this.getActiveZone(),r=So(this.points,e,this.filteredPointsBuffer),n=this.renderOrder.length,o=[];for(let l=0;l<n;l++){let u=this.renderOrder[l];if(r[u*5]!==0){let c=this.objects[u];if(!c||i&&i.objects.indexOf(c)===-1)continue;if(c.type!=="world-object"){o.push([c,[c]]);continue}t?o.push([c,c.getObjectsAt(e,t)]):o.push([c,this.emptyPaintables])}}return o}getPointsAt(e,t,i=1){let r=this.getObjectsAt(e),n=sn($n(i),Xi(-e[1],-e[2]),this.translationBuffer),o=t?sn(t,n,this.aggregateBuffer):n,l=r.length,u=[];for(let c=0;c<l;c++)r[c]&&u.push(...r[c][0].getAllPointsAt(e,o,i));return u}flushSubscriptions(){if(this.triggerQueue.length){this._alreadyFlushed=[];let e=this.triggerQueue.length;for(let t=0;t<e;t++){if(this._alreadyFlushed.indexOf(this.triggerQueue[t][0])!==-1)continue;typeof this.triggerQueue[t][1]>"u"&&this._alreadyFlushed.push(this.triggerQueue[t][0]);let i=this.subscriptions.length;for(let r=0;r<i;r++)this.subscriptions[r].apply(null,this.triggerQueue[t])}this.triggerQueue=[]}}trigger(e,t){this.triggerQueue.push([e,t])}triggerEventActivation(){this.trigger("event-activation")}triggerRepaint(){this.trigger("repaint")}gotoRegion(e){this.trigger("goto-region",e)}goHome(e=!1){this.trigger("go-home",{immediate:e})}zoomTo(e,t,i){this.trigger("zoom-to",{point:t,factor:e,stream:i})}zoomIn(e){this.trigger("zoom-to",{point:e,factor:.5})}zoomOut(e){this.trigger("zoom-to",{point:e,factor:2})}constraintBounds(e){this.trigger("constrain-bounds",{immediate:e})}},tl=/([0-9]+(px|em)\s+)+(solid)\s+(.*)/g,il={},WE=["backgroundColor","opacity","boxShadow","borderColor","borderWidth","borderStyle","outlineColor","outlineWidth","outlineOffset","outlineStyle"],HE=class extends Sr{constructor(){super(),this.type="spacial-content",this.hoverEvents=!1,this.activeEvents=!1,this.display={x:0,y:0,scale:1,width:-1,height:-1,points:ze(5)},this._parsed={border:{id:null,match:[]},outline:{id:null,match:[]}},this.props={},this.addHover=()=>{this.hovering=!0,this.__revision++},this.removeHover=()=>{this.hovering=!1,this.pressing=!1,this.__revision++},this.addPress=()=>{this.pressing=!0,this.__revision++},this.removePress=()=>{this.pressing=!1,this.__revision++},this.id=Fa(12),this.points=ze(5)}getAllPointsAt(e,t){return[[this,this.points,t]]}applyProps(e={}){let t=!1;if(e.interactive!==this.props.interactive&&(t=!0,this.props.interactive=e.interactive),e.style){let i=e.border||e.style.border;if(i!==this._parsed.border.id)if(!i)this._parsed.border.id=null,this._parsed.border.match=[];else{let r=il[i]||tl.exec(i)||tl.exec(i);r&&(this._parsed.border.id=i,this._parsed.border.match=il[i]=r)}if(this._parsed.border.id&&(e.style.borderWidth=this._parsed.border.match[1],e.style.borderStyle="solid",e.style.borderColor=this._parsed.border.match[4]),e.style.outline!==this._parsed.outline.id)if(!e.style.outline)this._parsed.outline.id=null,this._parsed.outline.match=[];else{let r=il[e.style.outline]||tl.exec(e.style.outline)||tl.exec(e.style.outline);r&&(this._parsed.outline.id=e.style.outline,this._parsed.outline.match=il[e.style.outline]=r)}this._parsed.outline.id&&(e.style.outlineWidth=this._parsed.outline.match[1],e.style.outlineStyle="solid",e.style.outlineColor=this._parsed.outline.match[4]),this.props.style=e.style,e.backgroundColor&&!this.props.style.backgroundColor&&(this.props.style.backgroundColor=e.backgroundColor,t=!0),e.style.background&&!this.props.style.backgroundColor&&(this.props.style.backgroundColor=e.style.background,t=!0);for(let r of WE)if(this.props.style[r]!==e.style[r]){t=!0;break}e.style[":hover"]!==this.props.hoverStyles&&(this.props.hoverStyles=e.style[":hover"],this.hoverEvents||(this.hoverEvents=!0,this.addEventListener("pointerenter",this.addHover),this.addEventListener("pointerleave",this.removeHover)),t=!0),e.style[":active"]!==this.props.pressStyles&&(this.props.pressStyles=e.style[":active"],this.activeEvents||(this.activeEvents=!0,this.addEventListener("mousedown",this.addPress),this.addEventListener("mouseup",this.removePress)),t=!0)}e.href!==this.props.href&&(this.props.href=e.href,t=!0),e.hrefTarget!==this.props.hrefTarget&&(this.props.hrefTarget=e.hrefTarget,t=!0),e.title!==this.props.title&&(this.props.title=e.title,t=!0),e.className!==this.props.className&&(this.props.className=e.className,e.className&&!this.hoverEvents&&(this.hoverEvents=!0,this.addEventListener("pointerenter",this.addHover),this.addEventListener("pointerleave",this.removeHover)),e.className&&!this.activeEvents&&(this.activeEvents=!0,this.addEventListener("mousedown",this.addPress),this.addEventListener("mouseup",this.removePress)),t=!0),e.relativeSize!==this.props.relativeSize&&(this.props.relativeSize=e.relativeSize,t=!0),e.relativeStyle!==this.props.relativeStyle&&(this.props.relativeStyle=e.relativeStyle,t=!0),e.html!==this.props.html&&(this.props.html=e.html,t=!0),e.target&&(e.target.width!==this.display.width||e.target.height!==this.display.height||e.target.x!==this.points[1]||e.target.y!==this.points[2])&&(t=!0,this.points=ut.singleBox(e.target.width,e.target.height,e.target.x,e.target.y),this.display.points=ut.singleBox(e.target.width,e.target.height,e.target.x,e.target.y),this.display.width=e.target.width,this.display.height=e.target.height),t&&this.__revision++}},rl=/([0-9]+(px|em)\s+)+(solid)\s+(.*)/g,nl={},qE=["backgroundColor","opacity","boxShadow","borderColor","borderWidth","borderStyle","outlineColor","outlineWidth","outlineOffset","outlineStyle"],QE=class extends Sr{constructor(){super(),this.type="spacial-content",this.isShape=!0,this.hoverEvents=!1,this.activeEvents=!1,this.display={x:0,y:0,scale:1,width:-1,height:-1,points:ze(5)},this.boundingBox=null,this._parsed={border:{id:null,match:[]},outline:{id:null,match:[]}},this.props={},this.shape={type:"none"},this.addHover=()=>{this.hovering=!0,this.__revision++},this.removeHover=()=>{this.hovering=!1,this.pressing=!1,this.__revision++},this.addPress=()=>{this.pressing=!0,this.__revision++},this.removePress=()=>{this.pressing=!1,this.__revision++},this.id=Fa(12),this.points=ze(5),this.shape={type:"none"}}updateBoundingBox(){if(this.shape.type==="none")return;let e=this.shape.points;if(this.shape.points.length>2){let t=Math.min(...e.map(o=>o[0])),i=Math.min(...e.map(o=>o[1])),r=Math.max(0,...e.map(o=>o[0])),n=Math.max(0,...e.map(o=>o[1]));this.boundingBox={x:t,y:i,width:r-t,height:n-i};return}this.boundingBox=null}intersects(e){if(!e||this.shape.type==="none")return!1;let[t,i]=e,r=this.shape.points,n=this.boundingBox;if(n||(this.updateBoundingBox(),n=this.boundingBox),!n||t<n.x||t>n.x+n.width||i<n.y||i>n.height+n.y)return!1;let o=!1;for(let l=0,u=r.length-1;l<r.length;u=l++)r[l][1]>i!=r[u][1]>i&&t<(r[u][0]-r[l][0])*(i-r[l][1])/(r[u][1]-r[l][1])+r[l][0]&&(o=!o);return o}getAllPointsAt(e,t){return e[3]-e[1]===1&&e[4]-e[2]===1?this.intersects([e[1],e[2]])?[[this,this.points,t]]:[]:[[this,this.points,t]]}applyProps(e={}){let t=!1;if(e.points)if(this.shape.type!=="polygon"||this.shape.points.length!==e.points.length)this.shape={type:"polygon",points:e.points,open:e.open},this.updateBoundingBox();else{let i=!1,r=e.points.length;for(let n=0;n<r;n++)if(e.points[n][0]!==this.shape.points[n][0]||e.points[n][1]!==this.shape.points[n][1]){i=!0;break}i&&(this.shape={type:"polygon",points:e.points,open:e.open},this.updateBoundingBox())}if(e.interactive!==this.props.interactive&&(t=!0,this.props.interactive=e.interactive),(e.open||e.open===!1)&&(t=!0,this.shape.open=e.open),e.style){let i=e.border||e.style.border;if(i!==this._parsed.border.id)if(!i)this._parsed.border.id=null,this._parsed.border.match=[];else{let r=nl[i]||rl.exec(i)||rl.exec(i);r&&(this._parsed.border.id=i,this._parsed.border.match=nl[i]=r)}if(this._parsed.border.id&&(e.style.borderWidth=this._parsed.border.match[1],e.style.borderStyle="solid",e.style.borderColor=this._parsed.border.match[4]),e.style.outline!==this._parsed.outline.id)if(!e.style.outline)this._parsed.outline.id=null,this._parsed.outline.match=[];else{let r=nl[e.style.outline]||rl.exec(e.style.outline)||rl.exec(e.style.outline);r&&(this._parsed.outline.id=e.style.outline,this._parsed.outline.match=nl[e.style.outline]=r)}this._parsed.outline.id&&(e.style.outlineWidth=this._parsed.outline.match[1],e.style.outlineStyle="solid",e.style.outlineColor=this._parsed.outline.match[4]),this.props.style=e.style,e.backgroundColor&&!this.props.style.backgroundColor&&(this.props.style.backgroundColor=e.backgroundColor,t=!0),e.style.background&&!this.props.style.backgroundColor&&(this.props.style.backgroundColor=e.style.background,t=!0);for(let r of qE)if(this.props.style[r]!==e.style[r]){t=!0;break}e.style[":hover"]!==this.props.hoverStyles&&(this.props.hoverStyles=e.style[":hover"],this.hoverEvents||(this.hoverEvents=!0,this.addEventListener("pointerenter",this.addHover),this.addEventListener("pointerleave",this.removeHover)),t=!0),e.style[":active"]!==this.props.pressStyles&&(this.props.pressStyles=e.style[":active"],this.activeEvents||(this.activeEvents=!0,this.addEventListener("mousedown",this.addPress),this.addEventListener("mouseup",this.removePress)),t=!0)}e.href!==this.props.href&&(this.props.href=e.href,t=!0),e.hrefTarget!==this.props.hrefTarget&&(this.props.hrefTarget=e.hrefTarget,t=!0),e.title!==this.props.title&&(this.props.title=e.title,t=!0),e.className!==this.props.className&&(this.props.className=e.className,e.className&&!this.hoverEvents&&(this.hoverEvents=!0,this.addEventListener("pointerenter",this.addHover),this.addEventListener("pointerleave",this.removeHover)),e.className&&!this.activeEvents&&(this.activeEvents=!0,this.addEventListener("mousedown",this.addPress),this.addEventListener("mouseup",this.removePress)),t=!0),e.relativeSize!==this.props.relativeSize&&(this.props.relativeSize=e.relativeSize,t=!0),e.relativeStyle!==this.props.relativeStyle&&(this.props.relativeStyle=e.relativeStyle,t=!0),e.html!==this.props.html&&(this.props.html=e.html,t=!0),e.target&&(e.target.width!==this.display.width||e.target.height!==this.display.height||e.target.x!==this.points[1]||e.target.y!==this.points[2])&&(t=!0,this.points=ut.singleBox(e.target.width,e.target.height,e.target.x,e.target.y),this.display.points=ut.singleBox(e.target.width,e.target.height,e.target.x,e.target.y),this.display.width=e.target.width,this.display.height=e.target.height),t&&this.__revision++}},VE=class extends Sr{constructor(){super(),this.type="spacial-content",this.color="#000",this.text="",this.display={x:0,y:0,scale:1,width:100,height:100,points:ze(5)},this.interactive=!1,this.props={font:"18px Arial, sans-serif",lineHeight:1,textAlign:"left",verticalAlign:"top",paddingX:0,paddingY:0,fitParent:!1,lineBreak:"auto",strokeText:!1,sizeToFill:!1,maxFontSizeToFill:void 0,allowNewLine:!0,justifyLines:!1,renderHDPI:!1,textDecoration:"none",interactive:!1,relativeSize:!1},this.id="",this.points=ze(5)}getAllPointsAt(e,t){return[[this,this.points,t]]}applyProps(e){var t=e,{id:i,target:r,text:n,color:o,backgroundColor:l,fontSize:u=18,interactive:c,fontFamily:p="Arial, sans-serif"}=t,f=le(t,["id","target","text","color","backgroundColor","fontSize","interactive","fontFamily"]);f.font=`${u}px ${p}`,this.interactive=c||!1,typeof n<"u"&&(this.text=n||""),o&&(this.color=o),l&&(this.backgroundColor=l),i&&(this.id=i),r&&(this.points=ut.singleBox(r.width,r.height,r.x,r.y),this.display.points=this.points,this.display.width=r.width,this.display.height=r.height),this.props=C(C({},this.props),f),this.__revision++}},Ft=Math.pow,sl=Math.sqrt,Oo=Math.sin,zg=Math.cos,Ro=Math.PI,ol=1.70158,al=ol*1.525,Fg=ol+1,Bg=2*Ro/3,jg=2*Ro/4.5,ll=function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},Fs={linear:e=>e,easeInQuad:function(e){return e*e},easeOutQuad:function(e){return 1-(1-e)*(1-e)},easeInOutQuad:function(e){return e<.5?2*e*e:1-Ft(-2*e+2,2)/2},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return 1-Ft(1-e,3)},easeInOutCubic:function(e){return e<.5?4*e*e*e:1-Ft(-2*e+2,3)/2},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return 1-Ft(1-e,4)},easeInOutQuart:function(e){return e<.5?8*e*e*e*e:1-Ft(-2*e+2,4)/2},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return 1-Ft(1-e,5)},easeInOutQuint:function(e){return e<.5?16*e*e*e*e*e:1-Ft(-2*e+2,5)/2},easeInSine:function(e){return 1-zg(e*Ro/2)},easeOutSine:function(e){return Oo(e*Ro/2)},easeInOutSine:function(e){return-(zg(Ro*e)-1)/2},easeInExpo:function(e){return e===0?0:Ft(2,10*e-10)},easeOutExpo:function(e){return e===1?1:1-Ft(2,-10*e)},easeInOutExpo:function(e){return e===0?0:e===1?1:e<.5?Ft(2,20*e-10)/2:(2-Ft(2,-20*e+10))/2},easeInCirc:function(e){return 1-sl(1-Ft(e,2))},easeOutCirc:function(e){return sl(1-Ft(e-1,2))},easeInOutCirc:function(e){return e<.5?(1-sl(1-Ft(2*e,2)))/2:(sl(1-Ft(-2*e+2,2))+1)/2},easeInBack:function(e){return Fg*e*e*e-ol*e*e},easeOutBack:function(e){return 1+Fg*Ft(e-1,3)+ol*Ft(e-1,2)},easeInOutBack:function(e){return e<.5?Ft(2*e,2)*((al+1)*2*e-al)/2:(Ft(2*e-2,2)*((al+1)*(e*2-2)+al)+2)/2},easeInElastic:function(e){return e===0?0:e===1?1:-Ft(2,10*e-10)*Oo((e*10-10.75)*Bg)},easeOutElastic:function(e){return e===0?0:e===1?1:Ft(2,-10*e)*Oo((e*10-.75)*Bg)+1},easeInOutElastic:function(e){return e===0?0:e===1?1:e<.5?-(Ft(2,20*e-10)*Oo((20*e-11.125)*jg))/2:Ft(2,-20*e+10)*Oo((20*e-11.125)*jg)/2+1},easeInBounce:function(e){return 1-ll(1-e)},easeOutBounce:ll,easeInOutBounce:function(e){return e<.5?(1-ll(1-2*e))/2:(1+ll(2*e-1))/2}},GE=class{constructor(e){this.runtime=e,this.pendingTransition={from:ze(5),to:ze(5),elapsed_time:0,done:!0,total_time:0,timingFunction:Fs.easeInOutQuad,constrain:!1}}hasPending(){return!this.pendingTransition.done}getPendingTransition(){return this.pendingTransition}getPendingFrom(){return this.pendingTransition.from}customTransition(e){e(this.pendingTransition)}stopTransition(){this.pendingTransition.from=ze(this.runtime.target),this.pendingTransition.to=ze(this.runtime.target),this.pendingTransition.done=!0,this.pendingTransition.elapsed_time=0,this.pendingTransition.total_time=0}runTransition(e,t){if(!this.pendingTransition.done){let i=this.pendingTransition,r=i.total_time===0?0:(i.elapsed_time+t)/i.total_time,n=i.total_time===0?1:r===0?0:i.timingFunction(r);e[1]=i.from[1]+(i.to[1]-i.from[1])*n,e[2]=i.from[2]+(i.to[2]-i.from[2])*n,e[3]=i.from[3]+(i.to[3]-i.from[3])*n,e[4]=i.from[4]+(i.to[4]-i.from[4])*n,this.pendingTransition.elapsed_time+=t,this.pendingTransition.elapsed_time>=this.pendingTransition.total_time&&(this.pendingTransition.done=!0,this.pendingTransition.constrain&&this.constrainBounds({transition:{duration:this.pendingTransition.total_time===0?0:500,easing:Fs.easeOutExpo}}))}}zoomTo(e,{origin:t,stream:i=!1,transition:r}={}){let n=this.runtime.getZoomedPosition(e,{origin:t}),o=Math.abs(1-e);this.applyTransition(n,r,{duration:2e3*o,easing:Fs.easeOutExpo,constrain:!0},{stream:!1})}constrainBounds({transition:e,panPadding:t=0}={}){let[i,r]=this.runtime.constrainBounds(this.runtime.target,{panPadding:t});i&&(this.applyTransition(r,e,{duration:500,easing:Fs.easeOutQuart,constrain:!1}),this.runtime.updateNextFrame())}applyTransition(e,t,i,{stream:r}={}){this.pendingTransition.from=ze(this.runtime.target),this.pendingTransition.to=e,r||(this.pendingTransition.elapsed_time=0),this.pendingTransition.done=!1,this.pendingTransition.total_time=typeof(t==null?void 0:t.duration)<"u"?t.duration:typeof(i==null?void 0:i.duration)<"u"?i.duration:1e3,this.pendingTransition.constrain=typeof(t==null?void 0:t.constrain)<"u"?t.constrain:typeof(i==null?void 0:i.constrain)<"u"?i.constrain:!1,this.pendingTransition.timingFunction=(t==null?void 0:t.easing)||(i==null?void 0:i.easing)||Fs.easeInOutSine}goToRegion(e,{transition:t}={}){let i=this.runtime.clampRegion(e);this.applyTransition(ut.singleBox(i.width,i.height,i.x,i.y),t,{duration:1e3,easing:Fs.easeOutExpo,constrain:!0}),this.runtime.updateNextFrame()}},Ug=class{constructor(e,t,i,r=[],n){this.id=Fa(),this.ready=!1,this.transformBuffer=ze(500),this.lastTarget=ze(5),this.zoomBuffer=ze(5),this.logNextRender=!1,this.pendingUpdate=!0,this.isCommitting=!1,this.firstRender=!0,this.mode="explore",this.controllers=[],this.controllersRunning=!1,this.controllerStopFunctions=[],this.maxScaleFactor=1,this._viewerToWorld={x:0,y:0},this._lastGoodScale=1,this.hooks={useFrame:[],useBeforeFrame:[],useAfterPaint:[],useAfterFrame:[]},this.hookOptions={filters:{grayscale:0,contrast:0,brightness:0,saturate:0,sepia:0,invert:0,hueRotate:0,blur:0}},this._viewport={x:0,y:0,width:0,height:0},this.setViewport=o=>{let l=Math.round(typeof o.x>"u"?this.target[1]:o.x),u=Math.round(typeof o.y>"u"?this.target[2]:o.y);o.width?this.target[3]=l+o.width:this.target[3]=this.target[3]-this.target[1]+l,o.height?this.target[4]=u+o.height:this.target[4]=this.target[4]-this.target[2]+u,Math.abs(this.target[1]-l)>.01&&(this.target[1]=l),Math.abs(this.target[2]-u)>.01&&(this.target[2]=u),this.pendingUpdate=!0},this.render=o=>{let l=o-this.lastTime;if(this.isCommitting||this.fpsLimit&&l<1e3/this.fpsLimit){this.stopId=window.requestAnimationFrame(this.render);return}this.lastTime=o,this.world.flushSubscriptions(),this.stopId=window.requestAnimationFrame(this.render),this.hook("useFrame",l);let u=this.pendingUpdate,c=this.renderer.pendingUpdate();if(this.transitionManager.hasPending()&&(this.transitionManager.runTransition(this.target,l),this.pendingUpdate=!0,this.updateControllerPosition()),!this.firstRender&&!u&&!c&&this.target[0]===this.lastTarget[0]&&this.target[1]===this.lastTarget[1]&&this.target[2]===this.lastTarget[2]&&this.target[3]===this.lastTarget[3]&&this.target[4]===this.lastTarget[4])return;this.hook("useBeforeFrame",l),this.renderer.beforeFrame(this.world,l,this.target,this.hookOptions);let p=this.getScaleFactor(),f=this.renderer.getPointsAt(this.world,this.target,this.aggregate,p),v=f.length;for(let _=0;_<v;_++){let P=f[_][0],O=f[_][1],I=f[_][2],A=I?Nn(O,I,this.transformBuffer):O;this.renderer.prepareLayer(P,P.__parent&&I?Nn(P.__parent.crop||P.__parent.points,I):A);let $=A.length/5;for(let z=0;z<$;z++){let B=z*5;A[B]!==0&&(this.renderer.paint(P,z,A[B+1],A[B+2],A[B+3]-A[B+1],A[B+4]-A[B+2]),this.hook("useAfterPaint",P))}this.renderer.finishLayer(P,O)}this.renderer.afterFrame(this.world,l,this.target,this.hookOptions),this.hook("useAfterFrame",l),this.lastTarget[0]=this.target[0],this.lastTarget[1]=this.target[1],this.lastTarget[2]=this.target[2],this.lastTarget[3]=this.target[3],this.lastTarget[4]=this.target[4],this.firstRender=!1,this.pendingUpdate=!1,this.logNextRender=!1,this.renderer.isReady()&&(this.ready=!0,this.world.trigger("ready")),this.world.flushSubscriptions();let x=this.world.getScheduledUpdates(this.target,p),E=x.length;if(E>0)for(let _=0;_<E;_++){let P=x[E-_-1]();P?P.then(()=>{this.pendingUpdate=!0}):this.pendingUpdate=!0}},this.renderer=e,this.world=t,this.options=C({maxOverZoom:1,maxUnderZoom:1,visibilityRatio:1.5},n||{}),this.target=ut.projection(i),this.manualHomePosition=!1,this.pendingUpdate=!0,this.homePosition=ut.projection(this.world),this.manualFocalPosition=!1,this.focalPosition=this.target,this.updateFocalPosition(),this.transitionManager=new GE(this),this.aggregate=$n(1),this.world.addLayoutSubscriber(o=>{o==="repaint"&&(this.pendingUpdate=!0),o==="recalculate-world-size"&&(this.manualHomePosition||(this.setHomePosition(),this.goHome()),this.updateFocalPosition())}),this.lastTime=performance.now(),this.controllers=r,this.render(this.lastTime),this.startControllers()}get x(){return this.target[1]}set x(e){this.target[1]=e}get y(){return this.target[2]}set y(e){this.target[2]=e}get x2(){return this.target[3]}set x2(e){this.target[3]=e}get y2(){return this.target[4]}set y2(e){this.target[4]=e}get width(){return this.target[3]-this.target[1]}set width(e){this.target[3]=this.target[1]+e}get height(){return this.target[4]-this.target[2]}set height(e){this.target[4]=this.target[2]=e}setHomePosition(e){this.homePosition.set(ut.projection(e||this.world)),this.pendingUpdate=!0}startControllers(){if(!this.controllersRunning){for(let e of this.controllers)this.controllerStopFunctions.push(e.start(this));this.controllersRunning=!0}}stopControllers(){if(this.controllersRunning){for(let e of this.controllerStopFunctions)e();this.controllersRunning=!1,this.controllerStopFunctions=[]}}updateControllerPosition(){for(let e of this.controllers)e.updatePosition(this.x,this.y,this.width,this.height)}triggerResize(){this.renderer.triggerResize&&this.renderer.triggerResize(),this.pendingUpdate=!0}addController(e){this.controllers.push(e),this.controllersRunning&&e.start(this),this.pendingUpdate=!0}cover(){return this.goHome({cover:!0})}getRendererScreenPosition(){return this.renderer.getRendererScreenPosition()}updateRendererScreenPosition(){this.pendingUpdate=!0,this.renderer.resize()}setOptions(e){this.options=C(C({},this.options),e)}goHome(e={}){if(this.world.width<=0||this.world.height<=0)return;let t=this.getScaleFactor(),i=e.position?{x:e.position[1],y:e.position[2],width:e.position[3]-e.position[1],height:e.position[4]-e.position[2]}:{x:this.homePosition[1],y:this.homePosition[2],width:this.homePosition[3]-this.homePosition[1],height:this.homePosition[4]-this.homePosition[2]},r=this.width*t,n=this.height*t,o=i.width/r,l=i.height/n,u=r/n;if(e.cover?o>l:o<l){let c=u*i.height,p=(c-i.width)/2;this.target[1]=Math.round(-p+i.x),this.target[2]=Math.round(i.y),this.target[3]=Math.round(c-p+i.x),this.target[4]=Math.round(i.height+i.y)}else{let c=i.width/u,p=(c-i.height)/2;this.target[1]=Math.round(i.x),this.target[2]=Math.round(i.y-p),this.target[3]=Math.round(i.x+i.width),this.target[4]=Math.round(i.y+c-p)}this.constrainBounds(this.target),this.updateControllerPosition()}resize(e,t,i,r){this.updateFocalPosition(e-t,i-r);let n=t/e,o=r/i;this.target[3]=this.target[1]+(this.target[3]-this.target[1])*n,this.target[4]=this.target[2]+(this.target[4]-this.target[2])*o,this.goHome({position:this.focalPosition}),this.renderer.resize(t,r),this.pendingUpdate=!0}updateFocalPosition(e,t){if(!this.manualFocalPosition){let i=this.width,r=this.height,n=Math.min(i,r),o=0,l=0,u=this.x+o,c=this.y+l;if(i<r){let p=this.height-this.width;this.focalPosition=ut.projection({x:u,y:c+p/2,width:n-o*2,height:n-l*2}),this.pendingUpdate=!0}else{let p=this.width-this.height;this.focalPosition=ut.projection({x:u+p/2,y:c,width:n-o*2,height:n-l*2}),this.pendingUpdate=!0}}}getViewport(){return this._viewport.x=this.target[1],this._viewport.y=this.target[2],this._viewport.width=this.target[3]-this.target[1],this._viewport.height=this.target[4]-this.target[2],this._viewport}constrainBounds(e,{panPadding:t=0,ref:i=!1}={}){let{minX:r,maxX:n,minY:o,maxY:l}=this.getBounds({target:e,padding:t}),u=!1,c=i?e:ze(e),p=Math.round(e[3]-e[1]),f=Math.round(e[4]-e[2]);return r>e[1]&&(u=!0,c[1]=r,c[3]=r+p),o>e[2]&&(u=!0,c[2]=o,c[4]=o+f),n<e[1]&&(u=!0,c[1]=n,c[3]=n+p),l<e[2]&&(u=!0,c[2]=l,c[4]=l+f),[u,c]}getBounds(e){let t=e.target||this.target,i=e.padding,r=this.options.visibilityRatio,n=Math.abs(1-r);if(this.world.hasActiveZone()){let I=this.world.getActiveZone();if(I){let A=t[3]-t[1]<I.points[3]-I.points[1],$=t[4]-t[2]<I.points[4]-I.points[2];return{minX:A?I.points[1]-i:I.points[1]+(I.points[3]-I.points[1])/2-(t[3]-t[1])/2,maxX:$?I.points[2]-i:I.points[2]+(I.points[4]-I.points[2])/2-(t[4]-t[2])/2,minY:A?I.points[3]+i:I.points[1]+(I.points[3]-I.points[1])/2-(t[3]-t[1])/2,maxY:$?I.points[4]+i:I.points[2]+(I.points[4]-I.points[2])/2-(t[4]-t[2])/2}}}let o=t[3]-t[1],l=this.world.width,u=-o*n,c=l-o-u,p=t[4]-t[2],f=this.world.height,v=-p*n,x=f-p-v,E=Math.round(Math.max(u,c)),_=Math.round(Math.min(u,c)),P=Math.round(Math.max(v,x)),O=Math.round(Math.min(v,x));return{minX:_,maxX:E,minY:O,maxY:P}}getScaleFactor(e=!1){let t=this.renderer.getScale(this.target[3]-this.target[1],this.target[4]-this.target[2],e);return t===0?this._lastGoodScale:(this._lastGoodScale=t,t)}getZoomedPosition(e,{origin:t,fromPos:i}){var r;let n=i?{width:i[3]-i[1],height:i[4]-i[2]}:void 0,o=n?this.renderer.getScale(n.width,n.height):this.getScaleFactor(),l=n?n.width:this.width,u=n?n.height:this.height,c=(r=this.getRendererScreenPosition())==null?void 0:r.width,p=this.world.width,f=c?c/p:1,v=this.options.maxUnderZoom,x=Math.max(f||1,this.options.maxOverZoom),E=1/e,_=o*E;if(E<1){let O=l*o,I=u*o,A=this.world.width/O,$=this.world.height/I;if(A>$){let z=this.world.width*_,B=~~(l*o)*v;z<B&&(e=this.world.width*o/(l*o*v))}else{let z=this.world.height*_,B=~~(u*o)*v;z<B&&(e=this.world.height*o/(u*o*v))}}else _>x&&(e=o/x);let P=Nn(this.target,za(e,t?t.x:this.target[1]+(this.target[3]-this.target[1])/2,t?t.y:this.target[2]+(this.target[4]-this.target[2])/2),this.zoomBuffer);return this.constrainBounds(P,{ref:!0,panPadding:100}),P}clampRegion({x:e,y:t,width:i,height:r,padding:n=0}){let o=this.width,l=this.height,u=i/o<r/l,c=e-n,p=t-n,f=i+n*2,v=r+n*2;if(u){let E=v/l*o;return{x:c-(E-f)/2,y:p,width:E,height:v}}let x=f/o*l;return{x:c,y:p-(x-v)/2,width:f,height:x}}viewerToWorld(e,t){let i=this.getScaleFactor();return this._viewerToWorld.x=this.target[1]+e/i,this._viewerToWorld.y=this.target[2]+t/i,this._viewerToWorld}worldToViewer(e,t,i,r){let n=ut.singleBox(i,r,e,t);return _r(n,sn($n(this.getScaleFactor()),Xi(-this.target[1],-this.target[2]))),{x:n[1],y:n[2],width:n[3]-n[1],height:n[4]-n[2],strand:n}}setScale(e,t){_r(this.target,za(e,t?t.x:this.target[1]+(this.target[3]-this.target[1])/2,t?t.y:this.target[2]+(this.target[4]-this.target[2])/2)),this.pendingUpdate=!0}syncTo(e){let t=this.target;return this.target=e.target,this.pendingUpdate=!0,()=>{this.target=t}}stop(){return typeof this.stopId<"u"&&(window.cancelAnimationFrame(this.stopId),this.stopId=void 0),()=>{this.render(performance.now())}}reset(){this.renderer.reset()}selectZone(e){this.world.selectZone(e),this.pendingUpdate=!0}deselectZone(){this.world.deselectZone(),this.pendingUpdate=!0}hook(e,t){let i=this.hooks[e].length;if(i!==0)for(let r=0;r<i;r++)this.hooks[e][r](t)}registerHook(e,t){return this.hooks[e].push(t),()=>{this.hooks[e]=this.hooks[e].filter(i=>i!==t)}}updateNextFrame(){this.pendingUpdate=!0}};typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes("firefox");var ul=!!(typeof window<"u"&&window.document&&window.document.createElement),ZE={canUseDOM:ul,canUseWorkers:typeof Worker<"u",canUseEventListeners:ul&&!!(window.addEventListener||window.attachEvent),canUseViewport:ul&&!!window.screen,isInWorker:!ul},XE=ZE,YE=XE;YE.canUseDOM&&document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","");var Dg=te.createContext("explore");Dg.displayName="Mode";function Wg(e,t,i){var r,n,o,l,u;t==null&&(t=100);function c(){var f=Date.now()-l;f<t&&f>=0?r=setTimeout(c,t-f):(r=null,i||(u=e.apply(o,n),o=n=null))}var p=function(){o=this,n=arguments,l=Date.now();var f=i&&!r;return r||(r=setTimeout(c,t)),f&&(u=e.apply(o,n),o=n=null),u};return p.clear=function(){r&&(clearTimeout(r),r=null)},p.flush=function(){r&&(u=e.apply(o,n),o=n=null,clearTimeout(r),r=null)},p}Wg.debounce=Wg;var Kh=te.createContext(null);Kh.displayName="Atlas";var Hg=te.createContext(null);Hg.displayName="Bounds";var hl,KE=typeof performance=="object"&&typeof performance.now=="function";if(KE){let e=performance;hl=()=>e.now()}else{let e=Date,t=e.now();hl=()=>e.now()-t}var qg={exports:{}},Un={};Un.ConcurrentRoot=1,Un.ContinuousEventPriority=4,Un.DefaultEventPriority=16,Un.DiscreteEventPriority=1,Un.IdleEventPriority=536870912,Un.LegacyRoot=0,qg.exports=Un;function Qg(e,t){e&&e.appendChild&&t&&e.appendChild(t)}function Vg(e,t){e&&e.removeChild&&t&&e.removeChild(t)}function JE(e,t){return Vg(e.world,t)}function eA(e,t,i){return Gg(e.world,t,i)}function Gg(e,t,i){e&&e instanceof Ug&&(e=e.world),e&&e.insertBefore&&e.insertBefore(t,i)}function Zg(e,t,i){if(i&&(e.applyProps&&e.applyProps(i),e instanceof Sr))for(let r of Na){let n=r.slice(2).toLowerCase();i[r]!==t[r]&&(t[r]&&e.removeEventListener(n,t[r]),e.addEventListener(n,i[r]))}}function Xg(e,t){let i=Object.keys(t),r=!1;for(let n of i)if(Na.indexOf(n)!==-1){let o=$h[n];if(o){if(e.activatedEvents.indexOf(o)!==-1)continue;r=!0,e.activatedEvents.push(o)}}r&&e.triggerEventActivation()}var cl=new Map,Yg={};function tA(e,t,i,r,n){var o=t,l=le(o,["args"]);if(!(i instanceof Ug)&&n){let p=f=>f.return?p(f.return):f.stateNode&&f.stateNode.containerInfo;i=p(n)}let u,c=i.world;switch(e){case"world":u=Yh.withProps({width:l.width,height:l.height,viewingDirection:"left-to-right"}),u.activatedEvents=c.activatedEvents,u.eventHandlers=c.eventHandlers,u.subscriptions=c.subscriptions,u.triggerEventActivation(),c=u;break;case"box":u=new HE;break;case"shape":u=new QE;break;case"worldObject":case"world-object":u=new el;break;case"worldImage":case"world-image":u=new Eo;break;case"texture":u=new lx;break;case"compositeImage":case"composite-image":u=new DE({id:l.id,width:l.width,height:l.height,images:[],renderOptions:l.renderOptions});break;case"tiledImage":case"tiled-image":u=Ng.fromTile(l.uri,l.display,l.tile,l.scaleFactor,void 0,l.format);break;case"paragraph":u=new VE,u.text=l.children;break;default:return}return Xg(c,l),Zg(u,{},l),u}function iA(e,t){if(t instanceof Yh)e.world=t;else if(t instanceof el)e.world.appendChild(t);else if(t)throw new Error("Invalid root")}var Mo=(0,nx.default)({unstable_now:hl,now:hl,createInstance:tA,removeChild:Vg,appendChild:Qg,appendInitialChild:Qg,insertBefore:Gg,warnsIfNotActing:!0,supportsMutation:!0,isPrimaryRenderer:!1,scheduleTimeout:typeof setTimeout<"u"?setTimeout:void 0,cancelTimeout:typeof clearTimeout<"u"?clearTimeout:void 0,setTimeout:typeof setTimeout<"u"?setTimeout:void 0,clearTimeout:typeof clearTimeout<"u"?clearTimeout:void 0,noTimeout:-1,appendChildToContainer:iA,removeChildFromContainer:JE,createTextInstance(){},insertInContainerBefore:eA,prepareUpdate(e,t,i,r,n){return Xg(n.world,r),r},commitUpdate(e,t,i,r,n,o){e.applyProps&&t&&Zg(e,r,t)},finalizeInitialChildren(e){return e==null?void 0:e.__handlers},getChildHostContext(){return Yg},getRootHostContext(){return Yg},prepareForCommit(e){return e.isCommitting=!0,null},preparePortalMount(){},hideInstance(e){e&&e.points&&(e.points[0]=0)},unhideInstance(e,t){e&&e.points&&(e.points[0]=1)},getPublicInstance(e){return e},hideTextInstance(){throw new Error("Text is not allowed in the react-three-fibre tree. You may have extraneous whitespace between components.")},resetAfterCommit(e){e.isCommitting=!1,e.pendingUpdate=!0,e.world&&e.world.needsRecalculate&&(e.world.recalculateWorldSize(),e.world.triggerRepaint())},shouldSetTextContent(){return!1},clearContainer(){return!1},supportsHydration:!1,supportsPersistence:!1,detachDeletedInstance(e){},afterActiveInstanceBlur(){},beforeActiveInstanceBlur(){},getCurrentEventPriority(){return console.log("getCurrentEventPriority"),qg.exports.DefaultEventPriority},getInstanceFromNode(e){throw console.log("getInstanceFromNode",e),new Error("Not implemented")},getInstanceFromScope(e){throw console.log("getInstanceFromScope",e),new Error("Not implemented")},prepareScopeUpdate(e,t){throw console.log("prepareScopeUpdate",e,t),new Error("Not implemented")},logRecoverableError(){},requestPostPaintCallback(){}});Mo.injectIntoDevTools({bundleType:0,version:Ts,rendererPackageName:"@atlas-viewer/atlas"});function rA(e,t){let i=cl.get(e);i&&Mo.updateContainer(null,i,null,()=>{cl.delete(e),t&&t(e)})}var Kg={render(e,t){let i=cl.get(t);if(i)Mo.updateContainer(e,i,null);else{let r=Mo.createContainer(t,0,null,!1,null,"",()=>{},null);Mo.updateContainer(e,r,null),cl.set(t,r)}},unmountComponentAtNode(e,t){rA(e,t)}},Jg=typeof window<"u"&&((vf=window.document)!=null&&vf.createElement||((bf=window.navigator)==null?void 0:bf.product)==="ReactNative")?At:de;te.memo(({children:e,setIsReady:t,onCreated:i,bounds:r,preset:n,mode:o="explore"})=>{let l=He(function(u){let c=we(!1),p=()=>{t(!0)};return de(()=>{if(n&&!c.current){n.runtime.goHome();let f=i&&i(n);return void(f&&f.then?f.then(p):p())}return()=>{}},[]),de(()=>{c.current=!0},[]),u.children},[n]);return Jg(()=>{if(n){let u=n.runtime;o!==u.mode&&(u.mode=o),Kg.render(te.createElement(te.StrictMode,null,te.createElement(l,null,te.createElement(Hg.Provider,{value:r},te.createElement(Dg.Provider,{value:o},te.createElement(Kh.Provider,{value:n},e))))),u)}},[n,o,e]),Jg(()=>{if(n){let u=n.runtime;return()=>{Kg.unmountComponentAtNode(u)}}return()=>{}},[n]),null}),te.forwardRef((e,t)=>te.createElement("div",D(C({},e),{ref:t,part:e.className})));var nA=()=>Kt(Kh),em=()=>{let e=nA();return e?e.runtime:void 0},sA=(e,t=[])=>{let i=em();de(()=>i?i.registerHook("useFrame",e):()=>{},t)};async function oA(e,t,i){if(Ts.startsWith("18.")){let r=await Promise.resolve().then(()=>je(Rh(),1)),n=r.default?r.default.createRoot:r.createRoot;i.current||(i.current=n(e)),i.current.render(t)}else if(typeof ReactDOM<"u"){let{render:r,unmountComponentAtNode:n}=ReactDOM;r(t,e),i.current={unmount(){n(e)}}}else{let r=await Promise.resolve().then(()=>(fe(),Mn)),n=r.default?r.default.render:r.render,o=r.default?r.default.unmountComponentAtNode:r.unmountComponentAtNode;n(t,e),i.current={unmount(){o(e)}}}}var aA=te.forwardRef((e,t)=>{var i=e,{children:r}=i,n=le(i,["children"]);let o=we(),l=em(),u=we(0),c=we(),p=we();return sA(()=>{var f,v,x,E;if(n.relative){let _=o.current;if(_&&l){let P=l.getScaleFactor();u.current!==P&&(u.current=P,_.style.transformOrigin="0 0",_.style.transform=`scale(${1/u.current})`,_.style.width=`${u.current*100}%`,_.style.height=`${u.current*100}%`,o.current&&((v=(f=c.current)==null?void 0:f.__owner.value)!=null&&v.rotation)&&(_.style.transform=`scale(${1/u.current}) translate(50%, 50%) rotate(${((E=(x=c.current)==null?void 0:x.__owner.value)==null?void 0:E.rotation)||0}deg)  translate(-50%, -50%)`))}}},[n.relative]),At(()=>{let f=c.current;t&&f&&(typeof t=="function"?t(f):t.current=f);async function v(){if(f&&f.__host){let x=n.relative?te.createElement("div",{ref:o},r):r;await oA(f.__host.element,x,p)}}f&&f.__host?v():f&&(f.__onCreate=v)},[t,r,c,n.relative]),At(()=>()=>{p.current&&setTimeout(()=>{p.current.unmount()},0)},[]),te.createElement("box",D(C({html:!0},n),{ref:c}))});aA.displayName="HTMLPortal",et(),et();var lA=0;function Ge(e,t,i,r,n){var o,l,u={};for(l in t)l=="ref"?o=t[l]:u[l]=t[l];var c={type:e,props:u,key:i,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--lA,__source:n,__self:r};if(typeof e=="function"&&(o=e.defaultProps))for(l in o)u[l]===void 0&&(u[l]=o[l]);return Ce.vnode&&Ce.vnode(c),c}var uA={id:"https://iiif-parser/annotation-page",type:"AnnotationPage",behavior:[],motivation:null,label:null,thumbnail:[],summary:null,requiredStatement:null,metadata:[],rights:null,provider:[],items:[],seeAlso:[],homepage:[],logo:[],rendering:[],service:[]},hA={id:"https://iiif-parser/empty-canvas",type:"Canvas",label:null,behavior:[],motivation:null,thumbnail:[],posterCanvas:null,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:[],rights:null,navDate:null,provider:[],items:[],annotations:[],seeAlso:[],homepage:[],logo:[],partOf:[],rendering:[],service:[],duration:0,height:0,width:0},cA={id:"https://iiif-parser/empty-collection",type:"Collection",label:null,viewingDirection:"left-to-right",behavior:[],motivation:null,thumbnail:[],posterCanvas:null,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:[],rights:null,navDate:null,provider:[],items:[],annotations:[],seeAlso:[],homepage:[],logo:[],partOf:[],rendering:[],service:[],services:[]},dA={id:"https://iiif-parser/empty-manifest",type:"Manifest",annotations:[],behavior:[],homepage:[],items:[],label:null,logo:[],metadata:[],motivation:null,navDate:null,provider:[],partOf:[],posterCanvas:null,accompanyingCanvas:null,placeholderCanvas:null,rendering:[],requiredStatement:null,rights:null,seeAlso:[],service:[],services:[],start:null,structures:[],summary:null,thumbnail:[],viewingDirection:"left-to-right"},pA={id:"https://iiif-parser/empty-canvas",type:"Range",label:null,behavior:[],motivation:null,thumbnail:[],posterCanvas:null,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:[],rights:null,navDate:null,provider:[],items:[],annotations:[],seeAlso:[],homepage:[],logo:[],partOf:[],rendering:[],service:[],start:null,supplementary:null,viewingDirection:"left-to-right"},fA={id:"https://iiif-parser/empty-agent",type:"Agent",label:{},logo:[],seeAlso:[],homepage:[]},tm=["Collection","Manifest","Canvas","AnnotationPage","AnnotationCollection","Annotation","ContentResource","Range","Service","Selector","Agent"];function gA(e){if(typeof e>"u"||e===null)throw new Error("Null or undefined is not a valid entity.");if(Array.isArray(e))throw new Error("Array is not a valid entity");if(typeof e!="object")throw new Error(`${typeof e} is not a valid entity`);if(typeof e.type=="string"){let t=tm.indexOf(e.type);if(t!==-1)return tm[t]}if(e.profile)return"Service";throw new Error("Resource type is not known")}var im=class{constructor(e,t={}){Ze(this,"traversals"),Ze(this,"options"),this.traversals=C({collection:[],manifest:[],canvas:[],annotationCollection:[],annotationPage:[],annotation:[],contentResource:[],choice:[],range:[],service:[],agent:[]},e),this.options=C({allowUndefinedReturn:!1},t)}static all(e){return new im({collection:[e],manifest:[e],canvas:[e],annotationCollection:[e],annotationPage:[e],annotation:[e],contentResource:[e],choice:[e],range:[e],service:[e]})}traverseDescriptive(e){return e.thumbnail&&(e.thumbnail=e.thumbnail.map(t=>this.traverseType(t,this.traversals.contentResource))),e.provider&&(e.provider=e.provider.map(t=>this.traverseAgent(t))),e}traverseLinking(e){return e.seeAlso&&(e.seeAlso=e.seeAlso.map(t=>this.traverseType(t,this.traversals.contentResource))),e.service&&(e.service=e.service.map(t=>this.traverseType(t,this.traversals.service))),e.services&&(e.services=e.services.map(t=>this.traverseType(t,this.traversals.service))),e.logo&&(e.logo=e.logo.map(t=>this.traverseType(t,this.traversals.contentResource))),e.homepage&&(e.homepage=e.homepage.map(t=>this.traverseType(t,this.traversals.contentResource))),e.partOf&&(e.partOf=e.partOf.map(t=>typeof t=="string"||!t.type?this.traverseType(t,this.traversals.contentResource):t.type==="Canvas"?this.traverseType(t,this.traversals.canvas):t.type==="AnnotationCollection"?this.traverseType(t,this.traversals.annotationCollection):this.traverseType(t,this.traversals.contentResource))),e.start&&(e.start=e.start?this.traverseType(e.start,this.traversals.canvas):null),e.rendering&&(e.rendering=e.rendering.map(t=>this.traverseType(t,this.traversals.contentResource))),e.supplementary&&(e.supplementary=e.supplementary.map(t=>this.traverseType(t,this.traversals.contentResource))),e}traverseCollectionItems(e){return e.items&&e.items.map(t=>t.type==="Collection"?this.traverseCollection(t):this.traverseManifest(t)),e}traverseCollection(e){return this.traverseType(this.traverseDescriptive(this.traverseInlineAnnotationPages(this.traverseLinking(this.traversePosterCanvas(this.traverseCollectionItems(e))))),this.traversals.collection)}traverseManifestItems(e){return e.items&&(e.items=e.items.map(t=>this.traverseCanvas(t))),e}traverseManifestStructures(e){return e.structures&&(e.structures=e.structures.map(t=>this.traverseRange(t))),e}traverseManifest(e){return this.traverseType(this.traverseInlineAnnotationPages(this.traverseManifestStructures(this.traversePosterCanvas(this.traverseDescriptive(this.traverseLinking(this.traverseManifestItems(e)))))),this.traversals.manifest)}traverseCanvasItems(e){return e.items=(e.items||[]).map(t=>this.traverseAnnotationPage(t)),e}traverseInlineAnnotationPages(e){return typeof e=="string"||!e||e.annotations&&(e.annotations=e.annotations.map(t=>this.traverseAnnotationPage(t))),e}traverseCanvas(e){return this.traverseType(this.traverseInlineAnnotationPages(this.traversePosterCanvas(this.traverseDescriptive(this.traverseLinking(this.traverseCanvasItems(e))))),this.traversals.canvas)}traverseAnnotationPageItems(e){return e.items&&(e.items=e.items.map(t=>this.traverseAnnotation(t))),e}traverseAnnotationPage(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseAnnotationPageItems(e))),this.traversals.annotationPage)}traverseAnnotationBody(e){return Array.isArray(e.body)?e.body=e.body.map(t=>this.traverseContentResource(t)):e.body&&(e.body=this.traverseContentResource(e.body)),e}traversePosterCanvas(e){return e.posterCanvas&&(e.posterCanvas=this.traverseType(e.posterCanvas,this.traversals.canvas)),e.placeholderCanvas&&(e.placeholderCanvas=this.traverseType(e.placeholderCanvas,this.traversals.canvas)),e.accompanyingCanvas&&(e.accompanyingCanvas=this.traverseType(e.accompanyingCanvas,this.traversals.canvas)),e}traverseAnnotation(e){return this.traverseType(this.traverseLinking(this.traverseAnnotationBody(e)),this.traversals.annotation)}traverseContentResourceLinking(e){return typeof e=="string"||!e||e&&e.service&&(e.service=(e.service||[]).map(t=>this.traverseType(t,this.traversals.service))),e}traverseContentResource(e){return e.type==="Choice"&&(e.items=e.items.map(t=>this.traverseContentResource(t))),this.traverseType(this.traverseInlineAnnotationPages(this.traverseContentResourceLinking(e)),this.traversals.contentResource)}traverseRangeRanges(e){return e.items&&(e.items=e.items.map(t=>typeof t=="string"?this.traverseCanvas({id:t,type:"Canvas"}):t.type==="Manifest"?this.traverseManifest(t):this.traverseRange(t))),e}traverseRange(e){return this.traverseType(this.traversePosterCanvas(this.traverseDescriptive(this.traverseLinking(this.traverseRangeRanges(e)))),this.traversals.range)}traverseAgent(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(e)),this.traversals.agent)}traverseType(e,t){return t.reduce((i,r)=>{let n=r(i);return typeof n>"u"&&!this.options.allowUndefinedReturn?i:n},e)}traverseService(e){return this.traverseType(e,this.traversals.service)}traverseUnknown(e){let t=gA(e);switch(t){case"Collection":return this.traverseCollection(e);case"Manifest":return this.traverseManifest(e);case"Canvas":return this.traverseCanvas(e);case"AnnotationPage":return this.traverseAnnotationPage(e);case"Annotation":return this.traverseAnnotation(e);case"ContentResource":return this.traverseContentResource(e);case"Range":return this.traverseRange(e);case"Service":return this.traverseService(e);case"Agent":return this.traverseAgent(e);default:throw new Error(`Unknown or unsupported resource type of ${t}`)}}},rm=["sc:Collection","sc:Manifest","sc:Canvas","oa:AnnotationList","oa:Annotation","sc:Range","sc:Layer","sc:Sequence","oa:Choice","Service","ContentResource"];function mA(e){if(typeof e>"u"||e===null)throw new Error("Null or undefined is not a valid entity.");if(Array.isArray(e))throw new Error("Array is not a valid entity");if(typeof e!="object")throw new Error(`${typeof e} is not a valid entity`);if(typeof e["@type"]=="string"){let t=rm.indexOf(e["@type"]);if(t!==-1)return rm[t]}if(e.profile)return"Service";if(e.format||e["@type"])return"ContentResource";throw new Error("Resource type is not known")}var nm=class{constructor(e,t={}){Ze(this,"traversals"),Ze(this,"options"),this.traversals=C({collection:[],manifest:[],canvas:[],annotationList:[],sequence:[],annotation:[],contentResource:[],choice:[],range:[],service:[],layer:[]},e),this.options=C({convertPropsToArray:!0,mergeMemberProperties:!0,allowUndefinedReturn:!1},t)}static all(e){return new nm({collection:[e],manifest:[e],canvas:[e],annotationList:[e],sequence:[e],annotation:[e],contentResource:[e],choice:[e],range:[e],service:[e],layer:[e]})}traverseCollection(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseCollectionItems(e))),this.traversals.collection)}traverseCollectionItems(e){if(this.options.mergeMemberProperties){let t=[...(e.manifests||[]).map(i=>typeof i=="string"?{"@id":i,"@type":"sc:Manifest"}:i),...(e.collections||[]).map(i=>typeof i=="string"?{"@id":i,"@type":"sc:Collection"}:i),...e.members||[]];delete e.collections,delete e.manifests,e.members=t}return e.manifests&&(e.manifests=e.manifests.map(t=>this.traverseManifest(typeof t=="string"?{"@id":t,"@type":"sc:Manifest"}:t))),e.collections&&(e.collections=e.collections.map(t=>this.traverseCollection(typeof t=="string"?{"@id":t,"@type":"sc:Collection"}:t))),e.members&&(e.members=e.members.map(t=>typeof t=="string"?t:this.traverseUnknown(t))),e}traverseManifest(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseManifestItems(e))),this.traversals.manifest)}traverseManifestItems(e){return e.sequences&&(e.sequences=e.sequences.map(t=>this.traverseSequence(t))),e.structures&&(e.structures=e.structures.map(t=>this.traverseRange(t))),e}traverseSequence(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseSequenceItems(e))),this.traversals.sequence)}traverseSequenceItems(e){return e.canvases&&(e.canvases=e.canvases.map(t=>this.traverseCanvas(t))),e}traverseCanvas(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseCanvasItems(e))),this.traversals.canvas)}traverseCanvasItems(e){return e.images&&(e.images=e.images.map(t=>this.traverseAnnotation(t))),e.otherContent&&(e.otherContent=e.otherContent.map(t=>this.traverseAnnotationList(t))),e}traverseRange(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseRangeItems(e))),this.traversals.range)}traverseRangeItems(e){if(this.options.mergeMemberProperties){let t=[...(e.ranges||[]).map(i=>typeof i=="string"?{"@id":i,"@type":"sc:Range"}:i),...(e.canvases||[]).map(i=>typeof i=="string"?{"@id":i,"@type":"sc:Canvas"}:i),...e.members||[]];delete e.ranges,delete e.canvases,e.members=t.length?t.map(i=>this.traverseUnknown(i)):void 0}return e}traverseAnnotationList(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseAnnotationListItems(e))),this.traversals.annotationList)}traverseAnnotationListItems(e){return e.resources&&(e.resources=e.resources.map(t=>this.traverseAnnotation(t))),e}traverseAnnotation(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseAnnotationItems(e))),this.traversals.annotation)}traverseAnnotationItems(e){return e.resource&&(e.resource=this.traverseContentResource(e.resource)),e.on,e}traverseLayer(e){return this.traverseType(this.traverseLinking(this.traverseLayerItems(e)),this.traversals.layer)}traverseLayerItems(e){return e.otherContent&&(e.otherContent=e.otherContent.map(t=>this.traverseAnnotationList(t))),e}traverseChoice(e){return this.traverseType(this.traverseChoiceItems(e),this.traversals.choice)}traverseChoiceItems(e){return e.default&&e.default!=="rdf:nil"&&(e.default=this.traverseContentResource(e.default)),e.item&&e.item!=="rdf:nil"&&(e.item=e.item.map(t=>this.traverseContentResource(t))),e}traverseService(e){return this.traverseType(this.traverseLinking(e),this.traversals.service)}traverseContentResource(e){return e["@type"]==="oa:Choice"?this.traverseChoice(e):this.traverseType(this.traverseDescriptive(this.traverseLinking(e)),this.traversals.contentResource)}traverseUnknown(e){if(!e["@type"]||typeof e=="string")return e;switch(mA(e)){case"sc:Collection":return this.traverseCollection(e);case"sc:Manifest":return this.traverseManifest(e);case"sc:Canvas":return this.traverseCanvas(e);case"sc:Sequence":return this.traverseSequence(e);case"sc:Range":return this.traverseRange(e);case"oa:Annotation":return this.traverseAnnotation(e);case"oa:AnnotationList":return this.traverseAnnotationList(e);case"sc:Layer":return this.traverseLayer(e);case"Service":return this.traverseService(e);case"oa:Choice":return this.traverseChoice(e);case"ContentResource":return this.traverseContentResource(e)}return e.profile?this.traverseService(e):e}traverseImageResource(e){let t=Array.isArray(e),i=Array.isArray(e)?e:[e],r=[];for(let n of i)typeof n=="string"?r.push(this.traverseContentResource({"@id":n,"@type":"dctypes:Image"})):r.push(this.traverseContentResource(n));return!t&&!this.options.convertPropsToArray?r[0]:r}traverseDescriptive(e){return e.thumbnail&&(e.thumbnail=this.traverseImageResource(e.thumbnail)),e.logo&&(e.logo=this.traverseImageResource(e.logo)),e}traverseOneOrMoreServices(e){let t=Array.isArray(e),i=Array.isArray(e)?e:[e],r=[];for(let n of i)r.push(this.traverseService(n));return!t&&!this.options.convertPropsToArray?r[0]:r}traverseLinking(e){return e.related&&(e.related=this.traverseOneOrManyType(e.related,this.traversals.contentResource)),e.rendering&&(e.rendering=this.traverseOneOrManyType(e.rendering,this.traversals.contentResource)),e.service&&(e.service=this.traverseOneOrMoreServices(e.service)),e.seeAlso&&(e.seeAlso=this.traverseOneOrManyType(e.seeAlso,this.traversals.contentResource)),e.within&&(typeof e.within=="string"||(e.within=this.traverseOneOrManyType(e.within,this.traversals.contentResource))),e.startCanvas&&(typeof e.startCanvas=="string"?e.startCanvas=this.traverseType({"@id":e.startCanvas,"@type":"sc:Canvas"},this.traversals.canvas):e.startCanvas&&this.traverseType(e.startCanvas,this.traversals.canvas)),e.contentLayer&&(typeof e.contentLayer=="string"?e.contentLayer=this.traverseLayer({"@id":e.contentLayer,"@type":"sc:Layer"}):e.contentLayer=this.traverseLayer(e.contentLayer)),e}traverseOneOrManyType(e,t){if(!Array.isArray(e))if(this.options.convertPropsToArray)e=[e];else return this.traverseType(e,t);return e.map(i=>this.traverseType(i,t))}traverseType(e,t){return t.reduce((i,r)=>{let n=r(i);return typeof n>"u"&&!this.options.allowUndefinedReturn?i:n},e)}},yA="http://library.stanford.edu/iiif/image-api/compliance.html#level0",sm="http://library.stanford.edu/iiif/image-api/compliance.html#level1",om="http://library.stanford.edu/iiif/image-api/compliance.html#level2",vA="http://library.stanford.edu/iiif/image-api/conformance.html#level0",am="http://library.stanford.edu/iiif/image-api/conformance.html#level1",lm="http://library.stanford.edu/iiif/image-api/conformance.html#level2",bA="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",um="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",hm="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",wA="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",cm="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",dm="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",xA="http://iiif.io/api/image/1/level0.json",_A="http://iiif.io/api/image/1/profiles/level0.json",pm="http://iiif.io/api/image/1/level1.json",fm="http://iiif.io/api/image/1/profiles/level1.json",gm="http://iiif.io/api/image/1/level2.json",mm="http://iiif.io/api/image/1/profiles/level2.json",SA="http://iiif.io/api/image/2/level0.json",EA="http://iiif.io/api/image/2/profiles/level0.json",ym="http://iiif.io/api/image/2/level1.json",vm="http://iiif.io/api/image/2/profiles/level1.json",bm="http://iiif.io/api/image/2/level2.json",wm="http://iiif.io/api/image/2/profiles/level2.json",AA="level0",xm="level1",_m="level2",kA="http://iiif.io/api/image/2/level0",Sm="http://iiif.io/api/image/2/level1",Em="http://iiif.io/api/image/2/level2",PA=[Sm,Em,sm,om,am,lm,um,hm,cm,dm,pm,fm,gm,mm,ym,vm,bm,wm,xm,_m],CA=[kA,Sm,Em,yA,sm,om,vA,am,lm,bA,um,hm,wA,cm,dm,xA,_A,pm,fm,gm,mm,SA,EA,ym,vm,bm,wm,AA,xm,_m],Jh={attributionLabel:"Attribution",lang:"none",providerId:"http://example.org/provider",providerName:"Unknown"};function Dn(e,t="none"){if(!e)return{};let i=Array.isArray(e)?e:[e],r={};for(let n of i){if(typeof n=="string"){r[t]=r[t]?r[t]:[],r[t].push(n||"");continue}if(!n["@language"]){r[t]=r[t]?r[t]:[],r[t].push(n["@value"]||"");continue}let o=n["@language"];r[o]=r[o]?r[o]:[],r[o].push(n["@value"]||"")}return r}function Am(e){if(Array.isArray(e))return Am(e.find(t=>typeof t=="string"));if(CA.indexOf(e)!==-1)return"level2";if(PA.indexOf(e)!==-1)return"level1";if(typeof e=="string")return e}function TA(e){let t=Array.isArray(e)?e:[e];for(let i of t)switch(i){case"http://iiif.io/api/image/2/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2":return"ImageService2";case"http://iiif.io/api/image/1/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/context.json":return"ImageService1";case"http://iiif.io/api/annex/openannotation/context.json":return"ImageApiSelector"}}function IA(e){switch(e){case"http://iiif.io/api/image/2/level0.json":case"http://iiif.io/api/image/2/level1.json":case"http://iiif.io/api/image/2/level2.json":return"ImageService2";case"http://iiif.io/api/auth/1/kiosk":case"http://iiif.io/api/auth/1/login":case"http://iiif.io/api/auth/1/clickthrough":case"http://iiif.io/api/auth/1/external":case"http://iiif.io/api/auth/0/kiosk":case"http://iiif.io/api/auth/0/login":case"http://iiif.io/api/auth/0/clickthrough":case"http://iiif.io/api/auth/0/external":return"AuthCookieService1";case"http://iiif.io/api/auth/1/token":case"http://iiif.io/api/auth/0/token":return"AuthTokenService1";case"http://iiif.io/api/auth/1/logout":case"http://iiif.io/api/auth/0/logout":return"AuthLogoutService1";case"http://iiif.io/api/search/1/search":case"http://iiif.io/api/search/0/search":return"SearchService1";case"http://iiif.io/api/search/1/autocomplete":case"http://iiif.io/api/search/0/autocomplete":return"AutoCompleteService1"}}function OA(e){return Array.isArray(e)?e:[e]}function RA(e){for(let t of["sc","oa","dcterms","dctypes","iiif"])if(e.startsWith(`${t}:`))return e.slice(t.length+1);return e}var MA=["Collection","Manifest","Annotation","AnnotationPage","Range","Service"];function ec(e){let t=e["@id"]||e.id,i=e["@type"]||e.type,r=e.profile||void 0,n=e["@context"]||void 0;if(r){let o=IA(r);if(o)return o}if(n){let o=TA(n);if(o)return o}if(i){if(Array.isArray(i)){if(i.indexOf("oa:CssStylesheet")!==-1)return"CssStylesheet";if(i.indexOf("cnt:ContentAsText")!==-1)return"TextualBody";i=i[0]}for(let o of["sc","oa","dcterms","dctypes","iiif"])if(i.startsWith(`${o}:`)){i=i.slice(o.length+1);break}switch(i){case"Layer":return"AnnotationCollection";case"AnnotationList":return"AnnotationPage";case"cnt:ContentAsText":return"TextualBody"}}if(i&&MA.indexOf(i)!==-1)return i;if(e.format){if(e.format.startsWith("image/"))return"Image";if(e.format.startsWith("text/")||e.format==="application/pdf")return"Text";if(e.format.startsWith("application/"))return"Dataset"}return t&&(t.endsWith(".jpg")||t.endsWith(".png")||t.endsWith(".jpeg"))?"Image":i||"unknown"}var LA=/http(s)?:\/\/(creativecommons.org|rightsstatements.org)[^"'\\<\n]+/gm;function $A(e){let t=e.match(LA);return t?t[0]:e}function NA(e,t="Rights/License",i="none"){let r=null,n=[],o=Array.isArray(e)?e:[e];for(let l of o){let u=l?$A(l):void 0;if(u&&(u.indexOf("creativecommons.org")!==-1||u.indexOf("rightsstatements.org")!==-1)){u.startsWith("https://")?r=`http://${u.slice(8)}`:r=u;continue}u&&n.push({label:{[i]:[t]},value:{[i]:[u]}})}return[r,n]}var zA=["http://iiif.io/api/presentation/2/context.json","http://iiif.io/api/image/2/context.json","http://iiif.io/api/image/1/context.json","http://library.stanford.edu/iiif/image-api/1.1/context.json","http://iiif.io/api/search/1/context.json","http://iiif.io/api/search/0/context.json","http://iiif.io/api/auth/1/context.json","http://iiif.io/api/auth/0/context.json","http://iiif.io/api/annex/openannotation/context.json"];function FA(e){if(e){let t=Array.isArray(e)?e:[e],i=[];for(let r of t)r==="http://iiif.io/api/presentation/2/context.json"&&i.push("http://iiif.io/api/presentation/3/context.json"),zA.indexOf(r)===-1&&i.push(r);if(t.length)return i.length===1?i[0]:i}}function BA(e){return e?e.map(t=>({label:Dn(t.label),value:Dn(t.value)})):[]}function Wr(e){for(let t in e)(typeof e[t]>"u"||e[t]===null)&&delete e[t];return e}var km=0;function Pm(e,t){let i=encodeURI(e.id||e["@id"]||"").trim();return i&&t?`${i}/${t}`:i||(km++,`http://example.org/${e["@type"]}${t?`/${t}`:""}/${km}`)}function Hr(e){let t=[...e.behavior||[]];return e.viewingHint&&t.push(e.viewingHint),{"@context":e["@context"]?FA(e["@context"]):void 0,id:(e["@id"]||Pm(e)).trim(),type:ec(e),behavior:t.length?t:void 0,height:e.height?e.height:void 0,width:e.width?e.width:void 0,motivation:e.motivation?RA(e.motivation):void 0,viewingDirection:e.viewingDirection,profile:e.profile,format:e.format?e.format:void 0,duration:void 0,timeMode:void 0}}function Ar(e){let[t,i]=NA(e.license),r=[...e.metadata?BA(e.metadata):[],...i];return{rights:t,metadata:r.length?r:void 0,label:e.label?Dn(e.label):void 0,requiredStatement:e.attribution?{label:Dn(Jh.attributionLabel),value:Dn(e.attribution)}:void 0,navDate:e.navDate,summary:e.description?Dn(e.description):void 0,thumbnail:e.thumbnail}}function jA(e){if(!e.within)return;let t=Array.isArray(e.within)?e.within:[e.within],i=[];for(let r of t)if(typeof r=="string"){if(r)switch(e["@type"]){case"sc:Manifest":i.push({id:r,type:"Collection"});break}}else r["@id"]&&i.push({id:r["@id"],type:ec(r)});return i.length?i:void 0}function un(e){let t=e.related?Array.isArray(e.related)?e.related:[e.related]:[],i=e.contentLayer;return{provider:e.logo||t.length?[{id:Jh.providerId,type:"Agent",homepage:t.length?[t[0]]:void 0,logo:e.logo?Array.isArray(e.logo)?e.logo:[e.logo]:void 0,label:Dn(Jh.providerName)}]:void 0,partOf:jA(e),rendering:e.rendering,seeAlso:e.seeAlso,start:e.startCanvas,service:e.service?OA(e.service):void 0,supplementary:i?[i]:void 0}}function UA(e){return Wr(D(C(C(C({},Hr(e)),Ar(e)),un(e)),{items:e.members}))}function DA(e){let t=[],i=[];for(let n of e.sequences||[])n.canvases.length&&t.push(...n.canvases),n.behavior&&i.push(...n.behavior);let r=Hr(e);return i.length&&(r.behavior?r.behavior.push(...i):r.behavior=i),Wr(D(C(C(C({},r),Ar(e)),un(e)),{items:t,structures:e.structures}))}function WA(e){return Wr(D(C(C(C({},Hr(e)),Ar(e)),un(e)),{items:e.images&&e.images.length?[{id:Pm(e,"annotation-page"),type:"AnnotationPage",items:e.images}]:void 0}))}function HA(e){return Wr(D(C(C(C({},Hr(e)),Ar(e)),un(e)),{items:e.resources}))}function qA(e){return!e.canvases||e.canvases.length===0?{canvases:[],behavior:[]}:{canvases:e.canvases,behavior:e.viewingHint?[e.viewingHint]:[]}}function QA(e){return Wr(D(C(C(C({},Hr(e)),Ar(e)),un(e)),{target:typeof e.on=="string"?encodeURI(e.on).trim():e.on,body:e.resource}))}function VA(e){let t=e;return Wr(C(C(C({},Hr(t)),Ar(t)),un(t)))}function GA(e){let t=[];return e.default&&e.default!=="rdf:nil"&&t.push(e.default),e.item&&e.item!=="rdf:nil"&&t.push(...e.item),D(C(C({},Hr(e)),Ar(e)),{items:t})}function ZA(e){return Wr(D(C(C(C({},Hr(e)),Ar(e)),un(e)),{items:e.members}))}function XA(e){let t=e,{"@id":i,"@type":r,"@context":n,profile:o}=t,l=le(t,["@id","@type","@context","profile"]);return i&&(l.id=i),l.type=ec(e),l.type==="unknown"&&(l.type="Service"),o&&(l.profile=Am(o)),Wr(C(C({},l),Ar(l)))}function YA(e){return Wr(C(C(C({},Hr(e)),Ar(e)),un(e)))}var KA=new nm({collection:[UA],manifest:[DA],canvas:[WA],annotationList:[HA],sequence:[qA],annotation:[QA],contentResource:[VA],choice:[GA],range:[ZA],service:[XA],layer:[YA]});function JA(e){return e&&e["@context"]&&(e["@context"]==="http://iiif.io/api/presentation/2/context.json"||e["@context"].indexOf("http://iiif.io/api/presentation/2/context.json")!==-1||e["@context"]==="http://www.shared-canvas.org/ns/context.json")||e["@context"]==="http://iiif.io/api/image/2/context.json"?KA.traverseUnknown(e):e}function ek(){return{Collection:{},Manifest:{},Canvas:{},AnnotationPage:{},AnnotationCollection:{},Annotation:{},ContentResource:{},Range:{},Service:{},Selector:{},Agent:{}}}function Cm(e,t){if(typeof e=="string")return{id:e,type:t};if(!e.id)throw new Error(`Invalid resource does not have an ID (${t})`);return e}function tk(e){return(t,i)=>{let r=e[t]?e[t]:{};return n=>{let o=Cm(n,i||t);return o&&o.id&&t?(r[o.id]=r[o.id]?Object.assign({},r[o.id],o):Object.assign({},o),{id:o.id,type:t==="ContentResource"?t:o.type}):o}}}function ik(e){return(t,i)=>r=>{let{id:n,type:o}=Cm(r,i||t);if(typeof n>"u")throw new Error("Found invalid entity without an ID.");return t==="ContentResource"?e[n]=t:e[n]=o,r}}function rk(e){let t=JSON.stringify(e),i=5381,r=t.length;for(;r;)i=i*33^t.charCodeAt(--r);let n=(i>>>0).toString(16);return n.length%2?"0"+n:n}function tc(e){return t=>typeof t=="string"?{id:t,type:e}:t.id?t.type?t:C({type:e},t):C({id:rk(t),type:e},t)}function Bs(e){return t=>C(C({},e),t)}function js(e){return Array.isArray(e)?e:[e]}function nk(e){return e.body&&(e.body=js(e.body)),e.seeAlso&&(e.seeAlso=js(e.seeAlso)),e.body&&(e.body=js(e.body)),e.audience&&(e.audience=js(e.audience)),e.accessibility&&(e.accessibility=js(e.accessibility)),e.motivation&&(e.motivation=js(e.motivation)),e}function Tm(e){let t=JA(e),i=ek(),r={},n=tk(i),o=ik(r),l=new im({collection:[Bs(cA),o("Collection"),n("Collection")],manifest:[Bs(dA),o("Manifest"),n("Manifest")],canvas:[Bs(hA),o("Canvas"),n("Canvas")],annotationPage:[tc("AnnotationPage"),Bs(uA),o("AnnotationPage"),n("AnnotationPage")],annotation:[tc("Annotation"),nk,o("Annotation"),n("Annotation")],contentResource:[tc("ContentResource"),o("ContentResource"),n("ContentResource")],range:[Bs(pA),o("Range","Canvas"),n("Range","Canvas")],agent:[Bs(fA),o("Agent"),n("Agent")]}).traverseUnknown(t);return{entities:i,resource:l,mapping:r}}var Wn="__$UNSET$__",Im="__$UNWRAP$__";function sk(e,t){let i=e.requests[t],r=e.mapping[t];if(!(!r||i&&i.resourceUri&&!e.entities[r][i.resourceUri]))return e.entities[r][i?i.resourceUri:t]}function ok(e){let t={};for(let[i,r]of e){if(i===Im&&r!==Wn)return r;r!==Wn&&typeof r<"u"&&r!==null&&(t[i]=r)}return t}function Om(e,t,i){if(!t.type||!t.id)throw new Error("Unknown entity");if(!i[t.type])throw new Error(`Serializer not found for ${t.type}`);function r(n){let o=i[n.type];if(!o)return Wn;let l=sk(e,n.id)||(n.id&&n.type?n:null);if(!l)return Wn;let u=o(l,e,{isTopLevel:t.id===n.id}),c=u.next();for(;!c.done;){let p=c.value,f=Wn;if(p)if(Array.isArray(p)){let v=[];for(let x of p)v.push(r(x));f=v}else f=r(p);c=u.next(f)}return c.value===Wn?Wn:ok(c.value)}return r(t)}function Us(e){if(!e)return;let t=Object.keys(e);if(t.length!==0){if(t.length===1){let i=t[0];if(!i)return"";let r=(e[i]||[]).join("");return i==="@none"||i==="none"||i==="en"?r:{"@language":i,"@value":r}}return t.map(i=>({"@language":i,"@value":(e[i]||[]).join("")}))}}function Rm(e){return Array.isArray(e)?e.map(t=>Rm(t)):typeof e=="string"?e:e.type&&e.type==="Canvas"?e.id:e}function hn(e,t=!1){if(e)return e.length>1&&!t?e:e[0]||void 0}function ak(e){if(e){if(typeof e=="string")return{"@id":e};if("@id"in e){let t=C({},e);return delete t["@type"],t}return{"@context":"http://iiif.io/api/image/2/context.json","@id":e.id,profile:`http://iiif.io/api/image/2/profiles/${e.profile}.json`}}}function Hn(e,t){return[["@id",e.id],["@type",t],["format",e.format],["height",e.height],["width",e.width],["viewingDirection",e.viewingDirection!=="left-to-right"?e.viewingDirection:void 0]]}function*qn(e){let t=e.provider?yield e.provider[0]:void 0;return[["label",Us(e.label)],["metadata",e.metadata&&e.metadata.length?e.metadata.map(i=>({label:Us(i.label)||"",value:Us(i.value)||""})):void 0],["description",Us(e.summary)],["thumbnail",hn(yield e.thumbnail)],["navDate",e.navDate],["logo",t?hn(t.logo):void 0],["homepage",t?t.homepage:void 0],["attribution",e.requiredStatement?Us(e.requiredStatement.value):void 0]]}function*Lo(e){return[["seeAlso",hn(yield e.seeAlso)],["service",hn((e.service||[]).map(ak))],["rendering",hn(yield e.rendering)],["startCanvas",e.start?e.start.id:void 0]]}var Mm={Manifest:function*(e){return[...Hn(e,"sc:Manifest"),...yield*qn(e),...yield*Lo(e),["sequences",[{"@id":`${e.id}/sequence0`,"@type":"sc:Sequence",canvases:yield e.items}]],["structures",yield e.structures]]},Canvas:function*(e){let t=(yield e.items)[0];return[...Hn(e,"sc:Canvas"),...yield*qn(e),...yield*Lo(e),["images",t?[t.resources]:void 0],["annotations",e.annotations&&e.annotations.length?hn(yield e.annotations):void 0]]},AnnotationPage:function*(e){return[...Hn(e,"sc:AnnotationList"),...yield*qn(e),["resources",e.items&&e.items.length?hn(yield e.items):void 0]]},Annotation:function*(e){return[["@id",e.id],["@type","oa:Annotation"],["motivation","sc:painting"],["on",Rm(e.target)],["resource",hn(yield e.body,!0)]]},ContentResource:function*(e){switch(e.type){case"Image":return[...Hn(e,"dctypes:Image"),...yield*qn(e),...yield*Lo(e)];case"Text":case"Dataset":default:return[...Hn(e,void 0),...yield*qn(e)]}},AnnotationCollection:function*(e){return[["@id",e.id],["@type","sc:Layer"],["label",Us(e.label)]]},Collection:function*(e){return[...Hn(e,"sc:Collection"),...yield*qn(e),...yield*Lo(e),["members",yield*e.items]]},Range:function*(e){let t=[],i=[];if(e.items)for(let r of e.items){let n=yield r;t.push({"@id":r.id,"@type":r.type,label:n?n.label:void 0,within:e.id}),r.type==="Canvas"&&i.push(r.id)}return[...Hn(e,"sc:Range"),...yield*qn(e),...yield*Lo(e),["canvases",i.length===t.length?i:void 0],["members",i.length!==t.length?t:void 0]]}};function Qn(e){return[["id",e.id],["type",e.type],["format",e.format],["profile",e.profile],["height",e.height],["width",e.width],["duration",e.duration||void 0],["viewingDirection",e.viewingDirection!=="left-to-right"?e.viewingDirection:void 0],["behavior",e.behavior&&e.behavior.length?e.behavior:void 0],["timeMode",e.timeMode],["motivation",e.motivation]]}function yi(e){if(!(!e||e.length===0))return e}function Lm(e){if(e&&e.type&&e.type==="ImageService2"){let t=e,{id:i,type:r,profile:n}=t,o=le(t,["id","type","profile"]);return C({"@id":i,"@type":r,profile:n.startsWith("http")?n:`http://iiif.io/api/image/2/${n}.json`},o)}return e}function $m(e){if(!(!e||e.length===0))return e.map(Lm)}function*Vn(e){return[["label",e.label],["metadata",yi(e.metadata)],["summary",e.summary],["requiredStatement",e.requiredStatement],["rights",e.rights],["navDate",e.navDate],["language",e.language],["thumbnail",yi(yield e.thumbnail)],["placeholderCanvas",yield e.placeholderCanvas],["accompanyingCanvas",yield e.accompanyingCanvas],["provider",yi(yield e.provider)]]}function*Gn(e){return[["seeAlso",yi(yield e.seeAlso)],["service",$m(e.service)],["services",$m(e.services)],["rendering",yi(yield e.rendering)],["supplementary",yi(yield e.supplementary)],["homepage",yi(yield e.homepage)],["logo",yi(yield e.logo)],["partOf",yi(yield e.partOf)],["start",e.start]]}var Nm={Manifest:function*(e,t,{isTopLevel:i}){return i?[["@context","http://iiif.io/api/presentation/3/context.json"],...Qn(e),...yield*Vn(e),...yield*Gn(e),["items",yield e.items],["structures",yi(yield e.structures)],["annotations",yi(yield e.annotations)]]:[...Qn(e),...yield*Vn(e)]},Canvas:function*(e){return[...Qn(e),...yield*Vn(e),...yield*Gn(e),["items",yield e.items],["annotations",yi(yield e.annotations)]]},Agent:function*(e){return[["id",e.id],["type","Agent"],["label",e.label],...yield*Gn(e)]},AnnotationPage:function*(e){return[...Object.entries(e).map(([t,i])=>[t,Array.isArray(i)?yi(i):i]).filter(([t,i])=>t!=="items"),...yield*Gn(e),["items",yield e.items]]},Service:function*(e){return[[Im,Lm(e)]]},Annotation:function*(e){return[...Object.entries(e).map(([t,i])=>[t,Array.isArray(i)?yi(i):i]).filter(([t])=>t!=="body"),["body",yield e.body]]},ContentResource:function*(e){return[...Qn(e),...yield*Vn(e),...yield*Gn(e),["annotations",yi(yield e.annotations)]]},AnnotationCollection:function*(e){return[["id",e.id],["type","AnnotationCollection"],["label",e.label]]},Collection:function*(e,t,{isTopLevel:i}){return i?[["@context","http://iiif.io/api/presentation/3/context.json"],...Qn(e),...yield*Vn(e),...yield*Gn(e),["items",yi(yield e.items)]]:[...Qn(e),...yield*Vn(e)]},Range:function*(e){let t=[];for(let i of e.items)i.type==="Range"?t.push(yield i):t.push(i);return[...Qn(e),...yield*Vn(e),...yield*Gn(e),["items",t],["annotations",yi(yield e.annotations)]]}},vi=je(Mh(),1);function lk(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function zm(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),i.push.apply(i,r)}return i}function Fm(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?zm(Object(i),!0).forEach(function(r){lk(e,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):zm(Object(i)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(i,r))})}return e}function Pi(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var Bm=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),ic=function(){return Math.random().toString(36).substring(7).split("").join(".")},dl={INIT:"@@redux/INIT"+ic(),REPLACE:"@@redux/REPLACE"+ic(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+ic()}};function uk(e){if(typeof e!="object"||e===null)return!1;for(var t=e;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function rc(e,t,i){var r;if(typeof t=="function"&&typeof i=="function"||typeof i=="function"&&typeof arguments[3]=="function")throw new Error(Pi(0));if(typeof t=="function"&&typeof i>"u"&&(i=t,t=void 0),typeof i<"u"){if(typeof i!="function")throw new Error(Pi(1));return i(rc)(e,t)}if(typeof e!="function")throw new Error(Pi(2));var n=e,o=t,l=[],u=l,c=!1;function p(){u===l&&(u=l.slice())}function f(){if(c)throw new Error(Pi(3));return o}function v(P){if(typeof P!="function")throw new Error(Pi(4));if(c)throw new Error(Pi(5));var O=!0;return p(),u.push(P),function(){if(O){if(c)throw new Error(Pi(6));O=!1,p();var I=u.indexOf(P);u.splice(I,1),l=null}}}function x(P){if(!uk(P))throw new Error(Pi(7));if(typeof P.type>"u")throw new Error(Pi(8));if(c)throw new Error(Pi(9));try{c=!0,o=n(o,P)}finally{c=!1}for(var O=l=u,I=0;I<O.length;I++){var A=O[I];A()}return P}function E(P){if(typeof P!="function")throw new Error(Pi(10));n=P,x({type:dl.REPLACE})}function _(){var P,O=v;return P={subscribe:function(I){if(typeof I!="object"||I===null)throw new Error(Pi(11));function A(){I.next&&I.next(f())}A();var $=O(A);return{unsubscribe:$}}},P[Bm]=function(){return this},P}return x({type:dl.INIT}),r={dispatch:x,subscribe:v,getState:f,replaceReducer:E},r[Bm]=_,r}function hk(e){Object.keys(e).forEach(function(t){var i=e[t],r=i(void 0,{type:dl.INIT});if(typeof r>"u")throw new Error(Pi(12));if(typeof i(void 0,{type:dl.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Pi(13))})}function pl(e){for(var t=Object.keys(e),i={},r=0;r<t.length;r++){var n=t[r];typeof e[n]=="function"&&(i[n]=e[n])}var o=Object.keys(i),l;try{hk(i)}catch(u){l=u}return function(u,c){if(u===void 0&&(u={}),l)throw l;for(var p=!1,f={},v=0;v<o.length;v++){var x=o[v],E=i[x],_=u[x],P=E(_,c);if(typeof P>"u")throw c&&c.type,new Error(Pi(14));f[x]=P,p=p||P!==_}return p=p||o.length!==Object.keys(u).length,p?f:u}}function Zn(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.length===0?function(r){return r}:t.length===1?t[0]:t.reduce(function(r,n){return function(){return r(n.apply(void 0,arguments))}})}function fl(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(r){return function(){var n=r.apply(void 0,arguments),o=function(){throw new Error(Pi(15))},l={getState:n.getState,dispatch:function(){return o.apply(void 0,arguments)}},u=t.map(function(c){return c(l)});return o=Zn.apply(void 0,u)(n.dispatch),Fm(Fm({},n),{},{dispatch:o})}}}var jm="@iiif/IMPORT_ENTITIES",Um="@iiif/MODIFY_ENTITY_FIELD",Dm="@iiif/REORDER_ENTITY_FIELD",Wm="@iiif/ADD_REFERENCE",Hm="@iiif/REMOVE_REFERENCE",qm=(0,vi.createAction)(jm)(),ck=(0,vi.createAction)(Um)(),dk=(0,vi.createAction)(Dm)(),pk=(0,vi.createAction)(Wm)(),fk=(0,vi.createAction)(Hm)(),gk={importEntities:qm,modifyEntityField:ck,reorderEntityField:dk,addReference:pk,removeReference:fk},Qm="@iiif/ADD_MAPPING",Vm="@iiif/ADD_MAPPINGS",mk=(0,vi.createAction)(Qm)(),yk=(0,vi.createAction)(Vm)(),Gm="@iiif/SET_META_VALUE",Zm="@iiif/SET_META_VALUE_DYNAMIC",Xm="@iiif/UNSET_META_VALUE",vk=(0,vi.createAction)(Gm)(),bk=(0,vi.createAction)(Zm)(),wk=(0,vi.createAction)(Xm)(),Ym={setMetaValue:vk,setMetaValueDynamic:bk,unsetMetaValue:wk},nc="RESOURCE_ERROR",Km="RESOURCE_LOADING",sc="RESOURCE_READY",Jm="@iiif/REQUEST_RESOURCE",ey="@iiif/REQUEST_ERROR",ty="@iiif/REQUEST_MISMATCH",iy="@iiif/REQUEST_COMPLETE",ry="@iiif/REQUEST_OFFLINE_RESOURCE",xk=(0,vi.createAction)(Jm)(),ny=(0,vi.createAction)(ey)(),_k=(0,vi.createAction)(ty)(),Sk=(0,vi.createAction)(iy)();(0,vi.createAction)(ry)();var oc="@iiif/BATCH",sy="@iiif/BATCH_IMPORT",ac=(0,vi.createAction)(oc)();(0,vi.createAction)(sy)();var Ek=(e,t)=>{let{entities:i,resource:r,mapping:n}=Tm(t);if(r.id===void 0)return[ny({id:e,message:"ID is not defined in resource."})];let o=[qm({entities:i}),yk({mapping:n})];return r.id!==e&&(o.push(mk({id:e,type:r.type})),o.push(_k({requestId:e,actualId:r.id}))),o.push(Sk({id:e})),o},oy=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function Ak(e,t){return!!(e===t||oy(e)&&oy(t))}function ay(e,t){if(!Array.isArray(e)||!Array.isArray(t))return e===t;if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!Ak(e[i],t[i]))return!1;return!0}function lc(e,t){let i=e.iiif.requests[t],r=e.iiif.mapping[t];if(!(!r||!e.iiif.entities[r][i.resourceUri]))return e.iiif.entities[r][i.resourceUri]}function ly(e,t,{waitTimeout:i=30}={}){return async(r,n)=>{let o=e.getState(),l=o.iiif.requests[r];if(l)switch(l.loadingState){case nc:break;case Km:{let u,c=!1;try{let p=await Promise.race([new Promise((f,v)=>{c||(u=e.subscribe(()=>{let x=e.getState();if(x.iiif.requests[r].loadingState===nc){v();return}if(x.iiif.requests[r].loadingState===sc){let E=lc(x,r);E?f(E):v()}}))}),new Promise((f,v)=>setTimeout(()=>{c=!0,v()},i*60))]);if(u&&u(),p)return p}catch{u&&u();break}break}case sc:{let u=lc(o,r);if(u)return u;break}}e.dispatch(xk({id:r}));try{let u=await t(r,n);!u.id&&!u["@id"]&&(u["@type"]&&(u["@id"]=r),u.id=r);let c=Ek(r,u);return e.dispatch(ac({actions:c})),lc(e.getState(),r)}catch(u){throw e.dispatch(ny({id:r,message:u.toString()})),u}}}function kk(){return{Collection:{},Manifest:{},Canvas:{},AnnotationPage:{},AnnotationCollection:{},Annotation:{},ContentResource:{},Range:{},Service:{},Selector:{},Agent:{}}}var Pk=(e={},t)=>{switch(t.type){case Qm:return D(C({},e),{[t.payload.id]:t.payload.type});case Vm:return C(C({},e),t.payload.mapping);default:return e}};function uc(e,t,i,r){return!(!e[i]||!e[i][t]||!e[i][t][r]||!Array.isArray(e[i][t][r]))}var Ck=(e=kk(),t)=>{var i;switch(t.type){case Um:{if(!e[t.payload.type]||!e[t.payload.type][t.payload.id])return e;let r=e[t.payload.type][t.payload.id];return typeof r=="string"?e:D(C({},e),{[t.payload.type]:D(C({},e[t.payload.type]),{[t.payload.id]:D(C({},r),{[t.payload.key]:t.payload.value})})})}case Dm:{if(!uc(e,t.payload.id,t.payload.type,t.payload.key))return e;let r=e[t.payload.type][t.payload.id];if(typeof r=="string")return e;let n=Array.from(r[t.payload.key]),[o]=n.splice(t.payload.startIndex,1);return n.splice(t.payload.endIndex,0,o),D(C({},e),{[t.payload.type]:D(C({},e[t.payload.type]),{[t.payload.id]:D(C({},r),{[t.payload.key]:n})})})}case jm:{let r=Object.keys(t.payload.entities),n=C({},e);for(let o of r)n[o]=C(C({},e[o]||{}),t.payload.entities[o]||{});return n}case Wm:{if(!uc(e,t.payload.id,t.payload.type,t.payload.key))return e;let r=e[t.payload.type][t.payload.id],n=Array.from(r[t.payload.key]);return n.splice(t.payload.index||n.length+1,0,t.payload.reference),D(C({},e),{[t.payload.type]:D(C({},e[t.payload.type]),{[t.payload.id]:D(C({},r),{[t.payload.key]:n})})})}case Hm:{if(!uc(e,t.payload.id,t.payload.type,t.payload.key))return e;let r=e[t.payload.type][t.payload.id],n=Array.from(r[t.payload.key]),o=t.payload.index||n.findIndex(l=>l&&l.id===t.payload.reference.id);return o===-1||((i=n[o])==null?void 0:i.id)!==t.payload.reference.id?e:(n.splice(o,1),D(C({},e),{[t.payload.type]:D(C({},e[t.payload.type]),{[t.payload.id]:D(C({},r),{[t.payload.key]:n})})}))}default:return e}},Tk=(e={},t)=>{switch(t.type){case Jm:case ry:return D(C({},e),{[t.payload.id]:{requestUri:t.payload.id,loadingState:Km,uriMismatch:!1,resourceUri:t.payload.id}});case ty:return D(C({},e),{[t.payload.requestId]:D(C({},e[t.payload.requestId]||{}),{uriMismatch:!0,resourceUri:t.payload.actualId}),[t.payload.actualId]:{requestUri:t.payload.requestId,loadingState:e[t.payload.requestId].loadingState,uriMismatch:!0,resourceUri:t.payload.actualId}});case ey:return D(C({},e),{[t.payload.id]:D(C({},e[t.payload.id]||{}),{loadingState:nc,error:t.payload.message})});case iy:return D(C({},e),{[t.payload.id]:D(C({},e[t.payload.id]||{}),{loadingState:sc,error:void 0})})}return e},Ik=(e={},t)=>{let{id:i,updateValue:r,value:n,meta:o,key:l}=t&&t.payload||{};switch(t.type){case Gm:return D(C({},e),{[i]:D(C({},e[i]||{}),{[o]:D(C({},e[i]?e[i][o]||{}:{}),{[l]:n})})});case Zm:return D(C({},e),{[i]:D(C({},e[i]||{}),{[o]:D(C({},e[i]?e[i][o]||{}:{}),{[l]:e[i]&&e[i][o]?r(e[i][o][l]):r(void 0)})})});case Xm:return e[i]&&e[i][o]&&e[i][o][l]?D(C({},e),{[i]:D(C({},e[i]||{}),{[o]:D(C({},e[i]?e[i][o]||{}:{}),{[l]:void 0})})}):e;default:return e}};function Ok(e){return(t,i)=>i&&i.type===oc?i.payload.actions.reduce(e,t):i&&i.type===sy?i.payload.state:e(t,i)}var Rk=pl({mapping:Pk,entities:Ck,requests:Tk,meta:Ik}),Mk=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Zn;function Lk(e={}){let{enableDevtools:t=!0,iiifStoreName:i="iiif",defaultState:r={},extraMiddleware:n=[],customReducers:o={}}=e,l=pl(C({[i]:Rk},o));return rc(Ok(l),r,t?Mk(fl(...n)):Zn(fl(...n)))}function $k(e){return{all:e=e||new Map,on:function(t,i){var r=e.get(t);r?r.push(i):e.set(t,[i])},off:function(t,i){var r=e.get(t);r&&(i?r.splice(r.indexOf(i)>>>0,1):e.set(t,[]))},emit:function(t,i){var r=e.get(t);r&&r.slice().map(function(n){n(i)}),(r=e.get("*"))&&r.slice().map(function(n){n(t,i)})}}}var hc=class{constructor(e,t){Ze(this,"options"),Ze(this,"store"),Ze(this,"emitter"),Ze(this,"isBatching",!1),Ze(this,"batchQueue",[]),Ze(this,"remoteFetcher"),Ze(this,"staticFetcher"),Ze(this,"defaultFetcher",i=>fetch(i).then(r=>r.json())),Ze(this,"middleware",i=>r=>n=>{if(n.type===oc){for(let u of n.payload.actions)this.emitter.emit(u.type,{realAction:u,state:i.getState()});let l=r(n);for(let u of n.payload.actions)this.emitter.emit(`after:${n.type}`,{action:n,state:l});return l}this.emitter.emit(n.type,{action:n,state:i.getState()});let o=r(n);return this.emitter.emit(`after:${n.type}`,{action:n,state:o}),o}),this.options=Object.assign({reducers:{},middleware:[],defaultState:{},customFetcher:this.defaultFetcher,enableDevtools:!0},e||{}),this.store=t||Lk({customReducers:this.options.reducers,extraMiddleware:[...this.options.middleware,this.middleware],defaultState:this.options.defaultState,enableDevtools:this.options.enableDevtools}),this.emitter=$k(),this.remoteFetcher=ly(this.store,this.options.customFetcher),this.staticFetcher=ly(this.store,(i,r)=>r)}batch(e){this.isBatching=!0;try{e(this),this.store.dispatch(ac({actions:this.batchQueue}))}catch(t){throw this.batchQueue=[],this.isBatching=!1,t}this.batchQueue=[],this.isBatching=!1}async asyncBatch(e){this.isBatching=!0;try{await e(this),this.store.dispatch(ac({actions:this.batchQueue}))}catch(t){throw this.batchQueue=[],this.isBatching=!1,t}this.batchQueue=[],this.isBatching=!1}modifyEntityField(e,t,i){this.dispatch(gk.modifyEntityField({id:e.id,type:e.type,key:t,value:i}))}dispatch(e){this.isBatching?this.batchQueue.push(e):this.store.dispatch(e)}serialize(e,t){return Om(this.getState().iiif,e,t)}toPresentation2(e){return this.serialize(e,Mm)}toPresentation3(e){return this.serialize(e,Nm)}hydrate(e,t){return this.get(e,t,{skipSelfReturn:!1})}get(e,t,i={}){typeof t!="string"&&(i=t||{},t=void 0);let{skipSelfReturn:r=!0}=i||{};if(Array.isArray(e))return e.map(c=>this.get(c,i));let n=this.getState();if(typeof e=="string"){let c=t||n.iiif.mapping[e];if(!c)return r?null:{id:e,type:"unknown"};e={id:e,type:c}}let o=t||e.type,l=e.id,u=n.iiif.entities[o];if(!u){let c=n.iiif.requests[l];return c&&c.resourceUri!==l?this.get(c.resourceUri,i):r?null:e}return u[e.id]||(r?null:e)}select(e){return e(this.getState())}getStore(){return this.store}getState(){return this.store.getState()}loadManifest(e,t){let i=typeof e=="string"?e:e.id;return this.load(i,t)}loadCollection(e,t){let i=typeof e=="string"?e:e.id;return this.load(i,t)}load(e,t){let i=typeof e=="string"?e:e.id;return t?this.staticFetcher(i,t):this.remoteFetcher(i)}areInputsEqual(e,t){return ay(e,t)}subscribe(e,t,i){typeof i>"u"&&(typeof t>"u"||t===!1||t===!0)&&(i=t,t=e,e=n=>n);let r=i?null:e(this.store.getState());return i||t(r,this),this.store.subscribe(()=>{let n=this.store.getState(),o=e(n);ay(r,o)||t(o,this),r=o})}async ensureLoaded(e){let t=typeof e=="string"?e:e.id;this.requestStatus(t)||await this.load(t)}requestStatus(e){return this.select(t=>t.iiif.requests[e])}getResourceMeta(e,t){let i=this.getState().iiif.meta[e];if(i)return t?i[t]:i}setMetaValue([e,t,i],r){this.dispatch(typeof r=="function"?Ym.setMetaValueDynamic({id:e,meta:t,key:i,updateValue:r}):Ym.setMetaValue({id:e,meta:t,key:i,value:r}))}};function Nk(){return typeof self<"u"?self:typeof window<"u"?window:typeof Xu<"u"?Xu:{}}function uy(e){let t=Nk();try{let r=t.IIIF_VAULT;if(r)return r}catch{}let i=new hc(e);try{t.IIIF_VAULT=i}catch{}return i}var bi=je(Mh(),1);je(Rh(),1);var zk=Object.defineProperty,Fk=Object.defineProperties,Bk=Object.getOwnPropertyDescriptors,hy=Object.getOwnPropertySymbols,jk=Object.prototype.hasOwnProperty,Uk=Object.prototype.propertyIsEnumerable,cy=(e,t,i)=>t in e?zk(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,dy=(e,t)=>{for(var i in t||(t={}))jk.call(t,i)&&cy(e,i,t[i]);if(hy)for(var i of hy(t))Uk.call(t,i)&&cy(e,i,t[i]);return e},py=(e,t)=>Fk(e,Bk(t)),Dk=/&?(xywh=)?(pixel:|percent:|pct:)?([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?)/,Wk=/&?(t=)(npt:)?([0-9]+(.[0-9]+)?)?(,([0-9]+(.[0-9]+)?))?/;function cc(e){if(Array.isArray(e))return e.reduce((t,i)=>{let{selector:r,selectors:n}=cc(i);return r&&(t.selector||(t.selector=r),t.selectors.push(...n)),t},{selector:null,selectors:[]});if(!e)return{selector:null,selectors:[]};if(typeof e=="string"){let[t,i]=e.split("#");return i?cc({type:"FragmentSelector",value:i}):{selector:null,selectors:[]}}if(e.type==="PointSelector"&&(e.t||e.t===0)){let t={type:"TemporalSelector",temporal:{startTime:e.t}};return{selector:t,selectors:[t]}}if(e.type==="FragmentSelector"){let t=Dk.exec(e.value);if(t){let r={type:"BoxSelector",spatial:{unit:t[2]==="percent:"||t[2]==="pct:"?"percent":"pixel",x:parseFloat(t[3]),y:parseFloat(t[4]),width:parseFloat(t[5]),height:parseFloat(t[6])}};return{selector:r,selectors:[r]}}let i=e.value.match(Wk);if(i){let r={type:"TemporalSelector",temporal:{startTime:i[4]?parseFloat(i[4]):0,endTime:i[7]?parseFloat(i[7]):void 0}};return{selector:r,selectors:[r]}}return{selector:null,selectors:[]}}return{selector:null,selectors:[]}}function $o(e,t={}){if(Array.isArray(e))return $o(e[0]);if(typeof e=="string"){let[i,r]=e.split("#");return r?$o({type:"SpecificResource",source:{id:i,type:"Unknown"},selector:{type:"FragmentSelector",value:r}}):{type:"SpecificResource",source:{id:i,type:t.typeMap&&t.typeMap[i]||"Unknown"},selector:null,selectors:[]}}if(e.type==="Choice"||e.type==="List"||e.type==="Composite"||e.type==="Independents")return $o(e.items[0]);if(e.type==="SpecificResource"){e.source.type==="Canvas"&&e.source.partOf&&typeof e.source.partOf=="string"&&(e.source.partOf=[{id:e.source.partOf,type:"Manifest"}]);let{selector:i,selectors:r}=e.selector?cc(e.selector):{selector:null,selectors:[]};return{type:"SpecificResource",source:e.source,selector:i,selectors:r}}if(e.id){e.type==="Canvas"&&e.partOf&&typeof e.partOf=="string"&&(e.partOf=[{id:e.partOf,type:"Manifest"}]);let[i,r]=e.id.split("#");return r?$o({type:"SpecificResource",source:py(dy({},e),{id:i}),selector:{type:"FragmentSelector",value:r}}):{type:"SpecificResource",source:py(dy({},e),{id:i}),selector:null,selectors:[]}}return{type:"SpecificResource",source:e,selector:null,selectors:[]}}function cn(e){return e.endsWith("info.json")?e:e.endsWith("/")?`${e}info.json`:`${e}/info.json`}var Hk="http://library.stanford.edu/iiif/image-api/compliance.html#level0",fy="http://library.stanford.edu/iiif/image-api/compliance.html#level1",gy="http://library.stanford.edu/iiif/image-api/compliance.html#level2",qk="http://library.stanford.edu/iiif/image-api/conformance.html#level0",my="http://library.stanford.edu/iiif/image-api/conformance.html#level1",yy="http://library.stanford.edu/iiif/image-api/conformance.html#level2",Qk="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",vy="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",by="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",Vk="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",wy="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",xy="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",Gk="http://iiif.io/api/image/1/level0.json",Zk="http://iiif.io/api/image/1/profiles/level0.json",_y="http://iiif.io/api/image/1/level1.json",Sy="http://iiif.io/api/image/1/profiles/level1.json",Ey="http://iiif.io/api/image/1/level2.json",Ay="http://iiif.io/api/image/1/profiles/level2.json",Xk="http://iiif.io/api/image/2/level0.json",Yk="http://iiif.io/api/image/2/profiles/level0.json",ky="http://iiif.io/api/image/2/level1.json",Py="http://iiif.io/api/image/2/profiles/level1.json",Cy="http://iiif.io/api/image/2/level2.json",Ty="http://iiif.io/api/image/2/profiles/level2.json",Kk="level0",Iy="level1",Oy="level2",Jk="http://iiif.io/api/image/2/level0",Ry="http://iiif.io/api/image/2/level1",My="http://iiif.io/api/image/2/level2",Ly=[My,gy,yy,by,xy,Ey,Ay,Cy,Ty,Oy],$y=[...Ly,Ry,fy,my,vy,wy,_y,Sy,ky,Py,Iy],eP=[Jk,Ry,My,Hk,fy,gy,qk,my,yy,Qk,vy,by,Vk,wy,xy,Gk,Zk,_y,Sy,Ey,Ay,Xk,Yk,ky,Py,Cy,Ty,Kk,Iy,Oy],tP={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["sizeByWhListed"]},iP={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPx","regionSquare","sizeByWhListed","sizeByH","sizeByW","sizeByWh"]},rP={extraFormats:["jpg","png"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPct","regionByPx","regionSquare","rotationBy90s","sizeByWhListed","sizeByConfinedWh","sizeByH","sizeByPct","sizeByW","sizeByWh"]};function nP(e){return Ly.indexOf(e)!==-1?rP:$y.indexOf(e)!==-1?iP:tP}function sP(e){let t=e?Array.isArray(e.profile)?e.profile:[e.profile]:[],i={extraQualities:[],extraFormats:[],extraFeatures:[]};for(let r of t)if(typeof r=="string"&&(r=nP(r)),!!r){if(r.formats)for(let n of r.formats)i.extraFormats.indexOf(n)===-1&&i.extraFormats.push(n);if(r.qualities)for(let n of r.qualities)i.extraQualities.indexOf(n)===-1&&i.extraQualities.push(n);if(r.supports)for(let n of r.supports)i.extraFeatures.indexOf(n)===-1&&i.extraFeatures.push(n);if(r.maxHeight&&(i.maxHeight=r.maxHeight),r.maxWidth&&(i.maxWidth=r.maxWidth),r.maxArea&&(i.maxArea=r.maxArea),r.extraFormats)for(let n of r.extraFormats)i.extraFormats.indexOf(n)===-1&&i.extraFormats.push(n);if(r.extraQualities)for(let n of r.extraQualities)i.extraQualities.indexOf(n)===-1&&i.extraQualities.push(n);if(r.extraFeatures)for(let n of r.extraFeatures)i.extraFeatures.indexOf(n)===-1&&i.extraFeatures.push(n);r.maxHeight&&(i.maxHeight=r.maxHeight),r.maxWidth&&(i.maxWidth=r.maxWidth),r.maxArea&&(i.maxArea=r.maxArea)}if(e.extraFormats)for(let r of e.extraFormats)i.extraFormats.indexOf(r)===-1&&i.extraFormats.push(r);if(e.extraFeatures)for(let r of e.extraFeatures)i.extraFeatures.indexOf(r)===-1&&i.extraFeatures.push(r);if(e.extraQualities)for(let r of e.extraQualities)i.extraQualities.indexOf(r)===-1&&i.extraQualities.push(r);return i}function oP(e){try{if(e==="full")return{full:!0};if(e==="square")return{square:!0};let t=e.startsWith("pct:"),i=e.substr(t?4:0).split(",").map(r=>parseFloat(r));return{x:i[0],y:i[1],w:i[2],h:i[3],percent:t}}catch{throw new Error("Expected 'full', 'square' or 'x,y,w,h'. Found "+e)}}function aP(e){let t={upscaled:!1,max:!1,confined:!1};if(e[0]==="^"&&(t.upscaled=!0,e=e.slice(1)),e==="max"||e==="full")return t.max=!0,t.serialiseAsFull=e==="full",t;if(e[0]==="!"&&(t.confined=!0,e=e.slice(1)),e[0]==="p")return t.percentScale=parseFloat(e.slice(4)),t;let i=e.split(",").map(r=>r.trim());return i.length&&(i[0]!==""&&(t.width=parseInt(i[0],10)),i[1]!==""?(t.height=parseInt(i[1],10),t.version=2):t.version=3),t}function lP(e){let t={angle:0};if(e[0]==="!"&&(t.mirror=!0,e=e.substr(1)),t.angle=parseFloat(e)%360,Number.isNaN(t.angle))throw new Error(`Invalid rotation ${e}`);return t}function Ny(e,t=""){let i=e.match(/^(([a-zA-Z]+):\/\/([^/]+))?((.*)+)/);if(!i)throw new Error(`Invalid or unknown input ${e}`);let r=i[2],n=i[3],o=i[4];if(o[0]==="/"&&(o=o.substr(1)),t.length>0){if(t[0]==="/"&&(t=t.substr(1)),t!==o.substr(0,t.length))throw new Error(`Path does not start with prefix (path: ${o}, prefix: ${t})`);o=o.substr(t.length)}return{scheme:r,server:n,path:o,prefix:t}}function uP(e,t=""){let{path:i,scheme:r,server:n,prefix:o}=Ny(e,t),l=i.split("/").reverse(),[u,c,p,f,...v]=l,x=v.reverse().filter(Boolean).join("/");if(l.length===1||u==="")return{type:"base",scheme:r,server:n,prefix:o,identifier:x};if(u==="info.json"){let[,..._]=l;return{type:"info",scheme:r,server:n,prefix:o,identifier:_.reverse().filter(Boolean).join("/")}}let E=u.split(".");return{type:"image",scheme:r,server:n,prefix:o,identifier:x,originalPath:i,region:oP(f),size:aP(p),rotation:lP(c),quality:E[0],format:E[1]}}function hP(e){let t=uP(cn(e.id));if(t.type!=="info")throw new Error("Invalid service URL");let i=sP(e);return{identifier:t.identifier,originalPath:"",server:t.server,prefix:t.prefix,scheme:t.scheme,type:"image",quality:i.extraQualities.indexOf("default")===-1?i.extraQualities[0]:"default",region:{full:!0},size:{max:!0,upscaled:!1,confined:!1},format:"jpg",rotation:{angle:0}}}function cP(e,t,i){let r=i.length,n=[];for(let o=0;o<r;o++){let l=i[o].width;n.push(e/l)}return n}function dP(e,t,i){let r=i.length,n=[];for(let o=0;o<r;o++){let l=i[o];n.push({width:Math.floor(e/l),height:Math.floor(t/l)})}return n}function qt(e){if(e["@id"])return e["@id"];if(e.id)return e.id}function gl(e){if(!e||!e.profile||!qt(e))return!1;let t=Array.isArray(e.profile)?e.profile:[e.profile];for(let i of t)if(typeof i=="string"&&eP.indexOf(i)!==-1)return!0;return!1}function pP(e){if(!gl(e))return!1;let t=Array.isArray(e.profile)?e.profile:[e.profile];for(let i of t)if(typeof i=="string"){if($y.indexOf(i)!==-1)return!0}else{let r=[...i.supports||[],...i.extraFeatures||[]];if(r.indexOf("regionByPx")!==-1&&(r.indexOf("sizeByW")!==-1||r.indexOf("sizeByWh")!==-1))return!0}return!1}function ml(e,t){if(t&&t.profile){let i=t.profile;if(i){let r=Array.isArray(i)?i:[i];return r.includes(`level${e}`)||r.includes(`http://iiif.io/api/image/2/level${e}.json`)||r.includes(`http://iiif.io/api/image/1/level${e}.json`)||r.includes(`http://iiif.io/api/image/1/profiles/level${e}.json`)}}return!1}function dc(e){return gl(e)?ml(0,e)?0:ml(1,e)?1:ml(2,e)?2:null:null}function zy(e){return(e["@context"]?Array.isArray(e["@context"])?e["@context"]:[e["@context"]]:[]).indexOf("http://iiif.io/api/image/3/context.json")!==-1}function fP(e){if(!pP(e))return[];let t=[],i=Array.isArray(e.profile)?e.profile:[e.profile],r=i.length;for(let n=0;n<r;n++){let o=i[n];if(typeof o!="string"&&(o.maxHeight||o.maxWidth))return[{id:qt(e),type:"variable",minWidth:0,minHeight:0,maxHeight:o.maxHeight||o.maxWidth,maxWidth:o.maxWidth||o.maxHeight,level:dc(e),version:e["@context"]==="http://iiif.io/api/image/3/context.json"?3:2}]}if(e.tiles){let n=e.tiles.length;for(let o=0;o<n;o++){let l=e.tiles[o];(l.height||l.width)&&t.push({id:qt(e),type:"variable",minHeight:0,minWidth:0,maxHeight:l.height||l.width,maxWidth:l.width,level:dc(e),version:zy(e)?3:2})}}return t}function Fy(e){let t=/^.*\/(full)\/(((\d+),(\d+)?)|max)\/(\d+)\/default\.(jpg|png|jpeg)$/,i=e.match(t);if(i){let r=i[1],n=parseInt(i[4],10),o=parseInt(i[5],10),l=i[7];if((r==="max"||r==="full")&&n&&o&&l)return{type:"fixed",id:e,height:o,width:n}}return{type:"unknown",id:e}}function gP(e){if(e["@type"])return e["@type"];if(e.type)return e.type}function pc(e){if(typeof e=="string")return Fy(e);let t=gP(e);if(t!=="Image"&&t!=="sc:Image")return null;let i=e,r=qt(i);return r?r&&i.width&&i.height?{id:r,type:"fixed",width:i.width,height:i.height,unsafe:!0}:Fy(r):null}function mP(e){return gl(e)?(e&&e.sizes?e.sizes:[]).map(t=>({id:qt(e),type:"fixed-service",height:t.height,width:t.width,level:dc(e),version:zy(e)?3:2})):[]}function By(e){let t=[],i=e.length;for(let r=0;r<i;r++){let n=mP(e[r]);n.length&&t.push(...n);let o=fP(e[r]);o.length&&t.push(...o)}return t}function fc(e){let t=e.service?Array.isArray(e.service)?e.service:[e.service]:[],i=t.length,r=[];for(let n=0;n<i;n++)gl(t[n])&&r.push(t[n]);return r}function yP(e,t=!0,i){let r=[],n=pc(e);if(n===null)return r;let o=e;if(r.push(n),t&&o&&o.width&&o.height){let l=[],u=fc(o);for(let c of u){let p={id:qt(c),width:o.width,height:o.height};if(i.canLoadSync(p)){let f=i.loadServiceSync(p);f&&(f.height||(f.height=o.height),f.width||(f.width=o.width),l.push(...By([f])))}}if(l.length)return r.push(...l),r}return o.service&&r.push(...By(o.service)),r}function vP({x:e=0,y:t=0,w:i,h:r,full:n,square:o,percent:l}){if(n)return"full";if(o)return"square";if(typeof i>"u"||typeof r>"u")throw new Error("RegionParameter: invalid region");let u=`${e},${t},${i},${r}`;return l?`pct:${u}`:u}function bP({max:e,percentScale:t,upscaled:i,confined:r,width:n,height:o,serialiseAsFull:l,version:u}){let c=[];return i&&c.push("^"),e?(c.push(l?"full":"max"),c.join("")):(r&&c.push("!"),t&&c.push(`pct:${t}`),n&&c.push(`${n}`),c.push(","),o&&u===3&&c.push(`${o}`),c.join(""))}function wP(e){return`${e.mirror?"!":""}${(e.angle||0)%360}`}var xP=Object.defineProperty,_P=Object.defineProperties,SP=Object.getOwnPropertyDescriptors,jy=Object.getOwnPropertySymbols,EP=Object.prototype.hasOwnProperty,AP=Object.prototype.propertyIsEnumerable,Uy=(e,t,i)=>t in e?xP(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,Xn=(e,t)=>{for(var i in t||(t={}))EP.call(t,i)&&Uy(e,i,t[i]);if(jy)for(var i of jy(t))AP.call(t,i)&&Uy(e,i,t[i]);return e},Yn=(e,t)=>_P(e,SP(t));function Dy(e,t){let i=e.prefix.startsWith("/")?e.prefix.substr(1):e.prefix,r=`${e.scheme}://${e.server}/${i?`${i}/`:""}${e.identifier}`;if(e.type==="base")return r;if(e.type==="info")return`${r}/info.json`;let{size:n}=e,{region:o,rotation:l,format:u,quality:c}=e;if(t){let p=t["@context"]?Array.isArray(t["@context"])?t["@context"]:[t["@context"]]:[],f=p.indexOf("http://iiif.io/api/image/2/context.json")!==-1,v=p.indexOf("http://iiif.io/api/image/3/context.json")!==-1;if((n.width===t.width&&!n.height||n.height===t.height&&!n.width||n.width===t.width&&n.height===t.height)&&(n=Yn(Xn({},n),{max:!0})),f&&(n.max&&!n.serialiseAsFull&&(n=Yn(Xn({},n),{serialiseAsFull:!0})),!n.max&&n.width&&n.height&&(n=Yn(Xn({},n),{height:void 0})),n=Yn(Xn({},n),{version:2})),v){if(n.max&&n.serialiseAsFull&&(n=Yn(Xn({},n),{serialiseAsFull:!1})),n.width&&!n.height&&t.width&&t.height){let x=t.height/t.width;n=Yn(Xn({},n),{height:Math.ceil(n.width*x)})}n=Yn(Xn({},n),{version:3})}}return[r,vP(o),bP(n),wP(l),`${c}.${u}`].filter(Boolean).join("/")}function gc(e,t,i){let r=hP({"@context":e.version===3?"http://iiif.io/api/image/3/context.json":"http://iiif.io/api/image/2/context.json",id:cn(qt(e)),profile:e.level===null||typeof e.level>"u"?"level0":`level${e.level}}`,type:e.version===3?"ImageService3":"ImageService2"});if(r.type!=="image")throw new Error("Invalid service");return r.size.max=!1,r.size.width=t,r.size.height=i,{id:Dy(r),type:"fixed",width:t,height:i||e.height/(e.width||1)*t,unsafe:e.width>t}}function Ds(e){let t=e.replace(/(https?:\/\/)?(www.)?/i,"");return t.indexOf("/")!==-1?t.split("/")[0]:t}function kP(e,t,i){let r=e.width?e.width:e.maxWidth;return i.height<=e.maxHeight&&i.width<=e.maxWidth&&i.height>=e.minHeight&&i.width>=e.minWidth&&(!t||Math.abs(i.width-r)<Math.abs(t.width-r))}function PP(e,t){let i=[],r=Object.assign({unsafeImageService:!1,atAnyCost:!0,fallback:!0,minHeight:64,minWidth:64,maxHeight:1/0,maxWidth:1/0,returnAllOptions:!1,preferFixedSize:!1,allowUnsafe:!1,explain:!1,height:0,width:0},e),n=(f,v=0)=>r.explain?i.push(new Array(v).fill(0).map(x=>"    ").join("")+f().trim()):void 0,o=[],l=[],u=null;n(()=>`Using configuration: ${JSON.stringify(r,null,2)}`);let c=(f,v)=>{if(n(()=>"Swapping choice",3),kP(r,v,f)){if(r.preferFixedSize&&f.unsafe){n(()=>`We found an image that was marked as unsafe, but it was the best size. (${f.id})`,4),l.push(f);return}r.returnAllOptions&&v&&l.push(v),n(()=>`We found a new image that was the best size. (${f.id})`,4),u=f}else r.returnAllOptions&&l.push(f)};n(()=>`The input shows we have ${t.length} list(s) of candidates to choose from.`);let p=t.length;for(let f=0;f<p;f++){let v=t[f]();n(()=>`Candidate group ${f}: ${JSON.stringify(v,null,2)}`,1);let x=v.length;n(()=>`Checking candidate list number ${f} and found ${x} potential ways of creating image(s)`,1);for(let E=0;E<x;E++){let _=v[E];if(n(()=>`-> Checking candidate ${E}`,1),_.type==="unknown"&&r.atAnyCost&&(n(()=>`We've found an unknown image type, adding this to the "last resort" list`,2),o.push(_)),_.type==="fixed"&&(_.unsafe?(n(()=>`We've found an unsafe fixed image type, adding this to the "last resort" list`,2),o.push(_)):(n(()=>"We've found a fixed size image, checking if it matches the request",2),c(_,u))),_.type==="fixed-service")if(r.unsafeImageService){n(()=>"Checking for an image from the tile source, without calculating the right height and width (unsafeImageService)",2);let P=gc(_,r.width,r.height);c(P,u)}else{n(()=>"Checking for an image from the tile source 3",2);let P=gc(_,_.width,_.height);c(P,u)}if(_.type==="variable"&&_.maxWidth){let P=gc({id:_.id,type:"fixed-service",width:_.maxWidth,height:_.maxWidth,level:_.level,version:_.version},_.maxWidth);c(P,u)}}if(u&&!r.returnAllOptions){if(u.unsafe||r.allowUnsafe)continue;n(()=>`We found a match in choice list number ${f}, no searching any more`);break}}return r.atAnyCost&&l.length===0?(n(()=>u?`We found an image! ${u.id} of type ${u.type}`:'We found no images, but "atAnyCost" is set, so returning that'),{best:u||o[0],fallback:o.slice(1),log:i}):r.returnAllOptions?(n(()=>"Returning all options that we have found"),{best:r.atAnyCost?u||l[0]||o[0]:u||l[0],fallback:[...l,...o],log:i}):(n(()=>"Returning the best image that we found, and a fallback"),{best:u||l[0]||null,fallback:u?l:l.slice(1),log:i})}var CP=Object.defineProperty,TP=Object.defineProperties,IP=Object.getOwnPropertyDescriptors,Wy=Object.getOwnPropertySymbols,OP=Object.prototype.hasOwnProperty,RP=Object.prototype.propertyIsEnumerable,Hy=(e,t,i)=>t in e?CP(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,MP=(e,t)=>{for(var i in t||(t={}))OP.call(t,i)&&Hy(e,i,t[i]);if(Wy)for(var i of Wy(t))RP.call(t,i)&&Hy(e,i,t[i]);return e},LP=(e,t)=>TP(e,IP(t));function $P(e,t,i){let r=e>t?e:t,n=i.length,o=[];for(let l=0;l<n;l++){let u=i[l],c=u.scaleFactors[0],p=r/c,f=[c];for(;p>=u.width;)c=c*2,f.push(c),p=p/2;o.push(LP(MP({},u),{scaleFactors:f}))}return o}function NP(e,t){if(e.length!==t.length)return!1;if(e.length===0&&t.length===0)return!0;let i=e.length,r=!0;for(let o=0;o<i;o++){let l=e[o],u=t[o];if(l.width!==u.width||l.height!==u.height){r=!1;break}}if(r)return!0;let n=0;for(let o=0;o<i;o++)for(let l=0;l<i;l++)if(e[o].width===t[l].width&&e[o].height===t[l].height){n++;break}return n===i}function qy(e){return ml(0,e)}var Kn=(e,t,i)=>new Promise((r,n)=>{var o=c=>{try{u(i.next(c))}catch(p){n(p)}},l=c=>{try{u(i.throw(c))}catch(p){n(p)}},u=c=>c.done?r(c.value):Promise.resolve(c.value).then(o,l);u((i=i.apply(e,t)).next())}),yl=class{constructor(e={}){this.config={verificationsRequired:1,approximateServices:!1,enableFetching:!0,disableThrottling:!1},this.fetchingCount=0,this.imageServices={},this.knownImageServers={},this.config=Object.assign(this.config,e)}setConfig(e){Object.assign(this.config,e)}sample(e,t,i=!0){let r=Ds(qt(e)),n=cn(qt(e)),o=this.knownImageServers[r];return this.imageServices[n]=Object.assign(e,{real:!0}),!o&&e.tiles&&!qy(e)?(this.knownImageServers[r]={verifications:0,malformed:!1,root:r,preLoaded:i,sampledId:qt(e),verified:!1,server:null,result:{context:e["@context"]||[],sampledProfile:e.profile,resourceServiceRatio:t&&e.height?t.height/e.height:1,sampledSizes:e.sizes||[],sizeRatios:cP(e.width,e.height,e.sizes||[]),sampledTiles:e.tiles||[]}},!0):this.verify(e)}preLoad(e,t=!0){this.knownImageServers[e.root]=e,t&&(this.knownImageServers[e.root].malformed=!1,this.knownImageServers[e.root].verifications=this.config.verificationsRequired)}predict(e,t=!1,i=!1){let r=e==null?void 0:e.source,n=Ds(qt(e)),o=this.knownImageServers[n],l=cn(qt(e));return this.imageServices[l]?this.imageServices[l]:!this.config.approximateServices||!o||!o.result||!(r!=null&&r.height||e.height)||!(r!=null&&r.width||e.width)||!i&&(o.malformed||o.verifications<this.config.verificationsRequired)||qy(e.source)?null:(this.imageServices[l]||(this.imageServices[l]={"@context":o.result.context,"@id":qt(e),id:qt(e),protocol:"http://iiif.io/api/image",tiles:(r==null?void 0:r.tiles)||$P(e.width,e.height,o.result.sampledTiles),sizes:(r==null?void 0:r.sizes)||dP(Math.round(e.width/o.result.resourceServiceRatio),Math.round(e.height/o.result.resourceServiceRatio),o.result.sizeRatios),profile:(r==null?void 0:r.profile)||o.result.sampledProfile,height:(r==null?void 0:r.height)||e.height,width:(r==null?void 0:r.width)||e.width,real:!1}),this.imageServices[l])}getThumbnailFromResource(e,t){return Kn(this,arguments,function*(i,r,n=!0,o=[]){let l=i?yield this.getImageCandidates(i,n):[];return PP(r,[()=>o,()=>l])})}getImageCandidates(e,t=!0){return Kn(this,null,function*(){let i=e;if(t&&i&&i.height&&i.width){let r=fc(i);for(let n of r){let o={id:qt(n),width:n.width?n.width:i.width,height:n.height?n.height:i.height,source:n};yield this.loadService(o)}}return yP(e,t,this)})}verify(e){return Kn(this,null,function*(){let t=this.predict(e,!1,!0),i=yield this.fetchService(qt(e));if(!t)return!1;let r=t.height===i.height&&t.width===i.width&&t["@context"]===i["@context"]&&NP(t.sizes||[],i.sizes||[]);if(r){let n=Ds(qt(e));this.knownImageServers[n]&&(this.knownImageServers[n].verifications+=1,this.knownImageServers[n].verifications>=this.config.verificationsRequired&&(this.knownImageServers[n].verified=!0))}return r})}canLoadSync(e){let t=typeof e=="string"?e:qt(e),i=cn(t);if(this.imageServices[i])return!0;let r=this.knownImageServers[Ds(t)];return r&&!r.malformed&&r.verifications>=this.config.verificationsRequired}markAsMalformed(e){return Kn(this,null,function*(){return this.knownImageServers[Ds(qt(e))].malformed=!0,this.loadService(e,!0)})}fetchService(e,t=!1){return Kn(this,null,function*(){let i=cn(e);if(this.imageServices[i]&&(!t||this.imageServices[i].real))return this.imageServices[i];if(!this.config.enableFetching)throw new Error("Fetching is not enabled");let r=yield this.fetch(i).then(n=>n.json());return!r.id&&r["@id"]&&(r.id=r["@id"]),r.id!==e&&(r.id=e,r["@id"]&&(r["@id"]=e)),this.imageServices[i]=Object.assign(r,{real:!0}),this.imageServices[i]})}fetch(e,t){return Kn(this,null,function*(){return fetch(e,t)})}loadService(e,t=!1){return Kn(this,null,function*(){if(!this.config.disableThrottling){let n=!0;for(;n;)if(this.fetchingCount>=this.config.verificationsRequired)yield new Promise(o=>setTimeout(o,500));else{n=!1;break}}let i=this.knownImageServers[Ds(qt(e))];if(i&&!i.malformed&&!t){yield i.result;let n=this.loadServiceSync(e);if(n)return n}this.fetchingCount++;let r=yield this.fetchService(qt(e),t);return this.fetchingCount--,r.real&&this.sample(r,e),r})}loadServiceSync(e){let t=cn(qt(e));return this.imageServices[t]?this.imageServices[t]:this.config.approximateServices?this.predict(e):null}};new yl;var zP=Object.defineProperty,FP=Object.defineProperties,BP=Object.getOwnPropertyDescriptors,Qy=Object.getOwnPropertySymbols,jP=Object.prototype.hasOwnProperty,UP=Object.prototype.propertyIsEnumerable,Vy=(e,t,i)=>t in e?zP(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,oi=(e,t)=>{for(var i in t||(t={}))jP.call(t,i)&&Vy(e,i,t[i]);if(Qy)for(var i of Qy(t))UP.call(t,i)&&Vy(e,i,t[i]);return e},Ci=(e,t)=>FP(e,BP(t)),DP={collection:void 0,manifest:void 0,range:void 0,canvas:void 0,annotation:void 0,annotationPage:void 0},Gy=te.createContext(DP),Jn=()=>Kt(Gy);function vl({value:e,children:t}){let i=Jn(),r=Ae(()=>oi(oi({},i),e),[e,i]);return Ge(Gy.Provider,{value:r,children:t})}var mc=te.createContext({vault:null,setVaultInstance:e=>{}});function dn({vault:e,vaultOptions:t,useGlobal:i,resources:r,children:n}){let[o,l]=Be(()=>e||(i?uy(t):t?new hc(t):new hc));return Ge(mc.Provider,{value:{vault:o,setVaultInstance:l},children:Ge(vl,{value:r||{},children:n})})}var Qt=()=>{let{vault:e}=Kt(mc);if(e===null)throw new Error("Vault not found. Ensure you have your provider set up correctly.");return e};function WP(e,{noCache:t=!1}={}){let i=typeof e=="string"?e:e.id,r=Qt(),[n,o]=Be(i),[l,u]=Be(void 0),c=Ae(()=>r.get(i,{skipSelfReturn:!0})||void 0,[i,r]),[p,f]=Be(c);return de(()=>{(async()=>{try{let v=c&&!t?c:await r.load(i),x=v?v.id||v["@id"]:null;v&&n!==x&&o(x),f(v)}catch(v){u(v)}})()},[i,t]),{isLoaded:!!p,id:n,requestId:i,error:l,resource:p,cached:!!(p&&p===c)}}function bl(e,t){let{id:i,isLoaded:r,error:n,resource:o,requestId:l,cached:u}=WP(e,t);return{id:i,isLoaded:r,error:n,manifest:o,requestId:l,cached:u}}function wl({manifest:e,children:t}){return Ge(vl,{value:{manifest:e},children:t})}function yc({canvas:e,children:t}){return Ge(vl,{value:{canvas:e},children:t})}function Ti(e,t=[]){let i=Qt(),[r,n]=Be(()=>e(i.getState(),i));return de(()=>i.subscribe(o=>e(o,i),o=>{n(o)},!1),t),r}var Zy=te.createContext([]);function Xy(){let e=Kt(Zy);return Ti(t=>e.map(i=>t.iiif.entities.Canvas[i]).filter(Boolean),[e])}function pn(e={},t=[]){let{id:i,selector:r}=e,n=Jn();Qt();let o=i||n.manifest,l=Ti(u=>o?u.iiif.entities.Manifest[o]:void 0,[o]);return Ae(()=>{if(l)return r?r(l):l},[l,r,...t])}function vc({range:e,children:t}){return Ge(vl,{value:{range:e},children:t})}function Yy(e,t){let i=[];for(let r of t.items)if(r.type==="Canvas"&&(r.id.indexOf("#")!==-1?i.push({id:r.id.split("#")[0],type:"Canvas"}):i.push(r)),r.type==="Range"&&i.push(...Yy(e,e.get(r))),r.type==="SpecificResource"){let n=typeof r.source=="string"?r.source:r.source.id;i.push({id:n,type:"Canvas"})}return i}function HP(e,t,{disablePaging:i,skipNonPaged:r}={}){let n=t.behavior,o=n.includes("paged"),l=o?!1:n.includes("continuous"),u=o||l?!1:n.includes("individuals"),c=t.type==="Manifest"?t.items:Yy(e,t);if(l)return[c,[c.map((_,P)=>P)]];if(u||!o||i)return[c,c.map((_,P)=>[P])];let p=[],f=[],v=()=>{f.length&&(p.push([...f]),f=[])},x=0,E=!1;for(let _=0;_<c.length;_++){let P=e.get(c[_]);if(P.behavior.includes("non-paged")){_===x&&x++,r||(v(),p.push([_]),v());continue}if(_===x||P.behavior.includes("facing-pages")){f.length&&(E=!0),v(),p.push([_]),v();continue}if(f.push(_),E){v(),E=!1;continue}f.length>1&&v()}return f.length&&v(),[c,p]}function bc(e={},t=[]){let{id:i,selector:r}=e,n=Jn(),o=i||n.range,l=Ti(u=>o?u.iiif.entities.Range[o]:void 0,[o]);return Ae(()=>{if(l)return r?r(l):l},[l,r,...t])}function qP({startCanvas:e,disablePaging:t}){var i;let r=Qt(),n=pn(),o=bc(),[l,u]=Be(void 0),c=o||n;if(!c)throw new Error("Nothing selected");let[p,f]=Ae(()=>HP(r,c,{disablePaging:t}),[r,c]),v=He(P=>{let O=f.findIndex(I=>I.includes(P));u(O===-1?0:O)},[p,f]),x=He(P=>{let O=p.findIndex(I=>I.id===P);O!==-1?v(O):u(0)},[p,f]),E=He(()=>{u(P=>P>=f.length?P:P+1)},[f]),_=He(()=>{u(P=>P<=0?0:P-1)},[f]);return typeof l>"u"&&(e?x(e):u(0)),{visibleItems:((i=f[l])==null?void 0:i.map(P=>p[P].id))||[],cursor:l,items:p,sequence:f,setSequenceIndex:u,setCanvasIndex:v,setCanvasId:x,next:E,previous:_}}var No=()=>{},Ky=si({setCurrentCanvasId:No,setCurrentCanvasIndex:No,nextCanvas:No,previousCanvas:No,items:[],sequence:[],setSequenceIndex:No,currentSequenceIndex:0});function QP(e){let t=pn(),{cursor:i,visibleItems:r,next:n,sequence:o,items:l,setCanvasIndex:u,setCanvasId:c,previous:p,setSequenceIndex:f}=qP({startCanvas:e.startCanvas,disablePaging:e.pagingEnabled===!1}),v=Ae(()=>({sequence:o,items:l,setCurrentCanvasId:c,nextCanvas:n,previousCanvas:p,totalCanvases:l.length,setCurrentCanvasIndex:u,setSequenceIndex:f,currentSequenceIndex:i}),[o,l,c,n,p,l,u,f,i]);return t?Ge(Ky.Provider,{value:v,children:Ge(Zy.Provider,{value:r,children:Ge(yc,{canvas:r[0],children:e.children})})}):(console.warn("The manifest passed to the provider is not a valid IIIF manifest."),Ge("div",{children:"Sorry, something went wrong."}))}function VP(e){let t=bl(e.manifest);if(!t)return console.warn("The manifest passed to the provider is not a valid IIIF manifest."),Ge("div",{children:"Sorry, something went wrong."});if(!t.isLoaded)return Ge("div",{children:"Loading..."});let i=Ge(QP,Ci(oi({},e),{children:e.children}));return Ge(wl,{manifest:t.id,children:e.rangeId?Ge(vc,{range:e.rangeId,children:i}):i})}function GP(){return Kt(Ky)}var ZP="@iiif/IMPORT_ENTITIES",XP="@iiif/MODIFY_ENTITY_FIELD",YP="@iiif/REORDER_ENTITY_FIELD",KP="@iiif/ADD_REFERENCE",JP="@iiif/REMOVE_REFERENCE",e2=(0,bi.createAction)(ZP)(),t2=(0,bi.createAction)(XP)(),i2=(0,bi.createAction)(YP)(),r2=(0,bi.createAction)(KP)(),n2=(0,bi.createAction)(JP)(),wc={importEntities:e2,modifyEntityField:t2,reorderEntityField:i2,addReference:r2,removeReference:n2},s2="@iiif/ADD_MAPPING",o2="@iiif/ADD_MAPPINGS";(0,bi.createAction)(s2)(),(0,bi.createAction)(o2)();var a2="@iiif/SET_META_VALUE",l2="@iiif/SET_META_VALUE_DYNAMIC",u2="@iiif/UNSET_META_VALUE";(0,bi.createAction)(a2)(),(0,bi.createAction)(l2)(),(0,bi.createAction)(u2)();var h2="@iiif/REQUEST_RESOURCE",c2="@iiif/REQUEST_ERROR",d2="@iiif/REQUEST_MISMATCH",p2="@iiif/REQUEST_COMPLETE",f2="@iiif/REQUEST_OFFLINE_RESOURCE";(0,bi.createAction)(h2)(),(0,bi.createAction)(c2)(),(0,bi.createAction)(d2)(),(0,bi.createAction)(p2)(),(0,bi.createAction)(f2)();var g2="@iiif/BATCH",m2="@iiif/BATCH_IMPORT";(0,bi.createAction)(g2)(),(0,bi.createAction)(m2)();function y2(){let e=Qt().getStore();return Ae(()=>t=>e.dispatch(t),[e])}function Jy(e){return typeof e!="string"&&e&&e.bindToVault}function v2(){let e=Qt(),t=we([]),i=y2(),r=Ae(()=>`vault://annotation-page/${new Date().getTime()}/${Math.round(Math.random()*1e9).toString(16)}`,[]);At(()=>{let u={id:r,type:"AnnotationPage",behavior:[],motivation:null,label:null,thumbnail:[],summary:null,requiredStatement:null,metadata:[],rights:null,provider:[],items:[],seeAlso:[],homepage:[],logo:[],rendering:[],service:[]};i(wc.importEntities({entities:{AnnotationPage:{[u.id]:u}}}))},[r]);let n=Ti(u=>r?u.iiif.entities.AnnotationPage[r]:null,[r]),o=He((u,c)=>{if(r){if(Jy(u)){let v=u;v.__vault||v.bindToVault(e),u=typeof v.source=="string"?v.source:v.source.id,t.current[u]=v}else typeof u!="string"&&(u=u.id);let p=e.get({id:r,type:"AnnotationPage"}),f=e.get({id:u,type:"Annotation"});p&&f&&(p.items.find(v=>v.id===f.id)||i(wc.addReference({id:r,type:"AnnotationPage",key:"items",reference:{id:u,type:"Annotation"},index:c})))}},[r]),l=He(u=>{r&&(Jy(u)?u=typeof u.source=="string"?u.source:u.source.id:typeof u!="string"&&(u=u.id),t.current[u]&&t.current[u].beforeRemove(),e.get({id:r,type:"AnnotationPage"})&&i(wc.removeReference({id:r,type:"AnnotationPage",key:"items",reference:{id:u,type:"Annotation"}})))},[r]);return[n,{addAnnotation:o,removeAnnotation:l}]}si(null),si(null),te.createContext(null),te.createContext(null);function b2(e){return{addEventListener(t,i,r,n){if(t)return e.setMetaValue([t.id,"eventManager",i],o=>{let l=o||[];for(let u of l)if(u.callback===r)return l;return[...l,{callback:r,scope:n}]}),r},removeEventListener(t,i,r){!t||e.setMetaValue([t.id,"eventManager",i],n=>(n||[]).filter(o=>o.callback!==r))},getListenersAsProps(t,i){let r=typeof t=="string"?{id:t}:t;if(!r||!r.id)return{};let n=e.getResourceMeta(r.id,"eventManager"),o={};if(n&&r)for(let l of Object.keys(n))o[l]=u=>{let c=e.get(r);for(let{callback:p,scope:f}of n[l]||[])(!f||i&&f.indexOf(i)!==-1)&&p(u,c)};return o}}}function xl(e,t){let i=Qt(),r=Ae(()=>b2(i),[i]),n=Ti(()=>e&&e.id?i.getResourceMeta(e.id,"eventManager"):null,[e]);return Ae(()=>e?r.getListenersAsProps(e,t):{},[n,e,i,t])}function ev(e){return{applyStyles(t,i,r){let n=typeof t=="string"?t:t.id;return e.setMetaValue([n,"styles",i],r)},getAppliedStyles(t){let i=typeof t=="string"?t:t.id;return e.getResourceMeta(i,"styles")}}}function es(e,t){let i=Qt(),r=Ae(()=>ev(i),[i]);return Ti(()=>{if(!e)return null;let n=r.getAppliedStyles(e.id);return n?t?n[t]:n:void 0},[e,t])}var w2=Object.defineProperty,x2=Object.defineProperties,_2=Object.getOwnPropertyDescriptors,tv=Object.getOwnPropertySymbols,S2=Object.prototype.hasOwnProperty,E2=Object.prototype.propertyIsEnumerable,iv=(e,t,i)=>t in e?w2(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,rv=(e,t)=>{for(var i in t||(t={}))S2.call(t,i)&&iv(e,i,t[i]);if(tv)for(var i of tv(t))E2.call(t,i)&&iv(e,i,t[i]);return e},nv=(e,t)=>x2(e,_2(t)),A2=/&?(xywh=)?(pixel:|percent:|pct:)?([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?)/,k2=/&?(t=)(npt:)?([0-9]+(.[0-9]+)?)?(,([0-9]+(.[0-9]+)?))?/;function _l(e){if(Array.isArray(e))return e.reduce((t,i)=>{let{selector:r,selectors:n}=_l(i);return r&&(t.selector||(t.selector=r),t.selectors.push(...n)),t},{selector:null,selectors:[]});if(!e)return{selector:null,selectors:[]};if(typeof e=="string"){let[t,i]=e.split("#");return i?_l({type:"FragmentSelector",value:i}):{selector:null,selectors:[]}}if(e.type==="PointSelector"&&(e.t||e.t===0)){let t={type:"TemporalSelector",temporal:{startTime:e.t}};return{selector:t,selectors:[t]}}if(e.type==="FragmentSelector"){let t=A2.exec(e.value);if(t){let r={type:"BoxSelector",spatial:{unit:t[2]==="percent:"||t[2]==="pct:"?"percent":"pixel",x:parseFloat(t[3]),y:parseFloat(t[4]),width:parseFloat(t[5]),height:parseFloat(t[6])}};return{selector:r,selectors:[r]}}let i=e.value.match(k2);if(i){let r={type:"TemporalSelector",temporal:{startTime:i[4]?parseFloat(i[4]):0,endTime:i[7]?parseFloat(i[7]):void 0}};return{selector:r,selectors:[r]}}return{selector:null,selectors:[]}}return{selector:null,selectors:[]}}function qr(e,t={}){if(Array.isArray(e))return qr(e[0]);if(typeof e=="string"){let[i,r]=e.split("#");return r?qr({type:"SpecificResource",source:{id:i,type:"Unknown"},selector:{type:"FragmentSelector",value:r}}):{type:"SpecificResource",source:{id:i,type:t.typeMap&&t.typeMap[i]||"Unknown"},selector:null,selectors:[]}}if(e.type==="Choice"||e.type==="List"||e.type==="Composite"||e.type==="Independents")return qr(e.items[0]);if(e.type==="SpecificResource"){e.source.type==="Canvas"&&e.source.partOf&&typeof e.source.partOf=="string"&&(e.source.partOf=[{id:e.source.partOf,type:"Manifest"}]);let{selector:i,selectors:r}=e.selector?_l(e.selector):{selector:null,selectors:[]};return{type:"SpecificResource",source:e.source,selector:i,selectors:r}}if(e.id){e.type==="Canvas"&&e.partOf&&typeof e.partOf=="string"&&(e.partOf=[{id:e.partOf,type:"Manifest"}]);let[i,r]=e.id.split("#");return r?qr({type:"SpecificResource",source:nv(rv({},e),{id:i}),selector:{type:"FragmentSelector",value:r}}):{type:"SpecificResource",source:nv(rv({},e),{id:i}),selector:null,selectors:[]}}return{type:"SpecificResource",source:e,selector:null,selectors:[]}}function xc(e={},t=[]){let{id:i,selector:r}=e,n=Jn(),o=Qt(),l=i||n.annotation,u=Ti(p=>l?p.iiif.entities.Annotation[l]:void 0,[l]),c=Ti(p=>u&&u.body?u.body.map(f=>f?p.iiif.entities[f.type][f.id]:null).filter(Boolean):[],[u]);return Ae(()=>{if(!u)return;let p=Ci(oi({},u),{body:c,target:qr(u.target,{typeMap:o.getState().iiif.mapping})});return r?r(p):p},[u,r,c,...t])}function fn(e={},t=[]){let{id:i,selector:r}=e,n=Jn(),o=i||n.canvas,l=Ti(u=>o?u.iiif.entities.Canvas[o]:void 0,[o]);return Ae(()=>{if(l)return r?r(l):l},[l,r,...t])}function sv(e){return e.type==="SpecificResource"?[e.source,{selector:e.selector}]:[e,{selector:null}]}function P2(e,t,i){let r=[],n=null,o=[];for(let l of t){let u=e.get(l.body,{skipSelfReturn:!1});for(let c of u){if(!c)continue;let[p,{selector:f}]=sv(c),v=(p.type||"unknown").toLowerCase();if(v==="choice"){let x=e.get(p.items),E=i.length?i.map(_=>x.find(P=>P.id===_)).filter(Boolean):[x[0]];E.length===0&&E.push(x[0]),n={type:"single-choice",items:x.map(_=>({id:_.id,label:_.label,selected:E.indexOf(_)!==-1})),label:c.label},u.push(...E);continue}r.indexOf(v)===-1&&r.push(v),o.push({annotationId:l.id,type:v,resource:p,target:l.target,selector:f})}}return{types:r,items:o,choice:n}}function ov(e,t){let{selector:i,source:r}=$o(t);if(r.id!==e.id)return[null,r];let n={type:"BoxSelector",spatial:{x:0,y:0,width:e.width,height:e.height}};return[i?i.type==="TemporalSelector"?{type:"TemporalBoxSelector",temporal:i.temporal,spatial:n.spatial}:i:null,r]}var C2={makeChoice:()=>{}},_c={type:"unknown"},ai=e=>({type:"unknown",reason:e,annotations:{pages:[]}}),T2=(e,t)=>({type:"empty",width:e,height:t,annotations:{pages:[]},image:null,images:[]});function I2(e,t){var i;let r=(i=e==null?void 0:e.iiif)==null?void 0:i.meta[t];return r?r.annotationPageManager:null}function O2(e,t){return Ti(i=>{let r=[];if(!e)return r;let n=Object.keys(i.iiif.entities.AnnotationPage);for(let o of n)if(!t||t.indexOf(o)!==-1){let l=I2(i,o);l&&l.views&&l.views[e]&&r.push(o)}return r},[e,t])}function R2({canvas:e,manifest:t,all:i,canvases:r}){let n=[];if(t)for(let o of t.annotations)n.indexOf(o.id)===-1&&n.push(o.id);if(i){if(r&&r.length)for(let o of r)for(let l of o.annotations)n.indexOf(l.id)===-1&&n.push(l.id)}else if(e)for(let o of e.annotations)n.indexOf(o.id)===-1&&n.push(o.id);return n}function M2(e,t){var i;let r=(i=e==null?void 0:e.iiif)==null?void 0:i.meta[t];return r?r.annotationPageManager:null}function Sc(e,t={}){let i=Qt(),r=pn(),n=fn(),o=Xy(),l=Ae(()=>R2({all:t.all,manifest:r,canvas:n,canvases:o}),[t.all,n,o,r]),u=O2(e,t.all?void 0:l),c=He(f=>{!e||i.setMetaValue([f,"annotationPageManager","views"],v=>v&&!v[e]?v:Ci(oi({},v||{}),{[e]:!1}))},[e,i]),p=He((f,v={})=>{if(!e)return;let x=i.getState(),E=[];if(v!=null&&v.deselectOthers){let _=Object.keys(x.iiif.entities.AnnotationPage);for(let P of _){let O=M2(x,P);O&&O.views&&O.views[e]&&E.push(P)}}for(let _ of E)c(_);i.setMetaValue([f,"annotationPageManager","views"],_=>_&&_[e]?_:Ci(oi({},_||{}),{[e]:!0}))},[e,c,i]);return{availablePageIds:l,enabledPageIds:u,setPageEnabled:p,setPageDisabled:c}}function L2(e,t){return Ti((i,r)=>r.get(e.map(n=>({id:n,type:t}))),[e,t])}var av=te.createContext(new yl);function Ec(){return Kt(av)}function lv(){let e=Ec(),[t,i]=Be({}),r=we(!1);return de(()=>()=>{r.current=!0},[]),[He((n,{height:o,width:l})=>{if(n){let u=n.id||n["@id"],c=e.loadServiceSync({id:u,width:n.width||l,height:n.height||o,source:n});c?n=c:t[u]||(r.current||i(p=>Ci(oi({},p),{[u]:"loading"})),e.loadService({id:u,width:n.width||l,height:n.height||o}).then(()=>{r.current||i(p=>Ci(oi({},p),{[u]:"done"}))}))}return n},[e,t]),t]}function $2(e={}){let t=xc(),i=fn(e.canvasId?{id:e.canvasId}:void 0);return Ti((r,n)=>{if(!i)return[];if(t&&e.enableSingleAnnotation)return[t];let o=n.get(i.items),l=[];for(let u of o)l.push(...n.get(u.items));return l},[i])}function N2(e,t=[]){let i=Qt(),r=$2({enableSingleAnnotation:e==null?void 0:e.enableSingleAnnotation}),[n,o]=Be((e==null?void 0:e.defaultChoices)||[]),l=Ae(()=>P2(i,r,n),[i,r,n,...t]),u={makeChoice:He((c,{deselectOthers:p=!0,deselect:f=!1}={})=>{if(l.choice){if(l.choice.type!=="single-choice")throw new Error("Complex choice not supported yet");o(v=>{if(f){let E=v.filter(_=>_!==c);if(E.length===0){let _=l.items[0].resource.id;return _?[_]:[]}return E}if(p)return[c];let x=[...v];if(x.length===0&&l.items.length){let E=l.items[0].resource.id;E&&x.push(E)}return v.indexOf(c)!==-1?v:[...v,c]})}},[l.choice])};return[l,u]}function z2(e,t,i){let r=[];for(let n of t.items){let o=n.resource&&n.resource.type==="SpecificResource"?n.resource.source:n.resource;if(!o.id)return ai("No resource Identifier");let l;if(o.service){let _=fc(o);_[0]&&(l=i(_[0],e))}let u={type:"BoxSelector",spatial:{x:0,y:0,width:e.width,height:e.height}},[c,p]=ov(e,n.target);if(p.id!==e.id)continue;let f={type:"BoxSelector",spatial:{x:0,y:0,width:e.width,height:e.height}},v=n.resource.type==="SpecificResource"?qr(n.resource):null,x=v&&v.selector&&(v.selector.type==="BoxSelector"||v.selector.type==="TemporalBoxSelector")?{type:"BoxSelector",spatial:{x:v.selector.spatial.x,y:v.selector.spatial.y,width:v.selector.spatial.width,height:v.selector.spatial.height}}:f;l&&!l.id&&(l.id=l["@id"]);let E={id:o.id,type:"Image",annotationId:n.annotationId,width:c?o.width:e.width,height:c?o.height:e.height,service:l,sizes:l&&l.sizes?l.sizes:o.width&&o.height?[{width:o.width,height:o.height}]:[],target:c&&c.type!=="PointSelector"?c:u,selector:x};r.push(E)}return{type:"images",image:r[0],images:r,choice:t.choice}}var F2=["model/gltf-binary"];function B2(e,t){let i=t.items[0].resource;return i.format?F2.indexOf(i.format)===-1?ai(`3D format: ${i.format} is unsupported`):{type:"3d-model",model:i}:ai("Unknown format")}function j2(e,t){var i;if(!e.duration)return ai("No duration on canvas");if(t.items.length>1)return ai("Only one audio source supported");let r=(i=t.items[0])==null?void 0:i.resource;return r?r.format?{type:"media",media:{annotationId:t.items[0].annotationId,duration:e.duration,url:r.id,type:"Sound",target:{type:"TemporalSelector",temporal:{startTime:0,endTime:e.duration}},format:r.format,selector:{type:"TemporalSelector",temporal:{startTime:0,endTime:e.duration}}},annotations:{pages:[]}}:ai("Audio does not have format"):ai("Unknown audio")}function U2(e,t){var i;let r=t.items.filter(o=>o.type==="video");if(!e.duration)return ai("No duration on canvas");if(r.length>1)return ai("Only one video source supported");let n=(i=r[0])==null?void 0:i.resource;return n?n.format?{type:"media",media:{annotationId:t.items[0].annotationId,duration:e.duration,url:n.id,type:"Video",items:[],target:{type:"TemporalSelector",temporal:{startTime:0,endTime:e.duration}},format:n.format,selector:{type:"TemporalSelector",temporal:{startTime:0,endTime:e.duration}}},annotations:{pages:[]}}:ai("Video does not have format"):ai("Unknown video")}function uv(e,t={},i){let r=e.language||i||"none";switch(e.type){case"TextualBody":{typeof e.value<"u"&&(t[r]=e.value);break}case"List":case"Composite":case"Choice":e.items&&e.items.forEach(n=>uv(n,t,r))}return t}function D2(e,t){let i=[];return t.items.forEach(r=>{if(r.resource){let[n]=ov(e,r.target);i.push({annotationId:r.annotationId,text:uv(r.resource),target:n})}}),{type:"textual-content",items:i}}function W2(e){let t=pn(),i=fn(),r=Qt(),[n,o]=lv(),{enabledPageIds:l}=Sc((e==null?void 0:e.annotationPageManagerId)||(t==null?void 0:t.id)||(i==null?void 0:i.id),{all:!1}),u=L2(l,"AnnotationPage"),c=(e==null?void 0:e.strategies)||["empty","images","media","textual-content","complex-timeline"],[p,f]=N2(e,[o]),v=Ae(()=>{if(!i)return _c;if(p.types.length===0)return c.indexOf("empty")!==-1?T2(i.width,i.height):_c;if(p.types.length!==1)if(p.types.length===2&&p.types.indexOf("text")!==-1)p.types=p.types.filter(E=>E!=="text");else return c.indexOf("complex-timeline")===-1?ai("Complex timeline not supported"):ai("ComplexTimelineStrategy not yet supported");let x=p.types[0];return x==="image"?c.indexOf("images")===-1?ai("Image not supported"):z2(i,p,n):x==="Model"||x==="model"?c.indexOf("3d-model")===-1?ai("3D not supported"):B2(i,p):x==="textualbody"?c.indexOf("textual-content")===-1?ai("Textual content not supported"):D2(i,p):x==="sound"||x==="audio"?c.indexOf("media")===-1?ai("Media not supported"):j2(i,p):x==="video"?c.indexOf("media")===-1?ai("Media not supported"):U2(i,p):_c},[i,p,r,f.makeChoice]);return Ae(()=>v.type==="unknown"?[v,C2]:[Ci(oi({},v),{annotations:{pages:u}}),f],[v,u])}var H2=(e,t=[])=>{let i=Qt();de(()=>{e(i)},[i,...t])};function q2(e,t={}){let i=t.imageServiceLoader||new yl;async function r(n,o,l,u=[],c){if(typeof n=="string")return{best:pc(n),fallback:[],log:[]};let p=e.get(n);if(typeof p=="string")return{best:pc(p),fallback:[],log:[]};switch(p.type){case"Annotation":{let f=p.body,v=e.get(f[0]);return c&&!v.width&&(v.width=c.width,v.height=c.height),await i.getThumbnailFromResource(v,o,l,u)}case"Canvas":{let f=p;if(f.thumbnail&&f.thumbnail.length){let v=e.get(f.thumbnail[0]),x=await i.getImageCandidates(v,l);x&&x.length&&u.push(...x)}return r(f.items[0],o,l,u,{width:f.width,height:f.height})}case"AnnotationPage":return r(p.items[0],o,l,u,c);case"Choice":return r(p.items[0],o,l,u,c);case"Collection":{let f=p.items[0];return r(f,o,l,u,c)}case"Manifest":{let f=p.items[0];return r(f,o,l,u,c)}case"SpecificResource":case"Image":case"Dataset":case"Sound":case"Text":case"TextualBody":case"Video":return c&&!p.width&&(p.width=c.width,p.height=c.height),i.getThumbnailFromResource(p,o,l,u);case"Service":case"Range":case"AnnotationCollection":case"CanvasReference":case"ContentResource":return{best:void 0,fallback:[],log:[]}}return{best:void 0,fallback:[],log:[]}}return{getBestThumbnailAtSize:r}}function Q2(e,t,{canvasId:i,manifestId:r}={}){let n=Qt(),o=Ec(),l=Ae(()=>q2(n,{imageServiceLoader:o}),[n,o]),[u,c]=Be(),p=pn(r?{id:r}:void 0),f=fn(i?{id:i}:void 0),v=f||p,x=we(!1);if(de(()=>(x.current=!1,()=>{x.current=!0}),[]),!v)throw new Error("Must be called under a manifest or canvas context.");return H2(E=>{l.getBestThumbnailAtSize(v,e,t).then(_=>{_.best&&!x.current&&c(_.best)})},[v]),u}function V2(e){return{isMuted:!1,playRequested:!1,isPlaying:!1,isFinished:!1,volume:100,duration:e}}function G2(e,t){switch(t.type){case"FINISHED":return Ci(oi({},e),{isFinished:!0,isPlaying:!1,playRequested:!1});case"PLAY_PAUSE":return Ci(oi({},e),{isFinished:!1,isPlaying:!e.isPlaying});case"PLAY_REQUESTED":return Ci(oi({},e),{isFinished:!1,playRequested:!0});case"PAUSE":return Ci(oi({},e),{isPlaying:!1});case"PLAY":return Ci(oi({},e),{isFinished:!1,playRequested:!1,isPlaying:!0});case"MUTE":return Ci(oi({},e),{isMuted:!0});case"SET_VOLUME":return Ci(oi({},e),{volume:t.volume,isMuted:t.volume===0});case"TOGGLE_MUTE":return Ci(oi({},e),{isMuted:!e.isMuted});case"UNMUTE":return Ci(oi({},e),{isMuted:!1})}return e}function Z2(e){let t=Math.round(e);return`${Math.floor(t/60)}:${`${t%60}`.padStart(2,"0")}`}function hv(e){let[t,i]=ks(G2,V2(e.duration)),r=we(null),n=we(null),o=we(null),l=we(!1),u=He(()=>{n.current&&r.current&&(n.current.innerHTML=Z2(r.current.currentTime),o.current&&(o.current.style.width=`${r.current.currentTime/e.duration*100}%`),l.current!==r.current.muted&&(l.current=r.current.muted,i(r.current.muted?{type:"MUTE"}:{type:"UNMUTE"})))},[e.duration]),c=He(()=>{r.current&&(i({type:"PLAY_REQUESTED"}),r.current.play().then(()=>{i({type:"PLAY"})}),u())},[u]),p=He(()=>{r.current&&(r.current.duration>0&&r.current.paused?c():f())},[u]),f=He(()=>{r.current&&(r.current.pause(),i({type:"PAUSE"}),u())},[u]),v=He(()=>{r.current&&(r.current.muted=!r.current.muted,i(r.current.muted?{type:"MUTE"}:{type:"UNMUTE"}))},[]),x=He(()=>{r.current&&(r.current.muted=!0,i({type:"MUTE"}))},[]),E=He(()=>{r.current&&(r.current.muted=!1,i({type:"UNMUTE"}))},[]),_=He(I=>{r.current&&(r.current.muted=!1,r.current.volume=I/100,i({type:"SET_VOLUME",volume:I}))},[]),P=He(I=>{r.current&&(r.current.currentTime=Math.max(0,Math.min(I*e.duration,e.duration)),u())},[]),O=He(I=>{r.current&&(r.current.currentTime=Math.max(0,Math.min(I,e.duration)),u())},[]);return de(()=>{let I=setInterval(()=>{u()},350);return()=>clearInterval(I)},[u,e.duration]),de(()=>{let I=()=>{i({type:"FINISHED"})},A=r.current;return A==null||A.addEventListener("ended",I),()=>A==null?void 0:A.removeEventListener("ended",I)},[]),[{element:r,currentTime:n,progress:o},t,{play:c,pause:f,playPause:p,mute:x,unmute:E,toggleMute:v,setVolume:_,setDurationPercent:P,setTime:O}]}var X2=si(null),Y2=si(null),K2=si(null);function J2({actions:e,state:t,children:i,currentTime:r,progress:n,element:o}){return Ge(K2.Provider,{value:{currentTime:r,progress:n,element:o},children:Ge(Y2.Provider,{value:e,children:Ge(X2.Provider,{value:t,children:i})})})}function eC(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cv(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tC(e,t,i){return t&&cv(e.prototype,t),i&&cv(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}te.createContext(),function(){function e(){eC(this,e),this.usedNamespaces={}}return tC(e,[{key:"addUsedNamespaces",value:function(t){var i=this;t.forEach(function(r){i.usedNamespaces[r]||(i.usedNamespaces[r]=!0)})}},{key:"getUsedNamespaces",value:function(){return Object.keys(this.usedNamespaces)}}]),e}();function iC(e={},t=[]){let{id:i,selector:r}=e,n=Jn(),o=i||n.annotationPage,l=Ti(u=>o?u.iiif.entities.AnnotationPage[o]:void 0,[o]);return Ae(()=>{if(l)return r?r(l):l},[l,...t])}function Sl(){let e=Kt(mc);return e&&e.vault?e.vault:uy()}function rC(){let e=Qt();return Ae(()=>ev(e),[e])}fe();async function nC(e){if(!e)return null;switch(e){case"static":return{render:"static",interactive:!1,viewport:!0};case"responsive":return{render:"static",interactive:!1,viewport:!1};case"zoom":return{render:"canvas",interactive:!0,viewport:!0}}if(e.startsWith("http"))return fetch(e).then(t=>t.json());if(e.startsWith("#")){let t=document.getElementById(e.slice(1));if(t)try{return JSON.parse(t.innerText)}catch{console.error("Invalid JSON on element",t)}}return null}function sC(e,t){let[i,r]=Be(!1),[n,o]=Be({}),l=e&&!n.__loaded,u=!!((!e||n.__loaded)&&i);return At(()=>{let c=[];return e&&nC(e).then(p=>{if(p){let f=p,{media:v}=f,x=le(f,["media"]),E=Object.keys(v||{}),_=E.map(O=>({query:O,mql:window.matchMedia(O)})),P=()=>{if(!_.length||!v)return C({__loaded:!0},x);let O=_.filter(({mql:A})=>A.matches),I=C(C({__loaded:!0},x),O.reduce((A,$)=>Object.assign(A,v[$.query]),{}));if(t)for(let A of O)t(A.query,I);return I};for(let O of E){let I=window.matchMedia(O),A=()=>{let $=P();o($)};I.addEventListener("change",A),c.push(()=>{I.removeEventListener("change",A)})}o(P())}else o({__loaded:!0})}).catch(()=>{o({__loaded:!0})}),()=>{c.forEach(p=>p())}},[u,e]),{internalConfig:n,isReady:u,isConfigBlocking:l,setIsReady:r}}fe();var zo=(e,t,i)=>{let r=e.length,n=i||Le(r);for(let o=0;o<r;o++)n[o]=o%5===0?e[o+1]<t[3]&&e[o+3]>t[1]&&e[o+2]<t[4]&&e[o+4]>t[2]?1:0:e[o];return n};function Le(e,t,i){return new Float32Array(e,t,i)}var oC=(e,t,i)=>{let r=e[1]<=t[3]&&e[3]>=t[1]&&e[2]<=t[4]&&e[4]>=t[2],n=i||Le(5);return r?(n[0]=1,n[1]=Math.max(e[1],t[1]),n[2]=Math.max(e[2],t[2]),n[3]=Math.min(e[3],t[3]),n[4]=Math.min(e[4],t[4]),n):(n[0]=0,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n)},aC=e=>e.length/5,Qr=(e,t,i)=>{let r=i||Le(9);return r[0]=e[0]*t[0]+e[1]*t[3]+e[2]*t[6],r[1]=e[0]*t[1]+e[1]*t[4]+e[2]*t[7],r[2]=e[0]*t[2]+e[1]*t[5]+e[2]*t[8],r[3]=e[3]*t[0]+e[4]*t[3]+e[5]*t[6],r[4]=e[3]*t[1]+e[4]*t[4]+e[5]*t[7],r[5]=e[3]*t[2]+e[4]*t[5]+e[5]*t[8],r[6]=e[6]*t[0]+e[7]*t[3]+e[8]*t[6],r[7]=e[6]*t[1]+e[7]*t[4]+e[8]*t[7],r[8]=e[6]*t[2]+e[7]*t[5]+e[8]*t[8],r},st=class{constructor(e){this.index=0,this.length=e,this.points=Le(this.length)}static grid(e=1,t=1){return new st(5*e*t)}static point(e,t){let i=Le(5);return i[0]=1,i[1]=e,i[2]=t,i[3]=e,i[4]=t,i}static positionPair(e){let t=Le(5);return t[0]=1,t[1]=e.x1,t[2]=e.y1,t[3]=e.x2,t[4]=e.y2,t}static projection(e){return st.singleBox(e.width,e.height,e.x,e.y)}static singleBox(e,t,i=0,r=0){let n=Le(5);return n[0]=1,n[1]=i,n[2]=r,n[3]=e+i,n[4]=t+r,n}row(e){return e(this)}addPoints(e,t,i,r){return this.points[this.index]=1,this.points[1+this.index]=e,this.points[2+this.index]=t,this.points[3+this.index]=i,this.points[4+this.index]=r,this.index+=5,this}addBox(e,t,i,r){return this.addPoints(e,t,e+i,t+r),this}build(){return this.points}},kr=(e,t)=>{let i=e.length;for(let r=0;r<i;r++)e[r]=r%5===0?t[6]*e[r+1]+t[7]*e[r+2]+t[8]*e[r]:r%5%2===1?t[0]*e[r]+t[1]*e[r+1]+t[2]:t[3]*e[r-1]+t[4]*e[r]+t[5];return e},gn=e=>{let t=Le(9);return t[0]=e,t[4]=e,t[8]=1,t},Fi=(e,t)=>{let i=Le(9);return i[0]=1,i[2]=e,i[4]=1,i[5]=t,i[8]=1,i},Fo=(e,t,i)=>Qr(Fi((1-e)*t,(1-e)*i),gn(e)),Vr=(e,t,i)=>{let r=e.length,n=i&&i.length>=r?i.slice(0,r):Le(r);for(let o=0;o<r;o++)n[o]=o%5===0?t[6]*e[o+1]+t[7]*e[o+2]+t[8]*e[o]:o%5%2===1?t[0]*e[o]+t[1]*e[o+1]+t[2]:t[3]*e[o-1]+t[4]*e[o]+t[5];return n},Bo=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,lC=typeof AbortController=="function",El=lC?AbortController:class{constructor(){this.signal=new dv}abort(e=new Error("This operation was aborted")){this.signal.reason=this.signal.reason||e,this.signal.aborted=!0,this.signal.dispatchEvent({type:"abort",target:this.signal})}},uC=typeof AbortSignal=="function",hC=typeof El.AbortSignal=="function",dv=uC?AbortSignal:hC?El.AbortController:class{constructor(){this.reason=void 0,this.aborted=!1,this._listeners=[]}dispatchEvent(e){e.type==="abort"&&(this.aborted=!0,this.onabort(e),this._listeners.forEach(t=>t(e),this))}onabort(){}addEventListener(e,t){e==="abort"&&this._listeners.push(t)}removeEventListener(e,t){e==="abort"&&(this._listeners=this._listeners.filter(i=>i!==t))}},Ac=new Set,kc=(e,t)=>{let i=`LRU_CACHE_OPTION_${e}`;Al(i)&&Cc(i,`${e} option`,`options.${t}`,Ws)},Pc=(e,t)=>{let i=`LRU_CACHE_METHOD_${e}`;if(Al(i)){let{prototype:r}=Ws,{get:n}=Object.getOwnPropertyDescriptor(r,e);Cc(i,`${e} method`,`cache.${t}()`,n)}},cC=(e,t)=>{let i=`LRU_CACHE_PROPERTY_${e}`;if(Al(i)){let{prototype:r}=Ws,{get:n}=Object.getOwnPropertyDescriptor(r,e);Cc(i,`${e} property`,`cache.${t}`,n)}},pv=(...e)=>{typeof process=="object"&&process&&typeof process.emitWarning=="function"?process.emitWarning(...e):console.error(...e)},Al=e=>!Ac.has(e),Cc=(e,t,i,r)=>{Ac.add(e);let n=`The ${t} is deprecated. Please use ${i} instead.`;pv(n,"DeprecationWarning",e,r)},mn=e=>e&&e===Math.floor(e)&&e>0&&isFinite(e),fv=e=>mn(e)?e<=Math.pow(2,8)?Uint8Array:e<=Math.pow(2,16)?Uint16Array:e<=Math.pow(2,32)?Uint32Array:e<=Number.MAX_SAFE_INTEGER?kl:null:null,kl=class extends Array{constructor(e){super(e),this.fill(0)}},dC=class{constructor(e){if(e===0)return[];let t=fv(e);this.heap=new t(e),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}},Ws=class{constructor(e={}){let{max:t=0,ttl:i,ttlResolution:r=1,ttlAutopurge:n,updateAgeOnGet:o,updateAgeOnHas:l,allowStale:u,dispose:c,disposeAfter:p,noDisposeOnSet:f,noUpdateTTL:v,maxSize:x=0,maxEntrySize:E=0,sizeCalculation:_,fetchMethod:P,fetchContext:O,noDeleteOnFetchRejection:I,noDeleteOnStaleGet:A,allowStaleOnFetchRejection:$,allowStaleOnFetchAbort:z,ignoreFetchAbort:B}=e,{length:H,maxAge:Y,stale:V}=e instanceof Ws?{}:e;if(t!==0&&!mn(t))throw new TypeError("max option must be a nonnegative integer");let he=t?fv(t):Array;if(!he)throw new Error("invalid max value: "+t);if(this.max=t,this.maxSize=x,this.maxEntrySize=E||this.maxSize,this.sizeCalculation=_||H,this.sizeCalculation){if(!this.maxSize&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(this.fetchMethod=P||null,this.fetchMethod&&typeof this.fetchMethod!="function")throw new TypeError("fetchMethod must be a function if specified");if(this.fetchContext=O,!this.fetchMethod&&O!==void 0)throw new TypeError("cannot set fetchContext without fetchMethod");if(this.keyMap=new Map,this.keyList=new Array(t).fill(null),this.valList=new Array(t).fill(null),this.next=new he(t),this.prev=new he(t),this.head=0,this.tail=0,this.free=new dC(t),this.initialFill=1,this.size=0,typeof c=="function"&&(this.dispose=c),typeof p=="function"?(this.disposeAfter=p,this.disposed=[]):(this.disposeAfter=null,this.disposed=null),this.noDisposeOnSet=!!f,this.noUpdateTTL=!!v,this.noDeleteOnFetchRejection=!!I,this.allowStaleOnFetchRejection=!!$,this.allowStaleOnFetchAbort=!!z,this.ignoreFetchAbort=!!B,this.maxEntrySize!==0){if(this.maxSize!==0&&!mn(this.maxSize))throw new TypeError("maxSize must be a positive integer if specified");if(!mn(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.initializeSizeTracking()}if(this.allowStale=!!u||!!V,this.noDeleteOnStaleGet=!!A,this.updateAgeOnGet=!!o,this.updateAgeOnHas=!!l,this.ttlResolution=mn(r)||r===0?r:1,this.ttlAutopurge=!!n,this.ttl=i||Y||0,this.ttl){if(!mn(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.initializeTTLTracking()}if(this.max===0&&this.ttl===0&&this.maxSize===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.max&&!this.maxSize){let Q="LRU_CACHE_UNBOUNDED";Al(Q)&&(Ac.add(Q),pv("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",Q,Ws))}V&&kc("stale","allowStale"),Y&&kc("maxAge","ttl"),H&&kc("length","sizeCalculation")}getRemainingTTL(e){return this.has(e,{updateAgeOnHas:!1})?1/0:0}initializeTTLTracking(){this.ttls=new kl(this.max),this.starts=new kl(this.max),this.setItemTTL=(i,r,n=Bo.now())=>{if(this.starts[i]=r!==0?n:0,this.ttls[i]=r,r!==0&&this.ttlAutopurge){let o=setTimeout(()=>{this.isStale(i)&&this.delete(this.keyList[i])},r+1);o.unref&&o.unref()}},this.updateItemAge=i=>{this.starts[i]=this.ttls[i]!==0?Bo.now():0},this.statusTTL=(i,r)=>{i&&(i.ttl=this.ttls[r],i.start=this.starts[r],i.now=e||t(),i.remainingTTL=i.now+i.ttl-i.start)};let e=0,t=()=>{let i=Bo.now();if(this.ttlResolution>0){e=i;let r=setTimeout(()=>e=0,this.ttlResolution);r.unref&&r.unref()}return i};this.getRemainingTTL=i=>{let r=this.keyMap.get(i);return r===void 0?0:this.ttls[r]===0||this.starts[r]===0?1/0:this.starts[r]+this.ttls[r]-(e||t())},this.isStale=i=>this.ttls[i]!==0&&this.starts[i]!==0&&(e||t())-this.starts[i]>this.ttls[i]}updateItemAge(e){}statusTTL(e,t){}setItemTTL(e,t,i){}isStale(e){return!1}initializeSizeTracking(){this.calculatedSize=0,this.sizes=new kl(this.max),this.removeItemSize=e=>{this.calculatedSize-=this.sizes[e],this.sizes[e]=0},this.requireSize=(e,t,i,r)=>{if(this.isBackgroundFetch(t))return 0;if(!mn(i))if(r){if(typeof r!="function")throw new TypeError("sizeCalculation must be a function");if(i=r(t,e),!mn(i))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return i},this.addItemSize=(e,t,i)=>{if(this.sizes[e]=t,this.maxSize){let r=this.maxSize-this.sizes[e];for(;this.calculatedSize>r;)this.evict(!0)}this.calculatedSize+=this.sizes[e],i&&(i.entrySize=t,i.totalCalculatedSize=this.calculatedSize)}}removeItemSize(e){}addItemSize(e,t){}requireSize(e,t,i,r){if(i||r)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache")}*indexes({allowStale:e=this.allowStale}={}){if(this.size)for(let t=this.tail;!(!this.isValidIndex(t)||((e||!this.isStale(t))&&(yield t),t===this.head));)t=this.prev[t]}*rindexes({allowStale:e=this.allowStale}={}){if(this.size)for(let t=this.head;!(!this.isValidIndex(t)||((e||!this.isStale(t))&&(yield t),t===this.tail));)t=this.next[t]}isValidIndex(e){return e!==void 0&&this.keyMap.get(this.keyList[e])===e}*entries(){for(let e of this.indexes())this.valList[e]!==void 0&&this.keyList[e]!==void 0&&!this.isBackgroundFetch(this.valList[e])&&(yield[this.keyList[e],this.valList[e]])}*rentries(){for(let e of this.rindexes())this.valList[e]!==void 0&&this.keyList[e]!==void 0&&!this.isBackgroundFetch(this.valList[e])&&(yield[this.keyList[e],this.valList[e]])}*keys(){for(let e of this.indexes())this.keyList[e]!==void 0&&!this.isBackgroundFetch(this.valList[e])&&(yield this.keyList[e])}*rkeys(){for(let e of this.rindexes())this.keyList[e]!==void 0&&!this.isBackgroundFetch(this.valList[e])&&(yield this.keyList[e])}*values(){for(let e of this.indexes())this.valList[e]!==void 0&&!this.isBackgroundFetch(this.valList[e])&&(yield this.valList[e])}*rvalues(){for(let e of this.rindexes())this.valList[e]!==void 0&&!this.isBackgroundFetch(this.valList[e])&&(yield this.valList[e])}[Symbol.iterator](){return this.entries()}find(e,t){for(let i of this.indexes()){let r=this.valList[i],n=this.isBackgroundFetch(r)?r.__staleWhileFetching:r;if(n!==void 0&&e(n,this.keyList[i],this))return this.get(this.keyList[i],t)}}forEach(e,t=this){for(let i of this.indexes()){let r=this.valList[i],n=this.isBackgroundFetch(r)?r.__staleWhileFetching:r;n!==void 0&&e.call(t,n,this.keyList[i],this)}}rforEach(e,t=this){for(let i of this.rindexes()){let r=this.valList[i],n=this.isBackgroundFetch(r)?r.__staleWhileFetching:r;n!==void 0&&e.call(t,n,this.keyList[i],this)}}get prune(){return Pc("prune","purgeStale"),this.purgeStale}purgeStale(){let e=!1;for(let t of this.rindexes({allowStale:!0}))this.isStale(t)&&(this.delete(this.keyList[t]),e=!0);return e}dump(){let e=[];for(let t of this.indexes({allowStale:!0})){let i=this.keyList[t],r=this.valList[t],n=this.isBackgroundFetch(r)?r.__staleWhileFetching:r;if(n===void 0)continue;let o={value:n};if(this.ttls){o.ttl=this.ttls[t];let l=Bo.now()-this.starts[t];o.start=Math.floor(Date.now()-l)}this.sizes&&(o.size=this.sizes[t]),e.unshift([i,o])}return e}load(e){this.clear();for(let[t,i]of e){if(i.start){let r=Date.now()-i.start;i.start=Bo.now()-r}this.set(t,i.value,i)}}dispose(e,t,i){}set(e,t,{ttl:i=this.ttl,start:r,noDisposeOnSet:n=this.noDisposeOnSet,size:o=0,sizeCalculation:l=this.sizeCalculation,noUpdateTTL:u=this.noUpdateTTL,status:c}={}){if(o=this.requireSize(e,t,o,l),this.maxEntrySize&&o>this.maxEntrySize)return c&&(c.set="miss",c.maxEntrySizeExceeded=!0),this.delete(e),this;let p=this.size===0?void 0:this.keyMap.get(e);if(p===void 0)p=this.newIndex(),this.keyList[p]=e,this.valList[p]=t,this.keyMap.set(e,p),this.next[this.tail]=p,this.prev[p]=this.tail,this.tail=p,this.size++,this.addItemSize(p,o,c),c&&(c.set="add"),u=!1;else{this.moveToTail(p);let f=this.valList[p];if(t!==f){if(this.isBackgroundFetch(f)?f.__abortController.abort(new Error("replaced")):n||(this.dispose(f,e,"set"),this.disposeAfter&&this.disposed.push([f,e,"set"])),this.removeItemSize(p),this.valList[p]=t,this.addItemSize(p,o,c),c){c.set="replace";let v=f&&this.isBackgroundFetch(f)?f.__staleWhileFetching:f;v!==void 0&&(c.oldValue=v)}}else c&&(c.set="update")}if(i!==0&&this.ttl===0&&!this.ttls&&this.initializeTTLTracking(),u||this.setItemTTL(p,i,r),this.statusTTL(c,p),this.disposeAfter)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return this}newIndex(){return this.size===0?this.tail:this.size===this.max&&this.max!==0?this.evict(!1):this.free.length!==0?this.free.pop():this.initialFill++}pop(){if(this.size){let e=this.valList[this.head];return this.evict(!0),e}}evict(e){let t=this.head,i=this.keyList[t],r=this.valList[t];return this.isBackgroundFetch(r)?r.__abortController.abort(new Error("evicted")):(this.dispose(r,i,"evict"),this.disposeAfter&&this.disposed.push([r,i,"evict"])),this.removeItemSize(t),e&&(this.keyList[t]=null,this.valList[t]=null,this.free.push(t)),this.head=this.next[t],this.keyMap.delete(i),this.size--,t}has(e,{updateAgeOnHas:t=this.updateAgeOnHas,status:i}={}){let r=this.keyMap.get(e);if(r!==void 0)if(this.isStale(r))i&&(i.has="stale",this.statusTTL(i,r));else return t&&this.updateItemAge(r),i&&(i.has="hit"),this.statusTTL(i,r),!0;else i&&(i.has="miss");return!1}peek(e,{allowStale:t=this.allowStale}={}){let i=this.keyMap.get(e);if(i!==void 0&&(t||!this.isStale(i))){let r=this.valList[i];return this.isBackgroundFetch(r)?r.__staleWhileFetching:r}}backgroundFetch(e,t,i,r){let n=t===void 0?void 0:this.valList[t];if(this.isBackgroundFetch(n))return n;let o=new El;i.signal&&i.signal.addEventListener("abort",()=>o.abort(i.signal.reason));let l={signal:o.signal,options:i,context:r},u=(x,E=!1)=>{let{aborted:_}=o.signal,P=i.ignoreFetchAbort&&x!==void 0;return i.status&&(_&&!E?(i.status.fetchAborted=!0,i.status.fetchError=o.signal.reason,P&&(i.status.fetchAbortIgnored=!0)):i.status.fetchResolved=!0),_&&!P&&!E?p(o.signal.reason):(this.valList[t]===v&&(x===void 0?v.__staleWhileFetching?this.valList[t]=v.__staleWhileFetching:this.delete(e):(i.status&&(i.status.fetchUpdated=!0),this.set(e,x,l.options))),x)},c=x=>(i.status&&(i.status.fetchRejected=!0,i.status.fetchError=x),p(x)),p=x=>{let{aborted:E}=o.signal,_=E&&i.allowStaleOnFetchAbort,P=_||i.allowStaleOnFetchRejection,O=P||i.noDeleteOnFetchRejection;if(this.valList[t]===v&&(!O||v.__staleWhileFetching===void 0?this.delete(e):_||(this.valList[t]=v.__staleWhileFetching)),P)return i.status&&v.__staleWhileFetching!==void 0&&(i.status.returnedStale=!0),v.__staleWhileFetching;if(v.__returned===v)throw x},f=(x,E)=>{this.fetchMethod(e,n,l).then(_=>x(_),E),o.signal.addEventListener("abort",()=>{(!i.ignoreFetchAbort||i.allowStaleOnFetchAbort)&&(x(),i.allowStaleOnFetchAbort&&(x=_=>u(_,!0)))})};i.status&&(i.status.fetchDispatched=!0);let v=new Promise(f).then(u,c);return v.__abortController=o,v.__staleWhileFetching=n,v.__returned=null,t===void 0?(this.set(e,v,D(C({},l.options),{status:void 0})),t=this.keyMap.get(e)):this.valList[t]=v,v}isBackgroundFetch(e){return e&&typeof e=="object"&&typeof e.then=="function"&&Object.prototype.hasOwnProperty.call(e,"__staleWhileFetching")&&Object.prototype.hasOwnProperty.call(e,"__returned")&&(e.__returned===e||e.__returned===null)}async fetch(e,{allowStale:t=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:r=this.noDeleteOnStaleGet,ttl:n=this.ttl,noDisposeOnSet:o=this.noDisposeOnSet,size:l=0,sizeCalculation:u=this.sizeCalculation,noUpdateTTL:c=this.noUpdateTTL,noDeleteOnFetchRejection:p=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:f=this.allowStaleOnFetchRejection,ignoreFetchAbort:v=this.ignoreFetchAbort,allowStaleOnFetchAbort:x=this.allowStaleOnFetchAbort,fetchContext:E=this.fetchContext,forceRefresh:_=!1,status:P,signal:O}={}){if(!this.fetchMethod)return P&&(P.fetch="get"),this.get(e,{allowStale:t,updateAgeOnGet:i,noDeleteOnStaleGet:r,status:P});let I={allowStale:t,updateAgeOnGet:i,noDeleteOnStaleGet:r,ttl:n,noDisposeOnSet:o,size:l,sizeCalculation:u,noUpdateTTL:c,noDeleteOnFetchRejection:p,allowStaleOnFetchRejection:f,allowStaleOnFetchAbort:x,ignoreFetchAbort:v,status:P,signal:O},A=this.keyMap.get(e);if(A===void 0){P&&(P.fetch="miss");let $=this.backgroundFetch(e,A,I,E);return $.__returned=$}else{let $=this.valList[A];if(this.isBackgroundFetch($)){let V=t&&$.__staleWhileFetching!==void 0;return P&&(P.fetch="inflight",V&&(P.returnedStale=!0)),V?$.__staleWhileFetching:$.__returned=$}let z=this.isStale(A);if(!_&&!z)return P&&(P.fetch="hit"),this.moveToTail(A),i&&this.updateItemAge(A),this.statusTTL(P,A),$;let B=this.backgroundFetch(e,A,I,E),H=B.__staleWhileFetching!==void 0,Y=H&&t;return P&&(P.fetch=H&&z?"stale":"refresh",Y&&z&&(P.returnedStale=!0)),Y?B.__staleWhileFetching:B.__returned=B}}get(e,{allowStale:t=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:r=this.noDeleteOnStaleGet,status:n}={}){let o=this.keyMap.get(e);if(o!==void 0){let l=this.valList[o],u=this.isBackgroundFetch(l);return this.statusTTL(n,o),this.isStale(o)?(n&&(n.get="stale"),u?(n&&(n.returnedStale=t&&l.__staleWhileFetching!==void 0),t?l.__staleWhileFetching:void 0):(r||this.delete(e),n&&(n.returnedStale=t),t?l:void 0)):(n&&(n.get="hit"),u?l.__staleWhileFetching:(this.moveToTail(o),i&&this.updateItemAge(o),l))}else n&&(n.get="miss")}connect(e,t){this.prev[t]=e,this.next[e]=t}moveToTail(e){e!==this.tail&&(e===this.head?this.head=this.next[e]:this.connect(this.prev[e],this.next[e]),this.connect(this.tail,e),this.tail=e)}get del(){return Pc("del","delete"),this.delete}delete(e){let t=!1;if(this.size!==0){let i=this.keyMap.get(e);if(i!==void 0)if(t=!0,this.size===1)this.clear();else{this.removeItemSize(i);let r=this.valList[i];this.isBackgroundFetch(r)?r.__abortController.abort(new Error("deleted")):(this.dispose(r,e,"delete"),this.disposeAfter&&this.disposed.push([r,e,"delete"])),this.keyMap.delete(e),this.keyList[i]=null,this.valList[i]=null,i===this.tail?this.tail=this.prev[i]:i===this.head?this.head=this.next[i]:(this.next[this.prev[i]]=this.next[i],this.prev[this.next[i]]=this.prev[i]),this.size--,this.free.push(i)}}if(this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return t}clear(){for(let e of this.rindexes({allowStale:!0})){let t=this.valList[e];if(this.isBackgroundFetch(t))t.__abortController.abort(new Error("deleted"));else{let i=this.keyList[e];this.dispose(t,i,"delete"),this.disposeAfter&&this.disposed.push([t,i,"delete"])}}if(this.keyMap.clear(),this.valList.fill(null),this.keyList.fill(null),this.ttls&&(this.ttls.fill(0),this.starts.fill(0)),this.sizes&&this.sizes.fill(0),this.head=0,this.tail=0,this.initialFill=1,this.free.length=0,this.calculatedSize=0,this.size=0,this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift())}get reset(){return Pc("reset","clear"),this.clear}get length(){return cC("length","size"),this.size}static get AbortController(){return El}static get AbortSignal(){return dv}},pC=Ws,fC=je(Kw(),1);fe(),fe(),fe();var gv=je(Jw());function gC({debounce:e,scroll:t,polyfill:i}={debounce:0,scroll:!1}){let r=i||(typeof window>"u"?class{}:window.ResizeObserver);if(!r)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");let[n,o]=Be({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),l=we({element:null,scrollContainers:null,resizeObserver:null,lastBounds:n}),u=e?typeof e=="number"?e:e.scroll:null,c=e?typeof e=="number"?e:e.resize:null,p=we(!1);de(()=>(p.current=!0,()=>void(p.current=!1)));let[f,v,x]=Ae(()=>{let O=()=>{if(!l.current.element)return;let{left:I,top:A,width:$,height:z,bottom:B,right:H,x:Y,y:V}=l.current.element.getBoundingClientRect(),he={left:I,top:A,width:$,height:z,bottom:B,right:H,x:Y,y:V};Object.freeze(he),p.current&&!bC(l.current.lastBounds,he)&&o(l.current.lastBounds=he)};return[O,c?(0,gv.debounce)(O,c):O,u?(0,gv.debounce)(O,u):O]},[o,u,c]);function E(){l.current.scrollContainers&&(l.current.scrollContainers.forEach(O=>O.removeEventListener("scroll",x,!0)),l.current.scrollContainers=null),l.current.resizeObserver&&(l.current.resizeObserver.disconnect(),l.current.resizeObserver=null)}function _(){!l.current.element||(l.current.resizeObserver=new r(x),l.current.resizeObserver.observe(l.current.element),t&&l.current.scrollContainers&&l.current.scrollContainers.forEach(O=>O.addEventListener("scroll",x,{capture:!0,passive:!0})))}let P=O=>{!O||O===l.current.element||(E(),l.current.element=O,l.current.scrollContainers=mv(O),_())};return yC(x,!!t),mC(v),de(()=>{E(),_()},[t,x,v]),de(()=>E,[]),[P,n,f]}function mC(e){de(()=>{let t=e;return window.addEventListener("resize",t),()=>void window.removeEventListener("resize",t)},[e])}function yC(e,t){de(()=>{if(t){let i=e;return window.addEventListener("scroll",i,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",i,!0)}},[e,t])}function mv(e){let t=[];if(!e||e===document.body)return t;let{overflow:i,overflowX:r,overflowY:n}=window.getComputedStyle(e);return[i,r,n].some(o=>o==="auto"||o==="scroll")&&t.push(e),[...t,...mv(e.parentElement)]}var vC=["x","y","top","bottom","left","right","width","height"],bC=(e,t)=>vC.every(i=>e[i]===t[i]),yv=gC;fe(),fe();var wC=je(ff(),1);fe(),fe(),fe(),fe(),fe(),fe(),fe(),fe(),fe(),fe(),fe(),fe(),fe(),fe(),fe(),fe(),fe(),fe(),fe(),fe(),fe(),fe(),fe(),fe();var xC=Object.defineProperty,_C=(e,t,i)=>t in e?xC(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,M=(e,t,i)=>(_C(e,typeof t!="symbol"?t+"":t,i),i),Pl=["onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut","onScroll","onWheel","onClick","onDragStart","onDragEnd","onDragEnter","onDragExit","onDrag","onDragOver"];function SC(){return Pl.reduce((e,t)=>(e[t]=[],e),{})}var Hs=Pl.reduce((e,t)=>(e[t.slice(2).toLowerCase()]=t,e[t]=t,e),{}),EC="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",Cl=(e=21)=>{let t="",i=crypto.getRandomValues(new Uint8Array(e));for(;e--;)t+=EC[i[e]&63];return t},Pr=class{constructor(){M(this,"__id"),M(this,"__revision",0),M(this,"__host"),M(this,"__onCreate"),M(this,"__parent"),M(this,"__owner",{value:void 0}),M(this,"__state",{}),M(this,"eventHandlers"),M(this,"scale",1),M(this,"layers",[]),M(this,"time",[]),M(this,"_crop"),M(this,"cropData"),M(this,"id"),M(this,"addEventListener",(e,t,i)=>{let r=Hs[e];if(!this.eventHandlers[r])throw new Error(`Unknown event ${r}`);this.eventHandlers[r].indexOf(t)===-1&&this.eventHandlers[r].push(t)}),M(this,"removeEventListener",(e,t)=>{let i=Hs[e];if(!this.eventHandlers[i]){console.warn(`Unknown event ${i}`);return}this.eventHandlers[i].indexOf(t)!==-1&&(this.eventHandlers[i]=this.eventHandlers[i].filter(r=>r!==t))}),this.id=this.__id=Cl(),this.eventHandlers=SC()}get crop(){return this._crop}set crop(e){this._crop=e}getObjectsAt(e){return[]}getAllPointsAt(e,t,i){return[]}getScheduledUpdates(e,t){return[]}dispatchEvent(e,t){let i=this.eventHandlers[e],r=i?i.length:0,n=!1;if(r)for(let o=0;o<r;o++)try{i[o](t),n=!0}catch(l){console.error(e,l)}return n}get x(){return this.points[1]}get y(){return this.points[2]}get width(){return this.points[3]-this.points[1]}get height(){return this.points[4]-this.points[2]}translate(e,t){kr(this.points,Fi(e,t))}atScale(e){kr(this.points,Fo(e,this.x,this.y)),this.scale*=e}transform(e){kr(this.points,e)}applyProps(e){this.__revision++}appendChild(e){}removeChild(e){}insertBefore(e,t){}hideInstance(){}},Gr=class Pp extends Pr{constructor(t){if(super(),M(this,"type","spacial-content"),M(this,"id"),M(this,"uri"),M(this,"display"),M(this,"points"),M(this,"priority"),M(this,"style",{opacity:1}),!t)this.id="",this.uri="",this.display={x:0,y:0,scale:1,width:0,height:0,points:Le(5)},this.points=Le(5);else{let i=t.scale||1;this.id=t.id||t.uri,this.uri=t.uri,this.points=st.singleBox(t.width,t.height,t.x,t.y),this.display={x:0,y:0,scale:i,width:t.width/i,height:t.height/i,points:st.singleBox(t.width/i,t.height/i),rotation:t==null?void 0:t.rotation}}}applyProps(t){let i=t.display?t.display.width:t.target.width,r=t.target.width/i;if(this.id=t.id||t.uri,this.uri=t.uri,this.points.set(st.singleBox(t.target.width,t.target.height,t.target.x,t.target.y)),t.style&&typeof t.style.opacity<"u"&&(this.style.opacity=t.style.opacity),t.crop){this.cropData=t.crop;let n=st.singleBox(t.crop.width,t.crop.height,t.crop.x,t.crop.y);kr(n,Fi(-t.crop.x,-t.crop.y)),this.crop?this.crop.set(n):this.crop=Le(n)}t.display?(this.display.scale=r,this.display.width=t.display.width,this.display.height=t.display.height,this.display.rotation=t.display.rotation,this.display.points=st.singleBox(t.display.width,t.display.height)):(this.display.scale=r,this.display.width=t.target.width/r,this.display.height=t.target.height/r,this.display.points=st.singleBox(t.target.width/r,t.target.height/r))}getAllPointsAt(t,i,r){return[[this,this.crop||this.points,i]]}static fromSvg(t,i,r,n){return Pp.fromImage("data:image/svg+xml;base64,"+btoa(t),i,r,n)}static fromImage(t,i,r,n){let o=new Pp;return o.applyProps({uri:t,id:n,display:r,target:i}),o}getImageUrl(){return this.uri}},Tl=class extends Pr{constructor(e){if(super(),M(this,"type","spacial-content"),M(this,"id"),M(this,"uri"),M(this,"display"),M(this,"points"),M(this,"getTexture"),this.getTexture=()=>({source:void 0,hash:-1}),!e)this.id="",this.uri="",this.display={x:0,y:0,scale:1,width:0,height:0,points:Le(5)},this.points=Le(5);else{let t=e.scale||1;this.id=e.id||e.uri,this.uri=e.uri,this.points=st.singleBox(e.width,e.height),this.display={x:0,y:0,scale:t,width:e.width/t,height:e.height/t,points:t!==1?st.singleBox(e.width/t,e.height/t):this.points}}}applyProps(e){let t=e.display?e.display.width:e.target.width,i=e.target.width/t;this.id=e.id,this.points.set(st.singleBox(e.target.width,e.target.height)),this.display.scale=i,this.display.width=e.target.width/i,this.display.height=e.target.height/i,this.getTexture=e.getTexture,this.display.points=i!==1?st.singleBox(e.target.width/i,e.target.height/i):this.points}getAllPointsAt(e,t,i){return[[this,this.points,t]]}};function AC(e,t,i=1){let r=t.length;if(r===0)throw new Error("No resources passed in.");let n=0;for(let o=0;o<r&&!(!t[o]||!t[o].display);o++)n=Math.abs(t[o].display.scale-e)*i<Math.abs(t[n].display.scale-e)?o:n;return n}function vv(e,t){return Math.abs(e-t)}function Il(e,t){let i=vv(e.x,t.x),r=vv(e.y,t.y);return Math.sqrt(Math.pow(i,2)+Math.pow(r,2))}function kC(e){let t=e.length;return e.indexOf("/info.json")===t-10?e.slice(0,-10):e}function Ol(e,t,i){return Math.min(Math.max(e,t),i)}var ts=class yw extends Pr{constructor(t){super(),M(this,"id"),M(this,"type","spacial-content"),M(this,"display"),M(this,"tileWidth"),M(this,"style",{opacity:1}),M(this,"points"),M(this,"service"),M(this,"format","jpg"),M(this,"crop2"),M(this,"tileUrl"),this.tileUrl=kC(t.url),this.id=t.id||`${this.tileUrl}--${t.scaleFactor}`,this.points=t.displayPoints?t.displayPoints:Vr(t.points,gn(t.scaleFactor)),this.tileWidth=t.tileWidth,this.display={x:0,y:0,width:t.width/t.scaleFactor,height:t.height/t.scaleFactor,points:t.points,scale:t.scaleFactor},t.format&&(this.format=t.format)}applyProps(t){if(t.style&&typeof t.style.opacity<"u"&&(this.style.opacity=t.style.opacity),t.service!==this.service&&(this.service=t.service),t.format?this.format=t.format:this.format="jpg",t.crop){this.cropData=t.crop;let i=Le([...this.points]),r=i.length/5,n=t.crop.x||0,o=t.crop.y||0,l=t.crop.x+t.crop.width,u=t.crop.y+t.crop.height;for(let c=0;c<r;c++){let p=c*5;i[p+1]<l&&i[p+3]>n&&i[p+2]<u&&i[p+4]>o?(i[p+1]=Ol(i[p+1],n,l),i[p+3]=Ol(i[p+3],n,l),i[p+2]=Ol(i[p+2],o,u),i[p+4]=Ol(i[p+4],o,u)):i[p]=0}kr(i,Fi(-t.crop.x,-t.crop.y)),this.crop?this.crop.set(i):this.crop=i}}static fromTile(t,i,r,n,o,l){r.height=r.height?r.height:r.width;let u=Math.ceil(i.width/n),c=Math.ceil(i.height/n),p=Math.ceil(u/r.width),f=Math.ceil(c/r.height),v=st.grid(p,f),x=st.grid(p,f);for(let _=0;_<f;_++)for(let P=0;P<p;P++){let O=P*r.width,I=_*r.height;x.addPoints(O*n,I*n,P===p-1?i.width:(O+r.width)*n,_===f-1?i.height:(I+r.height)*n),v.addPoints(O,I,P===p-1?u:O+r.width,_===f-1?c:I+r.height)}let E=new yw({url:t,scaleFactor:n,points:v.build(),displayPoints:x.build(),width:i.width,height:i.height,tileWidth:r.width,format:l});return E.applyProps({service:o}),E}getImageUrl(t){let i=this.points.slice(t*5,t*5+5),r=i[3]-i[1],n=i[4]-i[2],o=Math.ceil(r/this.display.scale);return`${this.tileUrl}/${i[1]},${i[2]},${r},${n}/${o>this.tileWidth?this.tileWidth:o},/0/default.${this.format||"jpg"}`}getAllPointsAt(t,i,r){let n=zo(this.crop||this.points,t);return[[this,n,i]]}transform(t){kr(this.points,t)}getScheduledUpdates(t,i){return[]}},PC=class extends Pr{constructor(){super(...arguments),M(this,"type","spacial-content")}getAllPointsAt(e,t,i){return[[this,this.points,t]]}},Tc=class extends PC{constructor(e){super(),M(this,"id"),M(this,"display"),M(this,"points"),M(this,"images",[]),M(this,"allImages",[]),M(this,"scaleFactors",[]),M(this,"aggregateBuffer",Le(9)),M(this,"lazyLoader"),M(this,"isFullyLoaded",!1),M(this,"maxScaleFactor",0),M(this,"renderOptions"),M(this,"_scheduleSortByScales",!1),M(this,"_sortByScales",()=>{this._scheduleSortByScales=!1,this.allImages.sort((i,r)=>r.display.width-i.display.width),this.images=[];let t=.1;for(let i of this.allImages)if(!(i.display.width<this.renderOptions.minSize&&i.display.height<this.renderOptions.minSize&&!i.priority||i instanceof Gr&&(i.display.width>this.renderOptions.maxImageSize||i.display.height>this.renderOptions.maxImageSize)&&!i.priority)){if(Math.abs(i.display.scale-t)<.25||i.priority){let r=this.images.pop();r&&(r instanceof Gr||r.priority)?(i.priority&&this.images.push(i),this.images.push(r)):i&&this.images.push(i)}else i&&this.images.push(i);t=i.display.scale}this.images.length===0&&(this.images=[...this.allImages]),this.scaleFactors=this.images.map(i=>i.display.scale),this.maxScaleFactor=Math.max(...this.scaleFactors)}),M(this,"loadFullResource",async()=>{if(!this.isFullyLoaded&&this.lazyLoader){this.isFullyLoaded=!0;let t=await this.lazyLoader();this.addImages(t)}}),M(this,"fallback",[this.loadFullResource]),this.id=e.id,this.points=st.singleBox(e.width,e.height),this.lazyLoader=e.loadFullImages,e.loadFullImages||(this.isFullyLoaded=!0),this.display={x:0,y:0,points:st.singleBox(e.width,e.height),height:e.height,width:e.width,scale:1},this.renderOptions=C({renderSmallestFallback:!0,renderLayers:2,minSize:255,maxImageSize:1024,quality:1.75},e.renderOptions||{}),this.addImages(e.images)}applyProps(e){typeof e.renderSmallestFallback<"u"&&e.renderSmallestFallback!==this.renderOptions.renderSmallestFallback&&(this.renderOptions.renderSmallestFallback=e.renderSmallestFallback),typeof e.renderLayers<"u"&&e.renderLayers!==this.renderOptions.renderLayers&&(this.renderOptions.renderLayers=e.renderLayers),typeof e.minSize<"u"&&e.minSize!==this.renderOptions.minSize&&(this.renderOptions.minSize=e.minSize),typeof e.maxImageSize<"u"&&e.maxImageSize!==this.renderOptions.maxImageSize&&(this.renderOptions.maxImageSize=e.maxImageSize),typeof e.quality<"u"&&e.quality!==this.renderOptions.quality&&(this.renderOptions.quality=e.quality)}appendChild(e){this.addImages([e])}removeChild(e){this.images.indexOf(e)!==-1&&(this.images=this.images.filter(t=>t!==e),this.sortByScales())}insertBefore(e,t){this.addImages([e])}hideInstance(){}addImages(e){for(let t of e)t.__parent=this,t.__owner=this.__owner;this.allImages.push(...e.filter(Boolean)),this.sortByScales()}sortByScales(){this._scheduleSortByScales=!0}getScheduledUpdates(e,t){return this._scheduleSortByScales?[this._sortByScales]:this.isFullyLoaded?[]:t>1/this.maxScaleFactor?this.fallback:[]}getAllPointsAt(e,t,i){if(this.images.length===0)return[];let r=AC(1/(i||1)/(window.devicePixelRatio||1),this.images,this.renderOptions.quality),n=this.images.length,o=t?Qr(t,Fi(this.x,this.y)):Fi(this.x,this.y);if(r!==this.images.length-1&&this.images[r+1]){let l=[];for(let p=n-1;p>=r;p--)l.push(p);let u=l[0];this.renderOptions.renderLayers&&(l=l.slice(-Math.min(l.length,this.renderOptions.renderLayers))),this.renderOptions.renderSmallestFallback&&l.indexOf(u)===-1&&l.unshift(u);let c=[];for(let p=0;p<l.length;p++)c.push(...this.images[l[p]].getAllPointsAt(e,o,i));return c}return this.images[r].getAllPointsAt(e,o,i)}};function Rl(e,t,i,r,n){let o=Math.PI/180*n,l=Math.cos(o),u=Math.sin(o),c=l*(i-e)+u*(r-t)+e,p=l*(r-t)-u*(i-e)+t;return[c,p]}var jo=class vw extends Pr{constructor(t,i){super(),M(this,"id"),M(this,"type","world-object"),M(this,"scale"),M(this,"layers"),M(this,"points"),M(this,"worldPoints"),M(this,"intersectionBuffer",Le(5)),M(this,"aggregateBuffer",Le(9)),M(this,"invertedBuffer",Le(9)),M(this,"rotation",0),M(this,"filteredPointsBuffer"),M(this,"_updatedList",[]),M(this,"geometry");let{x:r=0,y:n=0}=i||{};t?(this.id=t.id||"",this.scale=1,this.layers=t.layers,this.points=Le([1,r,n,r+t.width,n+t.height]),this.worldPoints=Le([1,r,n,r+t.width,n+t.height]),this.filteredPointsBuffer=Le(t.layers.length*5)):(this.id="",this.scale=1,this.layers=[],this.points=Le(5),this.worldPoints=Le(5),this.filteredPointsBuffer=Le(5))}static createWithProps(t){let i=new vw;return i.applyProps(t),i}applyProps(t){let i=t.x||0,r=t.y||0;this.id=t.id;let n=typeof t.scale<"u"?t.scale:this.scale;this.points[0]=1,this.points[1]=i,this.points[2]=r,this.points[3]=i+t.width,this.points[4]=r+t.height,this.rotation=t.rotation||0,this.worldPoints[3]=this.worldPoints[1]+t.width,this.worldPoints[4]=this.worldPoints[2]+t.height,t.scale&&t.scale!==1&&this.atScale(n),this.scale=n}appendChild(t){t.points[0]===0&&t.points.set(this.points),t.__owner.value=this,this.addLayers([t])}removeChild(t){this.layers=this.layers.filter(i=>i!==t),this.filteredPointsBuffer=Le(this.layers.length*5)}insertBefore(t,i){let r=this.layers.indexOf(i);if(r===-1||this.layers.indexOf(t)!==-1)return;let n=this.layers.slice(0,r),o=this.layers.slice(r);this.layers=[...n,t,...o]}hideInstance(){console.warn("hideInstance: not yet implemented")}getObjectsAt(t,i){if(this.rotation&&(t=this.applyRotation(t)),zo(this.points,t,this.filteredPointsBuffer)[0]===0)return[];let r=this.layers.length,n=[];for(let o=0;o<r;o++){let l=this.layers[o];if(i&&l.isShape){let u=Vr(l.points,Fi(this.x,this.y));if(!l.intersects([t[1]-u[1],t[2]-u[2]]))continue}if(zo(Vr(l.points,Fi(this.x,this.y)),t,this.filteredPointsBuffer)[0]!==0&&n.push(l),i){let u=l;n.push(...u.getObjectsAt(t,i))}}return n}applyRotation(t){if(this.rotation){let i={x:t[1],y:t[2]},r={x:t[1],y:t[4]},n={x:t[3],y:t[2]},o={x:t[3],y:t[4]},l=this.points[1]+(this.points[3]-this.points[1])/2,u=this.points[2]+(this.points[4]-this.points[2])/2,[c,p]=Rl(l,u,i.x,i.y,this.rotation),[f,v]=Rl(l,u,r.x,r.y,this.rotation),[x,E]=Rl(l,u,n.x,n.y,this.rotation),[_,P]=Rl(l,u,o.x,o.y,this.rotation),O=Math.min(c,f,x,_),I=Math.max(c,f,x,_),A=Math.min(p,v,E,P),$=Math.max(p,v,E,P);return Le([t[0],O,A,I,$])}return t}getAllPointsAt(t,i,r){let n=Qr(Fi(this.x,this.y),gn(this.scale),this.aggregateBuffer);this.rotation&&(t=this.applyRotation(t));let o=oC(t,this.points,this.intersectionBuffer),l=this.layers.length,u=[],c=Vr(o,Qr(gn(1/this.scale),Fi(-this.x,-this.y),this.invertedBuffer)),p=i?Qr(i,n,this.aggregateBuffer):n,f=r*this.scale;for(let v=0;v<l;v++)u.push(...this.layers[v].getAllPointsAt(c,p,f));return u}addLayers(t){let i=[];for(let r of t)this.layers.indexOf(r)===-1&&(i.push(r),r.points.length===5&&(r.points[1]<this.worldPoints[1]/this.scale||r.points[2]<this.worldPoints[2]/this.scale||r.points[3]>this.worldPoints[3]/this.scale||r.points[4]>this.worldPoints[4]/this.scale)&&(r.crop=r.crop||Le([1,Math.max(this.worldPoints[1]/this.scale,r.points[1]),Math.max(this.worldPoints[2]/this.scale,r.points[2]),Math.min(this.worldPoints[3]/this.scale,r.points[3]),Math.min(this.worldPoints[4]/this.scale,r.points[4])])));this.layers=this.layers.concat(i),this.filteredPointsBuffer=Le(this.layers.length*5)}getScheduledUpdates(t,i){let r=this.layers.length;this._updatedList=[];let n=i*this.scale;for(let o=0;o<r;o++){let l=this.layers[o].getScheduledUpdates(t,n);l&&this._updatedList.push(...l)}return this._updatedList}},is=class bw extends Pr{constructor(t=0,i=0,r=100,n="left-to-right"){super(),M(this,"id","world"),M(this,"_width"),M(this,"_height"),M(this,"aspectRatio"),M(this,"viewingDirection"),M(this,"aggregateBuffer",Le(9)),M(this,"isDirty",!1),M(this,"zones",[]),M(this,"filteredPointsBuffer"),M(this,"selectedZone"),M(this,"triggerQueue",[]),M(this,"activatedEvents",[]),M(this,"_updatedList",[]),M(this,"translationBuffer",Le(9)),M(this,"needsRecalculate",!0),M(this,"emptyPaintables",[]),M(this,"renderOrder",[]),M(this,"points"),M(this,"objects",[]),M(this,"subscriptions",[]),M(this,"_propagateEventTargets",[]),M(this,"_alreadyFlushed",[]),this._width=t,this._height=i,this.aspectRatio=Number.isNaN(t/i)?1:t/i,this.viewingDirection=n,this.points=Le(r*5),this.filteredPointsBuffer=Le(r*5)}get x(){return 0}get y(){return 0}get width(){return this._width}get height(){return this._height}static withProps(t){let i=new bw;return i.applyProps(t),i}applyProps(t){typeof t.width<"u"&&typeof t.height<"u"&&(t.width!==this._width||t.height!==this._height)&&this.resize(t.width,t.height),t.viewingDirection!==this.viewingDirection&&(this.viewingDirection=t.viewingDirection,this.triggerRepaint())}propagateTouchEvent(t,i,r){let n=[];for(let o of r)if(o.x&&o.y){let l=st.singleBox(1,1,o.x,o.y);n.push(this.getObjectsAt(l,!0).reverse())}return n.map(o=>this.propagateEvent(t,i,o,{bubbles:!0,cancelable:!0}))}propagatePointerEvent(t,i,r,n,o={}){let l=st.singleBox(1,1,r,n),u=this.getObjectsAt(l,!0).reverse();return this.propagateEvent(t,i,u,o)}propagateEvent(t,i,r,{bubbles:n=!1,cancelable:o=!1}={}){i.atlasTarget=this,this._propagateEventTargets.length=1,this._propagateEventTargets[0]=this;let l=!1;i.stopPropagation=()=>{l=!0};let u=r.length;for(let f=u-1;f>=0;f--){this._propagateEventTargets.unshift(r[f][0]);let v=r[f][1].length;if(v)for(let x=0;x<v;x++)this._propagateEventTargets.unshift(r[f][1][x])}let c=this._propagateEventTargets.length,p=!1;for(let f=0;f<c&&(i.atlasTarget=this._propagateEventTargets[f],i.atlasWorld=this,p=this._propagateEventTargets[f].dispatchEvent(t,i)||p,!l);f++);return p&&this.triggerRepaint(),this._propagateEventTargets}appendChild(t){let i=this.appendWorldObject(t);this.renderOrder.push(i/5)}removeChild(t){let i=this.objects.indexOf(t);if(i===-1){for(let r of this.objects)if(r&&r.id===t.id){this.removeChild(r);return}return}this.objects[i]=null,this.renderOrder=this.renderOrder.filter(r=>r!==i),this.points[i*5]=0,this.triggerRepaint(),this.needsRecalculate=!0}insertBefore(t,i){let r=this.objects.indexOf(i);if(r===-1)return;let n=this.appendWorldObject(t);this.renderOrder.splice(r-1,0,n/5)}hideInstance(){}asWorldObject(){return null}addZone(t){this.zones.push(t)}selectZone(t){if(typeof t=="string"){let i=this.zones.length;for(let r=0;r<i;r++)if(this.zones[r].id===t){this.selectedZone=r,this.trigger("zone-changed");return}}else this.zones[t]&&(this.selectedZone=t,this.trigger("zone-changed"))}deselectZone(){this.selectedZone=void 0}getActiveZone(){if(this.selectedZone)return this.zones[this.selectedZone]}hasActiveZone(){return typeof this.selectedZone<"u"}checkResizeInternalBuffer(){if(aC(this.points)===this.objects.length){let t=this.points,i=Le(this.points.length*2);i.set(t,0),this.points=i}}appendWorldObject(t){this.checkResizeInternalBuffer();let i=this.objects.length*5,r=t.points;return t.points=this.points.subarray(this.objects.length*5,this.objects.length*5+5),t.points[1]=r[1],t.points[2]=r[2],t.points[3]=r[3],t.points[4]=r[4],this.objects.push(t),this.filteredPointsBuffer=Le(this.objects.length*5),this.needsRecalculate=!0,this.triggerRepaint(),i}recalculateWorldSize(){let t=!1;if(this.needsRecalculate){let i=new Int32Array(this.objects.length),r=new Int32Array(this.objects.length),n=this.renderOrder.length;for(let u=0;u<n;u++){let c=this.renderOrder[u];this.objects[c]&&(i[u]=this.points[c*5+3],r[u]=this.points[c*5+4])}let o=Math.max(...i);o!==this._width&&(this._width=o,t=!0);let l=Math.max(...r);l!==this._height&&(this._height=l,t=!0),t&&this.trigger("recalculate-world-size",{width:o,height:l}),this.needsRecalculate=!1}return t}addObjectAt(t,i){i.width&&!i.height?i.height=i.width/t.width*t.height:i.height&&!i.width&&(i.width=i.height/t.height*t.width),(!i||!i.width||!i.height)&&(i.width=t.width,i.height=t.height);let{width:r,x:n,y:o}=i,l=r/t.width;this.checkResizeInternalBuffer(),this.points.set(st.singleBox(t.width,t.height,0,0),this.objects.length*5);let u=new jo(t);return u.points=this.points.subarray(this.objects.length*5,this.objects.length*5+5),this.objects.push(u),this.scaleWorldObject(this.objects.length-1,l),this.translateWorldObject(this.objects.length-1,n,o),this.filteredPointsBuffer=Le(this.points.length*2),this.triggerRepaint(),this.needsRecalculate=!0,u}scaleWorldObject(t,i){kr(this.points.subarray(t*5,t*5+5),Fo(i,this.points[t*5+1],this.points[t*5+2]));let r=this.objects[t];r&&(r.atScale(i),this.triggerRepaint())}translateWorldObject(t,i,r){kr(this.points.subarray(t*5,t*5+5),Fi(i,r));let n=this.objects[t];n&&(n.translate(i,r),this.triggerRepaint())}resize(t,i){return this._width=t,this._height=i,this.aspectRatio=t/i,this.triggerRepaint(),this}getObjects(){return this.objects}getPoints(){return this.points}getPointsFromViewer(t,i){let r=st.singleBox(t.width,t.height,t.x,t.y);return this.getPointsAt(r,i,t.scale)}addLayoutSubscriber(t){return this.subscriptions.push(t),()=>{this.subscriptions.splice(this.subscriptions.indexOf(t),1)}}getScheduledUpdates(t,i){let r=zo(this.points,t,this.filteredPointsBuffer),n=this.objects.length;this._updatedList=[];for(let o=0;o<n;o++)if(r[o*5]!==0){if(!this.objects[o])continue;this._updatedList.push(...this.objects[o].getScheduledUpdates(t,i))}return this._updatedList}getObjectsAt(t,i=!1){let r=this.getActiveZone(),n=zo(this.points,t,this.filteredPointsBuffer),o=this.renderOrder.length,l=[];for(let u=0;u<o;u++){let c=this.renderOrder[u];if(n[c*5]!==0){let p=this.objects[c];if(!p||r&&r.objects.indexOf(p)===-1)continue;if(p.type!=="world-object"){l.push([p,[p]]);continue}i?l.push([p,p.getObjectsAt(t,i)]):l.push([p,this.emptyPaintables])}}return l}getPointsAt(t,i,r=1){let n=this.getObjectsAt(t),o=Qr(gn(r),Fi(-t[1],-t[2]),this.translationBuffer),l=i?Qr(i,o,this.aggregateBuffer):o,u=n.length,c=[];for(let p=0;p<u;p++)n[p]&&c.push(...n[p][0].getAllPointsAt(t,l,r));return c}flushSubscriptions(){if(this.triggerQueue.length){this._alreadyFlushed=[];let t=this.triggerQueue.length;for(let i=0;i<t;i++){if(this._alreadyFlushed.indexOf(this.triggerQueue[i][0])!==-1)continue;typeof this.triggerQueue[i][1]>"u"&&this._alreadyFlushed.push(this.triggerQueue[i][0]);let r=this.subscriptions.length;for(let n=0;n<r;n++)this.subscriptions[n].apply(null,this.triggerQueue[i])}this.triggerQueue=[]}}trigger(t,i){this.triggerQueue.push([t,i])}triggerEventActivation(){this.trigger("event-activation")}triggerRepaint(){this.trigger("repaint")}gotoRegion(t){this.trigger("goto-region",t)}goHome(t=!1){this.trigger("go-home",{immediate:t})}zoomTo(t,i,r){this.trigger("zoom-to",{point:i,factor:t,stream:r})}zoomIn(t){this.trigger("zoom-to",{point:t,factor:.5})}zoomOut(t){this.trigger("zoom-to",{point:t,factor:2})}constraintBounds(t){this.trigger("constrain-bounds",{immediate:t})}},Ml=/([0-9]+(px|em)\s+)+(solid)\s+(.*)/g,Ll={},CC=["backgroundColor","opacity","boxShadow","borderColor","borderWidth","borderStyle","outlineColor","outlineWidth","outlineOffset","outlineStyle"],qs=class extends Pr{constructor(){super(),M(this,"id"),M(this,"type","spacial-content"),M(this,"points"),M(this,"hoverEvents",!1),M(this,"activeEvents",!1),M(this,"display",{x:0,y:0,scale:1,width:-1,height:-1,points:Le(5)}),M(this,"_parsed",{border:{id:null,match:[]},outline:{id:null,match:[]}}),M(this,"hovering"),M(this,"pressing"),M(this,"props",{}),M(this,"addHover",()=>{this.hovering=!0,this.__revision++}),M(this,"removeHover",()=>{this.hovering=!1,this.pressing=!1,this.__revision++}),M(this,"addPress",()=>{this.pressing=!0,this.__revision++}),M(this,"removePress",()=>{this.pressing=!1,this.__revision++}),this.id=Cl(12),this.points=Le(5)}getAllPointsAt(e,t){return[[this,this.points,t]]}applyProps(e={}){let t=!1;if(e.interactive!==this.props.interactive&&(t=!0,this.props.interactive=e.interactive),e.style){let i=e.border||e.style.border;if(i!==this._parsed.border.id)if(!i)this._parsed.border.id=null,this._parsed.border.match=[];else{let r=Ll[i]||Ml.exec(i)||Ml.exec(i);r&&(this._parsed.border.id=i,this._parsed.border.match=Ll[i]=r)}if(this._parsed.border.id&&(e.style.borderWidth=this._parsed.border.match[1],e.style.borderStyle="solid",e.style.borderColor=this._parsed.border.match[4]),e.style.outline!==this._parsed.outline.id)if(!e.style.outline)this._parsed.outline.id=null,this._parsed.outline.match=[];else{let r=Ll[e.style.outline]||Ml.exec(e.style.outline)||Ml.exec(e.style.outline);r&&(this._parsed.outline.id=e.style.outline,this._parsed.outline.match=Ll[e.style.outline]=r)}this._parsed.outline.id&&(e.style.outlineWidth=this._parsed.outline.match[1],e.style.outlineStyle="solid",e.style.outlineColor=this._parsed.outline.match[4]),this.props.style=e.style,e.backgroundColor&&!this.props.style.backgroundColor&&(this.props.style.backgroundColor=e.backgroundColor,t=!0),e.style.background&&!this.props.style.backgroundColor&&(this.props.style.backgroundColor=e.style.background,t=!0);for(let r of CC)if(this.props.style[r]!==e.style[r]){t=!0;break}e.style[":hover"]!==this.props.hoverStyles&&(this.props.hoverStyles=e.style[":hover"],this.hoverEvents||(this.hoverEvents=!0,this.addEventListener("pointerenter",this.addHover),this.addEventListener("pointerleave",this.removeHover)),t=!0),e.style[":active"]!==this.props.pressStyles&&(this.props.pressStyles=e.style[":active"],this.activeEvents||(this.activeEvents=!0,this.addEventListener("mousedown",this.addPress),this.addEventListener("mouseup",this.removePress)),t=!0)}e.href!==this.props.href&&(this.props.href=e.href,t=!0),e.hrefTarget!==this.props.hrefTarget&&(this.props.hrefTarget=e.hrefTarget,t=!0),e.title!==this.props.title&&(this.props.title=e.title,t=!0),e.className!==this.props.className&&(this.props.className=e.className,e.className&&!this.hoverEvents&&(this.hoverEvents=!0,this.addEventListener("pointerenter",this.addHover),this.addEventListener("pointerleave",this.removeHover)),e.className&&!this.activeEvents&&(this.activeEvents=!0,this.addEventListener("mousedown",this.addPress),this.addEventListener("mouseup",this.removePress)),t=!0),e.relativeSize!==this.props.relativeSize&&(this.props.relativeSize=e.relativeSize,t=!0),e.relativeStyle!==this.props.relativeStyle&&(this.props.relativeStyle=e.relativeStyle,t=!0),e.html!==this.props.html&&(this.props.html=e.html,t=!0),e.target&&(e.target.width!==this.display.width||e.target.height!==this.display.height||e.target.x!==this.points[1]||e.target.y!==this.points[2])&&(t=!0,this.points=st.singleBox(e.target.width,e.target.height,e.target.x,e.target.y),this.display.points=st.singleBox(e.target.width,e.target.height,e.target.x,e.target.y),this.display.width=e.target.width,this.display.height=e.target.height),t&&this.__revision++}},Uo=class extends Pr{constructor(){super(),M(this,"type","spacial-content"),M(this,"id"),M(this,"points"),M(this,"color","#000"),M(this,"backgroundColor"),M(this,"hovering"),M(this,"pressing"),M(this,"text",""),M(this,"display",{x:0,y:0,scale:1,width:100,height:100,points:Le(5)}),M(this,"className"),M(this,"html"),M(this,"interactive",!1),M(this,"props",{font:"18px Arial, sans-serif",lineHeight:1,textAlign:"left",verticalAlign:"top",paddingX:0,paddingY:0,fitParent:!1,lineBreak:"auto",strokeText:!1,sizeToFill:!1,maxFontSizeToFill:void 0,allowNewLine:!0,justifyLines:!1,renderHDPI:!1,textDecoration:"none",interactive:!1,relativeSize:!1}),this.id="",this.points=Le(5)}getAllPointsAt(e,t){return[[this,this.points,t]]}applyProps(e){var t=e,{id:i,target:r,text:n,color:o,backgroundColor:l,fontSize:u=18,interactive:c,fontFamily:p="Arial, sans-serif"}=t,f=le(t,["id","target","text","color","backgroundColor","fontSize","interactive","fontFamily"]);f.font=`${u}px ${p}`,this.interactive=c||!1,typeof n<"u"&&(this.text=n||""),o&&(this.color=o),l&&(this.backgroundColor=l),i&&(this.id=i),r&&(this.points=st.singleBox(r.width,r.height,r.x,r.y),this.display.points=this.points,this.display.width=r.width,this.display.height=r.height),this.props=C(C({},this.props),f),this.__revision++}},Bt=Math.pow,$l=Math.sqrt,Do=Math.sin,bv=Math.cos,Wo=Math.PI,Nl=1.70158,zl=Nl*1.525,wv=Nl+1,xv=2*Wo/3,_v=2*Wo/4.5,Fl=function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},Cr={linear:e=>e,easeInQuad:function(e){return e*e},easeOutQuad:function(e){return 1-(1-e)*(1-e)},easeInOutQuad:function(e){return e<.5?2*e*e:1-Bt(-2*e+2,2)/2},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return 1-Bt(1-e,3)},easeInOutCubic:function(e){return e<.5?4*e*e*e:1-Bt(-2*e+2,3)/2},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return 1-Bt(1-e,4)},easeInOutQuart:function(e){return e<.5?8*e*e*e*e:1-Bt(-2*e+2,4)/2},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return 1-Bt(1-e,5)},easeInOutQuint:function(e){return e<.5?16*e*e*e*e*e:1-Bt(-2*e+2,5)/2},easeInSine:function(e){return 1-bv(e*Wo/2)},easeOutSine:function(e){return Do(e*Wo/2)},easeInOutSine:function(e){return-(bv(Wo*e)-1)/2},easeInExpo:function(e){return e===0?0:Bt(2,10*e-10)},easeOutExpo:function(e){return e===1?1:1-Bt(2,-10*e)},easeInOutExpo:function(e){return e===0?0:e===1?1:e<.5?Bt(2,20*e-10)/2:(2-Bt(2,-20*e+10))/2},easeInCirc:function(e){return 1-$l(1-Bt(e,2))},easeOutCirc:function(e){return $l(1-Bt(e-1,2))},easeInOutCirc:function(e){return e<.5?(1-$l(1-Bt(2*e,2)))/2:($l(1-Bt(-2*e+2,2))+1)/2},easeInBack:function(e){return wv*e*e*e-Nl*e*e},easeOutBack:function(e){return 1+wv*Bt(e-1,3)+Nl*Bt(e-1,2)},easeInOutBack:function(e){return e<.5?Bt(2*e,2)*((zl+1)*2*e-zl)/2:(Bt(2*e-2,2)*((zl+1)*(e*2-2)+zl)+2)/2},easeInElastic:function(e){return e===0?0:e===1?1:-Bt(2,10*e-10)*Do((e*10-10.75)*xv)},easeOutElastic:function(e){return e===0?0:e===1?1:Bt(2,-10*e)*Do((e*10-.75)*xv)+1},easeInOutElastic:function(e){return e===0?0:e===1?1:e<.5?-(Bt(2,20*e-10)*Do((20*e-11.125)*_v))/2:Bt(2,-20*e+10)*Do((20*e-11.125)*_v)/2+1},easeInBounce:function(e){return 1-Fl(1-e)},easeOutBounce:Fl,easeInOutBounce:function(e){return e<.5?(1-Fl(1-2*e))/2:(1+Fl(2*e-1))/2}},TC=class{constructor(e){M(this,"runtime"),M(this,"pendingTransition"),this.runtime=e,this.pendingTransition={from:Le(5),to:Le(5),elapsed_time:0,done:!0,total_time:0,timingFunction:Cr.easeInOutQuad,constrain:!1}}hasPending(){return!this.pendingTransition.done}getPendingTransition(){return this.pendingTransition}getPendingFrom(){return this.pendingTransition.from}customTransition(e){e(this.pendingTransition)}stopTransition(){this.pendingTransition.from=Le(this.runtime.target),this.pendingTransition.to=Le(this.runtime.target),this.pendingTransition.done=!0,this.pendingTransition.elapsed_time=0,this.pendingTransition.total_time=0}runTransition(e,t){if(!this.pendingTransition.done){let i=this.pendingTransition,r=i.total_time===0?0:(i.elapsed_time+t)/i.total_time,n=i.total_time===0?1:r===0?0:i.timingFunction(r);e[1]=i.from[1]+(i.to[1]-i.from[1])*n,e[2]=i.from[2]+(i.to[2]-i.from[2])*n,e[3]=i.from[3]+(i.to[3]-i.from[3])*n,e[4]=i.from[4]+(i.to[4]-i.from[4])*n,this.pendingTransition.elapsed_time+=t,this.pendingTransition.elapsed_time>=this.pendingTransition.total_time&&(this.pendingTransition.done=!0,this.pendingTransition.constrain&&this.constrainBounds({transition:{duration:this.pendingTransition.total_time===0?0:500,easing:Cr.easeOutExpo}}))}}zoomTo(e,{origin:t,stream:i=!1,transition:r}={}){let n=this.runtime.getZoomedPosition(e,{origin:t}),o=Math.abs(1-e);this.applyTransition(n,r,{duration:2e3*o,easing:Cr.easeOutExpo,constrain:!0},{stream:!1})}constrainBounds({transition:e,panPadding:t=0}={}){let[i,r]=this.runtime.constrainBounds(this.runtime.target,{panPadding:t});i&&(this.applyTransition(r,e,{duration:500,easing:Cr.easeOutQuart,constrain:!1}),this.runtime.updateNextFrame())}applyTransition(e,t,i,{stream:r}={}){this.pendingTransition.from=Le(this.runtime.target),this.pendingTransition.to=e,r||(this.pendingTransition.elapsed_time=0),this.pendingTransition.done=!1,this.pendingTransition.total_time=typeof(t==null?void 0:t.duration)<"u"?t.duration:typeof(i==null?void 0:i.duration)<"u"?i.duration:1e3,this.pendingTransition.constrain=typeof(t==null?void 0:t.constrain)<"u"?t.constrain:typeof(i==null?void 0:i.constrain)<"u"?i.constrain:!1,this.pendingTransition.timingFunction=(t==null?void 0:t.easing)||(i==null?void 0:i.easing)||Cr.easeInOutSine}goToRegion(e,{transition:t}={}){let i=this.runtime.clampRegion(e);this.applyTransition(st.singleBox(i.width,i.height,i.x,i.y),t,{duration:1e3,easing:Cr.easeOutExpo,constrain:!0}),this.runtime.updateNextFrame()}},Bl=class{constructor(e,t,i,r=[],n){M(this,"id",Cl()),M(this,"ready",!1),M(this,"renderer"),M(this,"world"),M(this,"target"),M(this,"homePosition"),M(this,"manualHomePosition"),M(this,"manualFocalPosition"),M(this,"focalPosition"),M(this,"transitionManager"),M(this,"aggregate"),M(this,"transformBuffer",Le(500)),M(this,"lastTarget",Le(5)),M(this,"zoomBuffer",Le(5)),M(this,"logNextRender",!1),M(this,"pendingUpdate",!0),M(this,"isCommitting",!1),M(this,"firstRender",!0),M(this,"lastTime"),M(this,"stopId"),M(this,"mode","explore"),M(this,"controllers",[]),M(this,"controllersRunning",!1),M(this,"controllerStopFunctions",[]),M(this,"maxScaleFactor",1),M(this,"_viewerToWorld",{x:0,y:0}),M(this,"_lastGoodScale",1),M(this,"hooks",{useFrame:[],useBeforeFrame:[],useAfterPaint:[],useAfterFrame:[]}),M(this,"fpsLimit"),M(this,"options"),M(this,"hookOptions",{filters:{grayscale:0,contrast:0,brightness:0,saturate:0,sepia:0,invert:0,hueRotate:0,blur:0}}),M(this,"_viewport",{x:0,y:0,width:0,height:0}),M(this,"setViewport",o=>{let l=Math.round(typeof o.x>"u"?this.target[1]:o.x),u=Math.round(typeof o.y>"u"?this.target[2]:o.y);o.width?this.target[3]=l+o.width:this.target[3]=this.target[3]-this.target[1]+l,o.height?this.target[4]=u+o.height:this.target[4]=this.target[4]-this.target[2]+u,Math.abs(this.target[1]-l)>.01&&(this.target[1]=l),Math.abs(this.target[2]-u)>.01&&(this.target[2]=u),this.pendingUpdate=!0}),M(this,"render",o=>{let l=o-this.lastTime;if(this.isCommitting||this.fpsLimit&&l<1e3/this.fpsLimit){this.stopId=window.requestAnimationFrame(this.render);return}this.lastTime=o,this.world.flushSubscriptions(),this.stopId=window.requestAnimationFrame(this.render),this.hook("useFrame",l);let u=this.pendingUpdate,c=this.renderer.pendingUpdate();if(this.transitionManager.hasPending()&&(this.transitionManager.runTransition(this.target,l),this.pendingUpdate=!0,this.updateControllerPosition()),!this.firstRender&&!u&&!c&&this.target[0]===this.lastTarget[0]&&this.target[1]===this.lastTarget[1]&&this.target[2]===this.lastTarget[2]&&this.target[3]===this.lastTarget[3]&&this.target[4]===this.lastTarget[4])return;this.hook("useBeforeFrame",l),this.renderer.beforeFrame(this.world,l,this.target,this.hookOptions);let p=this.getScaleFactor(),f=this.renderer.getPointsAt(this.world,this.target,this.aggregate,p),v=f.length;for(let _=0;_<v;_++){let P=f[_][0],O=f[_][1],I=f[_][2],A=I?Vr(O,I,this.transformBuffer):O;this.renderer.prepareLayer(P,P.__parent&&I?Vr(P.__parent.crop||P.__parent.points,I):A);let $=A.length/5;for(let z=0;z<$;z++){let B=z*5;A[B]!==0&&(this.renderer.paint(P,z,A[B+1],A[B+2],A[B+3]-A[B+1],A[B+4]-A[B+2]),this.hook("useAfterPaint",P))}this.renderer.finishLayer(P,O)}this.renderer.afterFrame(this.world,l,this.target,this.hookOptions),this.hook("useAfterFrame",l),this.lastTarget[0]=this.target[0],this.lastTarget[1]=this.target[1],this.lastTarget[2]=this.target[2],this.lastTarget[3]=this.target[3],this.lastTarget[4]=this.target[4],this.firstRender=!1,this.pendingUpdate=!1,this.logNextRender=!1,this.renderer.isReady()&&(this.ready=!0,this.world.trigger("ready")),this.world.flushSubscriptions();let x=this.world.getScheduledUpdates(this.target,p),E=x.length;if(E>0)for(let _=0;_<E;_++){let P=x[E-_-1]();P?P.then(()=>{this.pendingUpdate=!0}):this.pendingUpdate=!0}}),this.renderer=e,this.world=t,this.options=C({maxOverZoom:1,maxUnderZoom:1,visibilityRatio:1.5},n||{}),this.target=st.projection(i),this.manualHomePosition=!1,this.pendingUpdate=!0,this.homePosition=st.projection(this.world),this.manualFocalPosition=!1,this.focalPosition=this.target,this.updateFocalPosition(),this.transitionManager=new TC(this),this.aggregate=gn(1),this.world.addLayoutSubscriber(o=>{o==="repaint"&&(this.pendingUpdate=!0),o==="recalculate-world-size"&&(this.manualHomePosition||(this.setHomePosition(),this.goHome()),this.updateFocalPosition())}),this.lastTime=performance.now(),this.controllers=r,this.render(this.lastTime),this.startControllers()}get x(){return this.target[1]}set x(e){this.target[1]=e}get y(){return this.target[2]}set y(e){this.target[2]=e}get x2(){return this.target[3]}set x2(e){this.target[3]=e}get y2(){return this.target[4]}set y2(e){this.target[4]=e}get width(){return this.target[3]-this.target[1]}set width(e){this.target[3]=this.target[1]+e}get height(){return this.target[4]-this.target[2]}set height(e){this.target[4]=this.target[2]=e}setHomePosition(e){this.homePosition.set(st.projection(e||this.world)),this.pendingUpdate=!0}startControllers(){if(!this.controllersRunning){for(let e of this.controllers)this.controllerStopFunctions.push(e.start(this));this.controllersRunning=!0}}stopControllers(){if(this.controllersRunning){for(let e of this.controllerStopFunctions)e();this.controllersRunning=!1,this.controllerStopFunctions=[]}}updateControllerPosition(){for(let e of this.controllers)e.updatePosition(this.x,this.y,this.width,this.height)}triggerResize(){this.renderer.triggerResize&&this.renderer.triggerResize(),this.pendingUpdate=!0}addController(e){this.controllers.push(e),this.controllersRunning&&e.start(this),this.pendingUpdate=!0}cover(){return this.goHome({cover:!0})}getRendererScreenPosition(){return this.renderer.getRendererScreenPosition()}updateRendererScreenPosition(){this.pendingUpdate=!0,this.renderer.resize()}setOptions(e){this.options=C(C({},this.options),e)}goHome(e={}){if(this.world.width<=0||this.world.height<=0)return;let t=this.getScaleFactor(),i=e.position?{x:e.position[1],y:e.position[2],width:e.position[3]-e.position[1],height:e.position[4]-e.position[2]}:{x:this.homePosition[1],y:this.homePosition[2],width:this.homePosition[3]-this.homePosition[1],height:this.homePosition[4]-this.homePosition[2]},r=this.width*t,n=this.height*t,o=i.width/r,l=i.height/n,u=r/n;if(e.cover?o>l:o<l){let c=u*i.height,p=(c-i.width)/2;this.target[1]=Math.round(-p+i.x),this.target[2]=Math.round(i.y),this.target[3]=Math.round(c-p+i.x),this.target[4]=Math.round(i.height+i.y)}else{let c=i.width/u,p=(c-i.height)/2;this.target[1]=Math.round(i.x),this.target[2]=Math.round(i.y-p),this.target[3]=Math.round(i.x+i.width),this.target[4]=Math.round(i.y+c-p)}this.constrainBounds(this.target),this.updateControllerPosition()}resize(e,t,i,r){this.updateFocalPosition(e-t,i-r);let n=t/e,o=r/i;this.target[3]=this.target[1]+(this.target[3]-this.target[1])*n,this.target[4]=this.target[2]+(this.target[4]-this.target[2])*o,this.goHome({position:this.focalPosition}),this.renderer.resize(t,r),this.pendingUpdate=!0}updateFocalPosition(e,t){if(!this.manualFocalPosition){let i=this.width,r=this.height,n=Math.min(i,r),o=0,l=0,u=this.x+o,c=this.y+l;if(i<r){let p=this.height-this.width;this.focalPosition=st.projection({x:u,y:c+p/2,width:n-o*2,height:n-l*2}),this.pendingUpdate=!0}else{let p=this.width-this.height;this.focalPosition=st.projection({x:u+p/2,y:c,width:n-o*2,height:n-l*2}),this.pendingUpdate=!0}}}getViewport(){return this._viewport.x=this.target[1],this._viewport.y=this.target[2],this._viewport.width=this.target[3]-this.target[1],this._viewport.height=this.target[4]-this.target[2],this._viewport}constrainBounds(e,{panPadding:t=0,ref:i=!1}={}){let{minX:r,maxX:n,minY:o,maxY:l}=this.getBounds({target:e,padding:t}),u=!1,c=i?e:Le(e),p=Math.round(e[3]-e[1]),f=Math.round(e[4]-e[2]);return r>e[1]&&(u=!0,c[1]=r,c[3]=r+p),o>e[2]&&(u=!0,c[2]=o,c[4]=o+f),n<e[1]&&(u=!0,c[1]=n,c[3]=n+p),l<e[2]&&(u=!0,c[2]=l,c[4]=l+f),[u,c]}getBounds(e){let t=e.target||this.target,i=e.padding,r=this.options.visibilityRatio,n=Math.abs(1-r);if(this.world.hasActiveZone()){let I=this.world.getActiveZone();if(I){let A=t[3]-t[1]<I.points[3]-I.points[1],$=t[4]-t[2]<I.points[4]-I.points[2];return{minX:A?I.points[1]-i:I.points[1]+(I.points[3]-I.points[1])/2-(t[3]-t[1])/2,maxX:$?I.points[2]-i:I.points[2]+(I.points[4]-I.points[2])/2-(t[4]-t[2])/2,minY:A?I.points[3]+i:I.points[1]+(I.points[3]-I.points[1])/2-(t[3]-t[1])/2,maxY:$?I.points[4]+i:I.points[2]+(I.points[4]-I.points[2])/2-(t[4]-t[2])/2}}}let o=t[3]-t[1],l=this.world.width,u=-o*n,c=l-o-u,p=t[4]-t[2],f=this.world.height,v=-p*n,x=f-p-v,E=Math.round(Math.max(u,c)),_=Math.round(Math.min(u,c)),P=Math.round(Math.max(v,x)),O=Math.round(Math.min(v,x));return{minX:_,maxX:E,minY:O,maxY:P}}getScaleFactor(e=!1){let t=this.renderer.getScale(this.target[3]-this.target[1],this.target[4]-this.target[2],e);return t===0?this._lastGoodScale:(this._lastGoodScale=t,t)}getZoomedPosition(e,{origin:t,fromPos:i}){var r;let n=i?{width:i[3]-i[1],height:i[4]-i[2]}:void 0,o=n?this.renderer.getScale(n.width,n.height):this.getScaleFactor(),l=n?n.width:this.width,u=n?n.height:this.height,c=(r=this.getRendererScreenPosition())==null?void 0:r.width,p=this.world.width,f=c?c/p:1,v=this.options.maxUnderZoom,x=Math.max(f||1,this.options.maxOverZoom),E=1/e,_=o*E;if(E<1){let O=l*o,I=u*o,A=this.world.width/O,$=this.world.height/I;if(A>$){let z=this.world.width*_,B=~~(l*o)*v;z<B&&(e=this.world.width*o/(l*o*v))}else{let z=this.world.height*_,B=~~(u*o)*v;z<B&&(e=this.world.height*o/(u*o*v))}}else _>x&&(e=o/x);let P=Vr(this.target,Fo(e,t?t.x:this.target[1]+(this.target[3]-this.target[1])/2,t?t.y:this.target[2]+(this.target[4]-this.target[2])/2),this.zoomBuffer);return this.constrainBounds(P,{ref:!0,panPadding:100}),P}clampRegion({x:e,y:t,width:i,height:r,padding:n=0}){let o=this.width,l=this.height,u=i/o<r/l,c=e-n,p=t-n,f=i+n*2,v=r+n*2;if(u){let E=v/l*o;return{x:c-(E-f)/2,y:p,width:E,height:v}}let x=f/o*l;return{x:c,y:p-(x-v)/2,width:f,height:x}}viewerToWorld(e,t){let i=this.getScaleFactor();return this._viewerToWorld.x=this.target[1]+e/i,this._viewerToWorld.y=this.target[2]+t/i,this._viewerToWorld}worldToViewer(e,t,i,r){let n=st.singleBox(i,r,e,t);return kr(n,Qr(gn(this.getScaleFactor()),Fi(-this.target[1],-this.target[2]))),{x:n[1],y:n[2],width:n[3]-n[1],height:n[4]-n[2],strand:n}}setScale(e,t){kr(this.target,Fo(e,t?t.x:this.target[1]+(this.target[3]-this.target[1])/2,t?t.y:this.target[2]+(this.target[4]-this.target[2])/2)),this.pendingUpdate=!0}syncTo(e){let t=this.target;return this.target=e.target,this.pendingUpdate=!0,()=>{this.target=t}}stop(){return typeof this.stopId<"u"&&(window.cancelAnimationFrame(this.stopId),this.stopId=void 0),()=>{this.render(performance.now())}}reset(){this.renderer.reset()}selectZone(e){this.world.selectZone(e),this.pendingUpdate=!0}deselectZone(){this.world.deselectZone(),this.pendingUpdate=!0}hook(e,t){let i=this.hooks[e].length;if(i!==0)for(let r=0;r<i;r++)this.hooks[e][r](t)}registerHook(e,t){return this.hooks[e].push(t),()=>{this.hooks[e]=this.hooks[e].filter(i=>i!==t)}}updateNextFrame(){this.pendingUpdate=!0}},jl=/([0-9]+(px|em)\s+)+(solid)\s+(.*)/g,Ul={},IC=["backgroundColor","opacity","boxShadow","borderColor","borderWidth","borderStyle","outlineColor","outlineWidth","outlineOffset","outlineStyle"],Sv=class extends Pr{constructor(){super(),M(this,"id"),M(this,"type","spacial-content"),M(this,"isShape",!0),M(this,"points"),M(this,"hoverEvents",!1),M(this,"activeEvents",!1),M(this,"display",{x:0,y:0,scale:1,width:-1,height:-1,points:Le(5)}),M(this,"boundingBox",null),M(this,"_parsed",{border:{id:null,match:[]},outline:{id:null,match:[]}}),M(this,"hovering"),M(this,"pressing"),M(this,"props",{}),M(this,"shape",{type:"none"}),M(this,"addHover",()=>{this.hovering=!0,this.__revision++}),M(this,"removeHover",()=>{this.hovering=!1,this.pressing=!1,this.__revision++}),M(this,"addPress",()=>{this.pressing=!0,this.__revision++}),M(this,"removePress",()=>{this.pressing=!1,this.__revision++}),this.id=Cl(12),this.points=Le(5),this.shape={type:"none"}}updateBoundingBox(){if(this.shape.type==="none")return;let e=this.shape.points;if(this.shape.points.length>2){let t=Math.min(...e.map(o=>o[0])),i=Math.min(...e.map(o=>o[1])),r=Math.max(0,...e.map(o=>o[0])),n=Math.max(0,...e.map(o=>o[1]));this.boundingBox={x:t,y:i,width:r-t,height:n-i};return}this.boundingBox=null}intersects(e){if(!e||this.shape.type==="none")return!1;let[t,i]=e,r=this.shape.points,n=this.boundingBox;if(n||(this.updateBoundingBox(),n=this.boundingBox),!n||t<n.x||t>n.x+n.width||i<n.y||i>n.height+n.y)return!1;let o=!1;for(let l=0,u=r.length-1;l<r.length;u=l++)r[l][1]>i!=r[u][1]>i&&t<(r[u][0]-r[l][0])*(i-r[l][1])/(r[u][1]-r[l][1])+r[l][0]&&(o=!o);return o}getAllPointsAt(e,t){return e[3]-e[1]===1&&e[4]-e[2]===1?this.intersects([e[1],e[2]])?[[this,this.points,t]]:[]:[[this,this.points,t]]}applyProps(e={}){let t=!1;if(e.points)if(this.shape.type!=="polygon"||this.shape.points.length!==e.points.length)this.shape={type:"polygon",points:e.points,open:e.open},this.updateBoundingBox();else{let i=!1,r=e.points.length;for(let n=0;n<r;n++)if(e.points[n][0]!==this.shape.points[n][0]||e.points[n][1]!==this.shape.points[n][1]){i=!0;break}i&&(this.shape={type:"polygon",points:e.points,open:e.open},this.updateBoundingBox())}if(e.interactive!==this.props.interactive&&(t=!0,this.props.interactive=e.interactive),(e.open||e.open===!1)&&(t=!0,this.shape.open=e.open),e.style){let i=e.border||e.style.border;if(i!==this._parsed.border.id)if(!i)this._parsed.border.id=null,this._parsed.border.match=[];else{let r=Ul[i]||jl.exec(i)||jl.exec(i);r&&(this._parsed.border.id=i,this._parsed.border.match=Ul[i]=r)}if(this._parsed.border.id&&(e.style.borderWidth=this._parsed.border.match[1],e.style.borderStyle="solid",e.style.borderColor=this._parsed.border.match[4]),e.style.outline!==this._parsed.outline.id)if(!e.style.outline)this._parsed.outline.id=null,this._parsed.outline.match=[];else{let r=Ul[e.style.outline]||jl.exec(e.style.outline)||jl.exec(e.style.outline);r&&(this._parsed.outline.id=e.style.outline,this._parsed.outline.match=Ul[e.style.outline]=r)}this._parsed.outline.id&&(e.style.outlineWidth=this._parsed.outline.match[1],e.style.outlineStyle="solid",e.style.outlineColor=this._parsed.outline.match[4]),this.props.style=e.style,e.backgroundColor&&!this.props.style.backgroundColor&&(this.props.style.backgroundColor=e.backgroundColor,t=!0),e.style.background&&!this.props.style.backgroundColor&&(this.props.style.backgroundColor=e.style.background,t=!0);for(let r of IC)if(this.props.style[r]!==e.style[r]){t=!0;break}e.style[":hover"]!==this.props.hoverStyles&&(this.props.hoverStyles=e.style[":hover"],this.hoverEvents||(this.hoverEvents=!0,this.addEventListener("pointerenter",this.addHover),this.addEventListener("pointerleave",this.removeHover)),t=!0),e.style[":active"]!==this.props.pressStyles&&(this.props.pressStyles=e.style[":active"],this.activeEvents||(this.activeEvents=!0,this.addEventListener("mousedown",this.addPress),this.addEventListener("mouseup",this.removePress)),t=!0)}e.href!==this.props.href&&(this.props.href=e.href,t=!0),e.hrefTarget!==this.props.hrefTarget&&(this.props.hrefTarget=e.hrefTarget,t=!0),e.title!==this.props.title&&(this.props.title=e.title,t=!0),e.className!==this.props.className&&(this.props.className=e.className,e.className&&!this.hoverEvents&&(this.hoverEvents=!0,this.addEventListener("pointerenter",this.addHover),this.addEventListener("pointerleave",this.removeHover)),e.className&&!this.activeEvents&&(this.activeEvents=!0,this.addEventListener("mousedown",this.addPress),this.addEventListener("mouseup",this.removePress)),t=!0),e.relativeSize!==this.props.relativeSize&&(this.props.relativeSize=e.relativeSize,t=!0),e.relativeStyle!==this.props.relativeStyle&&(this.props.relativeStyle=e.relativeStyle,t=!0),e.html!==this.props.html&&(this.props.html=e.html,t=!0),e.target&&(e.target.width!==this.display.width||e.target.height!==this.display.height||e.target.x!==this.points[1]||e.target.y!==this.points[2])&&(t=!0,this.points=st.singleBox(e.target.width,e.target.height,e.target.x,e.target.y),this.display.points=st.singleBox(e.target.width,e.target.height,e.target.x,e.target.y),this.display.width=e.target.width,this.display.height=e.target.height),t&&this.__revision++}},Ev=/(-?[0-9]+(px|em)\s+|0\s+)(-?[0-9]+(px|em)\s+|0\s+)(-?[0-9]+(px|em)\s+|0\s+)?(-?[0-9]+(px|em)\s+|0\s+)?(.*)/g,Av={},OC=typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes("firefox"),Dl={},RC=class{constructor(e,t){M(this,"canvas"),M(this,"ctx"),M(this,"options"),M(this,"imagesPending",0),M(this,"imagesLoaded",0),M(this,"imageIdsLoaded",[]),M(this,"frameIsRendering",!1),M(this,"pendingDrawCall",!1),M(this,"firstMeaningfulPaint",!1),M(this,"parallelTasks",8),M(this,"frameTasks",0),M(this,"loadingQueueOrdered",!0),M(this,"loadingQueue",[]),M(this,"currentTask",Promise.resolve()),M(this,"tasksRunning",0),M(this,"stats"),M(this,"averageJobTime",64),M(this,"lastKnownScale",1),M(this,"visible",[]),M(this,"previousVisible",[]),M(this,"rendererPosition"),M(this,"dpi"),M(this,"drawCalls",[]),M(this,"lastPaintedObject"),M(this,"hostCache"),M(this,"invalidated",[]),M(this,"_worker",()=>{if(this.loadingQueue.length){let i=this.loadingQueue.pop();i&&(this.tasksRunning++,this.frameTasks++,this.currentTask=i.task().then(()=>{this.tasksRunning--}).catch(()=>{this.tasksRunning--}))}}),M(this,"_scheduled",0),M(this,"_doWork",()=>{this.loadingQueue.length===0&&this.tasksRunning===0&&this._scheduled&&(clearInterval(this._scheduled),this._scheduled=0);let i=this.parallelTasks||1;!this.firstMeaningfulPaint&&this.loadingQueue.length&&(i=this.loadingQueue.length);for(let r=0;r<=i;r++)this._worker()}),this.canvas=e,this.rendererPosition=e.getBoundingClientRect(),this.ctx=e.getContext("2d",{alpha:!0}),this.ctx.imageSmoothingEnabled=!0,this.options=t||{},this.canvas.style.opacity="0",this.canvas.style.transition="opacity .3s",this.dpi=(t==null?void 0:t.dpi)||1,this.hostCache=t!=null&&t.lruCache?new pC({maxSize:1024*512*512,dispose:(i,r,n)=>{this.invalidated.push(r),i.width=0,i.height=0},sizeCalculation:(i,r)=>i.width*i.height}):{store:{},get(i){return this.store[i]},set(i,r){this.store[i]=r}}}getCanvasDims(){return{width:this.canvas.width/this.dpi,height:this.canvas.height/this.dpi}}resize(){this.rendererPosition=this.canvas.getBoundingClientRect()}isReady(){return this.firstMeaningfulPaint}afterFrame(e){if(this.clearTransform(),this.lastPaintedObject=void 0,this.frameIsRendering=!1,this.imagesPending=Math.max(0,this.imagesPending-this.imagesLoaded),this.imagesLoaded=0,this.loadingQueueOrdered||(this.loadingQueue=this.loadingQueue.sort((t,i)=>t.network&&t.scale===i.scale?i.distance-t.distance:t.scale<i.scale?-1:1),this.loadingQueueOrdered=!0),this.previousVisible=this.visible,this.pendingDrawCall=!!this.drawCalls.length,this.pendingDrawCall)for(let t=0;t<this.drawCalls.length;t++){let i=this.drawCalls.shift();i&&i()}this.doOffscreenWork(),this.options.debug&&this.stats&&this.stats.end()}doOffscreenWork(){this.frameTasks=0,this.loadingQueue.length&&(this._worker(),this.loadingQueue.length&&(this._scheduled||(this._scheduled=setInterval(this._doWork,0))))}getScale(e,t,i){if(Number.isNaN(e)||Number.isNaN(t))return this.lastKnownScale;let r=this.getCanvasDims(),n=r.width/e,o=r.height/t,l=(n<o?o:n)*(i&&this.dpi||1);return Number.isNaN(l)||(this.lastKnownScale=l),this.lastKnownScale}beforeFrame(e,t,i,r){var n;this.options.debug&&this.stats&&this.stats.begin(),this.frameIsRendering=!0,this.visible=[],this.options.beforeFrame&&this.options.beforeFrame(t);let o=this.getCanvasDims();if(this.ctx.globalAlpha=1,this.ctx.fillStyle=(n=this.canvas.dataset.background)!=null?n:"rgb(0, 0, 0)",this.ctx.fillRect(0,0,o.width,o.height),r.enableFilters&&(r.filters.brightness||r.filters.contrast||r.filters.grayscale||r.filters.invert||r.filters.sepia||r.filters.saturate||r.filters.hueRotate||r.filters.blur)){let l="";r.filters.brightness&&(l+=`brightness(${~~(100+r.filters.brightness*100)}%) `),r.filters.contrast&&(l+=`contrast(${~~(100+r.filters.contrast*100)}%) `),r.filters.grayscale&&(l+=`grayscale(${~~(r.filters.grayscale*100)}%) `),r.filters.invert&&(l+=`invert(${~~(r.filters.invert*100)}%) `),r.filters.sepia&&(l+=`sepia(${~~(r.filters.sepia*100)}%) `),r.filters.saturate&&(l+=`saturate(${~~(100+r.filters.saturate*100)}%) `),r.filters.hueRotate&&(l+=`hue-rotate(${r.filters.hueRotate}deg) `),r.filters.blur&&(l+=`blur(${r.filters.blur}px) `),this.ctx.filter=l}else this.ctx.filter="none"}applyTransform(e,t,i,r,n){let o=e.__owner.value;if(o&&o.rotation){this.ctx.save();let l=t+r/2,u=i+n/2;this.ctx.translate(l,u),this.ctx.rotate(o.rotation*Math.PI/180),this.ctx.translate(-l,-u),this.lastPaintedObject=o}}clearTransform(){this.lastPaintedObject&&(this.lastPaintedObject.rotation&&this.ctx.restore(),this.lastPaintedObject=void 0)}paint(e,t,i,r,n,o){let l=this.ctx.globalAlpha;if(e instanceof Gr||e instanceof ts){if(e.display.rotation){this.ctx.save();let p=i+n/2,f=r+o/2;e.crop&&(p-=e.crop[t*5+1],f-=e.crop[t*5+2]),this.ctx.translate(p,f),this.ctx.rotate(e.display.rotation*Math.PI/180),this.ctx.translate(-p,-f)}if(this.visible.push(e),typeof e.style&&e.style.opacity!=="undefined"){if(!e.style.opacity)return;this.ctx.globalAlpha=e.style.opacity}try{let p=e.__host.canvas,f=this.getCanvasDims();if((p.indices.indexOf(t)===-1||this.invalidated.indexOf(p.canvases[t])!==-1)&&this.schedulePaintToCanvas(p,e,t,Il({x:i+n/2,y:r+n/2},{x:f.width/2,y:f.height/2})),!this.firstMeaningfulPaint)return;let v=this.hostCache.get(p.canvases[t]);if(v)if(e.crop&&e.cropData){if(e.crop[t*5]){let x=[e.crop[t*5+1]/e.display.scale-e.display.points[t*5+1],e.crop[t*5+2]/e.display.scale-e.display.points[t*5+2],1+(e.crop[t*5+3]-e.crop[t*5+1])/e.display.scale,1+(e.crop[t*5+4]-e.crop[t*5+2])/e.display.scale];x[0]+=e.cropData.x/e.display.scale,x[1]+=e.cropData.y/e.display.scale;let E=e.x*this.lastKnownScale,_=e.y*this.lastKnownScale,P=[i+E,r+_,n,o];P[0]+=E,P[1]+=_,this.ctx.drawImage(v,x[0],x[1],x[2],x[3],P[0],P[1],P[2]+1,P[3]+1)}}else OC?this.ctx.drawImage(v,0,0,e.display.points[t*5+3]-e.display.points[t*5+1],e.display.points[t*5+4]-e.display.points[t*5+2],i,r,n+1,o+1):this.ctx.drawImage(v,0,0,e.display.points[t*5+3]-e.display.points[t*5+1],e.display.points[t*5+4]-e.display.points[t*5+2],i,r,n+Number.MIN_VALUE+.5,o+Number.MIN_VALUE+.5)}catch{}e.display.rotation&&this.ctx.restore()}let u=e instanceof qs&&this.options.box,c=e instanceof Sv&&this.options.polygon;if((u||c)&&!e.props.className&&!e.props.html&&!e.props.href){if(this.visible.push(e),e.props.style){let p=Object.assign({},e.props.style||{},e.hovering?e.props.hoverStyles:{},e.pressing?e.props.pressStyles:{}),f=e.props.relativeStyle?1:n/e.width;typeof p.opacity<"u"&&(this.ctx.globalAlpha=p.opacity);let v=0;typeof p.borderWidth<"u"&&(v=parseInt(p.borderWidth,10)*f);let x=0;typeof p.outlineWidth<"u"&&(x=parseInt(p.outlineWidth,10)*f);let E=0;if(typeof p.outlineOffset<"u"&&(E=parseInt(p.outlineOffset,10)*f),p.borderColor&&(this.ctx.strokeStyle=p.borderColor),p.boxShadow){let _=p.boxShadow.split(/,(?![^(]*\))/);for(let P of _){let O=Av[P]||Ev.exec(P)||Ev.exec(P);Av[P]=O,O&&(this.ctx.save(),this.ctx.shadowOffsetX=parseInt(O[1])*this.dpi*f,this.ctx.shadowOffsetY=parseInt(O[3])*this.dpi*f,this.ctx.shadowBlur=parseInt(O[5])*this.dpi*f,this.ctx.shadowColor=O[9],this.ctx.fillStyle="rgba(0,0,0,1)",this.ctx.fillRect(i+v,r+v,n,o),this.ctx.restore())}}if(this.ctx.fillStyle=p.backgroundColor||"transparent",this.ctx.lineWidth=v,c){let _=e.shape,P=_.points||[],O=P.length;this.ctx.beginPath();for(let I=0;I<O;I++)this.ctx.lineTo(i+P[I][0]*this.lastKnownScale,r+P[I][1]*this.lastKnownScale);_.open||this.ctx.closePath(),v&&this.ctx.stroke(),_.open||this.ctx.fill()}else v&&this.ctx.strokeRect(i+v/2,r+v/2,n+v,o+v),this.ctx.fillRect(i+v,r+v,n,o);x&&(p.outlineColor&&(this.ctx.strokeStyle=p.outlineColor),this.ctx.lineWidth=x,this.ctx.strokeRect(i-x/2-E,r-x/2-E,n+v*2+x+E*2,o+v*2+x+E*2))}this.ctx.globalAlpha=l}}loadImage(e,t,i,r=!1){if(Dl[e]&&Dl[e].naturalWidth>0){t(Dl[e]);return}try{let n=!1;r||setTimeout(()=>{n||this.loadImage(e,t,i,!0)},3e3);let o=document.createElement("img");o.decoding="auto",o.onload=function(){n=!0,t(o),Dl[e]=o,o.onload=null},this.options.crossOrigin&&(o.crossOrigin="anonymous"),o.src=e,o.complete&&o.onload({}),o.width}catch(n){console.log("image error",n),i(n)}}schedulePaintToCanvas(e,t,i,r){this.imagesPending++,e.indices.push(i);let n=`${t.id}--${t.display.scale}-${i}`,o=this.invalidated.indexOf(n);o!==-1&&this.invalidated.splice(o,1),e.canvases[i]=n,t.__host.canvas.loading=!0,this.loadingQueueOrdered=!1,this.loadingQueue.push({id:n,scale:t.display.scale,network:!0,distance:r,task:()=>new Promise(l=>{if(this.visible.indexOf(t)===-1){this.imagesPending--,e.indices.splice(e.indices.indexOf(i),1),l();return}let u=t.getImageUrl(i);this.loadImage(u,c=>{this.loadingQueue.push({id:n,scale:t.display.scale,distance:r,task:()=>new Promise(p=>{this.imageIdsLoaded.includes(n)||(this.imagesLoaded++,this.imageIdsLoaded.push(n)),e.loaded.push(i),e.loaded.length===e.indices.length&&(e.loading=!1);let f=t.display.points.slice(i*5,i*5+5),v=document.createElement("canvas"),x=v.getContext("2d");v.width=f[3]-f[1],v.height=f[4]-f[2],this.hostCache.set(e.canvases[i],v),this.drawCalls.push(()=>{x.drawImage(c,0,0,f[3]-f[1],f[4]-f[2]),p()})})}),l()},c=>{this.imagesPending--,e.indices.splice(e.indices.indexOf(i),1),l()})})})}afterPaintLayer(e,t){}prepareLayer(e,t){e.__owner.value&&(e.cropData?(this.lastKnownScale*(1/e.display.scale),this.applyTransform(e,t[1],t[2],t[3]-t[1],t[4]-t[2])):this.applyTransform(e,t[1],t[2],t[3]-t[1],t[4]-t[2])),(!e.__host||!e.__host.canvas)&&(e instanceof Gr||e instanceof ts)&&this.createImageHost(e)}finishLayer(){this.lastPaintedObject&&this.clearTransform()}createImageHost(e){e.__host=e.__host?e.__host:{},e.__host.canvas={canvas:void 0,canvases:[],indices:[],loaded:[],loading:!1}}getPointsAt(e,t,i,r){return e.getPointsAt(t,i,r)}getViewportBounds(e,t,i){let r=e.getActiveZone();if(r){let n=t[3]-t[1]<r.points[3]-r.points[1],o=t[4]-t[2]<r.points[4]-r.points[2];return{x1:n?r.points[1]-i:r.points[1]+(r.points[3]-r.points[1])/2-(t[3]-t[1])/2,y1:o?r.points[2]-i:r.points[2]+(r.points[4]-r.points[2])/2-(t[4]-t[2])/2,x2:n?r.points[3]+i:r.points[1]+(r.points[3]-r.points[1])/2-(t[3]-t[1])/2,y2:o?r.points[4]+i:r.points[2]+(r.points[4]-r.points[2])/2-(t[4]-t[2])/2}}return null}pendingUpdate(){let e=!this.pendingDrawCall&&this.drawCalls.length===0&&this.imagesPending===0&&this.loadingQueue.length===0&&this.tasksRunning===0;return!e&&this.visible.length===0&&setTimeout(()=>{this.canvas.style.opacity="1",this.firstMeaningfulPaint=!0},500),!this.firstMeaningfulPaint&&e&&this.visible.length?(this.canvas.style.opacity="1",this.firstMeaningfulPaint=e,!0):this.options.debug?!0:!e}getRendererScreenPosition(){return this.rendererPosition}reset(){this.loadingQueue=[],this.drawCalls=[]}},kv=class{constructor(e){M(this,"renderers",[]),M(this,"length");for(let t of e)t&&this.renderers.push(t);this.length=this.renderers.length}afterFrame(e,t,i,r){for(let n=0;n<this.length;n++)this.renderers[n].afterFrame(e,t,i,r)}afterPaintLayer(e,t){for(let i=0;i<this.length;i++)this.renderers[i].afterPaintLayer(e,t)}beforeFrame(e,t,i,r){for(let n=0;n<this.length;n++)this.renderers[n].beforeFrame(e,t,i,r)}triggerResize(){for(let e=0;e<this.length;e++){let t=this.renderers[e];t.triggerResize&&t.triggerResize()}}getPointsAt(e,t,i,r){return this.renderers[0].getPointsAt(e,t,i,r)}getScale(e,t){return this.renderers[0].getScale(e,t)}getViewportBounds(e,t,i){return this.renderers[0].getViewportBounds(e,t,i)}getRendererScreenPosition(){return this.renderers[0].getRendererScreenPosition()}isReady(){for(let e=0;e<this.length;e++)if(!this.renderers[e].isReady())return!1;return!0}paint(e,t,i,r,n,o){for(let l=0;l<this.length;l++)this.renderers[l].paint(e,t,i,r,n,o)}pendingUpdate(){for(let e=0;e<this.length;e++)if(this.renderers[e].pendingUpdate())return!0;return!1}prepareLayer(e,t){for(let i=0;i<this.length;i++)this.renderers[i].prepareLayer(e,t)}finishLayer(e,t){for(let i=0;i<this.length;i++)this.renderers[i].finishLayer(e,t)}resize(e,t){for(let i=0;i<this.length;i++)this.renderers[i].resize(e,t)}reset(){for(let e=0;e<this.length;e++)this.renderers[e].reset()}},MC=class{constructor(e){M(this,"canvas"),M(this,"context"),M(this,"heightRatio",1),M(this,"widthRatio",1),M(this,"target",new Float32Array(5)),M(this,"initialWidth"),M(this,"initialHeight"),M(this,"bounds"),M(this,"aggregate"),M(this,"delta",0),M(this,"renderNextFrame",!0),this.canvas=e,this.initialWidth=e.width,this.initialHeight=e.height,this.context=e.getContext("2d"),this.context.globalAlpha=.5,this.aggregate=gn(1)}isReady(){return!0}resize(){this.initialWidth=this.canvas.width,this.initialHeight=this.canvas.height,this.renderNextFrame=!0}afterFrame(e,t,i){if(this.renderNextFrame){this.context.clearRect(0,0,this.canvas.width,this.canvas.height);let r=this.initialWidth/e.width,n=this.initialHeight/e.height,o=this.widthRatio>this.heightRatio?r:n;if(this.target=i,this.bounds){let l=e.getPointsAt(this.bounds,this.aggregate,o);for(let[u,c]of l)if(u instanceof Gr&&u.__host.canvas){let p=c.length/5;for(let f=0;f<p;f++)u.__host.canvas.canvases[f]&&(c[f+1]*o,c[f+2]*o,(c[f+3]-c[f+1])*o,(c[f+4]-c[f+2])*o)}}e.getPoints().forEach((l,u,c)=>{if(u%5===0&&l){let p={x1:c[u+1]*o,y1:c[u+2]*o,x2:c[u+3]*o,y2:c[u+4]*o,width:(c[u+3]-c[u+1])*o,height:(c[u+4]-c[u+2])*o};this.context.strokeStyle="red",this.context.strokeRect(p.x1,p.y1,p.width,p.height)}}),i&&(this.context.strokeStyle="red",this.context.lineWidth=window.devicePixelRatio||1,this.context.strokeRect(i[1]*o,i[2]*o,(i[3]-i[1])*o,(i[4]-i[2])*o))}}getActiveZone(e){return null}getPointsAt(e,t,i,r){return e.getPointsAt(t,i,r)}getScale(e,t){return 1}beforeFrame(e,t){this.bounds=st.singleBox(e.width,e.height)}drawImage(){}afterPaintLayer(e,t){}paint(e,t,i,r,n,o){this.renderNextFrame=!0}prepareLayer(e){}pendingUpdate(){return!1}hasActiveZone(){return!1}getViewportBounds(e,t,i){return null}getRendererScreenPosition(){return this.canvas.getBoundingClientRect()}finishLayer(){}reset(){}};function LC(e){return{x:e[1],y:e[2],width:e[3]-e[1],height:e[4]-e[2]}}var Pv="pan",Cv="scroll",$C="gesture",NC={zoomOutFactor:.8,zoomInFactor:1.25,maxZoomFactor:1,minZoomFactor:.05,zoomDuration:300,zoomWheelConstant:20,zoomClamp:.6,panBounceStiffness:120,panBounceDamping:15,panTimeConstant:240,panPower:.1,nudgeDistance:100,panPadding:0,devicePixelRatio:1,enableWheel:!0,enableClickToZoom:!0,ignoreSingleFingerTouch:!1,enablePanOnWait:!1,requireMetaKeyForWheelZoom:!1,panOnWaitDelay:40,onPanInSketchMode:()=>{},parentElement:null},Tv=(e={})=>({start:function(t){let{zoomWheelConstant:i,enableWheel:r,enableClickToZoom:n,ignoreSingleFingerTouch:o,enablePanOnWait:l,panOnWaitDelay:u,parentElement:c,requireMetaKeyForWheelZoom:p}=C(C({},NC),e),f={pointerStart:{x:0,y:0},isPressing:!1,mousemoveBuffer:Le(5),multiTouch:{distance:0}};t.world.activatedEvents.push("onMouseUp","onMouseDown","onMouseMove","onTouchStart","onTouchEnd","onTouchMove");function v(){P=0,I="",$(),$(void 0,"notice"),O=0}function x(){t.world.constraintBounds(),v()}function E(Q){if(Q.which>1){f.isPressing=!1;return}t.mode==="explore"&&(Q.preventDefault(),f.pointerStart.x=Q.atlas.x,f.pointerStart.y=Q.atlas.y,t.transitionManager.stopTransition(),f.isPressing=!0)}function _(){v(),f.isPressing&&(t.mode==="explore"&&t.world.constraintBounds(),f.isPressing=!1)}let P=0,O=0,I="";function A(Q){if(t.mode==="explore"){if(Q.atlasTouches.length===1&&(O=performance.now(),o==!1&&Q.preventDefault(),f.pointerStart.x=Q.atlasTouches[0].x,f.pointerStart.y=Q.atlasTouches[0].y),Q.atlasTouches.length===2){I=$C,Q.preventDefault();let ue=Q.atlasTouches[0].x,pe=Q.atlasTouches[1].x;f.pointerStart.x=(ue+pe)/2;let ge=Q.atlasTouches[0].y,oe=Q.atlasTouches[1].y;f.pointerStart.y=(ge+oe)/2,P=Il({x:Q.touches[0].clientX,y:Q.touches[0].clientY},{x:Q.touches[1].clientX,y:Q.touches[1].clientY})}t.transitionManager.stopTransition(),f.isPressing=!0}}function $(Q,ue="intent"){c&&(c.dataset[ue]=Q)}function z(Q){let ue=null,pe=null,ge=0;if(f.isPressing&&Q.touches.length===2){let oe=Q.touches[0].clientX,Se=Q.touches[1].clientX;ue=(oe+Se)/2;let Pe=Q.touches[0].clientY,Ke=Q.touches[1].clientY;pe=(Pe+Ke)/2,ge=Il({x:Q.touches[0].clientX,y:Q.touches[0].clientY},{x:Q.touches[1].clientX,y:Q.touches[1].clientY})}if($(I),f.isPressing&&Q.touches.length===1){if(l&&(performance.now()-O<u&&I==""&&(I=Cv),I==""&&(I=Pv)),$(I),I==""&&o==!0||I==Cv){$("require-two-finger","notice");return}let oe=Q.touches[0];ue=oe.clientX,pe=oe.clientY}if(ue!==null&&pe!==null){let oe=t.getRendererScreenPosition();if(oe){let{x:Se,y:Pe}=t.viewerToWorld(ue-oe.x,pe-oe.y),Ke=ge&&P?ge/P:1;t.transitionManager.customTransition(re=>{re.from=Le(t.target),re.to=Vr(re.from,Qr(Fi(f.pointerStart.x-Se,f.pointerStart.y-Pe),Fo(1/Ke,Se,Pe)),f.mousemoveBuffer),re.elapsed_time=0,re.total_time=0,re.timingFunction=Cr.easeInOutExpo,re.done=!1})}P=ge}I==Pv&&Q.preventDefault()}function B(Q){if(f.isPressing){let ue=t.getRendererScreenPosition();if(ue){let{x:pe,y:ge}=t.viewerToWorld(Q.clientX-ue.x,Q.clientY-ue.y);t.transitionManager.customTransition(oe=>{oe.from=Le(t.target),oe.to=Vr(oe.from,Fi(f.pointerStart.x-pe,f.pointerStart.y-ge),f.mousemoveBuffer),oe.elapsed_time=0,oe.total_time=0,oe.timingFunction=Cr.easeInOutExpo,oe.done=!1})}}}function H(Q){t.mode==="explore"&&t.world.zoomIn(Q.atlas)}function Y(Q){let ue=1+(0,fC.default)(Q).spinY/i;t.world.zoomTo(ue,Q.atlas,!0)}function V(Q){return p&&Q.metaKey==!1?($("meta-required","notice"),Q.stopPropagation(),!1):!0}t.world.addEventListener("mouseup",x),t.world.addEventListener("touchend",x),t.world.addEventListener("touchstart",A),t.world.addEventListener("mousedown",E),window.addEventListener("touchend",_),window.addEventListener("mouseup",_),window.addEventListener("mousemove",B),c&&c.addEventListener("touchmove",z),n&&(t.world.activatedEvents.push("onClick"),t.world.addEventListener("click",H)),r&&(t.world.activatedEvents.push("onWheel"),p&&(c==null||c.addEventListener("wheel",V,{passive:!0,capture:!0})),t.world.addEventListener("wheel",Y));let he=t.world.addLayoutSubscriber((Q,ue)=>{if(Q==="zone-changed"&&t.transitionManager.constrainBounds({transition:{duration:0}}),Q==="zoom-to"&&ue&&t.transitionManager.zoomTo(ue.factor,{origin:ue.point,stream:ue.stream}),Q==="go-home"){let pe=ue.immediate?{duration:0}:void 0;t.transitionManager.goToRegion(LC(t.homePosition),{transition:pe})}if(Q==="goto-region"&&ue){let pe=ue.immediate?{duration:0}:{};t.transitionManager.goToRegion(ue,{transition:pe})}Q==="constrain-bounds"&&t.transitionManager.constrainBounds({transition:ue!=null&&ue.immediate?{duration:0}:void 0})});return()=>{t.world.removeEventListener("mouseup",x),t.world.removeEventListener("touchend",x),t.world.removeEventListener("touchstart",A),t.world.removeEventListener("mousedown",E),window.removeEventListener("touchend",_),window.removeEventListener("mouseup",_),t.world.removeEventListener("mousemove",B),c&&(c.removeEventListener("touchmove",B),c.removeEventListener("wheel",V,{passive:!0,capture:!0})),n&&t.world.removeEventListener("click",H),r&&t.world.removeEventListener("wheel",Y),he()}},updatePosition(){}}),Wl=te.createContext("explore");Wl.displayName="Mode";var Ic=()=>Kt(Wl),Hl=te.createContext(null);Hl.displayName="Atlas";var ql=te.createContext(null);ql.displayName="Bounds";var Ql,zC=typeof performance=="object"&&typeof performance.now=="function";if(zC){let e=performance;Ql=()=>e.now()}else{let e=Date,t=e.now();Ql=()=>e.now()-t}var FC=16;function Iv(e,t){e&&e.appendChild&&t&&e.appendChild(t)}function Ov(e,t){e&&e.removeChild&&t&&e.removeChild(t)}function BC(e,t){return Ov(e.world,t)}function jC(e,t,i){return Rv(e.world,t,i)}function Rv(e,t,i){e&&e instanceof Bl&&(e=e.world),e&&e.insertBefore&&e.insertBefore(t,i)}function Oc(e,t,i){if(i&&(e.applyProps&&e.applyProps(i),e instanceof Pr))for(let r of Pl){let n=r.slice(2).toLowerCase();i[r]!==t[r]&&(t[r]&&e.removeEventListener(n,t[r]),e.addEventListener(n,i[r]))}}function Rc(e,t){let i=Object.keys(t),r=!1;for(let n of i)if(Pl.indexOf(n)!==-1){let o=Hs[n];if(o){if(e.activatedEvents.indexOf(o)!==-1)continue;r=!0,e.activatedEvents.push(o)}}r&&e.triggerEventActivation()}var Vl=new Map,Mv={};function UC(e,t,i,r,n){var o=t,l=le(o,["args"]);if(!(i instanceof Bl)&&n){let p=f=>f.return?p(f.return):f.stateNode&&f.stateNode.containerInfo;i=p(n)}let u,c=i.world;switch(e){case"world":u=is.withProps({width:l.width,height:l.height,viewingDirection:"left-to-right"}),u.activatedEvents=c.activatedEvents,u.eventHandlers=c.eventHandlers,u.subscriptions=c.subscriptions,u.triggerEventActivation(),c=u;break;case"box":u=new qs;break;case"shape":u=new Sv;break;case"worldObject":case"world-object":u=new jo;break;case"worldImage":case"world-image":u=new Gr;break;case"texture":u=new Tl;break;case"compositeImage":case"composite-image":u=new Tc({id:l.id,width:l.width,height:l.height,images:[],renderOptions:l.renderOptions});break;case"tiledImage":case"tiled-image":u=ts.fromTile(l.uri,l.display,l.tile,l.scaleFactor,void 0,l.format);break;case"paragraph":u=new Uo,u.text=l.children;break;default:return}return Rc(c,l),Oc(u,{},l),u}function DC(e,t){if(t instanceof is)e.world=t;else if(t instanceof jo)e.world.appendChild(t);else if(t)throw new Error("Invalid root")}var Ho=(0,wC.default)({unstable_now:Ql,now:Ql,createInstance:UC,removeChild:Ov,appendChild:Iv,appendInitialChild:Iv,insertBefore:Rv,warnsIfNotActing:!0,supportsMutation:!0,isPrimaryRenderer:!1,scheduleTimeout:typeof setTimeout<"u"?setTimeout:void 0,cancelTimeout:typeof clearTimeout<"u"?clearTimeout:void 0,setTimeout:typeof setTimeout<"u"?setTimeout:void 0,clearTimeout:typeof clearTimeout<"u"?clearTimeout:void 0,noTimeout:-1,appendChildToContainer:DC,removeChildFromContainer:BC,createTextInstance(){},insertInContainerBefore:jC,prepareUpdate(e,t,i,r,n){return Rc(n.world,r),r},commitUpdate(e,t,i,r,n,o){e.applyProps&&t&&Oc(e,r,t)},finalizeInitialChildren(e){return e==null?void 0:e.__handlers},getChildHostContext(){return Mv},getRootHostContext(){return Mv},prepareForCommit(e){return e.isCommitting=!0,null},preparePortalMount(){},hideInstance(e){e&&e.points&&(e.points[0]=0)},unhideInstance(e,t){e&&e.points&&(e.points[0]=1)},getPublicInstance(e){return e},hideTextInstance(){throw new Error("Text is not allowed in the react-three-fibre tree. You may have extraneous whitespace between components.")},resetAfterCommit(e){e.isCommitting=!1,e.pendingUpdate=!0,e.world&&e.world.needsRecalculate&&(e.world.recalculateWorldSize(),e.world.triggerRepaint())},shouldSetTextContent(){return!1},clearContainer(){return!1},supportsHydration:!1,supportsPersistence:!1,detachDeletedInstance(e){},afterActiveInstanceBlur(){},beforeActiveInstanceBlur(){},getCurrentEventPriority(){return console.log("getCurrentEventPriority"),FC},getInstanceFromNode(e){throw console.log("getInstanceFromNode",e),new Error("Not implemented")},getInstanceFromScope(e){throw console.log("getInstanceFromScope",e),new Error("Not implemented")},prepareScopeUpdate(e,t){throw console.log("prepareScopeUpdate",e,t),new Error("Not implemented")},logRecoverableError(){},requestPostPaintCallback(){}});Ho.injectIntoDevTools({bundleType:0,version:Ts,rendererPackageName:"@atlas-viewer/atlas"});function Mc(e,t){let i=Vl.get(e);i&&Ho.updateContainer(null,i,null,()=>{Vl.delete(e),t&&t(e)})}var Lv={render(e,t){let i=Vl.get(t);if(i)Ho.updateContainer(e,i,null);else{let r=Ho.createContainer(t,0,null,!1,null,"",()=>{},null);Ho.updateContainer(e,r,null),Vl.set(t,r)}},unmountComponentAtNode(e,t){Mc(e,t)}},$v,Nv,qo=typeof window<"u"&&(($v=window.document)!=null&&$v.createElement||((Nv=window.navigator)==null?void 0:Nv.product)==="ReactNative")?At:de,WC=te.memo(({children:e,setIsReady:t,onCreated:i,bounds:r,preset:n,mode:o="explore"})=>{let l=He(function(u){let c=we(!1),p=()=>{t(!0)};return de(()=>{if(n&&!c.current){n.runtime.goHome();let f=i&&i(n);return void(f&&f.then?f.then(p):p())}return()=>{}},[]),de(()=>{c.current=!0},[]),u.children},[n]);return qo(()=>{if(n){let u=n.runtime;o!==u.mode&&(u.mode=o),Lv.render(Ge(te.StrictMode,{children:Ge(l,{children:Ge(ql.Provider,{value:r,children:Ge(Wl.Provider,{value:o,children:Ge(Hl.Provider,{value:n,children:e})})})})}),u)}},[n,o,e]),qo(()=>{if(n){let u=n.runtime;return()=>{Lv.unmountComponentAtNode(u)}}return()=>{}},[n]),null}),HC=class{constructor(e,t){M(this,"canvas"),M(this,"gl"),M(this,"program"),M(this,"fragmentShader"),M(this,"vertexShader"),M(this,"rectBuffer"),M(this,"fragmentShaderSource",`
    precision mediump float;

    uniform sampler2D u_image;
    varying vec2 v_texCoord;

    void main() {
        gl_FragColor = texture2D(u_image, v_texCoord);
    }
  `),M(this,"vertexShaderSource",`
    attribute vec2 a_position;
    uniform vec2 u_resolution;
    varying vec4 v_color;
    uniform sampler2D u_texture;

    attribute vec2 a_texCoord;
    varying vec2 v_texCoord;

    void main() {

        // convert the position from pixels to 0.0 to 1.0
        vec2 zeroToOne = a_position / u_resolution;

        // convert from 0->1 to 0->2
        vec2 zeroToTwo = zeroToOne * 2.0;

        // convert from 0->2 to -1->+1 (clip space)
        vec2 clipSpace = zeroToTwo - 1.0;

        gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);
        
        v_texCoord = a_texCoord;
    }
  `),M(this,"attributes"),M(this,"uniforms"),M(this,"buffers"),M(this,"rendererPosition"),M(this,"dpi"),M(this,"lastResize",0),M(this,"lastKnownScale",1),this.canvas=e,this.rendererPosition=e.getBoundingClientRect(),this.gl=e.getContext("webgl2"),this.fragmentShader=this.createShader(this.gl.FRAGMENT_SHADER,this.fragmentShaderSource),this.vertexShader=this.createShader(this.gl.VERTEX_SHADER,this.vertexShaderSource),this.program=this.createProgram(this.vertexShader,this.fragmentShader),this.dpi=(t==null?void 0:t.dpi)||1,this.attributes={position:this.gl.getAttribLocation(this.program,"a_position"),texCoord:this.gl.getAttribLocation(this.program,"a_texCoord")},this.uniforms={resolution:this.gl.getUniformLocation(this.program,"u_resolution"),texture:this.gl.getUniformLocation(this.program,"u_texture")},this.buffers={position:this.createArrayBuffer(),texCoord:this.createArrayBuffer(new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]))},this.rectBuffer=new Float32Array(12),this.resize(),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.useProgram(this.program),this.gl.enableVertexAttribArray(this.attributes.position)}resize(){this.resizeCanvasToDisplaySize(),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.rendererPosition=this.canvas.getBoundingClientRect()}isReady(){return!0}beforeFrame(e,t,i){this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.vertexAttribPointer(this.attributes.position,2,this.gl.FLOAT,!1,0,0),this.gl.uniform2f(this.uniforms.resolution,this.gl.canvas.width,this.gl.canvas.height),this.lastResize>1e3&&(this.lastResize=0,this.resizeCanvasToDisplaySize()),this.lastResize+=t}prepareLayer(e){(!e.__host||!e.__host.webgl)&&((e instanceof Gr||e instanceof ts)&&this.createImageHost(e),e instanceof Tl&&this.createTextureHost(e))}createTextureHost(e){e.__host=e.__host?e.__host:{};let t=this.gl,i=this.gl.createTexture();t.bindTexture(t.TEXTURE_2D,i),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!1);let r;if(e instanceof Tl){let n=e.getTexture();n.source&&t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n.source),r=n}t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),e.__host.webgl={height:e.height,width:e.width,texture:i,lastImage:r}}createImageHost(e){let t=[...new Array(e.points.length/5)];e.__host=e.__host?e.__host:{},e.__host.webgl={height:e.height,width:e.width,textures:t,loading:[],loaded:[],lastLevelRendered:-1,onLoad:(i,r)=>{let n=this.gl,o=this.gl.createTexture();n.bindTexture(n.TEXTURE_2D,o),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.bindTexture(n.TEXTURE_2D,null),e.__host.webgl.textures[i]=o,e.__host.webgl.loaded.push(i)}}}paint(e,t,i,r,n,o){if(e.type==="spacial-content"&&e.__host&&e.__host.webgl){if(e.getTexture){let u=e==null?void 0:e.getTexture();if(u&&e.__host.webgl.lastImage!==u.hash&&u.source&&!e.__host.webgl.error)try{let c=this.gl.RGBA,p=this.gl.RGBA,f=this.gl.UNSIGNED_BYTE;this.gl.bindTexture(this.gl.TEXTURE_2D,e.__host.webgl.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,c,p,f,u.source),e.__host.webgl.lastImage=u.hash}catch(c){e.__host.webgl.error=c}}if(e.__host.webgl.loading&&e.__host.webgl.loading.indexOf(t)===-1&&e.getImageUrl){e.__host.webgl.loading.push(t);let u=document.createElement("img");u.decoding="async",u.crossOrigin="anonymous",u.src=e.getImageUrl(t),u.onload=()=>(u.onload=null,e.__host.webgl.onLoad(t,u))}let l=e.__host.webgl.texture?e.__host.webgl.texture:e.__host.webgl.textures[t];l&&(this.gl.enableVertexAttribArray(this.attributes.texCoord),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffers.texCoord),this.gl.enableVertexAttribArray(this.attributes.texCoord),this.gl.vertexAttribPointer(this.attributes.texCoord,2,this.gl.FLOAT,!1,0,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffers.position),this.gl.enableVertexAttribArray(this.attributes.position),this.gl.vertexAttribPointer(this.attributes.position,2,this.gl.FLOAT,!1,0,0),this.gl.bindTexture(this.gl.TEXTURE_2D,l),this.gl.uniform1i(this.uniforms.texture,0),this.setRectangle(i,r,n,o),this.gl.drawArrays(this.gl.TRIANGLES,0,6))}}afterPaintLayer(e,t){}pendingUpdate(){return!0}getPointsAt(e,t,i,r){return e.getPointsAt(t,i,r)}afterFrame(){}getScale(e,t,i){if(Number.isNaN(e)||Number.isNaN(t))return this.lastKnownScale;let r=this.getCanvasDims(),n=r.width/e,o=r.height/t,l=(n<o?o:n)*(i&&this.dpi||1);return Number.isNaN(l)||(this.lastKnownScale=l),this.lastKnownScale}getCanvasDims(){return{width:this.canvas.width/this.dpi,height:this.canvas.height/this.dpi}}getViewportBounds(e,t,i){return null}createShader(e,t){let i=this.gl.createShader(e);if(i){if(this.gl.shaderSource(i,t),this.gl.compileShader(i),this.gl.getShaderParameter(i,this.gl.COMPILE_STATUS))return i;let r=this.gl.getShaderInfoLog(i);if(this.gl.deleteShader(i),r)throw new Error(r)}throw new Error("Invalid shader")}createProgram(e,t){let i=this.gl.createProgram();if(i){if(this.gl.attachShader(i,e),this.gl.attachShader(i,t),this.gl.linkProgram(i),this.gl.getProgramParameter(i,this.gl.LINK_STATUS))return i;let r=this.gl.getProgramInfoLog(i);if(this.gl.deleteProgram(i),r)throw new Error(r)}throw new Error("Invalid program")}resizeCanvasToDisplaySize(){let e=this.gl.canvas,t=e.clientWidth,i=e.clientHeight,r=e.width!==t||e.height!==i;return r&&(e.width=t,e.height=i),r}createArrayBuffer(e){let t=this.gl.createBuffer();if(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t),e&&this.gl.bufferData(this.gl.ARRAY_BUFFER,e,this.gl.STATIC_DRAW),!t)throw new Error("Cannot create buffer");return t}setRectangle(e,t,i,r){this.gl.bufferData(this.gl.ARRAY_BUFFER,this.getRectangle(e,t,i,r),this.gl.STATIC_DRAW)}getRectangle(e,t,i,r){let n=e,o=e+i,l=t,u=t+r;return this.rectBuffer.set([n,l,o,l,n,u,n,u,o,l,o,u]),this.rectBuffer}getRendererScreenPosition(){return this.rendererPosition}finishLayer(){}reset(){}};function Lc(e,t){let i=t?e:JSON.stringify(e),r=5381,n=i.length;for(;n;)r=r*33^i.charCodeAt(--n);let o=(r>>>0).toString(16);return o.length%2?"0"+o:o}var zv=class{constructor(e){M(this,"$element"),M(this,"stylesheetClasses"),M(this,"activeStylesheetClasses"),M(this,"sheetsDidUpdate"),M(this,"sheetPrefix"),M(this,"stylesheetEntries"),this.sheetPrefix=(e==null?void 0:e.sheetPrefix)||"a-",this.$element=document.createElement("style"),this.stylesheetClasses=[],this.activeStylesheetClasses=[],this.sheetsDidUpdate=!1,this.stylesheetEntries={}}getElement(){return this.$element}addStylesheet(e){let t=e.replace(/\s\s+/g," ").replace(/: /g,":").replace(/; /g,";").trim(),i=this.sheetPrefix+Lc(t,!0);return this.stylesheetClasses.indexOf(i)!==-1||(this.stylesheetClasses.push(i),this.activeStylesheetClasses.push(i),this.stylesheetEntries[i]=t,this.sheetsDidUpdate=!0),i}removeStylesheet(e){let t=this.sheetPrefix+Lc(e,!0);this.stylesheetClasses.indexOf(t)&&(this.stylesheetClasses=this.stylesheetClasses.filter(i=>i!==t)),this.sheetsDidUpdate=!0}clearClasses(){this.activeStylesheetClasses=[]}didUpdateActive(){if(this.activeStylesheetClasses.length){for(let e of this.activeStylesheetClasses)if(this.stylesheetClasses.indexOf(e)===-1)return!0;for(let e of this.stylesheetClasses)if(this.activeStylesheetClasses.indexOf(e)===-1)return!0}return!1}updateSheet(){(this.sheetsDidUpdate||this.didUpdateActive())&&(this.$element.innerText=this.activeStylesheetClasses.map(e=>`.${e}{${this.stylesheetEntries[e]}}`).join(""),this.sheetsDidUpdate=!1,this.stylesheetClasses=[...this.activeStylesheetClasses])}},Fv=class{constructor(e,t){M(this,"htmlContainer"),M(this,"visible",[]),M(this,"previousVisible",[]),M(this,"htmlIds",[]),M(this,"firstMeaningfulPaint",!1),M(this,"rendererPosition"),M(this,"stylesheet"),M(this,"options"),M(this,"paintTx",1),M(this,"zIndex",0),M(this,"classes"),this.htmlContainer=e,this.htmlContainer.innerHTML="",this.rendererPosition=this.htmlContainer.getBoundingClientRect(),this.options=C({triggerResize:()=>{},box:!1,text:!1,sheetPrefix:"",inlineStyles:!1,background:""},t||{}),this.stylesheet=new zv({sheetPrefix:this.options.sheetPrefix}),this.options.inlineStyles||this.htmlContainer.appendChild(this.stylesheet.getElement()),this.options.background&&this.htmlContainer.classList.add(this.stylesheet.addStylesheet(`
        background: ${this.options.background};
      `)),this.classes={hostClassName:this.stylesheet.addStylesheet(`
        position: absolute;
        transform-origin: 0px 0px;
      `),interactive:this.stylesheet.addStylesheet("pointer-events: all"),nonInteractive:this.stylesheet.addStylesheet("pointer-events: none")},this.stylesheet.updateSheet()}createHtmlHost(e){if(this.htmlContainer&&(this.options.box||e.props.className||e.props.html||e.props.href)){let t=document.createElement(e.props.href?"a":"div");if(e.props.href){t.style.display="block",t.href=e.props.href;let i=e.props.hrefTarget||"_blank";t.target=i,i!=="_self"&&(t.rel="noopener noreferrer")}t.title=e.props.title||"",this.options.inlineStyles?(t.style.display="block",t.style.position="absolute",t.style.overflow="hidden",t.style.transformOrigin="0px 0px"):t.classList.add(this.classes.hostClassName),e.__host={element:t,revision:null,relative:!1},this.updateHtmlHost(e,e.width,e.height),e.__onCreate&&e.__onCreate()}}triggerResize(){this.options.triggerResize()}updateHtmlHost(e,t,i){if(e.__revision!==e.__host.revision){let r=e.__host.element,n=[this.classes.hostClassName];if(e.props.interactive?this.options.inlineStyles?r.style.pointerEvents="all":n.push(this.classes.interactive):this.options.inlineStyles?r.style.pointerEvents="none":n.push(this.classes.nonInteractive),e.props.href){r.style.display="block",r.href=e.props.href;let l=e.props.hrefTarget||"_blank";r.target=l,l!=="_self"?r.rel="noopener noreferrer":r.rel=""}else r.href&&r.removeAttribute("href");if(e.props.title&&(r.title=e.props.title||""),e.props.className&&(n.push(e.props.className),e.hovering&&n.push(`${e.props.className}--hover`),e.pressing&&n.push(`${e.props.className}--active`)),e.props.relativeStyle?(r.style.width=`${t||e.width}px`,r.style.height=`${i||e.height}px`):(r.style.width=`${e.width}px`,r.style.height=`${e.height}px`),e.props.style){Object.assign(r.style,e.props.style||{},e.hovering?e.props.hoverStyles||{}:{},e.pressing?e.props.pressStyles||{}:{});return}if(this.options.text&&e instanceof Uo){e.text&&(r.innerText=e.text),e.backgroundColor&&(r.style.backgroundColor=e.backgroundColor),e.color&&(r.style.color=e.color),e.props.font&&(r.style.font=e.props.font),e.props.textAlign&&(r.style.textAlign=e.props.textAlign),e.__host.revision=e.__revision;let l=n.join(" ");r.className=l,r.part=l}e instanceof qs&&(this.options.box||e.props.className||e.props.html)&&(e.props.backgroundColor&&(r.style.backgroundColor=e.props.backgroundColor),e.props.border!==r.style.border&&(r.style.border=e.props.border));let o=n.join(" ");r.className=o,r.part=o}}afterFrame(e,t,i){this.stylesheet.updateSheet();for(let r of this.previousVisible)this.visible.indexOf(r)===-1&&this.htmlContainer&&r.__id&&this.htmlIds.indexOf(r.__id)!==-1&&this.htmlContainer.removeChild(r.__host.element);this.previousVisible=this.visible}afterPaintLayer(e,t){}beforeFrame(e,t,i){this.stylesheet.clearClasses(),this.paintTx++,this.zIndex=0,this.visible=[]}getPointsAt(e,t,i,r){return e.getPointsAt(t,i,r)}getScale(e,t){let i=this.rendererPosition.width/e,r=this.rendererPosition.height/t;return i<r?r:i}getViewportBounds(e,t,i){return null}isReady(){return!1}paint(e,t,i,r,n,o){if(this.zIndex++,(this.options.text&&e instanceof Uo||e instanceof qs&&(this.options.box||e.props.className||e.props.html))&&e.__host.tx!==this.paintTx&&(this.visible.push(e),e.__host.tx=this.paintTx,this.htmlContainer)){this.updateHtmlHost(e,n,o);let l=n/e.width,u=e.__host.element;u.style.zIndex=`${this.zIndex}`,e.props.relativeStyle?u.style.transform=`translate(${Math.round(i)}px, ${Math.round(r)}px)`:u.style.transform=`translate(${Math.round(i)}px, ${Math.round(r)}px) scale(${l})`,this.previousVisible.indexOf(e)===-1&&this.htmlContainer.appendChild(u),this.htmlIds.indexOf(e.__id)===-1&&this.htmlIds.push(e.__id)}}pendingUpdate(){return!1}prepareLayer(e){e.__host||(e instanceof Uo||e instanceof qs)&&this.createHtmlHost(e)}resize(e,t){typeof e<"u"&&typeof t<"u"&&(this.htmlContainer.style.width=`${e}px`,this.htmlContainer.style.height=`${t}px`),this.rendererPosition=this.htmlContainer.getBoundingClientRect()}getRendererScreenPosition(){return this.rendererPosition}finishLayer(){}reset(){}},Bv=class Yu{constructor(t,i,r){M(this,"element"),M(this,"runtime"),M(this,"unsubscribe"),M(this,"activatedEvents",[]),M(this,"eventHandlers",[]),M(this,"bounds"),M(this,"listening"),M(this,"pointerMoveEvent"),M(this,"pointerEventState",{isClicking:!1,isDragging:!1,isPressed:!1,mousedOver:[],itemsBeingDragged:[],mouseDownStart:{x:0,y:0},lastTouches:[]}),M(this,"options"),M(this,"_realPointerMove",o=>{this.pointerMoveEvent=o}),M(this,"onWheelEvent",o=>{o.preventDefault(),this.onPointerEvent(o)}),M(this,"onTouchEvent",o=>{let l=Hs[o.type],u=[],c=o.touches.length;for(let p=0;p<c;p++){let f=o.touches.item(p);if(!f)continue;let{x:v,y:x}=this.runtime.viewerToWorld(f.clientX-this.bounds.left,f.clientY-this.bounds.top),E={id:f.identifier,x:v,y:x};u.push(E)}u.length&&this.assignToEvent(o,u[0].x,u[0].y),l!=="onTouchEnd"?(this.pointerEventState.lastTouches=u,o.atlasTouches=u,this.runtime.world.propagateTouchEvent(l,o,u)):(o.atlasTouches=[],this.runtime.world.propagateTouchEvent(l,o,this.pointerEventState.lastTouches),this.pointerEventState.lastTouches=[])}),M(this,"onPointerEvent",o=>{let l=Hs[o.type];if(l&&this.runtime.world.activatedEvents.indexOf(l)!==-1){let{x:u,y:c}=this.runtime.viewerToWorld(o.clientX-this.bounds.left,o.clientY-this.bounds.top);this.assignToEvent(o,u,c),this.runtime.world.propagatePointerEvent(l,o,u,c)}}),M(this,"onPointerDown",o=>{this.pointerEventState.isPressed=!0,this.pointerEventState.isClicking=!0,this.pointerEventState.mouseDownStart.x=o.clientX,this.pointerEventState.mouseDownStart.y=o.clientY,setTimeout(()=>{this.runtime&&(this.pointerEventState.isClicking=!1)},250),setTimeout(()=>{if(this.runtime&&this.pointerEventState.isPressed&&!this.pointerEventState.isDragging){let l=this.runtime.viewerToWorld(this.pointerEventState.mouseDownStart.x-this.bounds.left,this.pointerEventState.mouseDownStart.y-this.bounds.top);this.pointerEventState.isDragging=!0,this.pointerEventState.itemsBeingDragged=this.runtime.world.propagatePointerEvent("onDragStart",o,l.x,l.y)}},800),this.onPointerEvent(o)}),M(this,"onPointerUp",o=>{if(this.pointerEventState.isClicking){let{x:l,y:u}=this.runtime.viewerToWorld(o.clientX-this.bounds.left,o.clientY-this.bounds.top);this.assignToEvent(o,l,u),this.runtime.world.propagatePointerEvent("onClick",o,l,u)}if(this.pointerEventState.isDragging){for(let l of this.pointerEventState.itemsBeingDragged)l.dispatchEvent("onDragEnd",o);this.pointerEventState.isDragging=!1}this.pointerEventState.isClicking=!1,this.pointerEventState.isPressed=!1,this.pointerEventState.itemsBeingDragged=[],this.onPointerEvent(o)}),M(this,"onPointerMove",o=>{this.pointerMoveEvent=void 0;let{x:l,y:u}=this.runtime.viewerToWorld(o.clientX-this.bounds.left,o.clientY-this.bounds.top);if(Number.isNaN(l)||Number.isNaN(u))return;this.assignToEvent(o,l,u),this.runtime.world.propagatePointerEvent("onPointerMove",o,l,u);let c=this.runtime.world.propagatePointerEvent("onMouseMove",o,l,u),p=[],f=[];for(let v of c)p.push(v.id),f.push(v),this.pointerEventState.mousedOver.indexOf(v)===-1&&(v.dispatchEvent("onMouseEnter",o),v.dispatchEvent("onPointerEnter",o),v.dispatchEvent("onMouseOver",o),v.dispatchEvent("onPointerOver",o));for(let v of this.pointerEventState.mousedOver)p.indexOf(v.id)===-1&&(v.dispatchEvent("onMouseLeave",o),v.dispatchEvent("onPointerLeave",o),v.dispatchEvent("onMouseOut",o),v.dispatchEvent("onPointerOut",o));if(this.pointerEventState.isDragging)for(let v of this.pointerEventState.itemsBeingDragged)v.dispatchEvent("onDrag",o);if(this.pointerEventState.isPressed&&!this.pointerEventState.isDragging&&Il(this.pointerEventState.mouseDownStart,{x:o.clientX,y:o.clientY})>50){let v=this.runtime.viewerToWorld(this.pointerEventState.mouseDownStart.x-this.bounds.left,this.pointerEventState.mouseDownStart.y-this.bounds.top);this.pointerEventState.isDragging=!0,this.pointerEventState.itemsBeingDragged=this.runtime.world.propagatePointerEvent("onDragStart",D(C({},o),{atlas:{x:v.x,y:v.y}}),v.x,v.y)}this.pointerEventState.mousedOver=f}),this.element=t,this.runtime=i,this.unsubscribe=i.world.addLayoutSubscriber(this.layoutSubscriber.bind(this)),this.bounds=t.getBoundingClientRect(),this.listening=!1,this.options=C({simulationRate:0},r||{});let n=0;i.registerHook("useFrame",o=>{n+=o,n>this.options.simulationRate&&this.pointerMoveEvent&&(n=0,i.updateNextFrame())}),i.registerHook("useBeforeFrame",()=>{this.pointerMoveEvent&&this.onPointerMove(this.pointerMoveEvent)}),this.activateEvents()}updateBounds(){this.bounds=this.element.getBoundingClientRect(),this.runtime.updateRendererScreenPosition()}layoutSubscriber(t){t==="event-activation"&&this.listening==!1&&this.activateEvents()}assignToEvent(t,i,r){Yu.eventPool.atlas.x=i,Yu.eventPool.atlas.y=r,t.atlas=Yu.eventPool.atlas}activateEvents(){this.listening=!0,this.element.addEventListener("pointermove",this._realPointerMove),this.element.addEventListener("pointerup",this.onPointerUp),this.element.addEventListener("pointerdown",this.onPointerDown),this.element.addEventListener("mousedown",this.onPointerEvent),this.element.addEventListener("mouseup",this.onPointerEvent),this.element.addEventListener("pointercancel",this.onPointerEvent),this.element.addEventListener("wheel",this.onWheelEvent),this.element.addEventListener("touchstart",this.onTouchEvent),this.element.addEventListener("touchcancel",this.onTouchEvent),this.element.addEventListener("touchend",this.onTouchEvent),this.element.addEventListener("touchmove",this.onTouchEvent)}normalizeEventName(t){return t.startsWith("on")?t.slice(2).toLowerCase():t.toLowerCase()}stop(){this.listening=!1,this.element.removeEventListener("pointermove",this._realPointerMove),this.element.removeEventListener("pointerup",this.onPointerUp),this.element.removeEventListener("pointerdown",this.onPointerDown),this.element.removeEventListener("mousedown",this.onPointerEvent),this.element.removeEventListener("mouseup",this.onPointerEvent),this.element.removeEventListener("pointercancel",this.onPointerEvent),this.element.removeEventListener("wheel",this.onWheelEvent),this.element.removeEventListener("touchstart",this.onTouchEvent),this.element.removeEventListener("touchcancel",this.onTouchEvent),this.element.removeEventListener("touchend",this.onTouchEvent),this.element.removeEventListener("touchmove",this.onTouchEvent),this.unsubscribe();for(let[t,i]of this.eventHandlers)this.element.removeEventListener(this.normalizeEventName(t),i)}};M(Bv,"eventPool",{atlas:{x:0,y:0}});var jv=Bv;function Uv({interactive:e=!0,viewport:t,forceRefresh:i,canvasElement:r,overlayElement:n,controllerConfig:o,unstable_webglRenderer:l,dpi:u,debug:c,canvasBox:p=!0,polygon:f=!0,navigatorElement:v,runtimeOptions:x}){if(!r)throw new Error("Invalid container");r.style.userSelect="none";let E=e?Tv(C({minZoomFactor:.5,maxZoomFactor:3,enableClickToZoom:!1,parentElement:r},o||{})):void 0,_=new kv([l?new HC(r,{dpi:u}):new RC(r,{dpi:u,debug:c,box:p,polygon:f}),n?new Fv(n,{box:l||!p,text:!0,triggerResize:i}):void 0,v?new MC(v):void 0]),P=new Bl(_,new is(1024,1024),t,E?[E]:[],x),O=new jv(r,P);return{name:"default-preset",em:O,runtime:P,renderer:_,controller:E,canvas:r,navigator:v,unmount(){Mc(P),P.stopControllers(),P.stop(),P.reset(),O&&O.stop()}}}var yn=1+Number.MIN_VALUE,qC=class{constructor(e,t){M(this,"container"),M(this,"width"),M(this,"height"),M(this,"pending",!0),M(this,"options"),M(this,"stylesheet"),M(this,"zIndex",0),M(this,"lastKnownScale",1),M(this,"rendererPosition"),M(this,"currentlyVisible",[]),M(this,"previouslyVisible",[]),this.container=e,this.rendererPosition=e.getBoundingClientRect();let{width:i,height:r}=this.rendererPosition;this.width=i,this.height=r,this.options=C({addPart:!1,setDraggableFalse:!1,imageClass:"",widthStylesheet:!1,sheetPrefix:"position-",background:"#000"},t||{}),this.stylesheet=new zv({sheetPrefix:this.options.sheetPrefix}),this.container.classList.add(this.stylesheet.addStylesheet(`
        background: ${this.options.background};
      `)),this.options.widthStylesheet&&this.container.appendChild(this.stylesheet.getElement())}isReady(){return!0}resize(){this.rendererPosition=this.container.getBoundingClientRect(),this.width=this.rendererPosition.width,this.height=this.rendererPosition.height}getRendererScreenPosition(){return this.rendererPosition}afterFrame(e,t,i){this.stylesheet.updateSheet();for(let r of this.previouslyVisible)this.currentlyVisible.indexOf(r)===-1&&this.container.removeChild(r);for(let r of this.currentlyVisible)this.previouslyVisible.indexOf(r)===-1&&this.container.appendChild(r);this.previouslyVisible=this.currentlyVisible,this.currentlyVisible=[]}afterPaintLayer(e,t){}beforeFrame(e,t,i){this.stylesheet.clearClasses(),this.zIndex=0}getPointsAt(e,t,i,r){return e.getPointsAt(t,i,r)}getScale(e,t){if(Number.isNaN(e)||Number.isNaN(t))return this.lastKnownScale;let i=this.width/e,r=this.height/t,n=i<r?r:i;return Number.isNaN(n)||(this.lastKnownScale=n),this.lastKnownScale}getViewportBounds(e,t,i){return null}createImage(){let e=document.createElement("img");return this.options.imageClass?(e.className=this.options.imageClass,this.options.addPart&&e.setAttribute("part",this.options.imageClass)):(e.style.position="absolute",e.style.pointerEvents="none",e.style.userSelect="none"),this.options.setDraggableFalse&&e.setAttribute("draggable","false"),e}paint(e,t,i,r,n,o){if(this.pending=!1,this.zIndex++,e instanceof Gr){if(!e.__host){let u=this.createImage();u.src=e.uri,e.__host=u,this.container.appendChild(e.__host)}let l=e.__host;this.currentlyVisible.push(l),l.style.zIndex=`${this.zIndex}`,l.style.opacity=`${e.style.opacity}`,this.options.widthStylesheet?l.className=this.options.imageClass+" "+this.stylesheet.addStylesheet(`width:${(n+yn).toFixed(2)}px;height:${(o+yn).toFixed(2)}px;`):(l.style.width=`${n+yn}px`,l.style.height=`${o+yn}px`),l.style.transform=`translate(${i}px, ${r}px)`}if(e instanceof ts){if(e.__host||(e.__host={images:[]}),!e.__host.images[t]){let u=e.getImageUrl(t),c=this.createImage();c.src=u,e.__host.images[t]=c,this.container.appendChild(c)}let l=e.__host.images[t];l.style.zIndex=`${this.zIndex}`,l.style.opacity=`${e.style.opacity}`,this.currentlyVisible.push(l),this.options.widthStylesheet?l.className=this.options.imageClass+" "+this.stylesheet.addStylesheet(`width:${(n+yn).toFixed(2)}px;height:${(o+yn).toFixed(2)}px;`):(l.style.width=`${n+yn}px`,l.style.height=`${o+yn}px`),l.style.transform=`translate(${i}px, ${r}px)`}}pendingUpdate(){return this.pending}prepareLayer(e){}finishLayer(e){}reset(){}};function QC({interactive:e,viewport:t,forceRefresh:i,containerElement:r,overlayElement:n,controllerConfig:o}){if(!r)throw new Error("Invalid container");r.style.userSelect="none";let l=e?Tv(C({minZoomFactor:.5,maxZoomFactor:3,enableClickToZoom:!1,parentElement:r},o||{})):void 0,u=new qC(r,{addPart:!1,setDraggableFalse:!1,imageClass:"atlas-static-image"}),c=n?new kv([u,new Fv(n,{box:!0,text:!0,triggerResize:i})]):u,p=new Bl(c,new is(1024,1024),t,l?[l]:[]),f=new jv(r,p);return{name:"static-preset",em:f,runtime:p,renderer:c,controller:l,container:r,overlay:n,unmount(){Mc(p),p.stopControllers(),p.stop(),f&&f.stop()}}}var VC={"default-preset":Uv,"static-preset":QC},GC={};function ZC(e,t){let i=we(),r=we(),n=we(),o=we(),l=we({width:t.width,height:t.height,didUpdate:!0}),[u="default-preset",c=GC]=Array.isArray(e)?e||[]:[e],[p,f]=Be(null);At(()=>{let x=r.current,E=o.current,_=i.current,P=n.current,O=(VC[u]||Uv)(C({containerElement:E,canvasElement:x,overlayElement:_,navigatorElement:P,viewport:l.current,dpi:window.devicePixelRatio||1,forceRefresh:t.forceRefresh,unstable_webglRenderer:t.unstable_webglRenderer},c||{}));return f(O),()=>{O&&(O.unmount(),x&&(x.height=0,x.width=0),_&&(_.innerHTML=""),P&&(P.height=0,P.width=0))}},[u,c]);let v=Ae(()=>({canvas:r,overlay:i,container:o,navigator:n}),[]);return[u,p,l,v]}function XC(e){return Ae(()=>Lc(e),e)}var Qo=te.forwardRef((e,t)=>Ge("div",D(C({},e),{ref:t,part:e.className}))),Dv=["brightness","contrast","grayscale","hueRotate","invert","saturate","sepia","blur"],YC=e=>{var t=e,{htmlChildren:i,renderPreset:r,onCreated:n,mode:o="explore",resetWorldOnChange:l=!0,unstable_webglRenderer:u=!1,unstable_noReconciler:c=!1,hideInlineStyle:p=!1,controllerConfig:f,children:v,overlayStyle:x,containerStyle:E,enableNavigator:_,className:P,containerProps:O={},homePosition:I,homeOnResize:A,homeCover:$,background:z,runtimeOptions:B,debug:H,filters:Y}=t,V=le(t,["htmlChildren","renderPreset","onCreated","mode","resetWorldOnChange","unstable_webglRenderer","unstable_noReconciler","hideInlineStyle","controllerConfig","children","overlayStyle","containerStyle","enableNavigator","className","containerProps","homePosition","homeOnResize","homeCover","background","runtimeOptions","debug","filters"]);let[he,Q]=Be(o),[ue,pe]=Be(!1),ge=we(!1),oe=Ae(()=>(typeof r=="string"&&(r=[r,{}]),H?r?[r[0],C({debug:H},r[1]||{})]:["default-preset",{debug:H}]:r||"default-preset"),[r,H]),[Se,Pe,Ke]=yv({scroll:!0}),re=we(),Ie=ke=>{re.current=ke,Se(ke)},[Ne,J,Oe,mt]=ZC(oe,{width:V.width,height:V.height,forceRefresh:Ke,unstable_webglRenderer:u}),[rt,ti]=Be("");de(()=>{Q(o)},[o]),de(()=>{J&&J.em&&J.em.updateBounds()},[J,Pe]),de(()=>{J==null||J.runtime.setOptions(B||{})},[B]),de(()=>{J&&J.runtime&&(J.runtime.mode=he),ue&&J&&(J.ready=!0)},[J,ue,he]),de(()=>{J&&($||(J.runtime.manualHomePosition=!!I,J.runtime.setHomePosition(I)))},[J,$,I]),de(()=>{if(J){let ke=J.runtime;ke.resize(Oe.current.width,V.width,Oe.current.height,V.height),Oe.current.width=V.width,Oe.current.height=V.height,ke.updateNextFrame(),Oe.current.didUpdate=!0}},[J,V.width,V.height]),de(()=>{if(Y&&J){let ke=J.runtime,Te=!1;ke.hookOptions.enableFilters=!0;for(let ot of Dv)Y[ot]?Y[ot]!==J.runtime.hookOptions.filters[ot]&&(ke.hookOptions.filters[ot]=Y[ot],Te=!0):ke.hookOptions.filters[ot]&&(ke.hookOptions.filters[ot]=0,Te=!0);Te&&ke.updateNextFrame()}else if(J){let ke=J.runtime;for(let Te of Dv)ke.hookOptions.filters[Te]=0;ke.hookOptions.enableFilters=!1,ke.updateNextFrame()}},[J,Y]),qo(()=>{if(J&&(J.overlay&&(J.overlay.style.width=`${Pe.width}px`,J.overlay.style.height=`${Pe.height}px`),J.container&&(J.container.style.width=`${Pe.width}px`,J.container.style.height=`${Pe.height}px`),$)){let ke=J.runtime.world.width,Te=J.runtime.world.height,ot=ke/Te,ii=Oe.current.width,Xe=Oe.current.height,Ye=ii/Xe;if(ot>Ye){Ye=Xe/ii,J.runtime.manualHomePosition=!0;let ht=(ke-Te/Ye)/2;$==="start"&&(ht=0),$==="end"&&(ht=ke-Te/Ye),J.runtime.setHomePosition({x:ht,y:0,width:Te/Ye,height:Te})}else{let ht=(Te-ke/Ye)/2;$==="start"&&(ht=0),$==="end"&&(ht=Te-ke/Ye),J.runtime.manualHomePosition=!0,J.runtime.setHomePosition({x:0,y:ht,width:ke,height:ke/Ye})}A&&J.runtime.goHome({})}},[J,Pe.height,Pe.width,$]),qo(()=>{let ke=()=>{if(J){let Te=J.runtime;Oe.current.width!==V.width&&Oe.current.height!==V.height&&(Te.resize(Oe.current.width,V.width,Oe.current.height,V.height),Oe.current.width=V.width,Oe.current.height=V.height,Te.updateNextFrame(),Oe.current.didUpdate=!0)}};return window.addEventListener("resize",ke),()=>window.removeEventListener("resize",ke)},[J,V.height,V.width]);let kt={width:120},li=()=>{if(J&&J.navigator){let ke=J.runtime.world.height,Te=J.runtime.world.width,ot=window.devicePixelRatio||1,ii=kt.width,Xe=kt.width/Te*ke;J.navigator.width=ii*ot,J.navigator.height=Xe*ot,J.navigator.style.width=ii+"px",J.navigator.style.height=Xe+"px"}};qo(()=>{if(J){li();let ke=J.runtime;return ke.world.addLayoutSubscriber(Te=>{Te==="recalculate-world-size"&&(li(),ke.resize(Oe.current.width,V.width,Oe.current.height,V.height))})}return()=>{}},[J,V.width,V.height]);let Tt=He(function(ke){let Te=()=>{pe(!0)};return de(()=>{if(J){J.runtime.goHome();let ot=n&&n(J);return void(ot&&ot.then?ot.then(Te):Te())}else throw new Error("Invalid configuration - no runtime found")},[]),ke.children},[J]);de(()=>{if(J){let ke=J.runtime;if(l)return ke.world.addLayoutSubscriber(Te=>{Te==="recalculate-world-size"&&ke.goHome()})}return()=>{}},[J,l]),de(()=>J?J.runtime.registerHook("useBeforeFrame",()=>{var ke;if(Oe.current.didUpdate&&J.canvas){let Te=window.devicePixelRatio||1,ot=Oe.current.width,ii=Oe.current.height;J.canvas.width=ot*Te,J.canvas.height=ii*Te,J.canvas.style.width=ot+"px",J.canvas.style.height=ii+"px",(ke=J.canvas.getContext("2d"))==null||ke.scale(Te,Te),J&&J.em&&J.em.updateBounds(),Oe.current.didUpdate=!1}}):()=>{},[J,l]),de(()=>{let ke=()=>{J&&(Q("sketch"),ti("mode-sketch")),window.removeEventListener("keyup",ke)},Te=ot=>{if(ot.code==="Space"&&J&&J.runtime.mode==="sketch"){if(ot.target&&ot.target.tagName&&ot.target.tagName.toLowerCase()==="input")return;ot.preventDefault(),Q("explore"),ti("mode-explore"),window.addEventListener("keyup",ke)}};return window.addEventListener("keydown",Te),()=>{window.removeEventListener("keydown",Te),window.removeEventListener("keyup",ke)}},[J]),ge.current=!0;let Mt=V,ui=le(Mt,["height","width"]),Zt=XC([V.width,V.height]),wt=!0;return oe&&Array.isArray(oe)&&oe.length>1&&oe[1].interactive===!1&&(wt=!1),z=z??"#000",re.current&&(z=getComputedStyle(re.current).getPropertyValue("--atlas-background")||z),Ge(Qo,{ref:Ie,className:["atlas",p?"":`atlas-width-${Zt}`,rt,P,`atlas-${Ne}`].filter(Boolean).join(" ").trim(),style:C(C({},E),p?{}:{width:V.width,height:V.height}),children:[Ne==="static-preset"?Ge(Qo,C({className:"atlas-static-container",ref:mt.container,tabIndex:0},O)):Ge("canvas",D(C(C({className:"atlas-canvas",part:"atlas-canvas",tabIndex:0},ui),O),{ref:mt.canvas,"data-background":z})),Ge(Qo,{className:["atlas-overlay",wt?"atlas-overlay--interactive":""].filter(Boolean).join(" ").trim(),style:C({},x||{}),ref:mt.overlay,children:c?Ge(Tt,{children:Ge(ql.Provider,{value:Pe,children:Ge(Wl.Provider,{value:he,children:Ge(Hl.Provider,{value:J,children:v})})})}):Ge(WC,{bounds:Pe,preset:J,mode:he,setIsReady:pe,onCreated:n,children:v})}),_?Ge(Qo,{className:"atlas-navigator",children:Ge("canvas",{className:"atlas-navigator-canvas",part:"atlas-navigator-canvas",ref:mt.navigator})}):null,p?Ge("style",{children:`.atlas-width-${Zt} { width: ${V.width}px; height: ${V.height}px; }`}):Ge("style",{children:`
        .atlas { position: relative; display: flex; background: ${z}; z-index: var(--atlas-z-index, 10); -webkit-touch-callout: none; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; }
        .atlas-width-${Zt} { width: ${V.width}px; height: ${V.height}px; }
        .atlas-canvas { flex: 1 1 0px; }
        .atlas-canvas:focus, .atlas-static-container:focus { outline: none }
        .atlas-canvas:focus-visible, .atlas-canvas-container:focus-visible { outline: var(--atlas-focus, 2px solid darkorange) }
        .atlas-static-preset { touch-action: inherit; }
        .atlas-static-container { position: relative; overflow: hidden; flex: 1 1 0px; }
        .atlas-overlay { position: absolute; top: 0; left: 0; none; overflow: hidden; }
        /** setting the pointer events to none means that Atlas will own the touch and mousewheel events **/
        .atlas-overlay--interactive { pointer-events: none; }
        .atlas-static-image { position: absolute; user-select: none; transform-origin: 0px 0px; }
        .atlas-navigator { position: absolute; top: var(--atlas-navigator-top, 10px); right: var(--atlas-navigator-bottom, 10px); left: var(--atlas-navigator-left); bottom: var(--atlas-navigator-bottom); opacity: .8 }
        .atlas-navigator-canvas { width: 100%; }
      `}),i]})};function KC(e){return Number(e)==e?`${e}px`:e}var JC=e=>{var t=e,{resizeHash:i,aspectRatio:r,containerProps:n={}}=t,o=le(t,["resizeHash","aspectRatio","containerProps"]);let[l,u,c]=yv(),p=o,{height:f,width:v}=p,x=le(p,["height","width"]);de(()=>{c()},[v,f,i,c]);let E=Ae(()=>r?{width:u.width,height:u.width*(1/r)}:u,[u,r]);return Ge(Qo,D(C({ref:l,className:"atlas-container"},n),{children:[E.width?Ge(YC,D(C({width:E.width||100,height:E.height||100},x),{children:o.children})):null,o.hideInlineStyle?null:Ge("style",{children:`
          .atlas-container { 
            display: var(--atlas-container-display, block);
            flex: var(--atlas-container-flex, none);
            width: var(--atlas-container-width, ${v?`${v}px`:"100%"});
            height: var(--atlas-container-height, ${KC(f||(r?E.height:512))})  
          }
      `}),o.htmlChildren]}))},Gl=()=>Kt(Hl),vn=()=>{let e=Gl();return e?e.runtime:void 0},$c=(e,t=[])=>{let i=vn();de(()=>i?i.registerHook("useAfterFrame",e):()=>{},t)},Nc=(e,t=[])=>{let i=vn();de(()=>i?i.registerHook("useFrame",e):()=>{},t)},eT=()=>{let e=Gl();return e&&e.canvas?e.canvas:void 0};function Wv(){return Kt(ql)}var Hv=({onCreate:e})=>{let t=we({x:0,y:0}),i=eT(),r=Wv(),n=vn(),[o,l]=Be(),[u,c]=Be(),p=Ic();return Nc(()=>{n&&o&&!u&&(n.pendingUpdate=!0)},[o,u]),$c(()=>{if(o&&i&&n){let f=i.getContext("2d");if(f){let{x:v,y:x,width:E,height:_}=n.worldToViewer(o.x,o.y,(u?u.x:t.current.x)-o.x,(u?u.y:t.current.y)-o.y);f.lineWidth=u?3:1,f.strokeStyle="#fff",f.strokeRect(v,x,E,_),f.lineWidth=u?3:1,f.strokeStyle="#000",f.strokeRect(v+1,x+1,E-2,_-2)}}},[o,u]),de(()=>{let f=v=>{if(r&&n){let{x,y:E}=n.viewerToWorld(v.clientX-r.left,v.clientY-r.top);t.current.x=~~x,t.current.y=~~E}};return i?(i.addEventListener("mousemove",f),()=>i.removeEventListener("mousemove",f)):()=>{}},[r,i,n]),de(()=>{let f=v=>{p==="sketch"&&(l({x:Math.round(t.current.x),y:Math.round(t.current.y)}),c(void 0))};return i?(i.addEventListener("mousedown",f),()=>i.removeEventListener("mousedown",f)):()=>{}},[i,p]),de(()=>{let f=v=>{o&&!u&&c({x:Math.round(t.current.x),y:Math.round(t.current.y)})};return i?(i.addEventListener("mouseup",f),()=>i.removeEventListener("mouseup",f)):()=>{}},[i,o,u]),de(()=>{o&&u&&e({x:Math.min(o.x,u.x),y:Math.min(o.y,u.y),width:Math.abs(u.x-o.x),height:Math.abs(u.y-o.y)})},[o,e,u]),null};async function tT(e,t,i){if(Ts.startsWith("18.")){let r=await Promise.resolve().then(()=>je(Rh(),1)),n=r.default?r.default.createRoot:r.createRoot;i.current||(i.current=n(e)),i.current.render(t)}else if(typeof ReactDOM<"u"){let{render:r,unmountComponentAtNode:n}=ReactDOM;r(t,e),i.current={unmount(){n(e)}}}else{let r=await Promise.resolve().then(()=>(fe(),Mn)),n=r.default?r.default.render:r.render,o=r.default?r.default.unmountComponentAtNode:r.unmountComponentAtNode;n(t,e),i.current={unmount(){o(e)}}}}var iT=te.forwardRef((e,t)=>{var i=e,{children:r}=i,n=le(i,["children"]);let o=we(),l=vn(),u=we(0),c=we(),p=we();return Nc(()=>{var f,v,x,E;if(n.relative){let _=o.current;if(_&&l){let P=l.getScaleFactor();u.current!==P&&(u.current=P,_.style.transformOrigin="0 0",_.style.transform=`scale(${1/u.current})`,_.style.width=`${u.current*100}%`,_.style.height=`${u.current*100}%`,o.current&&((v=(f=c.current)==null?void 0:f.__owner.value)!=null&&v.rotation)&&(_.style.transform=`scale(${1/u.current}) translate(50%, 50%) rotate(${((E=(x=c.current)==null?void 0:x.__owner.value)==null?void 0:E.rotation)||0}deg)  translate(-50%, -50%)`))}}},[n.relative]),At(()=>{let f=c.current;t&&f&&(typeof t=="function"?t(f):t.current=f);async function v(){if(f&&f.__host){let x=n.relative?Ge("div",{ref:o,children:r}):r;await tT(f.__host.element,x,p)}}f&&f.__host?v():f&&(f.__onCreate=v)},[t,r,c,n.relative]),At(()=>()=>{p.current&&setTimeout(()=>{p.current.unmount()},0)},[]),Ge("box",D(C({html:!0},n),{ref:c}))});iT.displayName="HTMLPortal";var qv=(e,t,i=[])=>{let r=vn(),n=r?r.world:void 0;de(()=>{if(r){let o=t,l=Hs[e];r.world.activatedEvents.push(l);let u=l.slice(2).toLowerCase();return r.world.addEventListener(u,o),()=>{r.world.removeEventListener(u,o)}}return()=>{}},[n,e,...i])};function Qv(e,t){if(e===0)return[0,1];if(t===0)return[1,0];let i=Math.abs(e)/Math.abs(t);return[i,1-i]}function rT(){let e=we({ctrl:!1,shift:!1,alt:!1});return At(()=>{function t(r){r.key==="Shift"&&(e.current.shift=!0),r.key==="Control"&&(e.current.ctrl=!0),r.key==="Alt"&&(e.current.alt=!0)}function i(r){r.key==="Shift"&&(e.current.shift=!1),r.key==="Control"&&(e.current.ctrl=!1),r.key==="Alt"&&(e.current.alt=!1)}return window.addEventListener("keydown",t),window.addEventListener("keyup",i),()=>{window.removeEventListener("keydown",t),window.removeEventListener("keyup",i)}},[]),e}var nT=(e,t)=>{let i=Ic(),r=vn(),n=Wv(),o=we(),l=we(null),u=we(),[c,p]=Be(!1),f=we(!1),v=we({north:0,south:0,east:0,west:0}),x=rT(),E=He(A=>$=>{if(f.current=!0,p(!0),n&&r){let{top:z,left:B}=n,H=r.viewerToWorld($.pageX-B,$.pageY-z);u.current={x:H.x,y:H.y},o.current=A}},[n,r]),_=Ae(()=>e.width/e.height,[e.width,e.height]),P=He(A=>{if(!Math.abs(A.north-A.south+(A.east-A.west)))return;let $=-A.west+A.east,z=-A.north+A.south,B=e.width+$,H=e.height+z;if(B/H>=_){let Y=H*_,V=B-Y,[he,Q]=Qv(A.east,A.west);A.west=A.west+V*Q,A.east=A.east-V*he}else{let Y=B/_,V=H-Y,[he,Q]=Qv(A.north,A.south);A.north=A.north+V*he,A.south=A.south-V*Q}},[e.width,e.height,_]);Nc(()=>{u&&r&&r.updateNextFrame()}),de(()=>{r&&r.updateNextFrame()},[r,c]);let O=He(A=>{var $;if(!r||!n||r.mode!=="sketch")return;let{top:z,left:B}=n,H=r.viewerToWorld(A.pageX-B,A.pageY-z),Y=l.current,V=!e.maintainAspectRatio&&x.current.alt,he=!V&&x.current.shift&&(($=o.current)==null?void 0:$.indexOf("-"))!==-1;if((o.current==="translate"||o.current==="east"||o.current==="north-east"||o.current==="south-east")&&(v.current.east=H.x-(u.current?u.current.x:0),V&&(v.current.west=-v.current.east)),(o.current==="translate"||o.current==="west"||o.current==="north-west"||o.current==="south-west")&&(v.current.west=H.x-(u.current?u.current.x:0),V&&(v.current.east=-v.current.west)),(o.current==="translate"||o.current==="north"||o.current==="north-east"||o.current==="north-west")&&(v.current.north=H.y-(u.current?u.current.y:0),V&&(v.current.south=-v.current.north)),(o.current==="translate"||o.current==="south"||o.current==="south-west"||o.current==="south-east")&&(v.current.south=H.y-(u.current?u.current.y:0),V&&(v.current.north=-v.current.south)),(e.maintainAspectRatio||he)&&P(v.current),Y){let Q=v.current.west,ue=v.current.north,pe=e.width+v.current.east,ge=e.height+v.current.south;Y.points[1]=Math.min(Q,pe),Y.points[2]=Math.min(ue,ge),Y.points[3]=Math.max(Q,pe),Y.points[4]=Math.max(ue,ge),r.updateNextFrame()}},[r,e.width,e.height,e.maintainAspectRatio,n]);qv("mousemove",O,[e.width,e.height,n]),qv("pointermove",O,[e.width,e.height,n]);let I=we();return de(()=>{I.current=()=>{if(f.current){let A=v.current.west,$=v.current.north,z=e.width+v.current.east,B=e.height+v.current.south,H=Math.min(A,z),Y=Math.min($,B),V=Math.max(A,z),he=Math.max($,B),Q={x:(e.x||0)+H,y:(e.y||0)+Y,width:V-H||1,height:he-Y||1};e.maintainAspectRatio,t(Q),o.current=void 0,u.current=void 0,v.current.east=0,v.current.west=0,v.current.north=0,v.current.south=0,f.current=!1,p(!1)}}},[t,e.height,e.width,e.x,e.y]),de(()=>{let A=()=>{I.current&&I.current()};return window.addEventListener("pointerup",A),window.addEventListener("touchend",A),()=>{window.removeEventListener("pointerup",A),window.removeEventListener("touchend",A)}},[]),{portalRef:l,mode:i,mouseEvent:E,onPointerMoveCallback:O,isEditing:c}};function Vv(e,t){return e?t?D(C(C({},e),t||{}),{":hover":e[":hover"]?Object.assign(e[":hover"]||{},t[":hover"]||{}):t[":hover"],":active":e[":active"]?Object.assign(e[":active"]||{},t[":active"]||{}):t[":hover"]}):e:t}fe();function We(e,{parse:t,defaultValue:i}={}){let r=we(),[n,o]=Be(()=>t?t(e):e),l=He(u=>{let c=t?t(u):u;typeof i<"u"&&typeof c>"u"&&(c=i),(r.current||n)!==c&&(o(c),r.current=c)},[]);return At(()=>{l(e)},[e]),[n,l,o,r]}function sT({max:e,percentScale:t,upscaled:i,confined:r,width:n,height:o}){let l=[];return i&&l.push("^"),e?(l.push("max"),l.join("")):(r&&l.push("!"),t&&l.push(`pct:${t}`),n&&l.push(`${n}`),l.push(","),o&&l.push(`${o}`),l.join(""))}function oT(e){let t={upscaled:!1,max:!1,confined:!1};if(e[0]==="^"&&(t.upscaled=!0,e=e.slice(1)),(e==="max"||e==="full")&&(t.max=!0),e[0]==="!"&&(t.confined=!0,e=e.slice(1)),e[0]==="p")return t.percentScale=parseFloat(e.slice(4)),t;let i=e.split(",").map(r=>r.trim());return i[0]!==""&&(t.width=parseInt(i[0],10)),i[1]!==""&&(t.height=parseInt(i[1],10)),t}function Zl(e){return e==null||e<0?0:e}function Xl(e){return aT(typeof e=="string"?e:JSON.stringify(e))}function Yl(e,t){if(e=e.trim(),e[0]==="{")return t?Promise.resolve(JSON.parse(e)):JSON.parse(e);if(e.startsWith("http")){if(!t)throw new Error("Cannot fetch remote fetch with async=false in parseContentState");return fetch(e).then(i=>i.json())}return Yl(lT(e),t)}function aT(e){let t=encodeURIComponent(e);return(typeof btoa>"u"?Buffer.from(t,"utf-8").toString("base64"):btoa(t)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function lT(e){let t=uT(e).replace(/-/g,"+").replace(/_/g,"/"),i=typeof atob>"u"?Buffer.from(t,"base64").toString("utf-8"):atob(t);return decodeURIComponent(i).trim()}function uT(e){let t=e.length%4;if(t===1)throw new Error("InvalidLengthError: Input base64url string is the wrong length to determine padding");return e+(t?"====".slice(0,4-t):"")}function Qs(e){if(!e)throw new Error("Content state is empty");Array.isArray(e)||(e=[e]);let t="vault://virtual-annotation/"+new Date().getTime(),i=["contentState"],r=[];for(let n of e){if(typeof n=="string")throw new Error("Content state is a [String] type and cannot be inferred");if(n.type==="Annotation"){if(t=n.id,Array.isArray(n.motivation))for(let l of n.motivation)i.indexOf(l)===-1&&i.push(l);if(Array.isArray(n.target))for(let l of n.target){let u=qr(l);r.push(u)}else{let l=qr(n.target);r.push(l)}continue}let o=qr(n);r.push(o)}return{id:t,type:"Annotation",motivation:["contentState",...e.motivation||[]],target:r,extensions:{}}}function hT(e){if(!e)return[];typeof e=="string"&&(e=e.split("|")),Array.isArray(e)||(e=[e]);let t=[];for(let i of e)typeof i=="string"&&(i=oT(i)),t.push(i);return t}function zc(e){if(typeof e=="string"){let t=e.match(/^(pct|pixel|percent)?:?([0-9,\s]+)/);if(t)return zc({type:"FragmentSelector",value:`xywh=${t[1]?t[1]==="pixel"?"pixel:":"percent:":""}${t[2]}`})}return e?_l(e):void 0}function Gv(e){return e?Array.isArray(e)?e:e.indexOf(",")!==-1?e.split(",").map(t=>t.trim()):[e]:[]}function cT(e){let t=Gv(e),i=[];for(let r of t){let[n,o]=r.split("#");if(o){let l=o.match(/opacity=([01]?\.[0-9]+)/);if(l){let u=parseFloat(l[1]);if(u<1&&u>=0){i.push({id:n,opacity:u});continue}}}i.push({id:n})}return i}function gt(e,t){return typeof e>"u"?t:typeof e=="string"?e.toLowerCase()==="true":t?typeof e>"u"?t:!1:e}function Tr(e,t){return typeof e>"u"||e===null||e===""?t:(typeof e=="string"&&(e=parseInt(""+e,10)),typeof e<"u"&&!Number.isNaN(e)?e:t)}function Kl(e){if(!e)return null;if(typeof e=="string"&&e.startsWith("http"))return{type:"remote-content-state",id:e};try{return Qs(typeof e=="string"?Yl(e):e)}catch{return null}}var dT=class{constructor(e,t){this._className="",this.onChange=e||(()=>{}),this.className=Array.isArray(t)?t.join(" "):t||""}set className(e){this._className=e}get className(){return this._className}add(e){this.className.split(" ").includes(e.trim())||(this.className+=" "+e.trim())}remove(e){this.className=this.className.split(" ").filter(t=>t&&t!==e).join(" ")}toggle(e,t){let i=this.className.split(" ");t&&!i.includes(e)&&(this.className+=" "+e.trim())}contains(e){return this.className.split(" ").includes(e.trim())}getClassName(){return this.className}};function Fc(e){return{addEventListener(t,i,r,n){if(t)return e.setMetaValue([t.id,"eventManager",i],o=>{let l=o||[];for(let u of l)if(u.callback===r)return l;return[...l,{callback:r,scope:n}]}),r},removeEventListener(t,i,r){!t||e.setMetaValue([t.id,"eventManager",i],n=>(n||[]).filter(o=>o.callback!==r))},getListenersAsProps(t,i){let r=typeof t=="string"?{id:t}:t;if(!r||!r.id)return{};let n=e.getResourceMeta(r.id,"eventManager"),o={};if(n&&r)for(let l of Object.keys(n))o[l]=u=>{let c=e.get(r);for(let{callback:p,scope:f}of n[l]||[])(!f||i&&f.indexOf(i)!==-1)&&p(u,c)};return o}}}function Bc(e){return{applyStyles(t,i,r){let n=typeof t=="string"?t:t.id;return e.setMetaValue([n,"styles",i],r)},getAppliedStyles(t){let i=typeof t=="string"?t:t.id;return e.getResourceMeta(i,"styles")}}}function rs(e){return e.endsWith("info.json")?e:e.endsWith("/")?`${e}info.json`:`${e}/info.json`}var pT="http://library.stanford.edu/iiif/image-api/compliance.html#level0",Zv="http://library.stanford.edu/iiif/image-api/compliance.html#level1",Xv="http://library.stanford.edu/iiif/image-api/compliance.html#level2",fT="http://library.stanford.edu/iiif/image-api/conformance.html#level0",Yv="http://library.stanford.edu/iiif/image-api/conformance.html#level1",Kv="http://library.stanford.edu/iiif/image-api/conformance.html#level2",gT="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",Jv="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",e0="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",mT="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",t0="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",i0="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",yT="http://iiif.io/api/image/1/level0.json",vT="http://iiif.io/api/image/1/profiles/level0.json",r0="http://iiif.io/api/image/1/level1.json",n0="http://iiif.io/api/image/1/profiles/level1.json",s0="http://iiif.io/api/image/1/level2.json",o0="http://iiif.io/api/image/1/profiles/level2.json",bT="http://iiif.io/api/image/2/level0.json",wT="http://iiif.io/api/image/2/profiles/level0.json",a0="http://iiif.io/api/image/2/level1.json",l0="http://iiif.io/api/image/2/profiles/level1.json",u0="http://iiif.io/api/image/2/level2.json",h0="http://iiif.io/api/image/2/profiles/level2.json",xT="level0",c0="level1",d0="level2",_T="http://iiif.io/api/image/2/level0",p0="http://iiif.io/api/image/2/level1",f0="http://iiif.io/api/image/2/level2",g0=[f0,Xv,Kv,e0,i0,s0,o0,u0,h0,d0],m0=[...g0,p0,Zv,Yv,Jv,t0,r0,n0,a0,l0,c0],ST=[_T,p0,f0,pT,Zv,Xv,fT,Yv,Kv,gT,Jv,e0,mT,t0,i0,yT,vT,r0,n0,s0,o0,bT,wT,a0,l0,u0,h0,xT,c0,d0],ET={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["sizeByWhListed"]},AT={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPx","regionSquare","sizeByWhListed","sizeByH","sizeByW","sizeByWh"]},kT={extraFormats:["jpg","png"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPct","regionByPx","regionSquare","rotationBy90s","sizeByWhListed","sizeByConfinedWh","sizeByH","sizeByPct","sizeByW","sizeByWh"]};function PT(e){return g0.indexOf(e)!==-1?kT:m0.indexOf(e)!==-1?AT:ET}function CT(e){let t=e?Array.isArray(e.profile)?e.profile:[e.profile]:[],i={extraQualities:[],extraFormats:[],extraFeatures:[]};for(let r of t)if(typeof r=="string"&&(r=PT(r)),!!r){if(r.formats)for(let n of r.formats)i.extraFormats.indexOf(n)===-1&&i.extraFormats.push(n);if(r.qualities)for(let n of r.qualities)i.extraQualities.indexOf(n)===-1&&i.extraQualities.push(n);if(r.supports)for(let n of r.supports)i.extraFeatures.indexOf(n)===-1&&i.extraFeatures.push(n);if(r.maxHeight&&(i.maxHeight=r.maxHeight),r.maxWidth&&(i.maxWidth=r.maxWidth),r.maxArea&&(i.maxArea=r.maxArea),r.extraFormats)for(let n of r.extraFormats)i.extraFormats.indexOf(n)===-1&&i.extraFormats.push(n);if(r.extraQualities)for(let n of r.extraQualities)i.extraQualities.indexOf(n)===-1&&i.extraQualities.push(n);if(r.extraFeatures)for(let n of r.extraFeatures)i.extraFeatures.indexOf(n)===-1&&i.extraFeatures.push(n);r.maxHeight&&(i.maxHeight=r.maxHeight),r.maxWidth&&(i.maxWidth=r.maxWidth),r.maxArea&&(i.maxArea=r.maxArea)}if(e.extraFormats)for(let r of e.extraFormats)i.extraFormats.indexOf(r)===-1&&i.extraFormats.push(r);if(e.extraFeatures)for(let r of e.extraFeatures)i.extraFeatures.indexOf(r)===-1&&i.extraFeatures.push(r);if(e.extraQualities)for(let r of e.extraQualities)i.extraQualities.indexOf(r)===-1&&i.extraQualities.push(r);return i}function TT(e){try{if(e==="full")return{full:!0};if(e==="square")return{square:!0};let t=e.startsWith("pct:"),i=e.substr(t?4:0).split(",").map(r=>parseFloat(r));return{x:i[0],y:i[1],w:i[2],h:i[3],percent:t}}catch{throw new Error("Expected 'full', 'square' or 'x,y,w,h'. Found "+e)}}function IT(e){let t={upscaled:!1,max:!1,confined:!1};if(e[0]==="^"&&(t.upscaled=!0,e=e.slice(1)),e==="max"||e==="full")return t.max=!0,t.serialiseAsFull=e==="full",t;if(e[0]==="!"&&(t.confined=!0,e=e.slice(1)),e[0]==="p")return t.percentScale=parseFloat(e.slice(4)),t;let i=e.split(",").map(r=>r.trim());return i.length&&(i[0]!==""&&(t.width=parseInt(i[0],10)),i[1]!==""&&(t.height=parseInt(i[1],10))),t}function OT(e){let t={angle:0};if(e[0]==="!"&&(t.mirror=!0,e=e.substr(1)),t.angle=parseFloat(e)%360,Number.isNaN(t.angle))throw new Error(`Invalid rotation ${e}`);return t}function RT(e,t=""){let i=e.match(/^(([a-zA-Z]+):\/\/([^/]+))?((.*)+)/);if(!i)throw new Error(`Invalid or unknown input ${e}`);let r=i[2],n=i[3],o=i[4];if(o[0]==="/"&&(o=o.substr(1)),t.length>0){if(t[0]==="/"&&(t=t.substr(1)),t!==o.substr(0,t.length))throw new Error(`Path does not start with prefix (path: ${o}, prefix: ${t})`);o=o.substr(t.length)}return{scheme:r,server:n,path:o,prefix:t}}function MT(e,t=""){let{path:i,scheme:r,server:n,prefix:o}=RT(e,t),l=i.split("/").reverse(),[u,c,p,f,...v]=l,x=v.reverse().filter(Boolean).join("/");if(l.length===1||u==="")return{type:"base",scheme:r,server:n,prefix:o,identifier:x};if(u==="info.json"){let[,..._]=l;return{type:"info",scheme:r,server:n,prefix:o,identifier:_.reverse().filter(Boolean).join("/")}}let E=u.split(".");return{type:"image",scheme:r,server:n,prefix:o,identifier:x,originalPath:i,region:TT(f),size:IT(p),rotation:OT(c),quality:E[0],format:E[1]}}function LT(e){let t=MT(rs(e.id));if(t.type!=="info")throw new Error("Invalid service URL");let i=CT(e);return{identifier:t.identifier,originalPath:"",server:t.server,prefix:t.prefix,scheme:t.scheme,type:"image",quality:i.extraQualities.indexOf("default")===-1?i.extraQualities[0]:"default",region:{full:!0},size:{max:!0,upscaled:!1,confined:!1},format:"jpg",rotation:{angle:0}}}function $T(e,t,i){let r=i.length,n=[];for(let o=0;o<r;o++){let l=i[o].width;n.push(e/l)}return n}function NT(e,t,i){let r=i.length,n=[];for(let o=0;o<r;o++){let l=i[o];n.push({width:Math.floor(e/l),height:Math.floor(t/l)})}return n}function Vt(e){if(e["@id"])return e["@id"];if(e.id)return e.id}function jc(e){if(!e||!e.profile||!Vt(e))return!1;let t=Array.isArray(e.profile)?e.profile:[e.profile];for(let i of t)if(typeof i=="string"&&ST.indexOf(i)!==-1)return!0;return!1}function zT(e){if(!jc(e))return!1;let t=Array.isArray(e.profile)?e.profile:[e.profile];for(let i of t)if(typeof i=="string"){if(m0.indexOf(i)!==-1)return!0}else{let r=[...i.supports||[],...i.extraFeatures||[]];if(r.indexOf("regionByPx")!==-1&&(r.indexOf("sizeByW")!==-1||r.indexOf("sizeByWh")!==-1))return!0}return!1}function FT(e){if(!zT(e))return[];let t=[],i=Array.isArray(e.profile)?e.profile:[e.profile],r=i.length;for(let n=0;n<r;n++){let o=i[n];if(typeof o!="string"&&(o.maxHeight||o.maxWidth))return[{id:Vt(e),type:"variable",minWidth:0,minHeight:0,maxHeight:o.maxHeight||o.maxWidth,maxWidth:o.maxWidth||o.maxHeight}]}if(e.tiles){let n=e.tiles.length;for(let o=0;o<n;o++){let l=e.tiles[o];(l.height||l.width)&&t.push({id:Vt(e),type:"variable",minHeight:0,minWidth:0,maxHeight:l.height||l.width,maxWidth:l.width})}}return t}function y0(e){let t=/^.*\/(full)\/(((\d+),(\d+)?)|max)\/(\d+)\/default\.(jpg|png|jpeg)$/,i=e.match(t);if(i){let r=i[1],n=parseInt(i[4],10),o=parseInt(i[5],10),l=i[7];if((r==="max"||r==="full")&&n&&o&&l)return{type:"fixed",id:e,height:o,width:n}}return{type:"unknown",id:e}}function BT(e){if(e["@type"])return e["@type"];if(e.type)return e.type}function Uc(e){if(typeof e=="string")return y0(e);let t=BT(e);if(t!=="Image"&&t!=="sc:Image")return null;let i=e,r=Vt(i);return r?r&&i.width&&i.height?{id:r,type:"fixed",width:i.width,height:i.height,unsafe:!0}:y0(r):null}function jT(e){return jc(e)?(e&&e.sizes?e.sizes:[]).map(t=>({id:Vt(e),type:"fixed-service",height:t.height,width:t.width})):[]}function v0(e){let t=[],i=e.length;for(let r=0;r<i;r++){let n=jT(e[r]);n.length&&t.push(...n);let o=FT(e[r]);o.length&&t.push(...o)}return t}function b0(e){let t=e.service?Array.isArray(e.service)?e.service:[e.service]:[],i=t.length,r=[];for(let n=0;n<i;n++)jc(t[n])&&r.push(t[n]);return r}function UT(e,t=!0,i){let r=[],n=Uc(e);if(n===null)return r;let o=e;if(r.push(n),t&&o.width&&o.height){let l=[],u=b0(o);for(let c of u){let p={id:Vt(c),width:o.width,height:o.height};if(i.canLoadSync(p)){let f=i.loadServiceSync(p);f&&(f.height||(f.height=o.height),f.width||(f.width=o.width),l.push(...v0([f])))}}if(l.length)return r.push(...l),r}return o.service&&r.push(...v0(o.service)),r}function DT({x:e=0,y:t=0,w:i,h:r,full:n,square:o,percent:l}){if(n)return"full";if(o)return"square";if(typeof i>"u"||typeof r>"u")throw new Error("RegionParameter: invalid region");let u=`${e},${t},${i},${r}`;return l?`pct:${u}`:u}function WT({max:e,percentScale:t,upscaled:i,confined:r,width:n,height:o,serialiseAsFull:l}){let u=[];return i&&u.push("^"),e?(u.push(l?"full":"max"),u.join("")):(r&&u.push("!"),t&&u.push(`pct:${t}`),n&&u.push(`${n}`),u.push(","),o&&u.push(`${o}`),u.join(""))}function HT(e){return`${e.mirror?"!":""}${(e.angle||0)%360}`}var qT=Object.defineProperty,QT=Object.defineProperties,VT=Object.getOwnPropertyDescriptors,w0=Object.getOwnPropertySymbols,GT=Object.prototype.hasOwnProperty,ZT=Object.prototype.propertyIsEnumerable,x0=(e,t,i)=>t in e?qT(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,Vo=(e,t)=>{for(var i in t||(t={}))GT.call(t,i)&&x0(e,i,t[i]);if(w0)for(var i of w0(t))ZT.call(t,i)&&x0(e,i,t[i]);return e},Go=(e,t)=>QT(e,VT(t));function XT(e,t){let i=e.prefix.startsWith("/")?e.prefix.substr(1):e.prefix,r=`${e.scheme}://${e.server}/${i?`${i}/`:""}${e.identifier}`;if(e.type==="base")return r;if(e.type==="info")return`${r}/info.json`;let{region:n,size:o,rotation:l,format:u,quality:c}=e;if(t){let p=t["@context"]?Array.isArray(t["@context"])?t["@context"]:[t["@context"]]:[],f=p.indexOf("http://iiif.io/api/image/2/context.json")!==-1,v=p.indexOf("http://iiif.io/api/image/3/context.json")!==-1;if((o.width===t.width&&!o.height||o.height===t.height&&!o.width||o.width===t.width&&o.height===t.height)&&(o=Go(Vo({},o),{max:!0})),f&&(o.max&&!o.serialiseAsFull&&(o=Go(Vo({},o),{serialiseAsFull:!0})),!o.max&&o.width&&o.height&&(o=Go(Vo({},o),{height:void 0}))),v&&(o.max&&o.serialiseAsFull&&(o=Go(Vo({},o),{serialiseAsFull:!1})),o.width&&!o.height&&t.width&&t.height)){let x=t.height/t.width;o=Go(Vo({},o),{height:Math.ceil(o.width*x)})}}return[r,DT(n),WT(o),HT(l),`${c}.${u}`].filter(Boolean).join("/")}function Dc(e,t,i){let r=LT({id:rs(Vt(e)),profile:"level2",type:"ImageService2"});if(r.type!=="image")throw new Error("Invalid service");return r.size.max=!1,r.size.width=t,r.size.height=i,{id:XT(r),type:"fixed",width:t,height:i||e.height/(e.width||1)*t,unsafe:e.width>t}}function Vs(e){let t=e.replace(/(https?:\/\/)?(www.)?/i,"");return t.indexOf("/")!==-1?t.split("/")[0]:t}function YT(e,t,i){let r=e.width?e.width:e.maxWidth;return i.height<=e.maxHeight&&i.width<=e.maxWidth&&i.height>=e.minHeight&&i.width>=e.minWidth&&(!t||Math.abs(i.width-r)<Math.abs(t.width-r))}function KT(e,t){let i=[],r=Object.assign({unsafeImageService:!1,atAnyCost:!0,fallback:!0,minHeight:64,minWidth:64,maxHeight:1/0,maxWidth:1/0,returnAllOptions:!1,preferFixedSize:!1,allowUnsafe:!1,explain:!1,height:0,width:0},e),n=[],o=[],l=null,u=(p,f)=>{if(YT(r,f,p)){if(r.preferFixedSize&&p.unsafe){o.push(p);return}r.returnAllOptions&&f&&o.push(f),l=p}else r.returnAllOptions&&o.push(p)},c=t.length;for(let p=0;p<c;p++){let f=t[p](),v=f.length;for(let x=0;x<v;x++){let E=f[x];if(E.type==="unknown"&&r.atAnyCost&&n.push(E),E.type==="fixed"&&(E.unsafe?n.push(E):u(E,l)),E.type==="fixed-service")if(r.unsafeImageService){let _=Dc(E,r.width,r.height);u(_,l)}else{let _=Dc(E,E.width,E.height);u(_,l)}if(E.type==="variable"&&E.maxWidth){let _=Dc({id:E.id,type:"fixed-service",width:E.maxWidth,height:E.maxWidth},E.maxWidth);u(_,l)}}if(l&&!r.returnAllOptions){if(l.unsafe||r.allowUnsafe)continue;break}}return r.atAnyCost&&o.length===0?{best:l||n[0],fallback:n.slice(1),log:i}:r.returnAllOptions?{best:r.atAnyCost?l||o[0]||n[0]:l||o[0],fallback:[...o,...n],log:i}:{best:l||o[0]||null,fallback:l?o:o.slice(1),log:i}}var JT=Object.defineProperty,eI=Object.defineProperties,tI=Object.getOwnPropertyDescriptors,_0=Object.getOwnPropertySymbols,iI=Object.prototype.hasOwnProperty,rI=Object.prototype.propertyIsEnumerable,S0=(e,t,i)=>t in e?JT(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,nI=(e,t)=>{for(var i in t||(t={}))iI.call(t,i)&&S0(e,i,t[i]);if(_0)for(var i of _0(t))rI.call(t,i)&&S0(e,i,t[i]);return e},sI=(e,t)=>eI(e,tI(t));function oI(e,t,i){let r=e>t?e:t,n=i.length,o=[];for(let l=0;l<n;l++){let u=i[l],c=u.scaleFactors[0],p=r/c,f=[c];for(;p>=u.width;)c=c*2,f.push(c),p=p/2;o.push(sI(nI({},u),{scaleFactors:f}))}return o}function aI(e,t){if(e.length!==t.length)return!1;if(e.length===0&&t.length===0)return!0;let i=e.length,r=!0;for(let o=0;o<i;o++){let l=e[o],u=t[o];if(l.width!==u.width||l.height!==u.height){r=!1;break}}if(r)return!0;let n=0;for(let o=0;o<i;o++)for(let l=0;l<i;l++)if(e[o].width===t[l].width&&e[o].height===t[l].height){n++;break}return n===i}function E0(e){if(e&&e.profile){let t=e.profile;if(t){let i=Array.isArray(t)?t:[t];return i.includes("level0")||i.includes("http://iiif.io/api/image/2/level0.json")||i.includes("http://iiif.io/api/image/1/level0.json")||i.includes("http://iiif.io/api/image/1/profiles/level0.json")}}return!1}var ns=(e,t,i)=>new Promise((r,n)=>{var o=c=>{try{u(i.next(c))}catch(p){n(p)}},l=c=>{try{u(i.throw(c))}catch(p){n(p)}},u=c=>c.done?r(c.value):Promise.resolve(c.value).then(o,l);u((i=i.apply(e,t)).next())}),lI=class{constructor(){this.config={verificationsRequired:1,approximateServices:!0,enableFetching:!0,disableThrottling:!1},this.fetchingCount=0,this.imageServices={},this.knownImageServers={}}setConfig(e){Object.assign(this.config,e)}sample(e,t,i=!0){let r=Vs(Vt(e)),n=rs(Vt(e)),o=this.knownImageServers[r];return this.imageServices[n]=Object.assign(e,{real:!0}),!o&&e.tiles&&!E0(e)?(this.knownImageServers[r]={verifications:0,malformed:!1,root:r,preLoaded:i,sampledId:Vt(e),verified:!1,server:null,result:{context:e["@context"]||[],sampledProfile:e.profile,resourceServiceRatio:t&&e.height?t.height/e.height:1,sampledSizes:e.sizes||[],sizeRatios:$T(e.width,e.height,e.sizes||[]),sampledTiles:e.tiles||[]}},!0):this.verify(e)}preLoad(e,t=!0){this.knownImageServers[e.root]=e,t&&(this.knownImageServers[e.root].malformed=!1,this.knownImageServers[e.root].verifications=this.config.verificationsRequired)}predict(e,t=!1,i=!1){let r=e==null?void 0:e.source,n=Vs(Vt(e)),o=this.knownImageServers[n];if(!o||!o.result||!i&&(o.malformed||o.verifications<this.config.verificationsRequired)||E0(e.source))return null;let l=rs(Vt(e));return this.imageServices[l]||(this.imageServices[l]={"@context":o.result.context,"@id":Vt(e),id:Vt(e),protocol:"http://iiif.io/api/image",tiles:(r==null?void 0:r.tiles)||oI(e.width,e.height,o.result.sampledTiles),sizes:(r==null?void 0:r.sizes)||NT(Math.round(e.width/o.result.resourceServiceRatio),Math.round(e.height/o.result.resourceServiceRatio),o.result.sizeRatios),profile:(r==null?void 0:r.profile)||o.result.sampledProfile,height:(r==null?void 0:r.height)||e.height,width:(r==null?void 0:r.width)||e.width,real:!1}),this.imageServices[l]}getThumbnailFromResource(e,t){return ns(this,arguments,function*(i,r,n=!0,o=[]){let l=yield this.getImageCandidates(i,n);return KT(r,[()=>o,()=>l])})}getImageCandidates(e,t=!0){return ns(this,null,function*(){let i=e;if(t&&i.height&&i.width){let r=b0(i);for(let n of r){let o={id:Vt(n),width:n.width?n.width:i.width,height:n.height?n.height:i.height,source:n};yield this.loadService(o)}}return UT(e,t,this)})}verify(e){return ns(this,null,function*(){let t=this.predict(e,!1,!0),i=yield this.fetchService(Vt(e));if(!t)return!1;let r=t.height===i.height&&t.width===i.width&&t["@context"]===i["@context"]&&aI(t.sizes||[],i.sizes||[]);if(r){let n=Vs(Vt(e));this.knownImageServers[n].verifications+=1,this.knownImageServers[n].verifications>=this.config.verificationsRequired&&(this.knownImageServers[n].verified=!0)}return r})}canLoadSync(e){let t=typeof e=="string"?e:Vt(e),i=rs(t);if(this.imageServices[i])return!0;let r=this.knownImageServers[Vs(t)];return r&&!r.malformed&&r.verifications>=this.config.verificationsRequired}markAsMalformed(e){return ns(this,null,function*(){return this.knownImageServers[Vs(Vt(e))].malformed=!0,this.loadService(e,!0)})}fetchService(e,t=!1){return ns(this,null,function*(){let i=rs(e);if(this.imageServices[i]&&(!t||this.imageServices[i].real))return this.imageServices[i];if(!this.config.enableFetching)throw new Error("Fetching is not enabled");let r=yield this.fetch(i).then(n=>n.json());return!r.id&&r["@id"]&&(r.id=r["@id"]),r.id!==e&&(r.id=e,r["@id"]&&(r["@id"]=e)),this.imageServices[i]=Object.assign(r,{real:!0}),this.imageServices[i]})}fetch(e,t){return ns(this,null,function*(){return fetch(e,t)})}loadService(e,t=!1){return ns(this,null,function*(){if(!this.config.disableThrottling){let n=!0;for(;n;)if(this.fetchingCount>=this.config.verificationsRequired)yield new Promise(o=>setTimeout(o,500));else{n=!1;break}}let i=this.knownImageServers[Vs(Vt(e))];if(i&&!i.malformed&&!t){yield i.result;let n=this.loadServiceSync(e);if(n)return n}this.fetchingCount++;let r=yield this.fetchService(Vt(e),t);return this.fetchingCount--,r.real&&this.sample(r,e),r})}loadServiceSync(e){let t=rs(Vt(e));return this.imageServices[t]?this.imageServices[t]:this.predict(e)}};function uI(e,t={}){let i=t.imageServiceLoader||new lI;async function r(n,o,l,u=[],c){if(typeof n=="string")return{best:Uc(n),fallback:[],log:[]};let p=e.get(n);if(typeof p=="string")return{best:Uc(p),fallback:[],log:[]};switch(p.type){case"Annotation":{let f=p.body,v=e.get(f[0]);return c&&!v.width&&(v.width=c.width,v.height=c.height),await i.getThumbnailFromResource(v,o,l,u)}case"Canvas":{let f=p;if(f.thumbnail&&f.thumbnail.length){let v=e.get(f.thumbnail[0]),x=await i.getImageCandidates(v,l);x&&x.length&&u.push(...x)}return r(f.items[0],o,l,u,{width:f.width,height:f.height})}case"AnnotationPage":return r(p.items[0],o,l,u,c);case"Choice":return r(p.items[0],o,l,u,c);case"Collection":{let f=p.items[0];return r(f,o,l,u,c)}case"Manifest":{let f=p.items[0];return r(f,o,l,u,c)}case"SpecificResource":case"Image":case"Dataset":case"Sound":case"Text":case"TextualBody":case"Video":return c&&!p.width&&(p.width=c.width,p.height=c.height),i.getThumbnailFromResource(p,o,l,u);case"Service":case"Range":case"AnnotationCollection":case"CanvasReference":case"ContentResource":return{best:void 0,fallback:[],log:[]}}return{best:void 0,fallback:[],log:[]}}return{getBestThumbnailAtSize:r}}function hI(e,t,i=[],r=!1){if(!e||!t||t.length===0)return;if(t.length===1)return t[0];if(t.indexOf(e)!==-1)return e;let n=e.indexOf("-")!==-1?e.slice(0,e.indexOf("-")):null;if(n&&t.indexOf(n)!==-1)return n;for(let o of i)if(t.indexOf(o)!==-1)return o;if(!r){let o=t.map(l=>l.indexOf("-")!==-1?l.slice(0,l.indexOf("-")):null).indexOf(e);if(o!==-1)return t[o];for(let l of i){let u=l.indexOf("-")!==-1?l.slice(0,l.indexOf("-")):null,c=u?t.indexOf(u):-1;if(c!==-1)return t[c]}}return t.indexOf("none")!==-1?"none":t.indexOf("@none")!==-1?"@none":t[0]}function cI(e,t,i={}){let{strictFallback:r=!1,defaultText:n="",separator:o=`
`,fallbackLanguages:l=[],closest:u}=i,c=Object.keys(e||{}),p=u?t:hI(t,c,l,r);if(!e)return n;if(typeof e=="string")return e;let f=p?e[p]:void 0;return f?typeof f=="string"?f:f.join(o):""}function Ir(e,t={}){return cI(e,typeof navigator<"u"?navigator.language:void 0,t)}var dI=function(){function e(t,i){var r=[],n=!0,o=!1,l=void 0;try{for(var u=t[Symbol.iterator](),c;!(n=(c=u.next()).done)&&(r.push(c.value),!(i&&r.length===i));n=!0);}catch(p){o=!0,l=p}finally{try{!n&&u.return&&u.return()}finally{if(o)throw l}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),Zo=Math.PI*2,Wc=function(e,t,i,r,n,o,l){var u=e.x,c=e.y;u*=t,c*=i;var p=r*u-n*c,f=n*u+r*c;return{x:p+o,y:f+l}},pI=function(e,t){var i=t===1.5707963267948966?.551915024494:t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),r=Math.cos(e),n=Math.sin(e),o=Math.cos(e+t),l=Math.sin(e+t);return[{x:r-n*i,y:n+r*i},{x:o+l*i,y:l-o*i},{x:o,y:l}]},A0=function(e,t,i,r){var n=e*r-t*i<0?-1:1,o=e*i+t*r;return o>1&&(o=1),o<-1&&(o=-1),n*Math.acos(o)},fI=function(e,t,i,r,n,o,l,u,c,p,f,v){var x=Math.pow(n,2),E=Math.pow(o,2),_=Math.pow(f,2),P=Math.pow(v,2),O=x*E-x*P-E*_;O<0&&(O=0),O/=x*P+E*_,O=Math.sqrt(O)*(l===u?-1:1);var I=O*n/o*v,A=O*-o/n*f,$=p*I-c*A+(e+i)/2,z=c*I+p*A+(t+r)/2,B=(f-I)/n,H=(v-A)/o,Y=(-f-I)/n,V=(-v-A)/o,he=A0(1,0,B,H),Q=A0(B,H,Y,V);return u===0&&Q>0&&(Q-=Zo),u===1&&Q<0&&(Q+=Zo),[$,z,he,Q]},gI=function(e){var t=e.px,i=e.py,r=e.cx,n=e.cy,o=e.rx,l=e.ry,u=e.xAxisRotation,c=u===void 0?0:u,p=e.largeArcFlag,f=p===void 0?0:p,v=e.sweepFlag,x=v===void 0?0:v,E=[];if(o===0||l===0)return[];var _=Math.sin(c*Zo/360),P=Math.cos(c*Zo/360),O=P*(t-r)/2+_*(i-n)/2,I=-_*(t-r)/2+P*(i-n)/2;if(O===0&&I===0)return[];o=Math.abs(o),l=Math.abs(l);var A=Math.pow(O,2)/Math.pow(o,2)+Math.pow(I,2)/Math.pow(l,2);A>1&&(o*=Math.sqrt(A),l*=Math.sqrt(A));var $=fI(t,i,r,n,o,l,f,x,_,P,O,I),z=dI($,4),B=z[0],H=z[1],Y=z[2],V=z[3],he=Math.abs(V)/(Zo/4);Math.abs(1-he)<1e-7&&(he=1);var Q=Math.max(Math.ceil(he),1);V/=Q;for(var ue=0;ue<Q;ue++)E.push(pI(Y,V)),Y+=V;return E.map(function(pe){var ge=Wc(pe[0],o,l,P,_,B,H),oe=ge.x,Se=ge.y,Pe=Wc(pe[1],o,l,P,_,B,H),Ke=Pe.x,re=Pe.y,Ie=Wc(pe[2],o,l,P,_,B,H),Ne=Ie.x,J=Ie.y;return{x1:oe,y1:Se,x2:Ke,y2:re,x:Ne,y:J}})},mI=vI,Hc={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},yI=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function vI(e){var t=[];return e.replace(yI,function(i,r,n){var o=r.toLowerCase();for(n=wI(n),o=="m"&&n.length>2&&(t.push([r].concat(n.splice(0,2))),o="l",r=r=="m"?"l":"L");;){if(n.length==Hc[o])return n.unshift(r),t.push(n);if(n.length<Hc[o])throw new Error("malformed path data");t.push([r].concat(n.splice(0,Hc[o])))}}),t}var bI=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function wI(e){var t=e.match(bI);return t?t.map(Number):[]}var xI=_I;function _I(e){var t=0,i=0,r=0,n=0;return e.map(function(o){o=o.slice();var l=o[0],u=l.toUpperCase();if(l!=u)switch(o[0]=u,l){case"a":o[6]+=r,o[7]+=n;break;case"v":o[1]+=n;break;case"h":o[1]+=r;break;default:for(var c=1;c<o.length;)o[c++]+=r,o[c++]+=n}switch(u){case"Z":r=t,n=i;break;case"H":r=o[1];break;case"V":n=o[1];break;case"M":r=t=o[1],n=i=o[2];break;default:r=o[o.length-2],n=o[o.length-1]}return o})}function SI(e){let t=mI(e),i=xI(t),r,n=0,o=0,l=0,u=0,c,p,f=0,v=0,x=[];for(let E=0;E<i.length;E++){let _=i[E],P=_[0];switch(P){case"M":n=_[1],o=_[2];break;case"H":_=["L",_[1],o];break;case"V":_=["L",n,_[1]];break;case"S":{let O=f,I=v;(r==="C"||r=="S")&&(O+=O-l,I+=I-u),_=["C",O,I,_[1],_[2],_[3],_[4]]}break;case"T":r==="Q"||r=="T"?(c=f*2-c,p=v*2-p):(c=f,p=v),_=["Q",c,p,_[1],_[2]];break;case"Q":c=_[1],p=_[2];break;case"A":{let O=gI({px:f,py:v,cx:_[6],cy:_[7],rx:_[1],ry:_[2],xAxisRotation:_[3],largeArcFlag:_[4],sweepFlag:_[5]});if(!O.length)continue;for(let[I,A]of O.entries())_=["C",A.x1,A.y1,A.x2,A.y2,A.x,A.y],I<O.length-1&&x.push(_);_=_}break;case"Z":_=["L",n,o];break}r=P,f=_[_.length-2],v=_[_.length-1],["C","Q","A"].indexOf(P)>-1?(l=_[_.length-4],u=_[_.length-3]):(l=f,u=v),x.push(_)}return x}function EI(e,t,i,r=1){return new k0(e,t,i).subdivide(r)}function AI(e,t,i,r,n=1){return new P0(new Float64Array([e.x,e.y,t.x,t.y,i.x,i.y,r.x,r.y])).subdivide(n)}function kI(e){return e.x*e.x+e.y*e.y}function Xo(e){return e/(1-.67+Math.pow(Math.pow(.67,4)+.25*e*e,.25))}function Gs(e){return e*(1-.39+Math.sqrt(.39*.39+.25*e*e))}var k0=class{constructor(e,t,i){this.start=e,this.control=t,this.end=i}eval(e){let t=1-e;return{x:this.start.x*t*t+2*this.control.x*t*e+this.end.x*e*e,y:this.start.y*t*t+2*this.control.y*t*e+this.end.y*e*e}}mapToBasic(){let{x:e,y:t}=this.start,{x:i,y:r}=this.control,{x:n,y:o}=this.end,l=2*i-e-n,u=2*r-t-o,c=(i-e)*l+(r-t)*u,p=(n-i)*l+(o-r)*u,f=(n-e)*u-(o-t)*l,v=c/f,x=p/f,E=Math.abs(f)/(Math.hypot(l,u)*Math.abs(x-v));return{x0:e,x2:n,scale:E,cross:f}}subdivide(e){let t=this.mapToBasic(),i=Xo(t.x0),r=Xo(t.x2),n=.5*Math.abs(r-i)*Math.sqrt(t.scale/e),o=Math.ceil(n),l=Gs(i),u=Gs(r),c=[0];for(let p=1;p<o;p++){let f=(Gs(i+(r-i)*p/o)-l)/(u-l);c.push(f)}return c.push(1),c.map(p=>this.eval(p))}},P0=class{constructor(e){this.c=e}weightsum(e,t,i,r){let n=e*this.c[0]+t*this.c[2]+i*this.c[4]+r*this.c[6],o=e*this.c[1]+t*this.c[3]+i*this.c[5]+r*this.c[7];return{x:n,y:o}}eval(e){let t=1-e,i=t*t*t,r=3*t*t*e,n=3*t*e*e,o=e*e*e;return this.weightsum(i,r,n,o)}deriv(e){let t=1-e,i=-3*t*t,r=3*e*e,n=-6*e*t-i,o=6*e*t-r;return this.weightsum(i,n,o,r)}midpoint_quadbez(){let e=this.weightsum(-.25,.75,.75,-.25);return new k0({x:this.c[0],y:this.c[1]},e,{x:this.c[6],y:this.c[7]})}subsegment(e,t){let i=new Float64Array(8),r=this.eval(e),n=this.eval(t);i[0]=r.x,i[1]=r.y;let o=(t-e)/3,l=this.deriv(e);i[2]=r.x+o*l.x,i[3]=r.y+o*l.y;let u=this.deriv(t);return i[4]=n.x-o*u.x,i[5]=n.y-o*u.y,i[6]=n.x,i[7]=n.y,new P0(i)}subdivide(e){let t=.1*e,i=e-t,r=Math.sqrt(i),n=kI(this.weightsum(1,-3,3,-1)),o=Math.ceil(Math.pow(n/(432*t*t),1/6)),l=[],u=0;for(let E=0;E<o;E++){let _=E/o,P=(E+1)/o,O=this.subsegment(_,P).midpoint_quadbez(),I=O.mapToBasic(),A=Xo(I.x0),$=Xo(I.x2),z=Math.sqrt(I.scale),B=Math.abs($-A)*z;if(Math.sign(I.x0)!=Math.sign(I.x2)){let H=r/z,Y=r*Math.abs($-A)/Xo(H);B=Math.max(B,Y)}l.push({quad:O,a0:A,a2:$,val:B}),u+=B}let c=.5*u/r,p=Math.ceil(c),f=[{x:this.c[0],y:this.c[1]}],v=0,x=0;for(let E=1;E<p;E++){let _=u*E/p;for(;v+l[x].val<_;)v+=l[x].val,x++;let P=l[x].a0,O=l[x].a2,I=Gs(P),A=Gs(O),$=P+(O-P)*(_-v)/l[x].val,z=(Gs($)-I)/(A-I);f.push(l[x].quad.eval(z))}return f.push({x:this.c[6],y:this.c[7]}),f}},PI=/&?(xywh=)?(pixel:|percent:|pct:)?([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?)/,CI=/&?(t=)(npt:)?([0-9]+(.[0-9]+)?)?(,([0-9]+(.[0-9]+)?))?/,C0=/^rgba\((\d+),(\d+),(\d+),([0-9.]+)\)$/;function qc(e,{domParser:t,svgPreprocessor:i}={}){var r,n;if(Array.isArray(e))return e.reduce((o,l)=>{let{selector:u,selectors:c}=qc(l);return u&&(o.selector||(o.selector=u),o.selectors.push(...c)),o},{selector:null,selectors:[]});if(!e)return{selector:null,selectors:[]};if(typeof e=="string"){let[o,l]=e.split("#");return l?qc({type:"FragmentSelector",value:l}):{selector:null,selectors:[]}}if(e.type==="PointSelector"&&(e.t||e.t===0)){let o={type:"TemporalSelector",temporal:{startTime:e.t}};return{selector:o,selectors:[o]}}if(e.type==="FragmentSelector"){let o=PI.exec(e.value);if(o){let u={type:"BoxSelector",spatial:{unit:o[2]==="percent:"||o[2]==="pct:"?"percent":"pixel",x:parseFloat(o[3]),y:parseFloat(o[4]),width:parseFloat(o[5]),height:parseFloat(o[6])}};return{selector:u,selectors:[u]}}let l=e.value.match(CI);if(l){let u={type:"TemporalSelector",temporal:{startTime:l[4]?parseFloat(l[4]):0,endTime:l[7]?parseFloat(l[7]):void 0}};return{selector:u,selectors:[u]}}return{selector:null,selectors:[]}}if(e.type==="SvgSelector"&&"value"in e){t||(typeof window<"u"?t=new window.DOMParser:console.warn("No DOMParser available, cannot parse SVG selector, `points`, `spatial` and `style` will be unavailable and the SVG will not be normalized."));let o=[],l,u,c=(r=i==null?void 0:i(e.value))!=null?r:e.value,p;if(t){let v=t.parseFromString(e.value,"image/svg+xml").querySelector("svg");if(!v)return console.warn(`Illegal SVG selector: ${e.value}`),{selector:null,selectors:[]};let x=T0(v);x&&(o=x.points,p=x.shapeType,l=[Math.min(...o.map(E=>E[0])),Math.min(...o.map(E=>E[1])),Math.max(...o.map(E=>E[0])),Math.max(...o.map(E=>E[1]))],{style:u,svg:c}=(n=OI(x.element))!=null?n:{svg:c})}let f={type:"SvgSelector",svg:c,svgShape:p,style:u,points:o.length?o:void 0,spatial:l?{unit:"pixel",x:l[0],y:l[1],width:l[2]-l[0],height:l[3]-l[1]}:void 0};return{selector:f,selectors:[f]}}return{selector:null,selectors:[]}}function TI(e){let t=e.map(r=>r[0]).reduce((r,n)=>(r[n]+=1,r),{C:0,Q:0,L:0,M:0}),i=new Set(e.map(r=>r[0]));if(t.C>0||t.Q>0)return"path";if(t.L>0&&(i.size===1||i.size===2&&i.has("M"))){if(t.L===4)return"rect";let r=e.slice(-1)[0];return e[0][0]==="M"&&r[0]==="L"&&r[1]==e[0][1]&&r[2]===e[0][2]||r[1]===0&&r[2]===0?"polygon":"polyline"}return"path"}function T0(e){var t,i,r,n,o,l,u,c,p,f,v,x,E,_,P,O,I;for(let A of Array.from(e.children))switch(A==null?void 0:A.tagName.toLowerCase()){case"g":{let $=T0(A);if($)return $}continue;case"path":{let $=A.getAttribute("d");if(!$)continue;let z=SI($);return{element:A,points:II(z),shapeType:TI(z)}}case"circle":{let $=parseFloat((t=A.getAttribute("cx"))!=null?t:"0"),z=parseFloat((i=A.getAttribute("cy"))!=null?i:"0"),B=parseFloat((r=A.getAttribute("r"))!=null?r:"0");if(!B)continue;let H=[];for(let Y=0;Y<=360;Y+=12){let V=Y*Math.PI/180;H.push([$+B*Math.cos(V),z+B*Math.sin(V)])}return{element:A,points:H,shapeType:"circle"}}case"ellipse":{let $=parseFloat((n=A.getAttribute("cx"))!=null?n:"0"),z=parseFloat((o=A.getAttribute("cy"))!=null?o:"0"),B=parseFloat((l=A.getAttribute("rx"))!=null?l:"0"),H=parseFloat((u=A.getAttribute("ry"))!=null?u:"0");if(!B&&!H)continue;let Y=[];for(let V=0;V<=360;V+=12){let he=Math.tan(V/360*Math.PI),Q=B*(1-he**2)/(1+he**2),ue=H*2*he/(1+he**2);Y.push([$+Q,z+ue])}return{element:A,points:Y,shapeType:"ellipse"}}case"line":{let $=parseFloat((c=A.getAttribute("x0"))!=null?c:"0"),z=parseFloat((p=A.getAttribute("y0"))!=null?p:"0"),B=parseFloat((f=A.getAttribute("x1"))!=null?f:"0"),H=parseFloat((v=A.getAttribute("y1"))!=null?v:"0");if($===B&&z===H)continue;return{element:A,points:[[$,z],[B,H]],shapeType:"polyline"}}case"polygon":case"polyline":{let $=(E=(x=A.getAttribute("points"))==null?void 0:x.split(" ").map(B=>B.split(",").map(parseFloat)))!=null?E:[];if(!$.length)continue;let z="polyline";return A.tagName.toLowerCase()==="polygon"&&($.push($[0]),z="polygon"),{element:A,points:$,shapeType:z}}case"rect":{let $=parseFloat((_=A.getAttribute("x"))!=null?_:"0"),z=parseFloat((P=A.getAttribute("y"))!=null?P:"0"),B=parseFloat((O=A.getAttribute("width"))!=null?O:"0"),H=parseFloat((I=A.getAttribute("height"))!=null?I:"0");if(!B||!H)continue;return{element:A,points:[[$,z],[$+B,z],[$+B,z+H],[$,z+H],[$,z]],shapeType:"rect"}}default:continue}return null}function II(e){var t;let i=[];for(let r=0;r<e.length;r++){let n=(t=i[i.length-1])!=null?t:[0,0],o=e[r];switch(o[0]){case"M":case"L":i.push([o[1],o[2]]);continue;case"C":i.push(...AI({x:n[0],y:n[1]},{x:o[1],y:o[2]},{x:o[3],y:o[4]},{x:o[5],y:o[6]}).map(l=>[l.x,l.y]).slice(1));continue;case"Q":i.push(...EI({x:n[0],y:n[1]},{x:o[1],y:o[2]},{x:o[3],y:o[4]}).map(l=>[l.x,l.y]).slice(1));continue}}return i}function OI(e){let t={};if(e.hasAttribute("fill")?(t.fill=e.getAttribute("fill"),e.removeAttribute("fill")):e.style.fill&&(t.fill=e.style.fill),t.fill){let r=C0.exec(t.fill);r&&(t.fillOpacity=parseFloat(r[4]),t.fill=`rgb(${r[1]}, ${r[2]}, ${r[3]})`)}if(e.hasAttribute("fill-opacity")?(t.fillOpacity=parseFloat(e.getAttribute("fill-opacity")),e.removeAttribute("fill-opacity")):e.style.fillOpacity&&(t.fillOpacity=parseFloat(e.style.fillOpacity)),e.hasAttribute("stroke")?(t.stroke=e.getAttribute("stroke"),e.removeAttribute("stroke")):e.style.stroke&&(t.stroke=e.style.stroke),t.stroke){let r=C0.exec(t.stroke);r&&(t.strokeOpacity=parseFloat(r[4]),t.stroke=`rgb(${r[1]}, ${r[2]}, ${r[3]})`)}e.hasAttribute("stroke-opacity")?(t.strokeOpacity=parseFloat(e.getAttribute("stroke-opacity")),e.removeAttribute("stroke-opacity")):e.style.strokeOpacity&&(t.strokeOpacity=parseFloat(e.style.strokeOpacity)),e.hasAttribute("stroke-width")?(t.strokeWidth=e.getAttribute("stroke-width"),e.removeAttribute("stroke-width")):e.style.strokeWidth&&(t.strokeWidth=e.style.strokeWidth),e.hasAttribute("stroke-dasharray")?(t.strokeDasharray=e.getAttribute("stroke-dasharray"),e.removeAttribute("stroke-dasharray")):e.style.strokeDasharray&&(t.strokeDasharray=e.style.strokeDasharray);let i=e;for(;i.tagName.toLowerCase()!=="svg";)if(i=i.parentElement,i===null)throw new Error("Could not find root SVG element");return{svg:i.outerHTML,style:Object.keys(t).length>0?t:void 0}}function RI(e){return e.type==="SpecificResource"?[e.source,{selector:e.selector}]:[e,{selector:null}]}function MI(e){function t(n){let o=n?typeof n=="string"?e.get(n):n:null;if(!o)return[];let l=e.get(o.items),u=[];for(let c of l)u.push(...e.get(c.items));return u}function i(n,o=[]){let l=Array.isArray(n)?n:t(n),u=[],c=null,p=[];for(let f of l){if(f.type!=="Annotation")throw new Error("getPaintables() accept either a canvas or list of annotations");let v=e.get(f.body);for(let x of v){let[E,{selector:_}]=RI(x),P=(E.type||"unknown").toLowerCase();if(P==="choice"){let O=e.get(E.items),I=o.length?o.map(A=>O.find($=>$.id===A)).filter(Boolean):[O[0]];I.length===0&&I.push(O[0]),c={type:"single-choice",items:O.map(A=>({id:A.id,label:A.label,selected:I.indexOf(A)!==-1})),label:x.label},v.push(...I);continue}u.indexOf(P)===-1&&u.push(P),p.push({type:P,resource:E,target:f.target,selector:_})}}return{types:u,items:p,choice:c}}function r(n){let{choice:o}=i(n);return o}return{getAllPaintingAnnotations:t,getPaintables:i,extractChoices:r}}function I0(e,t){for(let i of t.items){if(i.type==="Canvas")return i;if(i.type==="Range"){let r=I0(e,e.get(i));if(r)return r}}return null}function LI(e,t,i){for(let r of t.structures){let n=O0(e,e.get(r),i);if(n)return n}return null}function O0(e,t,i){var r;for(let n of t.items){let o=(r=n.id)==null?void 0:r.split("#")[0];if(n.type==="SpecificResource"&&n.source===i||n.type==="Canvas"&&i===o)return t;if(n.type==="Range"){let l=O0(e,e.get(n),i);if(l)return l}}return null}var $I=class{constructor(e){this.__vault=null,this.__eventsHelper=null,this.__stylesHelper=null,this.__e={},this.htmlProps={},this.handlers=[],this.__annotation=typeof e=="string"?{id:e,type:"Annotation"}:{id:e.id,type:"Annotation"},this.classList=new dT(t=>{this.__stylesHelper&&this.__stylesHelper.applyStyles(this.__annotation,"html",D(C({},this.htmlProps),{className:t}))}),this.source=e}get className(){return this.classList.getClassName()}set className(e){this.classList.className=e}set href(e){this.__stylesHelper&&this.__stylesHelper.applyStyles(this.__annotation,"html",{href:e}),this.htmlProps.href=e}set title(e){this.__stylesHelper&&this.__stylesHelper.applyStyles(this.__annotation,"html",{title:e}),this.htmlProps.title=e}set target(e){this.__stylesHelper&&this.__stylesHelper.applyStyles(this.__annotation,"html",{target:e}),this.htmlProps.target=e}applyStyle(e){this.style=Vv(this.style,e),this.__stylesHelper&&this.__stylesHelper.applyStyles(this.__annotation,"atlas",this.style)}addEventListener(e,t){this.__eventsHelper&&this.__eventsHelper.addEventListener(this.__annotation,e,t),this.handlers.push([e,t])}removeEventListener(e,t){this.__eventsHelper&&this.__eventsHelper.removeEventListener(this.__annotation,e,t),this.handlers=this.handlers.filter(i=>i[0]===e&&i[1]===t)}bindToVault(e){this.__vault=e,this.__eventsHelper=Fc(e),this.__stylesHelper=Bc(e);for(let[t,i]of this.handlers)this.__eventsHelper.addEventListener(this.__annotation,t,i);this.__stylesHelper.applyStyles(this.__annotation,"atlas",this.style),this.__stylesHelper.applyStyles(this.__annotation,"html",D(C({},this.htmlProps),{className:this.classList.getClassName()}))}getSource(){return this.source}getAnnotation(){return this.__annotation}beforeRemove(){if(this.onBeforeRemove&&this.onBeforeRemove(),this.__vault){if(this.__eventsHelper)for(let[e,t]of this.handlers)this.__eventsHelper.removeEventListener(this.__annotation,e,t);this.__vault=null}}};fe();var wi=je(Mh(),1),R0="@iiif/IMPORT_ENTITIES",M0="@iiif/MODIFY_ENTITY_FIELD",L0="@iiif/REORDER_ENTITY_FIELD",$0="@iiif/ADD_REFERENCE",N0="@iiif/REMOVE_REFERENCE",z0=(0,wi.createAction)(R0)(),NI=(0,wi.createAction)(M0)(),zI=(0,wi.createAction)(L0)(),FI=(0,wi.createAction)($0)(),BI=(0,wi.createAction)(N0)(),jI={importEntities:z0,modifyEntityField:NI,reorderEntityField:zI,addReference:FI,removeReference:BI},F0="@iiif/ADD_MAPPING",B0="@iiif/ADD_MAPPINGS",UI=(0,wi.createAction)(F0)(),DI=(0,wi.createAction)(B0)(),j0="@iiif/SET_META_VALUE",U0="@iiif/SET_META_VALUE_DYNAMIC",D0="@iiif/UNSET_META_VALUE",WI=(0,wi.createAction)(j0)(),HI=(0,wi.createAction)(U0)(),qI=(0,wi.createAction)(D0)(),W0={setMetaValue:WI,setMetaValueDynamic:HI,unsetMetaValue:qI},Qc="RESOURCE_ERROR",H0="RESOURCE_LOADING",Vc="RESOURCE_READY",q0="@iiif/REQUEST_RESOURCE",Q0="@iiif/REQUEST_ERROR",V0="@iiif/REQUEST_MISMATCH",G0="@iiif/REQUEST_COMPLETE",Z0="@iiif/REQUEST_OFFLINE_RESOURCE",QI=(0,wi.createAction)(q0)(),X0=(0,wi.createAction)(Q0)(),VI=(0,wi.createAction)(V0)(),GI=(0,wi.createAction)(G0)();(0,wi.createAction)(Z0)();var Gc="@iiif/BATCH",Y0="@iiif/BATCH_IMPORT",Zc=(0,wi.createAction)(Gc)();(0,wi.createAction)(Y0)();var ZI=(e,t)=>{let{entities:i,resource:r,mapping:n}=Tm(t);if(r.id===void 0)return[X0({id:e,message:"ID is not defined in resource."})];let o=[z0({entities:i}),DI({mapping:n})];return r.id!==e&&(o.push(UI({id:e,type:r.type})),o.push(VI({requestId:e,actualId:r.id}))),o.push(GI({id:e})),o},K0=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function XI(e,t){return!!(e===t||K0(e)&&K0(t))}function J0(e,t){if(!Array.isArray(e)||!Array.isArray(t))return e===t;if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!XI(e[i],t[i]))return!1;return!0}function Xc(e,t){let i=e.iiif.requests[t],r=e.iiif.mapping[t];if(!(!r||!e.iiif.entities[r][i.resourceUri]))return e.iiif.entities[r][i.resourceUri]}function eb(e,t,{waitTimeout:i=30}={}){return async(r,n)=>{let o=e.getState(),l=o.iiif.requests[r];if(l)switch(l.loadingState){case Qc:break;case H0:{let u,c=!1;try{let p=await Promise.race([new Promise((f,v)=>{c||(u=e.subscribe(()=>{let x=e.getState();if(x.iiif.requests[r].loadingState===Qc){v();return}if(x.iiif.requests[r].loadingState===Vc){let E=Xc(x,r);E?f(E):v()}}))}),new Promise((f,v)=>setTimeout(()=>{c=!0,v()},i*60))]);if(u&&u(),p)return p}catch{u&&u();break}break}case Vc:{let u=Xc(o,r);if(u)return u;break}}e.dispatch(QI({id:r}));try{let u=await t(r,n);!u.id&&!u["@id"]&&(u["@type"]&&(u["@id"]=r),u.id=r);let c=ZI(r,u);return e.dispatch(Zc({actions:c})),Xc(e.getState(),r)}catch(u){throw e.dispatch(X0({id:r,message:u.toString()})),u}}}function YI(){return{Collection:{},Manifest:{},Canvas:{},AnnotationPage:{},AnnotationCollection:{},Annotation:{},ContentResource:{},Range:{},Service:{},Selector:{},Agent:{}}}var KI=(e={},t)=>{switch(t.type){case F0:return D(C({},e),{[t.payload.id]:t.payload.type});case B0:return C(C({},e),t.payload.mapping);default:return e}};function Yc(e,t,i,r){return!(!e[i]||!e[i][t]||!e[i][t][r]||!Array.isArray(e[i][t][r]))}function JI(e,t){let i={},r=[];for(let[n,o]of Object.entries(e||{})){r.push(n);let l=(t||{})[n];if(!l||l.length===0){i[n]=o;continue}i[n]=l}for(let[n,o]of Object.entries(t||{}))r.indexOf(n)===-1&&(i[n]=o);return i}var eO=(e=YI(),t)=>{var i;switch(t.type){case M0:{if(!e[t.payload.type]||!e[t.payload.type][t.payload.id])return e;let r=e[t.payload.type][t.payload.id];return typeof r=="string"?e:D(C({},e),{[t.payload.type]:D(C({},e[t.payload.type]),{[t.payload.id]:D(C({},r),{[t.payload.key]:t.payload.value})})})}case L0:{if(!Yc(e,t.payload.id,t.payload.type,t.payload.key))return e;let r=e[t.payload.type][t.payload.id];if(typeof r=="string")return e;let n=Array.from(r[t.payload.key]),[o]=n.splice(t.payload.startIndex,1);return n.splice(t.payload.endIndex,0,o),D(C({},e),{[t.payload.type]:D(C({},e[t.payload.type]),{[t.payload.id]:D(C({},r),{[t.payload.key]:n})})})}case R0:{let r=Object.keys(t.payload.entities),n=C({},e);for(let o of r){let l=t.payload.entities[o],u=C({},e[o]||{}),c=!1,p=Object.keys(l||{})||[];if(l&&p){for(let f of p)c=!0,u[f]=e[o][f]?JI(e[o][f],l[f]):l[f];c&&(n[o]=u)}}return n}case $0:{if(!Yc(e,t.payload.id,t.payload.type,t.payload.key))return e;let r=e[t.payload.type][t.payload.id],n=Array.from(r[t.payload.key]);return n.splice(t.payload.index||n.length+1,0,t.payload.reference),D(C({},e),{[t.payload.type]:D(C({},e[t.payload.type]),{[t.payload.id]:D(C({},r),{[t.payload.key]:n})})})}case N0:{if(!Yc(e,t.payload.id,t.payload.type,t.payload.key))return e;let r=e[t.payload.type][t.payload.id],n=Array.from(r[t.payload.key]),o=t.payload.index||n.findIndex(l=>l&&l.id===t.payload.reference.id);return o===-1||((i=n[o])==null?void 0:i.id)!==t.payload.reference.id?e:(n.splice(o,1),D(C({},e),{[t.payload.type]:D(C({},e[t.payload.type]),{[t.payload.id]:D(C({},r),{[t.payload.key]:n})})}))}default:return e}},tO=(e={},t)=>{switch(t.type){case q0:case Z0:return D(C({},e),{[t.payload.id]:{requestUri:t.payload.id,loadingState:H0,uriMismatch:!1,resourceUri:t.payload.id}});case V0:return D(C({},e),{[t.payload.requestId]:D(C({},e[t.payload.requestId]||{}),{uriMismatch:!0,resourceUri:t.payload.actualId}),[t.payload.actualId]:{requestUri:t.payload.requestId,loadingState:e[t.payload.requestId].loadingState,uriMismatch:!0,resourceUri:t.payload.actualId}});case Q0:return D(C({},e),{[t.payload.id]:D(C({},e[t.payload.id]||{}),{loadingState:Qc,error:t.payload.message})});case G0:return D(C({},e),{[t.payload.id]:D(C({},e[t.payload.id]||{}),{loadingState:Vc,error:void 0})})}return e},iO=(e={},t)=>{let{id:i,updateValue:r,value:n,meta:o,key:l}=t&&t.payload||{};switch(t.type){case j0:return D(C({},e),{[i]:D(C({},e[i]||{}),{[o]:D(C({},e[i]?e[i][o]||{}:{}),{[l]:n})})});case U0:return D(C({},e),{[i]:D(C({},e[i]||{}),{[o]:D(C({},e[i]?e[i][o]||{}:{}),{[l]:e[i]&&e[i][o]?r(e[i][o][l]):r(void 0)})})});case D0:return e[i]&&e[i][o]&&e[i][o][l]?D(C({},e),{[i]:D(C({},e[i]||{}),{[o]:D(C({},e[i]?e[i][o]||{}:{}),{[l]:void 0})})}):e;default:return e}};function rO(e){return(t,i)=>i&&i.type===Gc?i.payload.actions.reduce(e,t):i&&i.type===Y0?i.payload.state:e(t,i)}var nO=pl({mapping:KI,entities:eO,requests:tO,meta:iO}),sO=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Zn;function oO(e={}){let{enableDevtools:t=!0,iiifStoreName:i="iiif",defaultState:r={},extraMiddleware:n=[],customReducers:o={}}=e,l=pl(C({[i]:nO},o));return rc(rO(l),r,t?sO(fl(...n)):Zn(fl(...n)))}function aO(e){return{all:e=e||new Map,on:function(t,i){var r=e.get(t);r?r.push(i):e.set(t,[i])},off:function(t,i){var r=e.get(t);r&&(i?r.splice(r.indexOf(i)>>>0,1):e.set(t,[]))},emit:function(t,i){var r=e.get(t);r&&r.slice().map(function(n){n(i)}),(r=e.get("*"))&&r.slice().map(function(n){n(t,i)})}}}var lO=class{constructor(e,t){Ze(this,"options"),Ze(this,"store"),Ze(this,"emitter"),Ze(this,"isBatching",!1),Ze(this,"batchQueue",[]),Ze(this,"remoteFetcher"),Ze(this,"staticFetcher"),Ze(this,"defaultFetcher",i=>fetch(i).then(r=>r.json())),Ze(this,"middleware",i=>r=>n=>{if(n.type===Gc){for(let u of n.payload.actions)this.emitter.emit(u.type,{realAction:u,state:i.getState()});let l=r(n);for(let u of n.payload.actions)this.emitter.emit(`after:${n.type}`,{action:n,state:l});return l}this.emitter.emit(n.type,{action:n,state:i.getState()});let o=r(n);return this.emitter.emit(`after:${n.type}`,{action:n,state:o}),o}),this.options=Object.assign({reducers:{},middleware:[],defaultState:{},customFetcher:this.defaultFetcher,enableDevtools:!0},e||{}),this.store=t||oO({customReducers:this.options.reducers,extraMiddleware:[...this.options.middleware,this.middleware],defaultState:this.options.defaultState,enableDevtools:this.options.enableDevtools}),this.emitter=aO(),this.remoteFetcher=eb(this.store,this.options.customFetcher),this.staticFetcher=eb(this.store,(i,r)=>r)}batch(e){this.isBatching=!0;try{e(this),this.store.dispatch(Zc({actions:this.batchQueue}))}catch(t){throw this.batchQueue=[],this.isBatching=!1,t}this.batchQueue=[],this.isBatching=!1}async asyncBatch(e){this.isBatching=!0;try{await e(this),this.store.dispatch(Zc({actions:this.batchQueue}))}catch(t){throw this.batchQueue=[],this.isBatching=!1,t}this.batchQueue=[],this.isBatching=!1}modifyEntityField(e,t,i){this.dispatch(jI.modifyEntityField({id:e.id,type:e.type,key:t,value:i}))}dispatch(e){this.isBatching?this.batchQueue.push(e):this.store.dispatch(e)}serialize(e,t){return Om(this.getState().iiif,e,t)}toPresentation2(e){return this.serialize(e,Mm)}toPresentation3(e){return this.serialize(e,Nm)}hydrate(e,t){return this.get(e,t,{skipSelfReturn:!1})}get(e,t,i={}){typeof t!="string"&&(i=t||{},t=void 0);let{skipSelfReturn:r=!0}=i||{};if(Array.isArray(e))return e.map(c=>this.get(c,i));let n=this.getState();if(typeof e=="string"){let c=t||n.iiif.mapping[e];if(!c)return r?null:{id:e,type:"unknown"};e={id:e,type:c}}let o=t||e.type,l=e.id,u=n.iiif.entities[o];if(!u){let c=n.iiif.requests[l];return c&&c.resourceUri!==l?this.get(c.resourceUri,i):r?null:e}return u[e.id]||(r?null:e)}select(e){return e(this.getState())}getStore(){return this.store}getState(){return this.store.getState()}loadManifest(e,t){let i=typeof e=="string"?e:e.id;return this.load(i,t)}loadCollection(e,t){let i=typeof e=="string"?e:e.id;return this.load(i,t)}load(e,t){let i=typeof e=="string"?e:e.id;return t?this.staticFetcher(i,t):this.remoteFetcher(i)}areInputsEqual(e,t){return J0(e,t)}subscribe(e,t,i){typeof i>"u"&&(typeof t>"u"||t===!1||t===!0)&&(i=t,t=e,e=n=>n);let r=i?null:e(this.store.getState());return i||t(r,this),this.store.subscribe(()=>{let n=this.store.getState(),o=e(n);r!==o&&!J0(r,o)&&t(o,this),r=o})}async ensureLoaded(e){let t=typeof e=="string"?e:e.id;this.requestStatus(t)||await this.load(t)}requestStatus(e){return this.select(t=>t.iiif.requests[e])}getResourceMeta(e,t){let i=this.getState().iiif.meta[e];if(i)return t?i[t]:i}setMetaValue([e,t,i],r){this.dispatch(typeof r=="function"?W0.setMetaValueDynamic({id:e,meta:t,key:i,updateValue:r}):W0.setMetaValue({id:e,meta:t,key:i,value:r}))}};function uO(){return typeof self<"u"?self:typeof window<"u"?window:typeof Xu<"u"?Xu:{}}function Kc(e){let t=uO();try{let r=t.IIIF_VAULT;if(r)return r}catch{}let i=new lO(e);try{t.IIIF_VAULT=i}catch{}return i}var ss=hO();function hO(e){let t={},i=(n,o)=>{var l;return t[n]===void 0&&(t[n]=[]),(l=t[n])==null||l.push(o),()=>{r(n,o)}},r=(n,o)=>{var l,u,c;let p=(u=(l=t[n])==null?void 0:l.indexOf(o))!=null?u:-1;(c=t[n])==null||c.splice(p>>>0,1)};return{on:i,off:r,once:(n,o)=>{let l=u=>{o(u),r(n,l)};i(n,l)},emit:(n,o)=>{var l;(l=t[n])==null||l.forEach(u=>{try{u(o)}catch(c){e==null||e.onError(c)}})}}}function Jl(e){let t=we(),i=.75,r=1/.75,n=Sl(),o=e.vault||n||Kc(),l=Ec(),u=we({}),{isReady:c,isConfigBlocking:p,setIsReady:f,internalConfig:v}=sC(e.preset,(be,Ue)=>{t.current?t.current.dispatchEvent(new CustomEvent("media",{detail:{query:be,config:Ue}})):u.current[be]=Ue}),x=Ae(()=>Fc(o),[o]),E=Ae(()=>Bc(o),[o]),_=Ae(()=>uI(o,{imageServiceLoader:l}),[o,l]),[P]=We(e.nested||v.nested,{parse:gt,defaultValue:!1}),[O]=We(e.x||v.x,{parse:Tr,defaultValue:0}),[I]=We(e.y||v.y,{parse:Tr,defaultValue:0}),A=we(),[$]=We(e.render||v.render,{defaultValue:"canvas"}),[z]=We(e.class),[B]=We(e.virtualSizes||v.virtualSizes,{parse:hT}),[H]=We(e.height||v.height,{parse:Tr}),[Y]=We(e.width||v.width,{parse:Tr}),[V]=We(e.a11yRole||void 0),[he]=We(e.a11yTitle||void 0),[Q]=We(e.interactive||v.interactive,{parse:gt,defaultValue:!0}),[ue]=We(e.background),[pe]=We(e.viewport||v.viewport,{parse:gt,defaultValue:!0}),[ge]=We(e.responsive||v.responsive,{parse:gt,defaultValue:!0}),[oe]=We(e.moveEvents||v.moveEvents,{parse:gt,defaultValue:!1}),[Se]=We(e.granularMoveEvents||v.granularMoveEvents,{parse:gt,defaultValue:!1}),[Pe]=We(e.clickToEnableZoom||e.clickToEnableZoom,{parse:gt,defaultValue:!0}),[Ke]=We(e.disableKeyboardNavigation||v.disableKeyboardNavigation,{parse:gt,defaultValue:!1}),[re]=We(e.debug||v.debug,{parse:gt}),[Ie]=We(e.enablePanOnWait||v.enablePanOnWait,{parse:gt,defaultValue:void 0}),[Ne]=We(e.ignoreSingleFingerTouch||v.ignoreSingleFingerTouch,{parse:gt,defaultValue:void 0}),[J]=We(e.requireMetaKeyForWheelZoom||v.requireMetaKeyForWheelZoom,{parse:gt,defaultValue:!1}),[Oe]=We(e.panOnWaitDelay||v.panOnWaitDelay,{parse:Tr,defaultValue:40}),[mt]=We(e.enableNavigator||v.enableNavigator,{parse:gt}),[rt,ti,kt,li]=We(e.target||e.region||v.target||v.region,{parse:zc}),[Tt,Mt,,ui]=We(e.rotation,{parse:Tr}),[Zt,wt,,ke]=We(e.highlight||v.highlight,{parse:zc}),[Te]=We(e.styleId||v.styleId),[ot]=We(e.highlightCssClass||v.highlightCssClass,{defaultValue:"canvas-panel-highlight"}),[ii,,,Xe]=We(e.preferredFormats||v.preferredFormats,{parse:Gv}),[Ye]=We(e.homeCover,{parse:be=>be==="false"?!1:be==="true"?!0:be==="start"?"start":be==="end"?"end":!1}),[ht,jt]=We(e.atlasMode||v.atlasMode),[hi,Zr]=Be(""),[os,rd]=Be(""),[as]=We(e.stylesheet||v.stylesheet),Di=we({}),[iu,nd]=Be("");function sd(be,Ue={}){return We(e[be]||v[be],Ue)}function Jo(){if(t.current&&A.current){let be=t.current.getBoundingClientRect(),Ue=A.current.world.height||1,xt=A.current.world.width||1;return xt/Ue<1?be.height/Ue:be.width/xt}return-1}let Xs=we({});de(()=>{let be=ss.on("onResetSeen",()=>{Xs.current={}}),Ue=Ut=>{let It=Ut.choice;if(t!=null&&t.current&&It&&It.items){let ie=It.items;ie.sort((_t,ft)=>_t.id<ft.id?-1:_t.id>ft.id?1:0);let $e=ie.map(_t=>_t.id).join(""),at=ie.map(_t=>_t.selected).join("");if(Xs.current[$e]&&Xs.current[$e]==at)return;Xs.current[$e]=at,It.partOf=Ut.partOf,t.current.dispatchEvent(new CustomEvent("choice",{detail:{choice:It}}))}},xt=ss.on("onChoiceChange",Ue);return()=>{be(),xt()}},[]),de(()=>{if(A.current&&t.current){let be=C({},ea(A.current));hi=="queued"&&be&&(be==null?void 0:be.scaleFactor)<1&&be.scaleFactor>0&&t.current!=null&&(Zr("fired"),setTimeout(()=>{var Ue;(Ue=t.current)==null||Ue.dispatchEvent(new CustomEvent("world-ready",{detail:be}))},100))}},[c,t.current,iu,hi]),de(()=>{var be;let Ue=A.current,xt=(be=A.current)==null?void 0:be.transitionManager;if(Ue&&xt&&c){let Ut=!1,It=0;return Ue.world.addLayoutSubscriber(async(ie,$e)=>{if(ie!=="repaint"&&t.current){if(["recalculate-world-size","zoom-to","go-home","goto-region"].includes(ie)){if(ie=="recalculate-world-size"&&Zr("queued"),xt.hasPending()){if(Ut)return;Ut=!0,await new Promise(od=>setTimeout(od,xt.pendingTransition.total_time-xt.pendingTransition.elapsed_time)),Ut=!1}let at=Jo(),_t=Math.abs(at-Ue._lastGoodScale)<2e-4;_t?It++:It=0;let ft={detail:C(D(C({source:ie,minZoomCount:It},ea(Ue)),{isMin:_t,isMax:Math.abs(Ue.maxScaleFactor-Ue._lastGoodScale)<2e-4}),$e||{})};t.current.dispatchEvent(new CustomEvent("zoom",ft));return}t.current.dispatchEvent(new CustomEvent(ie,{detail:$e}))}})}return()=>{}},[c,iu]);function ea(be){let Ue=be._lastGoodScale,xt=Jo(),Ut=be.getZoomedPosition(r,{}),It=be.getZoomedPosition(i,{}),ie={width:Math.round(It[3]),height:Math.round(It[4])},$e={width:Math.round(Ut[3]),height:Math.round(Ut[4])},at={width:Math.round(be.target[3]),height:Math.round(be.target[4])},_t=2,ft=at.height+_t<$e.height&&at.width+_t<$e.width;return{canZoomIn:at.height>ie.height&&at.width>ie.width,canZoomOut:ft,scaleFactor:be.getScaleFactor(),current:Ue,max:be.maxScaleFactor,min:xt,worldHeight:be.world.height,worldWidth:be.world.width}}de(()=>{var be;let Ue=A.current,xt=(be=A.current)==null?void 0:be.transitionManager;if(c&&Ue&&oe){let Ut=-1,It=-1,ie=!1;return Ue.registerHook("useAfterFrame",async()=>{if(t.current&&(Ue.target[1]!==Ut||Ue.target[2]!==It)){if(!Se&&xt){if(ie)return;xt.hasPending()&&(ie=!0,await new Promise($e=>setTimeout($e,xt.pendingTransition.total_time-xt.pendingTransition.elapsed_time)),ie=!1)}t.current.dispatchEvent(new CustomEvent("move",{detail:{x:Ue.x,y:Ue.y,width:Ue.width,height:Ue.height,points:Ue.target,lastX:Ut,lastY:It}})),Ut=Ue.x,It=Ue.y}})}return()=>{}},[c,oe]);function ru(be){At(()=>{e.__registerPublicApi&&e.__registerPublicApi(be)},[])}return ru(be=>{t.current=be;let Ue,xt,Ut=!1;if(Pe){Ue=$e=>{$e.stopPropagation()};let ie=()=>{Ue&&!Ut&&(Ut=!0,be.addEventListener("wheel",Ue,{capture:!0}),be.addEventListener("touchstart",Ue,{capture:!0}))};xt=()=>{Ue&&Ut&&(Ut=!1,be.removeEventListener("wheel",Ue,{capture:!0}),be.removeEventListener("touchstart",Ue,{capture:!0}))},ie(),document.addEventListener("click",$e=>{document.activeElement!==be&&ie()})}be.addEventListener("click",ie=>{xt&&xt();let $e=ie.composedPath()[0];$e&&be!==document.activeElement&&$e.focus()});let It=Object.keys(u.current);if(It.length){for(let ie of It)be.dispatchEvent(new CustomEvent("media",{detail:{query:ie,config:u.current[ie]}}));u.current={}}return{vault:o,events:x,styles:E,thumbnailHelper:_,imageServiceLoader:l,getRotation:()=>ui.current,setRotation:ie=>{be.setAttribute("rotation",ie.toString())},getHighlight:()=>ke.current,setHighlight:ie=>{typeof ie=="string"?be.setAttribute("highlight",ie):wt(ie)},getTarget:()=>li.current,setTarget:ie=>{typeof ie=="string"?be.setAttribute("target",ie):ti(ie)},setDefaultChoiceIds:ie=>{be.setAttribute("choice-id",ie.join(","))},getPosition(){var ie,$e,at,_t;return{x:(ie=A.current)==null?void 0:ie.x,y:($e=A.current)==null?void 0:$e.y,width:(at=A.current)==null?void 0:at.width,height:(_t=A.current)==null?void 0:_t.height}},getMaxZoom(){var ie;return((ie=A.current)==null?void 0:ie.maxScaleFactor)||1},getMinZoom(){return Jo()||0},makeChoice(ie,$e){ss.emit("onMakeChoice",{id:ie,options:$e})},zoomIn(ie){A.current&&A.current.world.trigger("zoom-to",{point:ie,factor:i})},zoomOut(ie){A.current&&A.current.world.trigger("zoom-to",{point:ie,factor:r})},zoomBy(ie,$e){A.current&&A.current.world.trigger("zoom-to",{point:$e,factor:ie})},zoomTo(ie,$e,at){A.current&&A.current.world.zoomTo(ie,$e,at)},withAtlas(ie){A.current?ie(A.current):Di.current=D(C({},Di.current),{[new Date().getTime()]:$e=>ie($e)})},goHome(ie=!1){A.current?A.current.world.goHome(ie):Di.current=D(C({},Di.current),{viewport:$e=>$e.world.goHome(ie)})},getZoom(){var ie;return(ie=A.current)==null?void 0:ie._lastGoodScale},getScaleInformation(){let ie=A.current;if(ie!=null)return C({},ea(ie))},goToTarget(ie,$e={}){A.current?A.current.world.gotoRegion(C(C({},ie),$e)):Di.current=D(C({},Di.current),{viewport:at=>{at.world.gotoRegion(C(C({},ie),$e))}})},setFps(ie){A.current?A.current.fpsLimit=ie:Di.current=D(C({},Di.current),{setFps:$e=>{$e.fpsLimit=ie}})},clearTarget(){ti(void 0),A.current?A.current.world.goHome(!0):Di.current=D(C({},Di.current),{viewport:ie=>{ie.world.goHome(!0)}})},setPreferredFormats(ie){be.setAttribute("preferred-formats",ie.join(","))},getPreferredFormats(){return Xe.current||[]},setMode(ie){be.setAttribute("atlas-mode",ie)},applyStyles(ie,$e){E.applyStyles(typeof ie=="string"?{id:ie}:ie,"atlas",$e)},applyHTMLProperties(ie,$e){E.applyStyles(typeof ie=="string"?{id:ie}:ie,"html",$e)},setClassName(ie,$e){E.applyStyles(typeof ie=="string"?{id:ie}:ie,"html",{className:$e})},createAnnotationDisplay(ie){return new $I(ie)},getThumbnail(ie,$e,at){return _.getBestThumbnailAtSize(ie,$e,at)},addVaultEventListener(ie,$e,at,_t){return x.addEventListener(ie,$e,at,_t)},removeVaultEventListener(ie,$e,at){x.removeEventListener(ie,$e,at)},getListenersAsProps(ie,$e){return x.getListenersAsProps(ie,$e)}}}),de(()=>{if(A.current){let be=Object.values(Di.current);for(let Ue of be)Ue(A.current);Di.current={}}},[c]),At(()=>{if(Te){let be=document.getElementById(Te);be&&rd(be.innerText)}},[c,Te]),At(()=>{if(t.current&&!Ke){let be=xt=>{var Ut,It,ie;if(A.current&&A.current.transitionManager){let $e=A.current.transitionManager,at=$e.pendingTransition.done?A.current.target:$e.pendingTransition.to,_t=Math.min(at[3]-at[1],at[4]-at[2])*.1,ft;switch(xt.key){case"=":{(Ut=A.current.world)==null||Ut.zoomIn();return}case"-":{(It=A.current.world)==null||It.zoomOut();return}case"0":{(ie=A.current.world)==null||ie.goHome();return}case"ArrowRight":{xt.preventDefault(),ft=at.slice(0),ft[1]=ft[1]+_t,ft[3]=ft[3]+_t;break}case"ArrowLeft":{xt.preventDefault(),ft=at.slice(0),ft[1]=ft[1]-_t,ft[3]=ft[3]-_t;break}case"ArrowUp":{xt.preventDefault(),ft=at.slice(0),ft[2]=ft[2]-_t,ft[4]=ft[4]-_t;break}case"ArrowDown":{xt.preventDefault(),ft=at.slice(0),ft[2]=ft[2]+_t,ft[4]=ft[4]+_t;break}}ft&&$e.applyTransition(ft,{duration:500,easing:Cr.easeOutExpo,constrain:!0})}},Ue=t.current;return Ue.addEventListener("keydown",be),()=>{Ue.removeEventListener("keydown",be)}}return()=>{}},[Ke]),{atlasProps:Ae(()=>({children:null,nested:P,responsive:ge,viewport:pe,enableNavigator:mt,onCreated:be=>{Zr(""),f(!0),nd(be.runtime.id),A.current=be.runtime},homePosition:rt&&rt.selector&&rt.selector.type==="BoxSelector"?rt.selector.spatial:void 0,renderPreset:$==="static"?["static-preset",{interactive:Q}]:["default-preset",{interactive:Q,unstable_webglRenderer:$==="webgl",controllerConfig:{ignoreSingleFingerTouch:Ne,enablePanOnWait:Ie,requireMetaKeyForWheelZoom:J,panOnWaitDelay:Oe}}],width:Y||void 0,height:H||(ge?void 0:512),role:V,title:he}),[ge,pe,rt,$,mt,v,V,he]),background:ue,isReady:c,isConfigBlocking:p,setIsReady:f,internalConfig:v,target:rt,setParsedTarget:kt,highlight:Zt,highlightCssClass:ot,preferredFormats:ii,render:$,interactive:Q,mode:ht,setMode:jt,virtualSizes:B,styleId:Te,responsive:ge,viewport:pe,debug:re,enableNavigator:mt,height:H,width:Y,className:z,inlineStyles:os,inlineStyleSheet:as,vault:o,nested:P,x:O,y:I,rotation:Tt,homeCover:Ye,useProp:sd,useRegisterWebComponentApi:ru,runtime:A,webComponent:t}}et(),fe();var Jc=si(!1);function cO(e){let t=Gl();return de(()=>{t&&e.onCreated(t)},[t]),null}function ed(e){var t=e,{children:i,onCreated:r,responsive:n,viewport:o,nested:l}=t,u=le(t,["children","onCreated","responsive","viewport","nested"]);let[c,p]=Be(!1),f=Kt(Jc);return l||f?N(it,null,r?N(cO,{onCreated:r}):null,i):N(Jc.Provider,{value:!0},N(JC,D(C({},u),{onCreated:v=>{if(p(!0),r)return v.runtime.updateNextFrame(),r(v)},unstable_noReconciler:!0}),N(Jc.Provider,{value:!0},c?i:null)))}et();function tb(e){var t=e,{children:i}=t,r=le(t,["children"]);let n=Sl(),{setIsReady:o,atlasProps:l,isReady:u,className:c}=Jl(r);return N(dn,{vault:n},N(ed,C({onCreated:()=>{o(!0)},viewport:!0,className:c||""},l),u?N("slot",null,i):null))}if(typeof window<"u"){let e={shadow:!0,onConstruct(t){t._props={__registerPublicApi:i=>{Object.assign(t,i(t))}}}};Ln(tb,"atlas-viewer",[],e),Ln(tb,"layout-container",[],e)}et(),fe(),et(),fe();var ib=()=>()=>({}),td=si(ib);function Yo(e,t){let i=we(),r=Kt(td)||ib;i.current!==t&&r(e),i.current=t}et();var dO=je(gf());fe(),et(),et(),fe();var rb=si(null);function bn({displayName:e,component:t,customConstructor:i}){let r=mi(function(n,o){var l=n,{children:u}=l,c=le(l,["children"]);let[p,f]=Be(),v=Gl(),x=Kt(rb),E=we(c);return de(()=>(v&&v.runtime&&f(i?i(c):new t),()=>{}),[]),de(()=>{if(v&&v.runtime&&p){let _=v.runtime,P=v.runtime.world,O=x||P;O.appendChild(p),o&&(typeof o=="function"?o(p):o.current=p),p instanceof is&&(_.world=p),p instanceof jo||(_.pendingUpdate=!0,_.world&&_.world.needsRecalculate&&(_.world.recalculateWorldSize(),_.world.triggerRepaint()));let I=O,A=p;return()=>{A&&(I.removeChild(A),_.pendingUpdate=!0,_.world&&_.world.needsRecalculate&&(_.world.recalculateWorldSize(),_.world.triggerRepaint()))}}return()=>{}},[p,v==null?void 0:v.runtime]),de(()=>{p&&v&&v.runtime&&(Rc(v.runtime.world,c),Oc(p,E.current,c),E.current=c,v.runtime.pendingUpdate=!0,v.runtime.world&&(v.runtime.world.needsRecalculate=!0,v.runtime.world.needsRecalculate&&(v.runtime.world.recalculateWorldSize(),v.runtime.world.triggerRepaint())))},[p,c]),p?N(rb.Provider,{value:p},u):null});return r.displayName=e,bh(r)}et(),fe();var pO=e=>{var t=e,{height:i,tiles:r,width:n,x:o,y:l,style:u,skipSizes:c=!1,skipThumbnail:p=!1,rotation:f=0,viewport:v,tileFormat:x,children:E}=t,_=le(t,["height","tiles","width","x","y","style","skipSizes","skipThumbnail","rotation","viewport","tileFormat","children"]);let P=n/r.width,O=r.imageService.tiles||[],I=r.imageService.sizes||[],A=r.imageService.id||r.imageService["@id"],$=Ae(()=>{let B=A;return B&&B.endsWith("/info.json")?B.slice(0,-1*10):B},[A]),z=u&&typeof u.opacity<"u"&&u.opacity!==1;return N(Zs,C({key:$,scale:P,height:r.height,width:r.width,x:o,rotation:f,y:l},_),N(fO,{key:"composite-"+$,id:$,width:r.width,height:r.height,renderOptions:z?{renderLayers:1,renderSmallestFallback:!1}:v?{renderLayers:1,renderSmallestFallback:!0}:{renderLayers:2,renderSmallestFallback:!0}},E,r.thumbnail&&!z&&!p?N(Ko,{uri:r.thumbnail.id,target:{width:r.width,height:r.height},display:{width:r.thumbnail.width,height:r.thumbnail.height},style:u}):null,c?null:I.map((B,H)=>{let{prefix:Y,server:V,scheme:he,path:Q}=Ny($);return N(Ko,{key:H,uri:Dy({scheme:he,server:V,prefix:Y,identifier:Q,originalPath:"",type:"image",region:{full:!0},size:{max:!1,upscaled:!1,confined:!1,width:B.width,height:B.height},rotation:{angle:0,mirror:!1},format:"jpg",quality:"default"},r.imageService),target:{width:r.width,height:r.height},display:{width:B.width,height:B.height},style:u})}),O.map(B=>(B.scaleFactors||[]).map(H=>N(gO,{key:`${B}-${H}`,uri:$,display:{width:r.width,height:r.height},tile:B,scaleFactor:H,style:u,format:x})))))};bn({displayName:"Atlas.World",component:is,customConstructor:e=>new is(e.width,e.height)});var Zs=bn({displayName:"Atlas.WorldObject",component:jo}),nb=bn({displayName:"Atlas.Box",component:qs}),Ko=bn({displayName:"Atlas.SingleImage",component:Gr});bn({displayName:"Atlas.ImageTexture",component:Tl});var fO=bn({displayName:"Atlas.CompositeResource",component:Tc,customConstructor:e=>new Tc({id:e.id,width:e.width,height:e.height,images:[],renderOptions:e.renderOptions})}),gO=bn({displayName:"Atlas.TiledImage",component:ts,customConstructor:e=>ts.fromTile(e.uri,e.display,e.tile,e.scaleFactor,void 0,e.format)});bn({displayName:"Atlas.Text",component:Uo}),et(),fe(),et(),fe(),fe(),fe(),et(),fe();var id=mi((e,t)=>{var i=e,{children:r}=i,n=le(i,["children"]);let o=we(),l=vn(),u=we(0),c=we(),[p,f]=ks(v=>v+1,0);return $c(()=>{if(n.relative){let v=o.current;if(v&&l){let x=l.getScaleFactor();u.current!==x&&(u.current=x,v.style.transformOrigin="0 0",v.style.transform=`scale(${1/u.current})`,v.style.width=`${u.current*100}%`,v.style.height=`${u.current*100}%`)}}},[n.relative]),At(()=>{let v=c.current;if(!v){let x=setTimeout(f,100);return()=>{clearTimeout(x)}}return t&&v&&(typeof t=="function"?t(v):t.current=v),v&&v.__host?n.relative?Cs(N("div",{ref:o},r),v.__host.element):Cs(r,v.__host.element):v&&(v.__onCreate=()=>{n.relative?Cs(N("div",{ref:o},r),v.__host.element):Cs(r,v.__host.element)}),()=>{}},[p,t,r,c,n.relative]),N(nb,C({html:!0,ref:c},n))});et();var mO=e=>{var t=e,{handleSize:i=9,resizable:r,onSave:n,children:o}=t,l=le(t,["handleSize","resizable","onSave","children"]);let{portalRef:u,mode:c,mouseEvent:p,isEditing:f}=nT({x:l.x||0,y:l.y||0,width:l.width,height:l.height},n),v=Ae(()=>p("translate"),[p]),x=Ae(()=>p("east"),[p]),E=Ae(()=>p("west"),[p]),_=Ae(()=>p("south"),[p]),P=Ae(()=>p("north"),[p]),O=Ae(()=>p("south-east"),[p]),I=Ae(()=>p("south-west"),[p]),A=Ae(()=>p("north-east"),[p]),$=Ae(()=>p("north-west"),[p]);return N(it,null,N(Zs,C({},l),o,N(id,{ref:u,target:{x:0,y:0,height:l.height,width:l.width},relative:!0,interactive:!1},c==="sketch"&&r?N(it,null,N("div",{onMouseDown:v,onTouchStart:v,style:{display:"block",width:"100%",height:"100%",border:"1px dashed #999",boxSizing:"border-box",pointerEvents:f?"none":c==="sketch"?"initial":"none"}}),N("div",{title:"east",onTouchStart:x,onMouseDown:x,style:{cursor:"e-resize",position:"absolute",background:"#fff",height:i*2,width:i,right:0,top:"50%",transform:`translate(${i/2}px, -${i}px)`,zIndex:999,boxShadow:"0px 2px 3px 0 rgba(0,0,0,0.5)",border:"1px solid #999",pointerEvents:f?"none":c==="sketch"?"initial":"none"}}),N("div",{title:"west",onMouseDown:E,style:{cursor:"w-resize",position:"absolute",background:"#fff",height:i*2,width:i,left:0,top:"50%",transform:`translate(-${i/2}px, -${i}px)`,zIndex:999,boxShadow:"0px 2px 3px 0 rgba(0,0,0,0.5)",border:"1px solid #999",pointerEvents:f?"none":c==="sketch"?"initial":"none"}}),N("div",{title:"north",onMouseDown:P,style:{cursor:"n-resize",position:"absolute",background:"#fff",height:i,width:i*2,left:"50%",top:0,transform:`translate(-${i}px, -${i/2}px)`,zIndex:999,boxShadow:"0px 2px 3px 0 rgba(0,0,0,0.5)",border:"1px solid rgba(0,0,0,.5)",pointerEvents:f?"none":c==="sketch"?"initial":"none"}}),N("div",{title:"south",onMouseDown:_,style:{cursor:"s-resize",position:"absolute",background:"#fff",height:i,width:i*2,left:"50%",bottom:0,transform:`translate(-${i}px, ${i/2}px)`,zIndex:999,boxShadow:"0px 2px 3px 0 rgba(0,0,0,0.5)",border:"1px solid #999",pointerEvents:f?"none":c==="sketch"?"initial":"none"}}),N("div",{title:"north-east",onMouseDown:A,style:{cursor:"ne-resize",position:"absolute",background:"#fff",height:i,width:i,right:0,top:0,transform:`translate(${i/2}px, -${i/2}px)`,zIndex:999,boxShadow:"0px 2px 3px 0 rgba(0,0,0,0.5)",border:"1px solid #999",pointerEvents:f?"none":c==="sketch"?"initial":"none"}}),N("div",{title:"south-east",onMouseDown:O,style:{cursor:"se-resize",position:"absolute",background:"#fff",height:i,width:i,bottom:0,right:0,transform:`translate(${i/2}px, ${i/2}px)`,zIndex:999,boxShadow:"0px 2px 3px 0 rgba(0,0,0,0.5)",border:"1px solid #999",pointerEvents:f?"none":c==="sketch"?"initial":"none"}}),N("div",{title:"south-west",onMouseDown:I,style:{cursor:"sw-resize",position:"absolute",background:"#fff",height:i,width:i,bottom:0,left:0,transform:`translate(-${i/2}px, ${i/2}px)`,zIndex:999,boxShadow:"0px 2px 3px 0 rgba(0,0,0,0.5)",border:"1px solid #999",pointerEvents:f?"none":c==="sketch"?"initial":"none"}}),N("div",{title:"north-west",onMouseDown:$,style:{cursor:"nw-resize",position:"absolute",background:"#fff",height:i,width:i,top:0,left:0,transform:`translate(-${i/2}px, -${i/2}px)`,zIndex:999,boxShadow:"0px 2px 3px 0 rgba(0,0,0,0.5)",border:"1px solid #999",pointerEvents:f?"none":c==="sketch"?"initial":"none"}})):null)))};et();var eu=e=>{var t=e,{children:i,interactive:r,region:n,onClick:o,onSave:l,isEditing:u,className:c,style:p}=t,f=le(t,["children","interactive","region","onClick","onSave","isEditing","className","style"]);let v=Ic(),x=He(E=>{l&&l(C({id:n.id,x:n.x,y:n.y,height:n.height,width:n.width},E))},[l,n.id,n.x,n.y,n.height,n.width]);return N(mO,{x:n.x,y:n.y,width:n.width,height:n.height,resizable:u,onSave:x,onClick:v==="explore"&&o?E=>{o(n)}:()=>{}},N(nb,C({html:!0,className:c,interactive:!0,relativeStyle:!0,target:{x:0,y:0,width:n.width,height:n.height},style:p},f)),i)};et(),fe(),et();function sb({annotationId:e,interactive:t,relative:i}){var r;let n=xc({id:e}),o={fill:"rgba(0,0,0,0)"},l={fill:"rgba(0,0,0,0)"};if(!((r=n==null?void 0:n.motivation)!=null&&r.includes("supplementing"))||!n.body)return null;let u=(Array.isArray(n.body)?n.body:[n.body]).filter(p=>p.type==="TextualBody"),c=n.target.selector;return c?N(it,null,N("rect",{x:i?0:c.spatial.x,y:i?0:c.spatial.y,width:c.spatial.width,height:c.spatial.height,style:l}),N("text",{x:i?0:c.spatial.x,y:(i?0:c.spatial.y)+c.spatial.height*.75,textLength:c.spatial.width,fontSize:`${c.spatial.height}px`,lengthAdjust:"spacingAndGlyphs",className:"text-line-segment",part:"text-line-segment",style:D(C({},o),{pointerEvents:t?"initial":void 0})},u[0].value||"")):null}function yO({annotation:e,textSelectionEnabled:t}){var i;let r=Qt();return!((i=e==null?void 0:e.motivation)!=null&&i.includes("supplementing"))||!e.body?null:N(id,{target:D(C({},e.target.selector.spatial),{x:0,y:0}),interactive:t},N(dn,{vault:r},N("svg",{height:e.target.selector.spatial.height,width:e.target.selector.spatial.width,style:{userSelect:t?"text":void 0}},N(sb,{annotationId:e.id,interactive:t,relative:!0}))))}var vO=({id:e,style:t,className:i,interactive:r,textSelectionEnabled:n})=>{let o=xc({id:e}),l=es(o,"atlas"),u=es(o,"html"),c=xl(o,["atlas"]),p=fn(),f=Ae(()=>Vv(t,l),[t,l]);return p&&o&&o.target&&o.target.selector&&o.target.selector.type==="BoxSelector"&&o.target.source&&o.target.source.id===p.id?N(eu,C({id:o.id,isEditing:!0,region:o.target.selector.spatial,style:f,className:(u==null?void 0:u.className)||i,interactive:!!(u!=null&&u.href||r),href:(u==null?void 0:u.href)||null,title:(u==null?void 0:u.title)||null,hrefTarget:(u==null?void 0:u.target)||null},c),N(yO,{annotation:o,textSelectionEnabled:n})):null},ob=({className:e,page:t,textSelectionEnabled:i})=>{var r;let n=es(t,"atlas"),o=es(t,"html");return Ti(l=>t.id?l.iiif.entities.AnnotationPage[t.id]:null,[]),N(it,null,(r=t.items)==null?void 0:r.map(l=>N(vO,{key:l.id,id:l.id,style:n,className:(o==null?void 0:o.className)||e,textSelectionEnabled:i})))};et(),fe();function bO(){let e=vn(),[t,i]=Be(),[r,n]=Be();return $c(()=>{e&&(!t||e.focalPosition[1]!==t[1]||e.focalPosition[2]!==t[2]||e.focalPosition[3]!==t[3]||e.focalPosition[4]!==t[4])&&i(new Float32Array(e.focalPosition)),e&&(!r||e.homePosition[1]!==r[1]||e.homePosition[2]!==r[2]||e.homePosition[3]!==r[3]||e.homePosition[4]!==r[4])&&n(new Float32Array(e.homePosition))},[t,r]),N(it,null,t?N(eu,{id:"focal",onClick:()=>{},onSave:()=>{},isEditing:!1,className:"test",region:{id:"focal",x:t[1],y:t[2],width:t[3]-t[1],height:t[4]-t[2]},style:{backgroundColor:"rgba(0, 0, 244, 0.5)"}}):null,r?N(eu,{id:"home",onClick:()=>{},onSave:()=>{},isEditing:!1,className:"test",region:{id:"home",x:r[1],y:r[2],width:r[3]-r[1],height:r[4]-r[2]},style:{backgroundColor:"rgba(0, 200, 0, 0.5)"}}):null)}fe(),et();function wO(e,t){let i=cn(e.id||e["@id"]||"").slice(0,-10);return!i||t.percentScale||!t.width||t.confined||!e.height||!e.width?[null,{height:0,width:0}]:[[i,"full",sT(t),"0","default.jpg"].join("/"),{width:t.width||1,height:t.confined?e.height/e.width*t.width:t.height||e.height/e.width*t.width}]}fe(),fe();function ab({id:e,image:t,thumbnail:i,isStatic:r,virtualSizes:n=[],x:o=0,y:l=0,rotation:u=0,annotations:c,tileFormat:p,skipSizes:f,annotationId:v,skipThumbnail:x}){var E,_,P,O;let I=es(v?{id:v,type:"Annotation"}:void 0,"atlas"),A=es({id:e,type:"ContentResource"},"atlas"),$=Ae(()=>C(C({},I),A),[I,A]),z=xl(v?{id:v,type:"Annotation"}:void 0,["atlas"]),B=xl({id:e,type:"ContentResource"},["atlas"]);return N(te.Fragment,null,t.service?N(it,{key:"service"},N(pO,C(C({viewport:r,tiles:{id:t.service.id,height:t.height!==t.service.height?t.service.height:t.height,width:t.width!==t.service.width?t.service.width:t.width,imageService:t.service,thumbnail:!x&&i&&i.type==="fixed"?i:void 0},skipSizes:f,skipThumbnail:x,x:((E=t.target)==null?void 0:E.spatial.x)+o,y:((_=t.target)==null?void 0:_.spatial.y)+l,rotation:u,width:(P=t.target)==null?void 0:P.spatial.width,height:(O=t.target)==null?void 0:O.spatial.height,style:$,tileFormat:p},z),B),t.service&&n.map(H=>{if(t.service){let[Y,{height:V,width:he}]=wO(t.service,H);return Y?N(Ko,{priority:!0,style:$,key:Y,uri:Y,target:t.target.spatial,display:{height:V,width:he}}):null}return null})),c):N(it,{key:"no-service"},N(Ko,C(C({style:$,uri:t.id,target:t.target.spatial,display:t.width&&t.height?{width:t.width,height:t.height}:void 0},z),B)),c))}et(),fe();function xO(){let[e,{addAnnotation:t,removeAnnotation:i}]=v2(),r=Qt(),n=rC(),o=we([]),l=e==null?void 0:e.id,u=Ae(()=>Fc(r),[r]);return Yo(()=>({annotations:{add(c){t(c)},get(c){if(l){let p=(r.get({id:l,type:"AnnotationPage"}).items||[]).find(f=>f.id===c);return p?r.get(p):null}return null},getSource(c){return o.current[c]||null},getAll(){if(l){let c=r.get({id:l,type:"AnnotationPage"});return c?r.get(c.items)||[]:[]}return[]},remove(c){i(c)},applyStyles(c){l&&n.applyStyles(l,"atlas",c)},addEventListener(c,p){if(l)return u.addEventListener({id:l,type:"AnnotationPage"},c,p)},applyHTMLProperties(c){l&&n.applyStyles(l,"html",c)}}}),l),[e,{addAnnotation:t,removeAnnotation:i}]}fe();var lb=si(null);function _O(){let e=Kt(lb);return[e.fullPage,{addAnnotation:e.addAnnotation,removeAnnotation:e.removeAnnotation}]}function ub({children:e}){let[t,{addAnnotation:i,removeAnnotation:r}]=xO();return N(lb.Provider,{value:Ae(()=>({fullPage:t,addAnnotation:i,removeAnnotation:r}),[t])},e)}et();function SO({media:e,children:t}){let[{element:i,currentTime:r,progress:n},o,l]=hv({duration:e.duration});return Yo(u=>(u.mediaActions=l,u.mediaElement=i,u.setMediaProgressElement=c=>{n.current=c},u.dispatchEvent(new Event("media-displayed")),u.dispatchEvent(new Event("audio-displayed")),{}),e.url),N(J2,{state:o,actions:l,currentTime:r,progress:n,element:i},N("video",{ref:i,src:e.url}),t)}et();function EO({media:e}){let[{element:t,currentTime:i,progress:r},n,o]=hv({duration:e.duration}),l=o.playPause;return Yo(u=>(u.mediaActions=o,u.mediaElement=t,u.setMediaProgressElement=c=>{r.current=c},u.dispatchEvent(new Event("media-displayed")),u.dispatchEvent(new Event("audio-displayed")),{}),e.url),N("div",{className:"video-container",part:"video-container",onClick:l},N("style",null,`
            .video-container {
              position: absolute;
              top: 0;
              bottom: 0;
              left: 0;
              right: 0;
              background: #000;
              z-index: 13;
              display: flex;
              justify-content: center;
              pointer-events: visible;
            }
          `),N("video",{ref:t,src:e.url,style:{width:"100%",objectFit:"contain"}}))}et();function AO({annotationPageId:e,selectionEnabled:t}){let i=iC({id:e}),r=fn(),n=Qt(),o=es(i,"text-lines");return!i||!i.items||!r?null:N(Zs,C({},{x:0,y:0,width:r.width,height:r.height}),N(id,{target:{x:0,y:0,width:r.width,height:r.height}},N(dn,{vault:n},N("svg",{tabindex:0,"aria-name":"","aria-live":"off","aria-atomic":"true","aria-relevant":"all","aria-expanded":"true",role:"article",style:D(C({},o),{userSelect:"text"}),width:r.width,height:r.height},i.items.map(l=>N(sb,{key:`line-${l.id}`,annotationId:l.id,interactive:t}))))))}function kO(e,t){let i=[],r={};for(let n of e){let o={},l=[],u=t.get(n),c=(u==null?void 0:u.items)||[];for(let p of c){let f=t.get(p);if(f.motivation)for(let v of f.motivation)l.includes(v)||l.push(v),o[v]=o[v]?o[v]:[],o[v].push(f.id)}i.push({typeMap:o,allTypes:l,id:n});for(let p of l)r[p]=r[p]||[],r[p].push(n)}return{pagesWithTypes:i,pageMapping:r}}function hb({x:e,y:t,highlight:i,annoMode:r,onCreated:n,debug:o,virtualSizes:l,highlightCssClass:u,defaultChoices:c,isStatic:p,textSelectionEnabled:f,textEnabled:v,disableThumbnail:x,skipSizes:E,rotation:_}){var P;let O=pn(),I=fn(),A=xl(I,["deep-zoom"]),[$]=_O(),z=Qt(),B=Ae(()=>Bc(z),[z]),[H,Y]=W2({strategies:["images","media"],defaultChoices:c==null?void 0:c.map(({id:oe})=>oe)}),V=Sc((O==null?void 0:O.id)||(I==null?void 0:I.id)),he=Ti((oe,Se)=>V.availablePageIds.map(Pe=>Se.get(Pe)),[...V.availablePageIds]);de(()=>{let oe=MI(z);if(I!=null&&I.id){let Se=(c==null?void 0:c.map(({id:Ke})=>Ke))||[],Pe=oe.getAllPaintingAnnotations(I.id);for(let Ke of Pe){if(Ke.type!=="Annotation")throw new Error("getPaintables() accept either a canvas or list of annotations");let re=Array.from(Array.isArray(Ke.body)?Ke.body:[Ke.body]);for(let Ie of re){let[Ne,{selector:J}]=sv(Ie),Oe=z.get(Ne);if((Oe.type||"unknown").toLowerCase()!=="choice")continue;let mt=z.get(Oe.items),rt=Se.length?Se.map(kt=>mt.find(li=>li.id===kt)).filter(Boolean):[mt[0]];rt.length===0&&rt.push(mt[0]);let ti={type:"single-choice",items:mt.map(kt=>({id:kt.id,label:kt.label,selected:rt.indexOf(kt)!==-1})),label:Ne.label};ss.emit("onChoiceChange",{choice:ti,partOf:{canvasId:I.id,choiceId:Oe.id,manifestId:O==null?void 0:O.id}})}}oe.extractChoices(I.id)}},[I==null?void 0:I.id,Y,c]);let Q=Ae(()=>kO(V.availablePageIds,z),he),ue=(P=Q.pageMapping.supplementing)!=null&&P.length?Q.pageMapping.supplementing[0]:null;de(()=>{let oe=ss.on("onMakeChoice",Se=>{Y.makeChoice(Se.id,Se.options)});return()=>{oe()}},[Y]),de(()=>{if(v){let oe=[];for(let Se of V.availablePageIds)z.requestStatus(Se)||oe.push(z.load(Se))}},[I==null?void 0:I.id,v]),de(()=>{if(c)for(let oe of c)typeof oe.opacity<"u"&&B.applyStyles({id:oe.id},"atlas",{opacity:oe.opacity})},[c]);let pe=Q2({maxWidth:256,maxHeight:256});if(!I)return null;if(H.type==="media"){if(H.media.type!=="Sound"&&H.media.type!=="Video")throw new Error("Unknown media type");return N(Zs,C({key:H.type,height:I.height||1e3,width:I.width||1e3,x:e,y:t},A),H.media.type==="Sound"?N(SO,{media:H.media}):null,H.media.type==="Video"?N(EO,{media:H.media}):null)}if(H.type==="unknown"){if(pe&&pe.type==="fixed")return N(Zs,{height:I.height,width:I.width,x:e,y:t},N(Ko,{uri:pe.id,target:{x:0,y:0,width:I.width,height:I.height},display:pe.width&&pe.height?{width:pe.width,height:pe.height}:void 0}));throw new Error("Unknown image strategy")}let ge=N(it,null,r?N(Hv,{onCreate:oe=>{n&&n(oe)}}):null,i&&i.selector&&i.selector.type==="BoxSelector"?N(eu,{id:"highlight",isEditing:!0,onClick:()=>{},onSave:()=>{},region:i.selector.spatial,style:u?void 0:{border:"3px solid red"},className:u}):null,$?N(ob,{page:$,textSelectionEnabled:f}):null,H.annotations&&H.annotations.pages?H.annotations.pages.map(oe=>N(ob,{key:oe.id,page:oe,textSelectionEnabled:f})):null,o?N(bO,null):null,v&&ue?N(AO,{annotationPageId:ue,selectionEnabled:f}):null);return N(Zs,C({key:H.type,height:I.height,width:I.width,x:e,y:t},A),H.type==="images"?H.images.map((oe,Se)=>N(ab,{isStatic:p,key:oe.id,image:oe,id:oe.id,rotation:_,annotationId:oe.annotationId,thumbnail:Se===0&&!x?pe:void 0,virtualSizes:l,annotations:ge,skipSizes:E,skipThumbnail:x})):null)}fe(),et(),fe();function tu({error:e,resetErrorBoundary:t,aspectRatio:i,height:r=512,width:n}){let o=i?{paddingTop:`${i*100}%`}:{height:r,width:n},l="img";return de(()=>{console.error(e)},[e]),N("slot",{name:"fallback"},N("div",{role:"alert",style:C({background:"#000",color:"#fff",display:"flex",flexDirection:"column",alignContent:"center",justifyContent:"center",fontFamily:"monospace"},o)},N("div",{style:{padding:"1em",textAlign:"center"}},N(l,{className:"img-oops",part:"image-oops",width:11*3,height:8*3,src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAICAYAAAAvOAWIAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAC6ADAAQAAAABAAAACAAAAADGHiDWAAAAO0lEQVQYGWP4DwQMQACjQWxkABOH0TgVwjRhKIQLwFRAaZg4jEaTphKXEWYOPmsYgQCmjnQPwnXiYQAAP/M3zvinPKAAAAAASUVORK5CYII="}),N("h2",null,"Unable to load image"),N("pre",null,e==null?void 0:e.message),t?N("button",{style:{color:"#fff",border:"2px solid #fff",background:"#000",fontFamily:"monospace",padding:"0.25em 1em"},onClick:t},"Try again"):null,N("style",null,".img-oops { border: 3px solid white; padding: 15px; image-rendering: auto; image-rendering: crisp-edges; image-rendering: pixelated; margin-bottom: 10px; }"))))}function PO(e,t){var i=e,{unit:r}=i,n=le(i,["unit"]);return r==="percent"?{x:t.width*(n.x/100),y:t.height*(n.y/100),width:t.width*(n.width/100),height:t.height*(n.height/100)}:n}et(),fe();var CO=yc;function TO(e){let t=Xy(),i=GP(),r=bc(),n=we(!1),o=we();Yo(c=>(o.current=c,c.sequence=i,n.current||(n.current=!0,c.dispatchEvent(new CustomEvent("sequence",{detail:i}))),{}),[i]),de(()=>{o.current&&(ss.emit("onResetSeen"),o.current.dispatchEvent(new CustomEvent("sequence-change",{detail:{index:i.currentSequenceIndex,total:i.sequence.length}})))},[i.currentSequenceIndex,r]);let l=0,u=t.map((c,p)=>{let f=l;return l+=c.width+(e.margin||0),N(CO,{key:c.id,canvas:c.id},N(hb,D(C({key:c.id},e),{x:f})))});return N(it,null,u)}var IO=dO.ErrorBoundary;function cb(e){let t=Qt(),i=Jn(),r=fn(),n=pn(),o=Sc((n==null?void 0:n.id)||(r==null?void 0:r.id)),[l,u]=Be(!1),c=e.rotation||0,p=!e.displayOptions.viewport&&r?e.displayOptions.homePosition?e.displayOptions.homePosition.width/e.displayOptions.homePosition.height:r.width/r.height:void 0;Yo(_=>o?(_.annotationPageManager||(_.annotationPageManager={}),_.annotationPageManager.availablePageIds=o.availablePageIds,_.annotationPageManager.enabledPageIds=o.enabledPageIds,_.annotationPageManager.setPageEnabled=o.setPageEnabled,_.annotationPageManager.setPageDisabled=o.setPageDisabled,{}):{},[o.availablePageIds,o.enabledPageIds,o.setPageEnabled,o.setPageDisabled].join("/")),At(()=>{e.followAnnotations!==!1&&o.availablePageIds.map(_=>{t.requestStatus(_)||t.load(_)})},[o.availablePageIds,e.followAnnotations]),Ti(_=>i.canvas?_.iiif.entities.Canvas[i.canvas]:null,[]);let[f,v]=Ae(()=>{let _=e.displayOptions,{width:P,height:O,homePosition:I,containerProps:A}=_,$=le(_,["width","height","homePosition","containerProps"]),z=e.displayOptions.homePosition&&r?PO(e.displayOptions.homePosition,r):null;return z&&($.homePosition=z),P&&($.width=P),O&&($.height=O),[$,A]},[e.displayOptions,r]),x=_=>{_.altKey&&_.code==="KeyB"&&u(!0)},E=e.renderMultiple?TO:hb;return N(IO,{fallbackRender:_=>N(tu,C({height:f.height,width:f.width,aspectRatio:p},_))},N(ed,D(C({key:e.renderMultiple?"":r==null?void 0:r.id,aspectRatio:p,containerProps:C({onKeyDown:x},v||{}),className:e.className,background:e.background},f),{mode:l?"sketch":e.mode,homeCover:e.homeCover,homeOnResize:!!e.homeCover}),N(E,{isStatic:!e.interactive,debug:e.debug,virtualSizes:e.virtualSizes,highlight:e.highlight,highlightCssClass:e.highlightCssClass,annoMode:l,defaultChoices:e.defaultChoices,disableThumbnail:e.disableThumbnail,skipSizes:e.skipSizes,rotation:c,onCreated:_=>{n&&r&&_&&navigator.clipboard.writeText(Xl({id:`${r.id}#xywh=${_.x},${_.y},${_.width},${_.height}`,type:"Canvas",partOf:[{id:n.id,type:"Manifest"}]})),u(!1)},x:e.x,y:e.y,textSelectionEnabled:e.textSelectionEnabled,textEnabled:e.textEnabled,margin:e.margin}),e.children))}et();function OO(e){return N("svg",C({width:"1em",height:"1em",viewBox:"0 0 38 38",xmlns:"http://www.w3.org/2000/svg",stroke:"#000"},e),N("g",{transform:"translate(1 1)",strokeWidth:2,fill:"none",fillRule:"evenodd"},N("circle",{strokeOpacity:.5,cx:18,cy:18,r:18}),N("path",{d:"M36 18c0-9.94-8.06-18-18-18"},N("animateTransform",{attributeName:"transform",type:"rotate",from:"0 18 18",to:"360 18 18",dur:"1s",repeatCount:"indefinite"}))))}et(),fe();var RO=({manifestId:e,children:t})=>{let{manifest:i,isLoaded:r,error:n}=bl(e,{});return de(()=>{n&&console.error(n)},[n]),n?N(tu,{error:new Error(`Unable to load Manifest: ${e} 
 
 ${n.toString()}`)}):!r||!i?N(OO,null):N(wl,{manifest:i.id},t)};fe();var db=["width","height","target","region","highlight","highlight-css-class","disable-keyboard-navigation","click-to-enable-zoom","preferred-formats","atlas-mode","style-id","debug","preset","responsive","interactive","class","move-events","granular-move-events","a11y-title","a11y-role"],MO=[...db,"manifest-id","canvas-id","choice-id","text-selection-enabled","disable-thumbnail","text-enabled","follow-annotations","iiif-content","home-cover","rotation","background"],LO=e=>{let{vault:t,webComponent:i,runtime:r,atlasProps:n,isConfigBlocking:o,setParsedTarget:l,highlight:u,highlightCssClass:c,preferredFormats:p,virtualSizes:f,viewport:v,debug:x,mode:E,interactive:_,x:P,y:O,homeCover:I,className:A,inlineStyles:$,inlineStyleSheet:z,useProp:B,useRegisterWebComponentApi:H,setMode:Y,background:V}=Jl(e),[he,Q]=Be(void 0),ue=we([]),[pe,ge]=Be(),[oe,,Se]=B("iiifContent",{parse:Kl}),[Pe,Ke,,re]=B("canvasId"),[Ie,Ne,,J]=B("rotation",{parse:Tr,defaultValue:0}),[Oe,mt,,rt]=B("manifestId"),[ti]=B("followAnnotations",{parse:gt,defaultValue:!0}),[kt,,,li]=B("choiceId",{parse:cT}),[Tt]=B("textSelectionEnabled",{parse:gt,defaultValue:!0}),[Mt]=B("disableThumbnail",{parse:gt,defaultValue:!1}),[ui]=B("skipSizes",{parse:gt,defaultValue:!1}),[Zt]=B("textEnabled",{parse:gt,defaultValue:!1}),wt=oe&&oe.type!=="remote-content-state"?oe:null,ke=oe&&oe.type==="remote-content-state"?oe.id:null,Te=He(Xe=>{i.current&&(ss.emit("onResetSeen"),i.current.dispatchEvent(new CustomEvent("canvas-change",{detail:{canvas:Xe}})))},[]),ot=He(Xe=>{if(he){let Ye={id:`${Pe}#xywh=${Zl(Xe.x)},${Zl(Xe.y)},${Xe.width},${Xe.height}`,type:"Canvas",partOf:[{id:Oe,type:"Manifest"}]},ht={contentState:Ye,normalisedContentState:Qs(Ye),encodedContentState:Xl(Ye),selection:{type:"BoxSelector",spatial:Xe}};ue.current.push(ht),he(ht)}},[he,Oe,Pe]);if(H(Xe=>({vault:t,setCanvas:Ye=>{Xe.setAttribute("canvas-id",Ye)},setManifest:Ye=>{Xe.setAttribute("manifest-id",Ye)},setDefaultChoiceIds:Ye=>{Xe.setAttribute("choice-id",Ye.join(","))},getDefaultChoiceIds(){return(li.current||[]).map(({id:Ye})=>Ye)},getCanvasId(){return re.current},getContentState(){var Ye,ht,jt,hi;let Zr=rt!=null&&rt.current?rt==null?void 0:rt.current:Oe,os={id:`${re!=null&&re.current?re==null?void 0:re.current:Pe}#xywh=${(Ye=r.current)==null?void 0:Ye.x},${(ht=r.current)==null?void 0:ht.y},${(jt=r.current)==null?void 0:jt.width},${(hi=r.current)==null?void 0:hi.height}`,type:"Canvas",partOf:[{id:Zr,type:"Manifest"}]};return{contentState:os,normalisedContentState:Qs(os),encodedContentState:Xl(os)}},getPosition(){var Ye,ht,jt,hi;return{x:(Ye=r.current)==null?void 0:Ye.x,y:(ht=r.current)==null?void 0:ht.y,width:(jt=r.current)==null?void 0:jt.width,height:(hi=r.current)==null?void 0:hi.height}},getManifestId(){return rt.current},disableTextSelection(){Xe.setAttribute("text-selection-enabled","false")},enableTextSelection(){Xe.setAttribute("text-selection-enabled","true")},enableText(){Xe.setAttribute("text-enabled","true")},disableText(){Xe.setAttribute("text-enabled","true")},easingFunctions(){return Cr},getContentStateStack(){return ue.current},transition(Ye){var ht,jt;(ht=r.current)!=null&&ht.transitionManager&&Ye((jt=r.current)==null?void 0:jt.transitionManager)},enableContentStateSelection(Ye){Y("sketch"),Q(ht=>ht||Ye)},disableContentStateSelection(){Q(void 0),Y("explore"),ue.current=[]},setContentStateFromText(Ye,ht=!1){if(Ye==null||Ye.trim()==="")return;let jt=Qs(Yl(Ye));jt.immediate=ht;let hi=jt.target[0];re.current===hi.source.id?r.current&&jt.target&&jt.target[0]&&jt.target[0].selector&&jt.target[0].selector.type==="BoxSelector"&&r.current.world.gotoRegion(D(C({},jt.target[0].selector.spatial),{immediate:ht})):Se(jt)}})),At(()=>{ke&&!pe&&fetch(ke).then(Xe=>Xe.json()).then(Xe=>{Se(Kl(Xe))}).catch(Xe=>{console.error(Xe),ge(new Error(`Failed to load content state from ${ke} 

 ${Xe.toString()}`))})},[ke,pe]),At(()=>{if(wt&&wt.target.length){let Xe=wt.target[0];if(Xe.type==="SpecificResource"&&Xe.source.type==="Canvas"){let Ye=(Xe.source.partOf||[]).find(ht=>ht.type==="Manifest");if(Ke(Xe.source.id),Ye&&mt(Ye.id),Xe.selector&&r.current&&i.current)if(Xe.selector.type==="BoxSelector"){let{x:ht,y:jt,width:hi,height:Zr}=Xe.selector.spatial;r.current.world.gotoRegion({x:ht,y:jt,width:hi,height:Zr,immediate:wt.immediate})}else l(Xe)}}},[wt]),de(()=>{Te(Pe)},[Pe]),o)return null;if(pe)return N(tu,{error:pe,resetErrorBoundary:()=>ge(null)});let ii=Pe?N(yc,{canvas:Pe},N(cb,{key:`${Pe}-${v?"v1":"v0"}`,interactive:_,defaultChoices:kt,followAnnotations:ti,className:A,highlight:u,debug:x,background:V,virtualSizes:f,highlightCssClass:c,canvasId:Pe,displayOptions:n,mode:E,rotation:Ie||0,x:P,y:O,textEnabled:Zt,textSelectionEnabled:Tt,disableThumbnail:Mt,skipSizes:ui,homeCover:I},N("slot",{name:"atlas"}),he?N(Hv,{onCreate:ot}):null),N("slot",null)):null;return N(td.Provider,{value:e.__registerPublicApi},N(dn,{vault:t},N(ub,null,Oe?N(RO,{manifestId:Oe},ii):ii)),$?N("style",null,$):null,z?N("link",{rel:"stylesheet",href:z}):null)};typeof window<"u"&&Ln(LO,"canvas-panel",MO,{shadow:!0,onConstruct(e){Object.defineProperty(e,"vault",{get(){return e._props.vault},set(t){e._props.vault=t}}),e._props={__registerPublicApi:t=>{Object.assign(e,t(e))}}}}),et(),fe();var $O=je(gf()),NO=$O.ErrorBoundary;function zO(e){let{atlasProps:t,isConfigBlocking:i,setIsReady:r,preferredFormats:n,virtualSizes:o,height:l,width:u,className:c,inlineStyles:p,inlineStyleSheet:f,viewport:v,vault:x,useProp:E,interactive:_,x:P,y:O,homeCover:I,background:A}=Jl(e),[$]=E("src"),[z]=E("nested",{parse:gt}),[B]=E("rotation",{parse:Tr}),[H,Y]=E("tileFormat"),[V]=E("skipSizes",{parse:gt}),[he]=E("disableThumbnail",{parse:gt}),[Q,ue]=lv(),pe=ue[$],ge=Ae(()=>{let Se=Q({id:$},{});return Se&&Se.preferredFormats&&Se.preferredFormats.length===1&&Y(Se.preferredFormats[0]),Se&&Se.height&&Se.width&&pe!=="loading"?{id:$,width:Se.width,height:Se.height,service:Se,type:"Image",selector:{type:"BoxSelector",spatial:{x:0,y:0,width:Se.width,height:Se.height}},target:{type:"BoxSelector",spatial:{x:0,y:0,width:Se.width,height:Se.height}}}:null},[Q,$,ue]);if(!ge||!ge.height||!ge.width||i)return null;let oe=v?void 0:t.homePosition?t.homePosition.width/t.homePosition.height:ge.width/ge.height;return N(NO,{fallbackRender:Se=>N(tu,C({height:l,width:u,aspectRatio:oe},Se))},N(dn,{vault:x},N(ed,C({onCreated:()=>{r(!0)},viewport:!0,aspectRatio:oe,className:c,nested:z,homeCover:I,background:A,homeOnResize:!!I,rotation:B},t),N(ab,{key:ge.id,image:ge,id:ge.id,isStatic:!_,virtualSizes:o,skipSizes:V,skipThumbnail:he,x:P,y:O,rotation:B,tileFormat:H}))),p?N("style",null,p):null,f?N("link",{rel:"stylesheet",href:f}):null,e.children?N("slot",null,e.children):null)}function FO(e){let t=Ae(()=>new yl,[]);return N(av.Provider,{value:t},N(zO,C({},e)))}typeof window<"u"&&Ln(FO,"image-service",["src","nested","x","y","width","height","target","region","highlight","highlight-css-class","text-selection-enabled","disable-keyboard-navigation","click-to-enable-zoom","preferred-formats","atlas-mode","style-id","debug","preset","responsive","interactive","iiif-content","class","choice-id","move-events","granular-move-events","home-cover","tile-format","rotation","background"],{shadow:!0,onConstruct(e){e._props={__registerPublicApi:t=>{Object.assign(e,t(e))}}}}),et(),fe();var BO=[...db,"manifest-id","range-id","start-canvas","paging-enabled","text-selection-enabled","text-enabled","follow-annotations","margin","background"];function jO(e){let{vault:t,webComponent:i,runtime:r,atlasProps:n,isConfigBlocking:o,setParsedTarget:l,highlight:u,highlightCssClass:c,preferredFormats:p,virtualSizes:f,viewport:v,debug:x,mode:E,interactive:_,x:P,y:O,className:I,inlineStyles:A,inlineStyleSheet:$,useProp:z,useRegisterWebComponentApi:B,setMode:H,background:Y}=Jl(e),[V,he,,Q]=z("manifestId"),[ue,,,pe]=z("rangeId"),[ge,oe,,Se]=z("startCanvas"),[Pe]=z("margin",{parse:Tr,defaultValue:0}),[Ke]=z("pagingEnabled",{parse:gt,defaultValue:!0}),[re]=z("textSelectionEnabled",{parse:gt,defaultValue:!0}),[Ie]=z("textEnabled",{parse:gt,defaultValue:!1}),[Ne]=z("followAnnotations",{parse:gt,defaultValue:!0}),[J,,Oe]=z("iiifContent",{parse:Kl}),mt=J&&J.type!=="remote-content-state"?J:null,rt=J&&J.type==="remote-content-state"?J.id:null,[ti,kt]=Be(),[li]=z("skipSizes",{parse:gt,defaultValue:!1});return B(Tt=>({vault:t,setManifest:Mt=>{Tt.setAttribute("manifest-id",Mt)},setRange:Mt=>{Tt.setAttribute("range-id",Mt)},getRangeId(){return pe.current},getContentState(){let Mt=Q!=null&&Q.current?Q==null?void 0:Q.current:V,ui=i.current.sequence,Zt=ui.items[ui.sequence[ui.currentSequenceIndex][0]].id,{x:wt,y:ke,width:Te,height:ot}=(r==null?void 0:r.current)||{},ii={id:`${Zt}#xywh=${Zl(wt)},${Zl(ke)},${Te},${ot}`,type:"Canvas",partOf:[{id:Mt,type:"Manifest"}]};return{contentState:ii,normalisedContentState:Qs(ii),encodedContentState:Xl(ii)}},setContentStateFromText(Mt,ui=!1){if(Mt==null||Mt.trim()==="")return;let Zt=Qs(Yl(Mt));Zt.immediate=ui,Oe(Zt)},getManifestId(){return Q.current},disableTextSelection(){Tt.setAttribute("text-selection-enabled","false")},enableTextSelection(){Tt.setAttribute("text-selection-enabled","true")},enableText(){Tt.setAttribute("text-enabled","true")},disableText(){Tt.setAttribute("text-enabled","true")}})),At(()=>{rt&&!ti&&fetch(rt).then(Tt=>Tt.json()).then(Tt=>{Oe(Kl(Tt))}).catch(Tt=>{console.error(Tt),kt(new Error(`Failed to load content state from ${rt} 

 ${Tt.toString()}`))})},[rt,ti]),At(()=>{var Tt;if(mt&&mt.target.length){let Mt=mt.target[0];if(Mt.type==="SpecificResource"&&Mt.source.type==="Canvas"){let ui=(Mt.source.partOf||[]).find(Zt=>Zt.type==="Manifest");if(i.current.sequence.setCurrentCanvasId(Mt.source.id),ui&&he(ui.id),Mt.selector&&Mt.selector.type==="BoxSelector"){let{x:Zt,y:wt,width:ke,height:Te}=Mt.selector.spatial;(Tt=r==null?void 0:r.current)==null||Tt.world.gotoRegion({x:Zt,y:wt,width:ke,height:Te,immediate:mt.immediate})}}}},[mt]),!V||o?null:N(td.Provider,{value:e.__registerPublicApi},N(dn,{vault:t},N(ub,null,N(VP,{manifest:V,startCanvas:ge,rangeId:ue,pagingEnabled:Ke},N(cb,{renderMultiple:!0,key:`${ge}-${v?"v1":"v0"}`,background:Y,interactive:_,followAnnotations:Ne,className:I,highlight:u,debug:x,virtualSizes:f,highlightCssClass:c,displayOptions:n,mode:E,textEnabled:Ie,skipSizes:li,textSelectionEnabled:re,margin:Pe},N("slot",{name:"atlas"})),N("slot",null)))),A?N("style",null,A):null,$?N("link",{rel:"stylesheet",href:$}):null)}typeof window<"u"&&Ln(jO,"sequence-panel",BO,{shadow:!0,onConstruct(e){Object.defineProperty(e,"vault",{get(){return e._props.vault},set(t){e._props.vault=t}}),e._props={__registerPublicApi:t=>{Object.assign(e,t(e))}}}}),et(),fe(),et();var UO=({metadata:e=[],config:t,variation:i="table",labelWidth:r=16,bordered:n,labelStyle:o,showEmptyMessage:l,allowHtml:u,separator:c})=>{let p={separator:c},f=Ae(()=>{let v=(t||[]).reduce((E,_)=>[...E,..._.keys],[]),x={};for(let E of e){let _=E&&E.label?Object.values(E.label):[];for(let P of _)if(P&&P.length&&(v.indexOf(`metadata.${P[0]}`)!==-1||v.length===0)&&E){let O=`metadata.${P[0]}`;x[O]=x[O]?x[O]:[],x[O].push(E);break}}return x},[t,e]);return Object.keys(f).length===0&&l?N("slot",{name:"empty"}):t&&t.length?N("table",{"data-variation":i,"data-label-style":o,"data-bordered":n},N("slot",{slot:"header"}),N("tbody",null,t.map((v,x)=>{let E=[];for(let _ of v.keys)for(let P of f[_]||[])E.push(N("div",{key:x+"__"+_},u?N("span",{dangerouslySetInnerHTML:{__html:Ir(P.value,p)}}):Ir(P.value,p)));return E.length===0?null:N("tr",{className:"metadata-row",key:x},N("td",{className:"metadata-key",style:r?{minWidth:r}:{}},u?N("span",{dangerouslySetInnerHTML:{__html:Ir(v.label,p)}}):Ir(v.label,p)),N("td",{className:"metadata-value"},E))})),N("slot",{name:"footer"})):N("table",{"data-variation":i,"data-label-style":o,"data-bordered":n},N("slot",{name:"header"}),N("tbody",null,e&&e.length?e.map((v,x)=>v?N("tr",{className:"metadata-row",key:x},N("td",{className:"metadata-key",style:r?{minWidth:r}:{}},u?N("span",{dangerouslySetInnerHTML:{__html:Ir(v.label,p)}}):Ir(v.label,p)),N("td",{className:"metadata-value"},u?N("span",{dangerouslySetInnerHTML:{__html:Ir(v.value,p)}}):Ir(v.value,p))):null):N("slot",{name:"empty-table"})),N("slot",{name:"footer"}))};function DO(e){let t=Sl(),i=e.vault||t||Kc(),[r]=We(e.manifestId),[n]=We(e.variation),[o]=We(e.labelStyle),[l]=We(e.separator),[u]=We(e.labelWidth,{parse:Tr}),[c]=We(e.bordered,{parse:gt,defaultValue:!1}),[p]=We(e.allowHtml,{parse:gt,defaultValue:!1}),[f]=We(e.showEmptyMessage,{parse:gt,defaultValue:!1});return r?N(it,null,N(dn,{vault:i},N(wl,{manifest:r},N(WO,{manifestId:r,variation:n,labelStyle:o,labelWidth:u,bordered:c,showEmptyMessage:f,allowHtml:p,separator:l})))):N("slot",{name:"no-manifest"})}function WO(e){let{manifest:t}=bl(e.manifestId);return N(UO,D(C({},e),{metadata:t==null?void 0:t.metadata}))}var HO=["manifest-id","config-id","variation","label-style","label-width","bordered","show-empty-message"];typeof window<"u"&&Ln(DO,"metadata-panel",HO,{shadow:!1,onConstruct(e){Object.defineProperty(e,"vault",{get(){return e._props.vault},set(t){e._props.vault=t}}),e._props={__registerPublicApi:t=>{Object.assign(e,t(e))}}}}),et(),fe(),et();function pb(e){var t;let i=bc(),r=Qt(),n=Ae(()=>i==null?void 0:i.items.find(c=>c.type==="Canvas"),[i]),o=Ae(()=>!!(i!=null&&i.items.find(c=>c.type==="Range")),[i]),l=e.selected&&e.selected===(i==null?void 0:i.id);function u(){var c,p;if(i&&e.onRangeClick){let f={isLeaf:!o};if(n){let[v,x]=(c=n.id)==null?void 0:c.split("#");f.selector=n.id,f.canvasId=v,f.fragment=x}else if(i){let v=I0(r,i);if(v){let[x,E]=(p=v.id)==null?void 0:p.split("#");f.selector=v.id,f.canvasId=x,f.fragment=E}}if(f.selector)try{f.parsedSelector=qc(f.selector)}catch{}e.onRangeClick(i,f)}}return i?N("ul",{className:"range-item-container","data-leaf":!o,"data-selected":l,"data-with-selector":((t=n==null?void 0:n.id)==null?void 0:t.indexOf("#"))!==-1,"data-range-id":i.id},i.label?N("li",{className:"range-split",onClick:u},N("span",{className:"range-label"},Ir(i.label))):null,o?N("div",{className:"range-nested-container"},i.items.map(c=>c.type==="Canvas"||c.type==="SpecificResource"||!c.id?null:N(vc,{key:c.id,range:c.id},N(pb,{onRangeClick:e.onRangeClick,selected:e.selected})))):null):null}et(),fe();function qO(e){let t=pn(),i=Qt();if(!t)throw new Error("No manifest");let r=e.canvasId?LI(i,t,e.canvasId):e.selectedRange?i.get(e.selectedRange):void 0;return At(()=>{if(r&&e.autoScroll){let n=document.querySelector(`[data-range-id="${r.id}"]`);n&&n.scrollIntoView({block:"nearest",behavior:"auto"})}},[r]),!t||!t.structures.length?N("slot",{name:"no-range"}):N(it,null,r?N("div",{className:"range-current"},Ir(r.label)):null,t.structures.map(n=>N(vc,{key:n.id,range:n.id},N(pb,{selected:r==null?void 0:r.id,onRangeClick:e.onRangeClick}))))}fe();function QO(e){let t=Sl(),i=e.vault||t||Kc(),[r]=We(e.manifestId),[n]=We(e.canvasId),[o]=We(e.selectedRange),[l]=We(e.autoScroll,{parse:gt,defaultValue:!0}),[u,c]=Be();if(At(()=>{e.__registerPublicApi&&e.__registerPublicApi(f=>(c(f),{}))},[]),!r)return N("slot",{name:"no-manifest"});function p(f,v){u&&u.dispatchEvent(new CustomEvent("range-change",{detail:{range:f,isLeaf:v.isLeaf,canvasId:v.canvasId,fragment:v.fragment,selector:v.selector,parsedSelector:v.parsedSelector}}))}return N(it,null,N(dn,{vault:i},N(VO,{manifestId:r,canvasId:n,selectedRange:o,autoScroll:l,onRangeClick:p})))}function VO(e){let{manifest:t,isLoaded:i}=bl(e.manifestId);return!t||!i?null:N(wl,{manifest:t.id},N(qO,C({},e)))}var GO=["manifest-id","config-id","canvas-id","auto-scroll","selected-range"];typeof window<"u"&&Ln(QO,"range-panel",GO,{shadow:!1,onConstruct(e){Object.defineProperty(e,"vault",{get(){return e._props.vault},set(t){e._props.vault=t}}),e._props={__registerPublicApi:t=>{Object.assign(e,t(e))}}}})})();/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Ku=window,Fp=Ku.ShadowRoot&&(Ku.ShadyCSS===void 0||Ku.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Bp=Symbol(),rw=new WeakMap;let ww=class{constructor(w,g,y){if(this._$cssResult$=!0,y!==Bp)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=w,this.t=g}get styleSheet(){let w=this.o;const g=this.t;if(Fp&&w===void 0){const y=g!==void 0&&g.length===1;y&&(w=rw.get(g)),w===void 0&&((this.o=w=new CSSStyleSheet).replaceSync(this.cssText),y&&rw.set(g,w))}return w}toString(){return this.cssText}};const hM=L=>new ww(typeof L=="string"?L:L+"",void 0,Bp),cM=(L,...w)=>{const g=L.length===1?L[0]:w.reduce((y,S,k)=>y+(R=>{if(R._$cssResult$===!0)return R.cssText;if(typeof R=="number")return R;throw Error("Value passed to 'css' function must be a 'css' function result: "+R+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(S)+L[k+1],L[0]);return new ww(g,L,Bp)},dM=(L,w)=>{Fp?L.adoptedStyleSheets=w.map(g=>g instanceof CSSStyleSheet?g:g.styleSheet):w.forEach(g=>{const y=document.createElement("style"),S=Ku.litNonce;S!==void 0&&y.setAttribute("nonce",S),y.textContent=g.cssText,L.appendChild(y)})},nw=Fp?L=>L:L=>L instanceof CSSStyleSheet?(w=>{let g="";for(const y of w.cssRules)g+=y.cssText;return hM(g)})(L):L;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var wp;const th=window,sw=th.trustedTypes,pM=sw?sw.emptyScript:"",ow=th.reactiveElementPolyfillSupport,Cp={toAttribute(L,w){switch(w){case Boolean:L=L?pM:null;break;case Object:case Array:L=L==null?L:JSON.stringify(L)}return L},fromAttribute(L,w){let g=L;switch(w){case Boolean:g=L!==null;break;case Number:g=L===null?null:Number(L);break;case Object:case Array:try{g=JSON.parse(L)}catch{g=null}}return g}},xw=(L,w)=>w!==L&&(w==w||L==L),xp={attribute:!0,type:String,converter:Cp,reflect:!1,hasChanged:xw},Tp="finalized";let po=class extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this._$Eu()}static addInitializer(w){var g;this.finalize(),((g=this.h)!==null&&g!==void 0?g:this.h=[]).push(w)}static get observedAttributes(){this.finalize();const w=[];return this.elementProperties.forEach((g,y)=>{const S=this._$Ep(y,g);S!==void 0&&(this._$Ev.set(S,y),w.push(S))}),w}static createProperty(w,g=xp){if(g.state&&(g.attribute=!1),this.finalize(),this.elementProperties.set(w,g),!g.noAccessor&&!this.prototype.hasOwnProperty(w)){const y=typeof w=="symbol"?Symbol():"__"+w,S=this.getPropertyDescriptor(w,y,g);S!==void 0&&Object.defineProperty(this.prototype,w,S)}}static getPropertyDescriptor(w,g,y){return{get(){return this[g]},set(S){const k=this[w];this[g]=S,this.requestUpdate(w,k,y)},configurable:!0,enumerable:!0}}static getPropertyOptions(w){return this.elementProperties.get(w)||xp}static finalize(){if(this.hasOwnProperty(Tp))return!1;this[Tp]=!0;const w=Object.getPrototypeOf(this);if(w.finalize(),w.h!==void 0&&(this.h=[...w.h]),this.elementProperties=new Map(w.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const g=this.properties,y=[...Object.getOwnPropertyNames(g),...Object.getOwnPropertySymbols(g)];for(const S of y)this.createProperty(S,g[S])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(w){const g=[];if(Array.isArray(w)){const y=new Set(w.flat(1/0).reverse());for(const S of y)g.unshift(nw(S))}else w!==void 0&&g.push(nw(w));return g}static _$Ep(w,g){const y=g.attribute;return y===!1?void 0:typeof y=="string"?y:typeof w=="string"?w.toLowerCase():void 0}_$Eu(){var w;this._$E_=new Promise(g=>this.enableUpdating=g),this._$AL=new Map,this._$Eg(),this.requestUpdate(),(w=this.constructor.h)===null||w===void 0||w.forEach(g=>g(this))}addController(w){var g,y;((g=this._$ES)!==null&&g!==void 0?g:this._$ES=[]).push(w),this.renderRoot!==void 0&&this.isConnected&&((y=w.hostConnected)===null||y===void 0||y.call(w))}removeController(w){var g;(g=this._$ES)===null||g===void 0||g.splice(this._$ES.indexOf(w)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach((w,g)=>{this.hasOwnProperty(g)&&(this._$Ei.set(g,this[g]),delete this[g])})}createRenderRoot(){var w;const g=(w=this.shadowRoot)!==null&&w!==void 0?w:this.attachShadow(this.constructor.shadowRootOptions);return dM(g,this.constructor.elementStyles),g}connectedCallback(){var w;this.renderRoot===void 0&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(w=this._$ES)===null||w===void 0||w.forEach(g=>{var y;return(y=g.hostConnected)===null||y===void 0?void 0:y.call(g)})}enableUpdating(w){}disconnectedCallback(){var w;(w=this._$ES)===null||w===void 0||w.forEach(g=>{var y;return(y=g.hostDisconnected)===null||y===void 0?void 0:y.call(g)})}attributeChangedCallback(w,g,y){this._$AK(w,y)}_$EO(w,g,y=xp){var S;const k=this.constructor._$Ep(w,y);if(k!==void 0&&y.reflect===!0){const R=(((S=y.converter)===null||S===void 0?void 0:S.toAttribute)!==void 0?y.converter:Cp).toAttribute(g,y.type);this._$El=w,R==null?this.removeAttribute(k):this.setAttribute(k,R),this._$El=null}}_$AK(w,g){var y;const S=this.constructor,k=S._$Ev.get(w);if(k!==void 0&&this._$El!==k){const R=S.getPropertyOptions(k),F=typeof R.converter=="function"?{fromAttribute:R.converter}:((y=R.converter)===null||y===void 0?void 0:y.fromAttribute)!==void 0?R.converter:Cp;this._$El=k,this[k]=F.fromAttribute(g,R.type),this._$El=null}}requestUpdate(w,g,y){let S=!0;w!==void 0&&(((y=y||this.constructor.getPropertyOptions(w)).hasChanged||xw)(this[w],g)?(this._$AL.has(w)||this._$AL.set(w,g),y.reflect===!0&&this._$El!==w&&(this._$EC===void 0&&(this._$EC=new Map),this._$EC.set(w,y))):S=!1),!this.isUpdatePending&&S&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(g){Promise.reject(g)}const w=this.scheduleUpdate();return w!=null&&await w,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var w;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach((S,k)=>this[k]=S),this._$Ei=void 0);let g=!1;const y=this._$AL;try{g=this.shouldUpdate(y),g?(this.willUpdate(y),(w=this._$ES)===null||w===void 0||w.forEach(S=>{var k;return(k=S.hostUpdate)===null||k===void 0?void 0:k.call(S)}),this.update(y)):this._$Ek()}catch(S){throw g=!1,this._$Ek(),S}g&&this._$AE(y)}willUpdate(w){}_$AE(w){var g;(g=this._$ES)===null||g===void 0||g.forEach(y=>{var S;return(S=y.hostUpdated)===null||S===void 0?void 0:S.call(y)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(w)),this.updated(w)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(w){return!0}update(w){this._$EC!==void 0&&(this._$EC.forEach((g,y)=>this._$EO(y,this[y],g)),this._$EC=void 0),this._$Ek()}updated(w){}firstUpdated(w){}};po[Tp]=!0,po.elementProperties=new Map,po.elementStyles=[],po.shadowRootOptions={mode:"open"},ow==null||ow({ReactiveElement:po}),((wp=th.reactiveElementVersions)!==null&&wp!==void 0?wp:th.reactiveElementVersions=[]).push("1.6.3");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var _p;const ih=window,mo=ih.trustedTypes,aw=mo?mo.createPolicy("lit-html",{createHTML:L=>L}):void 0,Ip="$lit$",In=`lit$${(Math.random()+"").slice(9)}$`,_w="?"+In,fM=`<${_w}>`,_s=document,Sa=()=>_s.createComment(""),Ea=L=>L===null||typeof L!="object"&&typeof L!="function",Sw=Array.isArray,gM=L=>Sw(L)||typeof(L==null?void 0:L[Symbol.iterator])=="function",Sp=`[ 	
\f\r]`,wa=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,lw=/-->/g,uw=/>/g,bs=RegExp(`>|${Sp}(?:([^\\s"'>=/]+)(${Sp}*=${Sp}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),hw=/'/g,cw=/"/g,Ew=/^(?:script|style|textarea|title)$/i,mM=L=>(w,...g)=>({_$litType$:L,strings:w,values:g}),Aa=mM(1),Ss=Symbol.for("lit-noChange"),Gt=Symbol.for("lit-nothing"),dw=new WeakMap,ws=_s.createTreeWalker(_s,129,null,!1);function Aw(L,w){if(!Array.isArray(L)||!L.hasOwnProperty("raw"))throw Error("invalid template strings array");return aw!==void 0?aw.createHTML(w):w}const yM=(L,w)=>{const g=L.length-1,y=[];let S,k=w===2?"<svg>":"",R=wa;for(let F=0;F<g;F++){const U=L[F];let Z,ne,C=-1,D=0;for(;D<U.length&&(R.lastIndex=D,ne=R.exec(U),ne!==null);)D=R.lastIndex,R===wa?ne[1]==="!--"?R=lw:ne[1]!==void 0?R=uw:ne[2]!==void 0?(Ew.test(ne[2])&&(S=RegExp("</"+ne[2],"g")),R=bs):ne[3]!==void 0&&(R=bs):R===bs?ne[0]===">"?(R=S??wa,C=-1):ne[1]===void 0?C=-2:(C=R.lastIndex-ne[2].length,Z=ne[1],R=ne[3]===void 0?bs:ne[3]==='"'?cw:hw):R===cw||R===hw?R=bs:R===lw||R===uw?R=wa:(R=bs,S=void 0);const Re=R===bs&&L[F+1].startsWith("/>")?" ":"";k+=R===wa?U+fM:C>=0?(y.push(Z),U.slice(0,C)+Ip+U.slice(C)+In+Re):U+In+(C===-2?(y.push(void 0),F):Re)}return[Aw(L,k+(L[g]||"<?>")+(w===2?"</svg>":"")),y]};class ka{constructor({strings:w,_$litType$:g},y){let S;this.parts=[];let k=0,R=0;const F=w.length-1,U=this.parts,[Z,ne]=yM(w,g);if(this.el=ka.createElement(Z,y),ws.currentNode=this.el.content,g===2){const C=this.el.content,D=C.firstChild;D.remove(),C.append(...D.childNodes)}for(;(S=ws.nextNode())!==null&&U.length<F;){if(S.nodeType===1){if(S.hasAttributes()){const C=[];for(const D of S.getAttributeNames())if(D.endsWith(Ip)||D.startsWith(In)){const Re=ne[R++];if(C.push(D),Re!==void 0){const le=S.getAttribute(Re.toLowerCase()+Ip).split(In),lt=/([.?@])?(.*)/.exec(Re);U.push({type:1,index:k,name:lt[2],strings:le,ctor:lt[1]==="."?bM:lt[1]==="?"?xM:lt[1]==="@"?_M:nh})}else U.push({type:6,index:k})}for(const D of C)S.removeAttribute(D)}if(Ew.test(S.tagName)){const C=S.textContent.split(In),D=C.length-1;if(D>0){S.textContent=mo?mo.emptyScript:"";for(let Re=0;Re<D;Re++)S.append(C[Re],Sa()),ws.nextNode(),U.push({type:2,index:++k});S.append(C[D],Sa())}}}else if(S.nodeType===8)if(S.data===_w)U.push({type:2,index:k});else{let C=-1;for(;(C=S.data.indexOf(In,C+1))!==-1;)U.push({type:7,index:k}),C+=In.length-1}k++}}static createElement(w,g){const y=_s.createElement("template");return y.innerHTML=w,y}}function yo(L,w,g=L,y){var S,k,R,F;if(w===Ss)return w;let U=y!==void 0?(S=g._$Co)===null||S===void 0?void 0:S[y]:g._$Cl;const Z=Ea(w)?void 0:w._$litDirective$;return(U==null?void 0:U.constructor)!==Z&&((k=U==null?void 0:U._$AO)===null||k===void 0||k.call(U,!1),Z===void 0?U=void 0:(U=new Z(L),U._$AT(L,g,y)),y!==void 0?((R=(F=g)._$Co)!==null&&R!==void 0?R:F._$Co=[])[y]=U:g._$Cl=U),U!==void 0&&(w=yo(L,U._$AS(L,w.values),U,y)),w}class vM{constructor(w,g){this._$AV=[],this._$AN=void 0,this._$AD=w,this._$AM=g}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(w){var g;const{el:{content:y},parts:S}=this._$AD,k=((g=w==null?void 0:w.creationScope)!==null&&g!==void 0?g:_s).importNode(y,!0);ws.currentNode=k;let R=ws.nextNode(),F=0,U=0,Z=S[0];for(;Z!==void 0;){if(F===Z.index){let ne;Z.type===2?ne=new Oa(R,R.nextSibling,this,w):Z.type===1?ne=new Z.ctor(R,Z.name,Z.strings,this,w):Z.type===6&&(ne=new SM(R,this,w)),this._$AV.push(ne),Z=S[++U]}F!==(Z==null?void 0:Z.index)&&(R=ws.nextNode(),F++)}return ws.currentNode=_s,k}v(w){let g=0;for(const y of this._$AV)y!==void 0&&(y.strings!==void 0?(y._$AI(w,y,g),g+=y.strings.length-2):y._$AI(w[g])),g++}}class Oa{constructor(w,g,y,S){var k;this.type=2,this._$AH=Gt,this._$AN=void 0,this._$AA=w,this._$AB=g,this._$AM=y,this.options=S,this._$Cp=(k=S==null?void 0:S.isConnected)===null||k===void 0||k}get _$AU(){var w,g;return(g=(w=this._$AM)===null||w===void 0?void 0:w._$AU)!==null&&g!==void 0?g:this._$Cp}get parentNode(){let w=this._$AA.parentNode;const g=this._$AM;return g!==void 0&&(w==null?void 0:w.nodeType)===11&&(w=g.parentNode),w}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(w,g=this){w=yo(this,w,g),Ea(w)?w===Gt||w==null||w===""?(this._$AH!==Gt&&this._$AR(),this._$AH=Gt):w!==this._$AH&&w!==Ss&&this._(w):w._$litType$!==void 0?this.g(w):w.nodeType!==void 0?this.$(w):gM(w)?this.T(w):this._(w)}k(w){return this._$AA.parentNode.insertBefore(w,this._$AB)}$(w){this._$AH!==w&&(this._$AR(),this._$AH=this.k(w))}_(w){this._$AH!==Gt&&Ea(this._$AH)?this._$AA.nextSibling.data=w:this.$(_s.createTextNode(w)),this._$AH=w}g(w){var g;const{values:y,_$litType$:S}=w,k=typeof S=="number"?this._$AC(w):(S.el===void 0&&(S.el=ka.createElement(Aw(S.h,S.h[0]),this.options)),S);if(((g=this._$AH)===null||g===void 0?void 0:g._$AD)===k)this._$AH.v(y);else{const R=new vM(k,this),F=R.u(this.options);R.v(y),this.$(F),this._$AH=R}}_$AC(w){let g=dw.get(w.strings);return g===void 0&&dw.set(w.strings,g=new ka(w)),g}T(w){Sw(this._$AH)||(this._$AH=[],this._$AR());const g=this._$AH;let y,S=0;for(const k of w)S===g.length?g.push(y=new Oa(this.k(Sa()),this.k(Sa()),this,this.options)):y=g[S],y._$AI(k),S++;S<g.length&&(this._$AR(y&&y._$AB.nextSibling,S),g.length=S)}_$AR(w=this._$AA.nextSibling,g){var y;for((y=this._$AP)===null||y===void 0||y.call(this,!1,!0,g);w&&w!==this._$AB;){const S=w.nextSibling;w.remove(),w=S}}setConnected(w){var g;this._$AM===void 0&&(this._$Cp=w,(g=this._$AP)===null||g===void 0||g.call(this,w))}}class nh{constructor(w,g,y,S,k){this.type=1,this._$AH=Gt,this._$AN=void 0,this.element=w,this.name=g,this._$AM=S,this.options=k,y.length>2||y[0]!==""||y[1]!==""?(this._$AH=Array(y.length-1).fill(new String),this.strings=y):this._$AH=Gt}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(w,g=this,y,S){const k=this.strings;let R=!1;if(k===void 0)w=yo(this,w,g,0),R=!Ea(w)||w!==this._$AH&&w!==Ss,R&&(this._$AH=w);else{const F=w;let U,Z;for(w=k[0],U=0;U<k.length-1;U++)Z=yo(this,F[y+U],g,U),Z===Ss&&(Z=this._$AH[U]),R||(R=!Ea(Z)||Z!==this._$AH[U]),Z===Gt?w=Gt:w!==Gt&&(w+=(Z??"")+k[U+1]),this._$AH[U]=Z}R&&!S&&this.j(w)}j(w){w===Gt?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,w??"")}}class bM extends nh{constructor(){super(...arguments),this.type=3}j(w){this.element[this.name]=w===Gt?void 0:w}}const wM=mo?mo.emptyScript:"";class xM extends nh{constructor(){super(...arguments),this.type=4}j(w){w&&w!==Gt?this.element.setAttribute(this.name,wM):this.element.removeAttribute(this.name)}}class _M extends nh{constructor(w,g,y,S,k){super(w,g,y,S,k),this.type=5}_$AI(w,g=this){var y;if((w=(y=yo(this,w,g,0))!==null&&y!==void 0?y:Gt)===Ss)return;const S=this._$AH,k=w===Gt&&S!==Gt||w.capture!==S.capture||w.once!==S.once||w.passive!==S.passive,R=w!==Gt&&(S===Gt||k);k&&this.element.removeEventListener(this.name,this,S),R&&this.element.addEventListener(this.name,this,w),this._$AH=w}handleEvent(w){var g,y;typeof this._$AH=="function"?this._$AH.call((y=(g=this.options)===null||g===void 0?void 0:g.host)!==null&&y!==void 0?y:this.element,w):this._$AH.handleEvent(w)}}class SM{constructor(w,g,y){this.element=w,this.type=6,this._$AN=void 0,this._$AM=g,this.options=y}get _$AU(){return this._$AM._$AU}_$AI(w){yo(this,w)}}const pw=ih.litHtmlPolyfillSupport;pw==null||pw(ka,Oa),((_p=ih.litHtmlVersions)!==null&&_p!==void 0?_p:ih.litHtmlVersions=[]).push("2.8.0");const kw=(L,w,g)=>{var y,S;const k=(y=g==null?void 0:g.renderBefore)!==null&&y!==void 0?y:w;let R=k._$litPart$;if(R===void 0){const F=(S=g==null?void 0:g.renderBefore)!==null&&S!==void 0?S:null;k._$litPart$=R=new Oa(w.insertBefore(Sa(),F),F,void 0,g??{})}return R._$AI(L),R};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var Ep,Ap;let xs=class extends po{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var w,g;const y=super.createRenderRoot();return(w=(g=this.renderOptions).renderBefore)!==null&&w!==void 0||(g.renderBefore=y.firstChild),y}update(w){const g=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(w),this._$Do=kw(g,this.renderRoot,this.renderOptions)}connectedCallback(){var w;super.connectedCallback(),(w=this._$Do)===null||w===void 0||w.setConnected(!0)}disconnectedCallback(){var w;super.disconnectedCallback(),(w=this._$Do)===null||w===void 0||w.setConnected(!1)}render(){return Ss}};xs.finalized=!0,xs._$litElement$=!0,(Ep=globalThis.litElementHydrateSupport)===null||Ep===void 0||Ep.call(globalThis,{LitElement:xs});const fw=globalThis.litElementPolyfillSupport;fw==null||fw({LitElement:xs});((Ap=globalThis.litElementVersions)!==null&&Ap!==void 0?Ap:globalThis.litElementVersions=[]).push("3.3.3");/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const EM=L=>L.strings===void 0;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Pw={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},Cw=L=>(...w)=>({_$litDirective$:L,values:w});class Tw{constructor(w){}get _$AU(){return this._$AM._$AU}_$AT(w,g,y){this._$Ct=w,this._$AM=g,this._$Ci=y}_$AS(w,g){return this.update(w,g)}update(w,g){return this.render(...g)}}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const _a=(L,w)=>{var g,y;const S=L._$AN;if(S===void 0)return!1;for(const k of S)(y=(g=k)._$AO)===null||y===void 0||y.call(g,w,!1),_a(k,w);return!0},rh=L=>{let w,g;do{if((w=L._$AM)===void 0)break;g=w._$AN,g.delete(L),L=w}while((g==null?void 0:g.size)===0)},Iw=L=>{for(let w;w=L._$AM;L=w){let g=w._$AN;if(g===void 0)w._$AN=g=new Set;else if(g.has(L))break;g.add(L),PM(w)}};function AM(L){this._$AN!==void 0?(rh(this),this._$AM=L,Iw(this)):this._$AM=L}function kM(L,w=!1,g=0){const y=this._$AH,S=this._$AN;if(S!==void 0&&S.size!==0)if(w)if(Array.isArray(y))for(let k=g;k<y.length;k++)_a(y[k],!1),rh(y[k]);else y!=null&&(_a(y,!1),rh(y));else _a(this,L)}const PM=L=>{var w,g,y,S;L.type==Pw.CHILD&&((w=(y=L)._$AP)!==null&&w!==void 0||(y._$AP=kM),(g=(S=L)._$AQ)!==null&&g!==void 0||(S._$AQ=AM))};class CM extends Tw{constructor(){super(...arguments),this._$AN=void 0}_$AT(w,g,y){super._$AT(w,g,y),Iw(this),this.isConnected=w._$AU}_$AO(w,g=!0){var y,S;w!==this.isConnected&&(this.isConnected=w,w?(y=this.reconnected)===null||y===void 0||y.call(this):(S=this.disconnected)===null||S===void 0||S.call(this)),g&&(_a(this,w),rh(this))}setValue(w){if(EM(this._$Ct))this._$Ct._$AI(w,this);else{const g=[...this._$Ct._$AH];g[this._$Ci]=w,this._$Ct._$AI(g,this,0)}}disconnected(){}reconnected(){}}/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const TM=()=>new IM;let IM=class{};const kp=new WeakMap,OM=Cw(class extends CM{render(L){return Gt}update(L,[w]){var g;const y=w!==this.G;return y&&this.G!==void 0&&this.ot(void 0),(y||this.rt!==this.lt)&&(this.G=w,this.dt=(g=L.options)===null||g===void 0?void 0:g.host,this.ot(this.lt=L.element)),Gt}ot(L){var w;if(typeof this.G=="function"){const g=(w=this.dt)!==null&&w!==void 0?w:globalThis;let y=kp.get(g);y===void 0&&(y=new WeakMap,kp.set(g,y)),y.get(this.G)!==void 0&&this.G.call(this.dt,void 0),y.set(this.G,L),L!==void 0&&this.G.call(this.dt,L)}else this.G.value=L}get rt(){var L,w,g;return typeof this.G=="function"?(w=kp.get((L=this.dt)!==null&&L!==void 0?L:globalThis))===null||w===void 0?void 0:w.get(this.G):(g=this.G)===null||g===void 0?void 0:g.value}disconnected(){this.rt===this.lt&&this.ot(void 0)}reconnected(){this.ot(this.lt)}}),RM=cM`
  :host {
    position: relative;
    display: flex;
    justify-content: center;
    max-height: 100vh;
    max-width: 100vw;
  }

  .image-sequence {
    height: 100vh;
    width: 100%;
  }

  .image-sequence.interactive {
    cursor: grab;
  }

  .image-sequence.interactive.loading {
    cursor: wait;
  }

  .overlay {
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    top: 0;
    left: 0;
    height: 100%;
    width: 100%;
    background: rgba(0,0,0,0);
    color: white;
    transition: all 0.25s linear;
    z-index: 9999;
    pointer-events: none;
  }

  .overlay.visible {
    opacity: 1;
    pointer-events: auto;
  }

  .overlay:not(.visible) {
    opacity: 0;
    display: none;
  }

  .overlay:hover {
    background: rgba(0,0,0,0.6);
  }

  .overlay.loading.visible {
    animation: loading-overlay 1s infinite alternate;
  }

  .buffering-indicator {
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    border-radius: 5px;
    height: 15%;
    width: 15%;
    background: rgba(0,0,0,0.6);
  }

  @keyframes loading-overlay {
    from {
      opacity: 0.6;
    }
    to {
      opacity: 1;
    }
  }

  .description {
    display: flex;
    flex-direction: column;
    justify-content: space-around;
    align-items: center;
    opacity: 0;
    transition: opacity 0.25s linear;
  }

  .description__icon {
    fill: white;
    height: 2em;
  }

  .overlay:hover .description {
    opacity: 1;
  }

  canvas {
    display: none;
    pointer-events: none;
    user-select: none;
    object-fit: contain;
    width: 100%;
    height: 100%;
    position: absolute;
    top: 0;
    left: 0;
  }

  canvas.visible {
    display: block;
  }

  canvas.fade-in {
    animation: fade-in 0.25s 1 linear;          
  }

  @keyframes fade-in {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  slot[name='placeholder-image'] img {
    display: block;
    pointer-events: none;
    opacity: 0;
    height: 100%;
    width: 100%;
    margin: 0px auto 0px;
    transition: opacity 0.25s linear;
    object-fit: contain;
  }

  slot[name='placeholder-image'] img.loading {
    opacity: 1;
    filter: brightness(0.4);
    animation: loading-image 1s linear infinite alternate;
  }

  @keyframes loading-image {
    from {
      filter: brightness(0.4);
    }
    to {
      filter: brightness(0.2);
    }
  }`;var fo,Ju,Pa,Rp,Ca,Mp,Ta,Lp,Ia,$p,go,eh;class Op extends xs{constructor(){super();vs(this,fo);vs(this,Pa);vs(this,Ca);vs(this,Ta);vs(this,Ia);vs(this,go);vr(this,"canvasRef",TM());this.description="Click and drag horizontally to rotate image",this.imageUrls=this.getAttribute("items").split(","),this.posterImageSrc=this.imageUrls.length>0?this.imageUrls[0]:"",this.isContinuous=this.getAttribute("continuous")==="true",this.isInteractive=this.getAttribute("interactive")==="true",this.didInteract=!1,this.isReversed=this.getAttribute("reverse")==="true",this.sequenceId=this.getAttribute("sequence-id");const g=.2;this.bufferSize=Math.ceil(this.imageUrls.length*g),this.blitting=null,this.images=Array(this.imageUrls.length).fill(null),this.requests=Array(this.imageUrls.length).fill(null),this.visible=!1,this.index=0,this.intrinsicHeight=0,this.intrinsicWidth=0,this.oldIndex=null,this.oldX=null,this.imageCount=this.imageUrls.length,this.isInteractive&&this.addEventListener("mousemove",this.handleMouseMove.bind(this))}get bufferedPct(){return Math.floor(this.images.filter((g,y)=>co(this,fo,Ju).includes(y)&&g!==null).length/this.bufferSize*100)}get someImagesLoaded(){return this.images.some(g=>g!==null)}connectedCallback(){super.connectedCallback();const g=(k,R)=>{k.forEach(F=>{F.isIntersecting&&(this.visible=!0,R.disconnect())})},y={root:null,threshold:.5};new IntersectionObserver(g,y).observe(this)}debounce(g,y=250,S=!1){let k=null;return function(){const R=this,F=arguments,U=function(){k=null,S||g.apply(R,F)},Z=S&&!k;clearTimeout(k),k=setTimeout(U,y),Z&&g.apply(R,F)}}handleMouseMove({buttons:g,clientX:y}){if(g){if(this.didInteract=!0,this.oldX){const S=y-this.oldX,k=Math.floor(Math.log(Math.abs(S)))||1;S>0?this.isReversed?this.previousImage(k):this.nextImage(k):S<0&&(this.isReversed?this.nextImage(k):this.previousImage(k))}this.oldX=y}else this.oldX=null}nextImage(g=1){const y=this.index+g>=this.imageCount?this.index+g-this.imageCount:this.index+g;this.index=y}willUpdate(g){if(g.has("rotateToIndex")&&this.rotateToIndex!==!1){const y=this.rotateToIndex-this.index+this.bufferSize/2,S=Array(y).fill(0).map((k,R)=>this.index+R+1);Br(this,go,eh).call(this,S).then(this.animateRotation(this.rotateToIndex))}if(g.has("animationFrame")){if(!this.animationFrame||this.images[this.animationFrame]===null)return;Br(this,Ia,$p).call(this,this.images[this.animationFrame])}g.has("index")&&this.someImagesLoaded&&Br(this,go,eh).call(this).then(()=>{this.animateRotation(this.index)}),g.has("visible")&&!this.visible&&Br(this,go,eh).call(this).then(()=>Br(this,Ia,$p).call(this))}animateRotation(g){if(this.animationFrame===g)return;this.animationFrame=this.index;const y=setInterval(()=>{if(this.animationFrame===g&&(this.index=g,this.rotateToIndex=!1,this.synchronizeSequenceInstances()),this.rotateToIndex!==g){clearInterval(y);return}this.animationFrame+=1},this.transition)}previousImage(g=1){const y=this.index-g<0?this.imageCount+this.index-g:this.index-g;this.index=y}synchronizeSequenceInstances(){clearTimeout(this.updateTimer),this.updateTimer=setTimeout(()=>{document.querySelectorAll(`q-image-sequence[sequence-id="${this.sequenceId}"]`).forEach(y=>{parseInt(y.getAttribute("index"))!==this.index&&y.setAttribute("index",this.index)})},250)}render(){const g=this.isInteractive?Aa`<div slot='overlay' class="overlay ${this.didInteract===!1?"visible":""}"><span class="description">
            <svg class="description__icon">
              <symbol id="rotation-icon" viewBox="0 0 24 24">
                <path d="M6.07426 4.68451L6.89234 4.68451L6.89234 6.34444C7.68861 5.65993 8.56396 5.09807 9.5184 4.65884C10.4728 4.21961 11.4791 4 12.5371 4C13.5952 4 14.6014 4.21106 15.5559 4.63317C16.5103 5.05528 17.3856 5.6086 18.1819 6.29311L18.1819 4.68451L19 4.68451L19 7.93593L15.8913 7.93593L15.8913 7.08029L17.7565 7.08029C16.9821 6.39578 16.1694 5.85388 15.3186 5.45458C14.4678 5.05528 13.5406 4.85564 12.5371 4.85564C11.5336 4.85564 10.6092 5.05528 9.76382 5.45458C8.91847 5.85388 8.10311 6.39578 7.31775 7.08029L9.18298 7.08029L9.18298 7.93593L6.07426 7.93593L6.07426 4.68451ZM6.09062 14.0794L7.8086 9.42473L9.05209 9.90389C9.24843 9.98375 9.42023 10.0978 9.56748 10.2461C9.71474 10.3945 9.81018 10.577 9.85381 10.7938L10.1156 12.1457L14.975 9.86966C15.3895 9.67572 15.8067 9.66431 16.2267 9.83544C16.6466 10.0066 16.9493 10.3089 17.1348 10.7424C17.3202 11.1759 17.3338 11.6123 17.1757 12.0515C17.0175 12.4908 16.7312 12.8073 16.3167 13.0013L13.7479 14.1992L13.9115 14.6099C13.9333 14.6555 13.9442 14.7069 13.9442 14.7639L13.9442 14.935L13.8461 17.7415C13.8352 18.0381 13.737 18.3005 13.5516 18.5287C13.3661 18.7569 13.1316 18.9109 12.848 18.9907L9.3466 19.9491C9.03027 20.0403 8.73031 20.009 8.4467 19.8549C8.1631 19.7009 7.95585 19.4699 7.82496 19.1619L6.12334 15.1575C6.04699 14.9864 6.00608 14.8067 6.00063 14.6184C5.99518 14.4302 6.02517 14.2505 6.09062 14.0794ZM6.97415 14.6099L8.83938 19.0079L12.848 17.9469L12.9953 14.4559L12.6189 13.6002L15.9076 12.0601C16.0931 11.9688 16.2185 11.8433 16.284 11.6836C16.3494 11.5239 16.3385 11.3471 16.2512 11.1531C16.164 10.9592 16.044 10.8308 15.8913 10.7681C15.7386 10.7053 15.5695 10.7196 15.3841 10.8109L9.41204 13.5831L8.88847 10.9478L8.38126 10.7595L6.97415 14.6099Z" />
              </symbol>
              <switch>
                <use xlink:href="#rotation-icon"></use>
              </switch>
            </svg>
            <span class="description__text">${this.description}</span>
          </span></div>`:"";return Aa`<div class="image-sequence ${co(this,Pa,Rp)?"":"loading"} ${this.isInteractive?"interactive":""}">
        <slot name="loading-overlay">
          <div slot="loading-overlay" class='${co(this,Pa,Rp)?"":"visible"} loading overlay'>
            <div class="buffering-indicator">Loading Image Sequence&nbsp;(${this.bufferedPct}%)...</div>
            </div>
        </slot>
        <canvas ${OM(this.canvasRef)} height="${this.intrinsicHeight}" width="${this.intrinsicWidth}" class="${this.someImagesLoaded?"visible":""} ${this.didInteract?"":"fade-in"}" slot="images"></canvas>
        <slot name="overlay">
          ${g}
        </slot>
      </div>`}}fo=new WeakSet,Ju=function(){const g=this.images.length,y=g+this.index-Math.round(this.bufferSize/2);return Array(this.bufferSize).fill(0).map((S,k)=>(y+k)%g)},Pa=new WeakSet,Rp=function(){return this.images.filter((g,y)=>co(this,fo,Ju).includes(y)&&g!==null).length===this.bufferSize},Ca=new WeakSet,Mp=function(g,y){if(this.requests[y])return;const S=new Request(g),k=fetch(S).then(R=>R.blob()).then(R=>window.createImageBitmap(R)).then(R=>{this.intrinsicHeight===0&&(this.intrinsicHeight=R.height,this.intrinsicWidth=R.width),this.images[y]=R}).then(()=>{this.requests[y]=null,this.requestUpdate()}).catch(R=>{console.error(R)});return this.requests[y]=k,k},Ta=new WeakSet,Lp=function(g){this.context.drawImage(g,0,0)},Ia=new WeakSet,$p=function(g){if(this.canvasRef.value){if(this.context??(this.context=this.canvasRef.value.getContext("2d")),g){window.cancelAnimationFrame(this.blitting),this.blitting=window.requestAnimationFrame(()=>Br(this,Ta,Lp).call(this,g));return}if(!this.images[this.index]){Br(this,Ca,Mp).call(this,this.imageUrls[this.index],this.index);return}window.cancelAnimationFrame(this.blitting),this.blitting=window.requestAnimationFrame(()=>Br(this,Ta,Lp).call(this,this.images[this.index]))}},go=new WeakSet,eh=function(g){if(!this.images.some(k=>k===null))return Promise.all([]);const y=g??co(this,fo,Ju),S=this.images.map((k,R)=>{if(!y.includes(R)||k!==null)return null;const F=this.imageUrls[R];return Br(this,Ca,Mp).call(this,F,R)}).filter(k=>k);return Promise.all(S)},vr(Op,"styles",[RM]),vr(Op,"properties",{animationFrame:{type:Number,state:!0},bufferSize:{type:Number,state:!0},didInteract:{type:Boolean,state:!0},images:{type:Array,state:!0},imageUrls:{attribute:"image-urls",type:String},index:{type:Number},intrinsicHeight:{type:Number,state:!0},intrinsicWidth:{type:Number,state:!0},rotateToIndex:{attribute:"rotate-to-index",type:Number},transition:{type:Number},visible:{type:Boolean,state:!0}});customElements.define("q-image-sequence",Op);/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */class Np extends Tw{constructor(w){if(super(w),this.et=Gt,w.type!==Pw.CHILD)throw Error(this.constructor.directiveName+"() can only be used in child bindings")}render(w){if(w===Gt||w==null)return this.ft=void 0,this.et=w;if(w===Ss)return w;if(typeof w!="string")throw Error(this.constructor.directiveName+"() called with a non-string value");if(w===this.et)return this.ft;this.et=w;const g=[w];return g.raw=g,this.ft={_$litType$:this.constructor.resultType,strings:g,values:[]}}}Np.directiveName="unsafeHTML",Np.resultType=1;const xa=Cw(Np);class Ow extends xs{setupStyles(){let w=this.querySelector('style[slot="lightbox-styles"]');w&&w.sheet&&(this.adoptedStyleSheets=[w.sheet])}constructor(){super(),this.setupStyles(),this.setupFiguresData(),this.setupFullscreenButton(),this.setupNavigationButtons(),this.setupKeyboardControls()}get counterCurrent(){return this.querySelector("[data-lightbox-counter-current]")}get counterTotal(){return this.querySelector("[data-lightbox-counter-total]")}get fullscreenButton(){return this.querySelector("[data-lightbox-fullscreen]")}get nextButton(){return this.querySelector("[data-lightbox-next]")}get previousButton(){return this.querySelector("[data-lightbox-previous]")}get slides(){return this.querySelectorAll(".q-lightbox-slides__slide")}get slideIds(){return Array.from(this.slides).map(w=>w.id)}get currentSlide(){if(this.slides.length)return this.currentId?this.slides[this.currentSlideIndex]:this.slides[0]}get currentSlideIndex(){if(this.slides.length)return this.currentId?this.slideIds.findIndex(w=>w===this.currentId):0}get fullscreen(){return document.fullscreen||this.wrapper.classList.contains("quire-entry__lightbox--fullscreen")}get wrapper(){return document.querySelector(".quire-entry__lightbox")}enterFullscreen(){const w=this.renderRoot.firstElementChild;w.requestFullscreen?w.requestFullscreen():(this.wrapper.classList.add("quire-entry__lightbox--fullscreen"),document.body.style.position="fixed",document.body.style.top=`-${window.scrollY}px`)}exitFullscreen(){document.exitFullscreen?document.exitFullscreen():(this.wrapper.classList.remove("quire-entry__lightbox--fullscreen"),document.body.style.position="",document.body.style.top="")}next(){if(!this.slides.length)return;const w=this.currentSlideIndex+1,g=this.slideIds[w%this.slides.length];this.currentId=g}previous(){if(!this.slides.length)return;const w=this.currentSlideIndex-1,g=this.slideIds.slice(w)[0];this.currentId=g}_alignSlideData(w){const{aspect_ratio:g="widescreen",caption:y,credit:S,id:k,isSequence:R,label:F,mediaType:U}=w;return{...w,isAudio:U==="soundcloud",isVideo:U==="video"||U==="vimeo"||U==="youtube",aspectRatio:g}}_lightboxSlide(w){const{id:g,mediaType:y,figureElementContent:S,annotationsElementContent:k,aspectRatio:R,isVideo:F,isAudio:U,label:Z,labelHtml:ne,caption:C,captionHtml:D,credit:Re,creditHtml:le}=w,lt=`q-lightbox-slides__element--${y}`,qe=F?`q-lightbox-slides__element--video q-lightbox-slides__element--${R}`:"";return Aa`<div class="q-lightbox-slides__slide" slot="slides" id="${g}">
      <div class="q-lightbox-slides__element ${lt} ${qe} ${U?"q-lightbox-slides__element--audio":""}">
        ${xa(S)}
      </div>
      <div class="q-figure-slides__slide-ui">
        <div class="q-lightbox-slides__caption ${Z||C||Re?"":"is-hidden"}">
          <span class="q-lightbox-slides__caption-label ${Z?"":"is-hidden"}">${xa(ne)}</span>
          <span class="q-lightbox-slides__caption-content ${C||Re?"":"is-hidden"}">${D?xa(D):""} ${le?xa(le):""}</span>
        </div>
        ${xa(k??"")}
      </div>
    </div>`}setupFiguresData(){const w=this.querySelector('script[type="application/json"]'),g=JSON.parse(w.innerHTML);this.figures=g,g.forEach(y=>{console.log("Rendering",y.id);const S=this._alignSlideData(y);let k=document.createElement("template");kw(this._lightboxSlide(S),k.content);const R=k.content.cloneNode(!0);this.appendChild(R)})}setupFullscreenButton(){this.fullscreenButton&&this.fullscreenButton.addEventListener("click",()=>{this.toggleFullscreen()})}setupNavigationButtons(){!this.nextButton||!this.previousButton||(this.nextButton.addEventListener("click",()=>{this.next()}),this.previousButton.addEventListener("click",()=>{this.previous()}))}setupKeyboardControls(){document.addEventListener("keyup",({code:w})=>{if(this.slides.length>1)switch(w){default:break;case"ArrowRight":this.next();break;case"ArrowLeft":this.previous();break}})}toggleFullscreen(){this.updateFullscreenButton(),this.fullscreen?this.exitFullscreen():this.enterFullscreen()}updateCounterElements(){!this.counterCurrent||!this.counterTotal||(this.counterCurrent.innerText=this.currentSlideIndex+1,this.counterTotal.innerText=this.slides.length)}updateCurrentSlideElement(){this.currentSlide&&(this.slides.forEach(w=>{w.id!==this.currentId&&delete w.dataset.lightboxCurrent,[this.preloadNextId,this.preloadPrevId].includes(w.id)?w.dataset.lightboxPreload=!0:delete w.dataset.lightboxPreload}),this.currentSlide.dataset.lightboxCurrent=!0)}updateFullscreenButton(){this.fullscreenButton&&(this.fullscreenButton.dataset.lightboxFullscreen=!this.fullscreen)}render(){return this.slides.length?(this.currentId=this.slideIds[this.currentSlideIndex],this.preloadNextId=this.currentSlideIndex+1<this.slideIds.length?this.slideIds[this.currentSlideIndex+1]:void 0,this.preloadPrevId=this.currentSlideIndex-1>=0?this.slideIds[this.currentSlideIndex-1]:void 0,this.updateCurrentSlideElement(),this.updateCounterElements(),Aa`
      <div class="q-lightbox">
        <slot name="lightbox-styles"></slot>
        <slot name="data"></slot>
        <div class="q-lightbox-slides">
          <slot name="slides"></slot>
        </div>
        <slot name="ui"></slot>
      </div>
    `):""}}vr(Ow,"properties",{currentId:{attribute:"current-id",type:String},preloadNextId:{attribute:"preload-next-id",type:String},preloadPrevId:{attribute:"preload-prev-id",type:String}});customElements.define("q-lightbox",Ow);class Rw extends xs{get closeButton(){return this.querySelector("[data-modal-close]")}get lightbox(){return this.querySelector("q-lightbox")}constructor(){super(),this.setupKeyboardControls(),this.setupModalTriggers()}close(){this.active=!1,this.currentId=null,this.updateLightboxCurrentId(),this.enableScrolling()}disableScrolling(){document.querySelector("html").style.overflow="hidden"}enableScrolling(){document.querySelector("html").style.overflow="auto"}getCurrentFigureId(w){const{target:g}=w;let y=g;for(;!y.matches("figure")&&!y.getAttribute("id");)y=y.parentNode;return y.getAttribute("id")}open(w){this.currentId=this.getCurrentFigureId(w),this.active=!0,this.updateLightboxCurrentId(),this.disableScrolling()}setupCloseButton(){this.closeButton&&this.closeButton.addEventListener("click",()=>{this.close()})}setupKeyboardControls(){document.addEventListener("keyup",({code:w})=>{this.active&&w==="Escape"&&this.close()})}setupModalTriggers(){document.querySelectorAll(".q-figure__modal-link").forEach(w=>{w.addEventListener("click",g=>{g.preventDefault(),this.open(g)})})}updateLightboxCurrentId(){this.lightbox&&this.lightbox.setAttribute("current-id",this.currentId)}render(){return this.dataset.modalActive=this.active,this.setupCloseButton(),Aa`
      <div class="q-modal">
        <slot></slot>
      </div>
    `}}vr(Rw,"properties",{active:{type:Boolean},currentId:{attribute:"current-id",type:String}});customElements.define("q-modal",Rw);var br;const Et=(br=class{constructor(w){this.copyLinkButton=w.querySelector(".accordion-section__copy-link-button"),this.element=w,this.id=w.getAttribute("id"),this.globalExpand=document.querySelector(".global-accordion-expand-all"),this.globalCollapse=document.querySelector(".global-accordion-collapse-all"),this.tooltip=w.querySelector(".accordion-tooltip")}get parentAccordions(){return Array.from(Et.elements).filter(w=>w.contains(this.element)&&w!=this.element)}static setGlobalControls(){if(!(!!Et.globalCollapse&&!!Et.globalExpand))return;const g=this.globalControlsState,y=Et.elements.length,S=Array.from(Et.elements).filter(R=>R.getAttribute("open")===null).length,k=()=>{let R;switch(!0){case S===y:R="allClosed";break;case S===0:R="allOpen";break;default:R="mixed";break}return R};if(g!==k())switch(this.globalControlsState=k(),this.globalControlsState){case"allClosed":Et.globalExpand.classList.remove("visually-hidden"),Et.globalCollapse.classList.add("visually-hidden");break;case"allOpen":Et.globalExpand.classList.add("visually-hidden"),Et.globalCollapse.classList.remove("visually-hidden");break;default:Et.globalCollapse.classList.remove("visually-hidden"),Et.globalExpand.classList.remove("visually-hidden");break}}static setup(){Et.elements.length&&(Et.elements.forEach(w=>{new Et(w).init()}),Et.setGlobalControls())}addEventListeners(){this.copyLinkButton.addEventListener("click",this.copyLink.bind(this)),this.element.addEventListener("toggle",Et.setGlobalControls.bind(this)),Et.globalExpand&&Et.globalExpand.addEventListener("click",this.open.bind(this)),Et.globalCollapse&&Et.globalCollapse.addEventListener("click",this.close.bind(this))}close(){this.element.removeAttribute("open"),Et.setGlobalControls()}copyLink(){if(this.copying)return;this.copying=!0;const w=this.copyLinkButton.getAttribute("value"),{origin:g,pathname:y}=window.location;this.tooltip.classList.add("accordion-tooltip--active");try{const S=new URL(y+w,g);navigator.clipboard.writeText(S),window.history.replaceState({},"",S),setTimeout(()=>{this.tooltip.classList.remove("accordion-tooltip--active"),this.copying=!1},2e3)}catch(S){console.error("Error copying heading link: ",S)}}init(){this.addEventListeners(),this.setStateFromUrl()}open(){this.element.setAttribute("open",!0),Et.setGlobalControls()}setStateFromUrl(){const w=window.location.hash.replace(/^#/,"");if(!w)return;const g=document.querySelector(window.location.hash);(w===this.id||this.element.contains(g))&&(this.open(),this.parentAccordions&&this.parentAccordions.length&&this.parentAccordions.forEach(y=>y.setAttribute("open",!0)))}},vr(br,"className","accordion-section"),vr(br,"globalExpand",document.querySelector(".global-accordion-expand-all")),vr(br,"globalCollapse",document.querySelector(".global-accordion-collapse-all")),vr(br,"elements",document.querySelectorAll(`.${br.className}`)),vr(br,"partOfAccordion",w=>w.closest(`.${br.className}`)),br),MM=(L,w,g={})=>{const y={root:document.querySelector(".quire-entry__content"),rootMargin:"-50% 0% -50% 0%",threshold:0,...g},S=R=>{R.forEach(F=>{F.isIntersecting&&w()})};new IntersectionObserver(S,y).observe(L)},LM=({callback:L,interval:w=200,maxTries:g=10,tries:y=0,validate:S})=>{const k=()=>{if(y===g){console.error("Polling reached maximum number of attempts");return}y++,S()?L():setTimeout(k,w)};k()};function $M(L,w=null,g=null){const y=document.querySelector(".quire-navbar"),S=7,k=y?L-y.clientHeight-S:L-S;[document.documentElement,document.body.parentNode,document.body].forEach(F=>{F.scrollTop=k})}const jp=L=>{if(!L)return;L=L.replace(":","\\:"),L=L.replace(".","\\.");const w=document.querySelector(L);if(w){Et.partOfAccordion(w)&&new Et(w.closest(`.${Et.className}`)).setStateFromUrl();const g=w.getBoundingClientRect().top+window.scrollY;$M(g),setTimeout(()=>w.focus())}},Mw=L=>({checked:L.checked,id:L.getAttribute("value"),input:L.getAttribute("type"),type:L.getAttribute("data-annotation-type")}),Lw=L=>{if(!L)return;const w=L.querySelector("canvas-panel"),g=L.querySelector("q-image-sequence"),y=L.querySelector("image-service");return w?w.getAttribute("canvas-id"):y?y.getAttribute("src"):g?g.getAttribute("sequence-id"):void 0},gw=L=>{const[w,g,y,S]=L.split(",").map(k=>parseInt(k.trim()));return{x:w,y:g,width:y,height:S}},zp=function({annotationIds:L=[],figureId:w,historyBehavior:g="push",region:y,sequence:S={}}){if(!w){console.error("goToFigureState called without an undefined figureId");return}const k=`#${w}`,R=`[slot="slides"][id="${w}"]`,F=document.querySelector(k),U=document.querySelector(R),Z=Lw(F||U);if(!F&&!U)return;const ne=U.closest("q-lightbox");if(ne.currentId=w,!Z)return;const D=[...document.querySelectorAll(`#${w} .annotations-ui__input, [slot="slides"][id="${w}"] .annotations-ui__input`)].map(De=>{const je=De.getAttribute("data-annotation-id");return De.checked=L.includes(je),Mw(De)});Et.elements.forEach(De=>{De.contains(F)&&De.setAttribute("open",!0)}),$w(Z,{annotations:D,region:y||"reset",sequence:S});const Re=new URL(window.location.pathname,window.location.origin);Re.hash=w,jp(Re.hash);const le=new URLSearchParams(L.map(De=>["annotation-id",encodeURIComponent(De)]));y&&le.set("region",encodeURIComponent(y)),Number.isInteger(parseInt(S.index))&&le.set("sequence-index",encodeURIComponent(S.index));const lt=le.toString(),qe=[Re.pathname];lt&&qe.push(lt);const Ct=[{},"",`${qe.join("?")}${Re.hash}`];g==="replace"?window.history.replaceState(...Ct):window.history.pushState(...Ct)},mw=L=>{const w=L.getAttribute("id"),g=Lw(L.closest(".q-figure, .q-lightbox-slides__slide")),y=document.querySelector("q-lightbox").contains(L),S=Mw(L),{checked:k,input:R,type:F}=S;if(y){const U=document.querySelector(`#${w.split("lightbox-")[1]}`);U&&(U.checked=L.checked)}else{const U=document.querySelector(`#${["lightbox",w].join("-")}`);U&&(U.checked=L.checked)}if(R==="checkbox"&&F==="choice"){const U=L.closest("form"),Z=U.querySelectorAll(".annotations-ui__input[checked]");if(!k&&Z.length===1&&Z[0].setAttribute("disabled",!0),k){const ne=U.querySelector("[disabled]");ne&&ne.removeAttribute("disabled")}}$w(g,{annotations:[S]})},NM=(L,w)=>{const{checked:g,id:y,type:S}=w;switch(S){case"annotation":L.applyStyles(y,{opacity:+!!g});break;case"choice":LM({callback:()=>zM(L,w),validate:()=>!!L.makeChoice});break}},zM=(L,w)=>{const{checked:g,id:y,input:S}=w;L.setAttribute("choice-id",y),L.makeChoice(y,{deselect:!g,deselectOthers:S==="radio"})},FM=()=>{const L=document.querySelectorAll(".ref");for(const g of L){let y=g.getAttribute("data-annotation-ids");y=y.length?y.split(","):void 0;const S=g.getAttribute("data-figure-id"),k={index:parseInt(g.getAttribute("data-sequence-index")),transition:parseInt(g.getAttribute("data-sequence-transition"))},R=g.getAttribute("data-region");g.getAttribute("data-on-scroll")==="true"?MM(g,()=>zp({annotationIds:y,figureId:S,historyBehavior:"replace",region:R,sequence:k})):g.addEventListener("click",({target:U})=>zp({annotationIds:y,figureId:S,region:R,sequence:k}))}const w=document.querySelectorAll(".annotations-ui__input");for(const g of w)mw(g),g.addEventListener("click",({target:y})=>mw(y))},$w=(L,w)=>{const g=document.querySelectorAll(`canvas-panel[canvas-id="${L}"], image-service[src="${L}"], q-image-sequence[sequence-id="${L}"]`);g.length||console.error(`Failed to call update on canvas panel or image-service component with id ${L}. Element does not exist.`);const{annotations:y,region:S}=w;g.forEach(k=>{const R=k.tagName.toLowerCase()==="q-image-sequence";if(R&&BM(k,w),S&&!R){const F=gw(S&&S!=="reset"?S:k.getAttribute("region")),U={easing:k.easingFunctions().easeOutExpo,duration:2e3};setTimeout((()=>{k.transition(ne=>{ne.goToRegion(F,{transition:U})})})(),500)}Array.isArray(y)&&y.forEach(F=>NM(k,F))})},BM=(L,{sequence:w={}})=>{const{index:g,transition:y}=w,S=parseInt(L.getAttribute("index")),k=parseInt(g);if(Number.isInteger(k)&&k>=0&&S!==k){if(y){L.setAttribute("transition",y),L.setAttribute("rotate-to-index",k);return}L.setAttribute("rotate-to-index",!1),L.setAttribute("index",k)}};var Nw=Nw||{};Nw.Widget=function(L){function w(y){if(g[y])return g[y].exports;var S=g[y]={exports:{},id:y,loaded:!1};return L[y].call(S.exports,S,S.exports,w),S.loaded=!0,S.exports}var g={};return w.m=L,w.c=g,w.p="",w(0)}([function(L,w,g){function y(K){return!!(K===""||K&&K.charCodeAt&&K.substr)}function S(K){return!!(K&&K.constructor&&K.call&&K.apply)}function k(K){return!(!K||K.nodeType!==1||K.nodeName.toUpperCase()!=="IFRAME")}function R(K){var se,ce=!1;for(se in it)if(it.hasOwnProperty(se)&&it[se]===K){ce=!0;break}return ce}function F(K){var se,ce,ee;for(se=0,ce=Zi.length;se<ce&&(ee=K(Zi[se]),ee!==!1);se++);}function U(K){var se,ce,ee,Me="";for(K.substr(0,2)==="//"&&(K=window.location.protocol+K),ee=K.split("/"),se=0,ce=ee.length;se<ce&&se<3;se++)Me+=ee[se],se<2&&(Me+="/");return Me}function Z(K){return K.contentWindow?K.contentWindow:K.contentDocument&&"parentWindow"in K.contentDocument?K.contentDocument.parentWindow:null}function ne(K){var se,ce=[];for(se in K)K.hasOwnProperty(se)&&ce.push(K[se]);return ce}function C(K,se,ce){ce.callbacks[K]=ce.callbacks[K]||[],ce.callbacks[K].push(se)}function D(K,se){var ce,ee=!0;return se.callbacks[K]=[],F(function(Me){if(ce=Me.callbacks[K]||[],ce.length)return ee=!1,!1}),ee}function Re(K,se,ce){var ee,Me,nt=Z(ce);return!!nt.postMessage&&(ee=ce.getAttribute("src").split("?")[0],Me=JSON.stringify({method:K,value:se}),ee.substr(0,2)==="//"&&(ee=window.location.protocol+ee),ee=ee.replace(/http:\/\/(w|wt).soundcloud.com/,"https://$1.soundcloud.com"),void nt.postMessage(Me,ee))}function le(K){var se;return F(function(ce){if(ce.instance===K)return se=ce,!1}),se}function lt(K){var se;return F(function(ce){if(Z(ce.element)===K)return se=ce,!1}),se}function qe(K,se){return function(ce){var ee=S(ce),Me=le(this),nt=!ee&&se?ce:null,Ei=ee&&!se?ce:null;return Ei&&C(K,Ei,Me),Re(K,nt,Me.element),this}}function Ct(K,se,ce){var ee,Me,nt;for(ee=0,Me=se.length;ee<Me;ee++)nt=se[ee],K[nt]=qe(nt,ce)}function De(K,se,ce){return K+"?url="+se+"&"+je(ce)}function je(K){var se,ce,ee=[];for(se in K)K.hasOwnProperty(se)&&(ce=K[se],ee.push(se+"="+(se==="start_track"?parseInt(ce,10):ce?"true":"false")));return ee.join("&")}function Yt(K,se,ce){var ee,Me,nt=K.callbacks[se]||[];for(ee=0,Me=nt.length;ee<Me;ee++)nt[ee].apply(K.instance,ce);(R(se)||se===Nt.READY)&&(K.callbacks[se]=[])}function Ze(K){var se,ce,ee,Me,nt;try{ce=JSON.parse(K.data)}catch{return!1}return se=lt(K.source),ee=ce.method,Me=ce.value,(!se||Ht(K.origin)===Ht(se.domain))&&(se?(ee===Nt.READY&&(se.isReady=!0,Yt(se,er),D(er,se)),ee!==Nt.PLAY||se.playEventFired||(se.playEventFired=!0),ee!==Nt.PLAY_PROGRESS||se.playEventFired||(se.playEventFired=!0,Yt(se,Nt.PLAY,[Me])),nt=[],Me!==void 0&&nt.push(Me),void Yt(se,ee,nt)):(ee===Nt.READY&&hr.push(K.source),!1))}function Ht(K){return K.replace(me,"")}var Si,N,$i,wr=g(1),it=g(2),ei=g(3),Nt=wr.api,ji=wr.bridge,hr=[],Zi=[],er="__LATE_BINDING__",cr="http://wt.soundcloud.test:9200/",me=/^http(?:s?)/;window.addEventListener?window.addEventListener("message",Ze,!1):window.attachEvent("onmessage",Ze),L.exports=$i=function(K,se,ce){if(y(K)&&(K=document.getElementById(K)),!k(K))throw new Error("SC.Widget function should be given either iframe element or a string specifying id attribute of iframe element.");se&&(ce=ce||{},K.src=De(cr,se,ce));var ee,Me,nt=lt(Z(K));return nt&&nt.instance?nt.instance:(ee=hr.indexOf(Z(K))>-1,Me=new Si(K),Zi.push(new N(Me,K,ee)),Me)},$i.Events=Nt,window.SC=window.SC||{},window.SC.Widget=$i,N=function(K,se,ce){this.instance=K,this.element=se,this.domain=U(se.getAttribute("src")),this.isReady=!!ce,this.callbacks={}},Si=function(){},Si.prototype={constructor:Si,load:function(K,se){if(K){se=se||{};var ce=this,ee=le(this),Me=ee.element,nt=Me.src,Ei=nt.substr(0,nt.indexOf("?"));ee.isReady=!1,ee.playEventFired=!1,Me.onload=function(){ce.bind(Nt.READY,function(){var yt,Es=ee.callbacks;for(yt in Es)Es.hasOwnProperty(yt)&&yt!==Nt.READY&&Re(ji.ADD_LISTENER,yt,ee.element);se.callback&&se.callback()})},Me.src=De(Ei,K,se)}},bind:function(K,se){var ce=this,ee=le(this);return ee&&ee.element&&(K===Nt.READY&&ee.isReady?setTimeout(se,1):ee.isReady?(C(K,se,ee),Re(ji.ADD_LISTENER,K,ee.element)):C(er,function(){ce.bind(K,se)},ee)),this},unbind:function(K){var se,ce=le(this);ce&&ce.element&&(se=D(K,ce),K!==Nt.READY&&se&&Re(ji.REMOVE_LISTENER,K,ce.element))}},Ct(Si.prototype,ne(it)),Ct(Si.prototype,ne(ei),!0)},function(L,w){w.api={LOAD_PROGRESS:"loadProgress",PLAY_PROGRESS:"playProgress",PLAY:"play",PAUSE:"pause",FINISH:"finish",SEEK:"seek",READY:"ready",OPEN_SHARE_PANEL:"sharePanelOpened",CLICK_DOWNLOAD:"downloadClicked",CLICK_BUY:"buyClicked",ERROR:"error"},w.bridge={REMOVE_LISTENER:"removeEventListener",ADD_LISTENER:"addEventListener"}},function(L,w){L.exports={GET_VOLUME:"getVolume",GET_DURATION:"getDuration",GET_POSITION:"getPosition",GET_SOUNDS:"getSounds",GET_CURRENT_SOUND:"getCurrentSound",GET_CURRENT_SOUND_INDEX:"getCurrentSoundIndex",IS_PAUSED:"isPaused"}},function(L,w){L.exports={PLAY:"play",PAUSE:"pause",TOGGLE:"toggle",SEEK_TO:"seekTo",SET_VOLUME:"setVolume",NEXT:"next",PREV:"prev",SKIP:"skip"}}]);var zw={exports:{}};/**
 * lunr - http://lunrjs.com - A bit like Solr, but much smaller and not as bright - 2.3.9
 * Copyright (C) 2020 Oliver Nightingale
 * @license MIT
 */(function(L,w){(function(){var g=function(y){var S=new g.Builder;return S.pipeline.add(g.trimmer,g.stopWordFilter,g.stemmer),S.searchPipeline.add(g.stemmer),y.call(S,S),S.build()};g.version="2.3.9";/*!
 * lunr.utils
 * Copyright (C) 2020 Oliver Nightingale
 */g.utils={},g.utils.warn=function(y){return function(S){y.console&&console.warn&&console.warn(S)}}(this),g.utils.asString=function(y){return y==null?"":y.toString()},g.utils.clone=function(y){if(y==null)return y;for(var S=Object.create(null),k=Object.keys(y),R=0;R<k.length;R++){var F=k[R],U=y[F];if(Array.isArray(U)){S[F]=U.slice();continue}if(typeof U=="string"||typeof U=="number"||typeof U=="boolean"){S[F]=U;continue}throw new TypeError("clone is not deep and does not support nested objects")}return S},g.FieldRef=function(y,S,k){this.docRef=y,this.fieldName=S,this._stringValue=k},g.FieldRef.joiner="/",g.FieldRef.fromString=function(y){var S=y.indexOf(g.FieldRef.joiner);if(S===-1)throw"malformed field ref string";var k=y.slice(0,S),R=y.slice(S+1);return new g.FieldRef(R,k,y)},g.FieldRef.prototype.toString=function(){return this._stringValue==null&&(this._stringValue=this.fieldName+g.FieldRef.joiner+this.docRef),this._stringValue};/*!
 * lunr.Set
 * Copyright (C) 2020 Oliver Nightingale
 */g.Set=function(y){if(this.elements=Object.create(null),y){this.length=y.length;for(var S=0;S<this.length;S++)this.elements[y[S]]=!0}else this.length=0},g.Set.complete={intersect:function(y){return y},union:function(){return this},contains:function(){return!0}},g.Set.empty={intersect:function(){return this},union:function(y){return y},contains:function(){return!1}},g.Set.prototype.contains=function(y){return!!this.elements[y]},g.Set.prototype.intersect=function(y){var S,k,R,F=[];if(y===g.Set.complete)return this;if(y===g.Set.empty)return y;this.length<y.length?(S=this,k=y):(S=y,k=this),R=Object.keys(S.elements);for(var U=0;U<R.length;U++){var Z=R[U];Z in k.elements&&F.push(Z)}return new g.Set(F)},g.Set.prototype.union=function(y){return y===g.Set.complete?g.Set.complete:y===g.Set.empty?this:new g.Set(Object.keys(this.elements).concat(Object.keys(y.elements)))},g.idf=function(y,S){var k=0;for(var R in y)R!="_index"&&(k+=Object.keys(y[R]).length);var F=(S-k+.5)/(k+.5);return Math.log(1+Math.abs(F))},g.Token=function(y,S){this.str=y||"",this.metadata=S||{}},g.Token.prototype.toString=function(){return this.str},g.Token.prototype.update=function(y){return this.str=y(this.str,this.metadata),this},g.Token.prototype.clone=function(y){return y=y||function(S){return S},new g.Token(y(this.str,this.metadata),this.metadata)};/*!
 * lunr.tokenizer
 * Copyright (C) 2020 Oliver Nightingale
 */g.tokenizer=function(y,S){if(y==null||y==null)return[];if(Array.isArray(y))return y.map(function(Re){return new g.Token(g.utils.asString(Re).toLowerCase(),g.utils.clone(S))});for(var k=y.toString().toLowerCase(),R=k.length,F=[],U=0,Z=0;U<=R;U++){var ne=k.charAt(U),C=U-Z;if(ne.match(g.tokenizer.separator)||U==R){if(C>0){var D=g.utils.clone(S)||{};D.position=[Z,C],D.index=F.length,F.push(new g.Token(k.slice(Z,U),D))}Z=U+1}}return F},g.tokenizer.separator=/[\s\-]+/;/*!
 * lunr.Pipeline
 * Copyright (C) 2020 Oliver Nightingale
 */g.Pipeline=function(){this._stack=[]},g.Pipeline.registeredFunctions=Object.create(null),g.Pipeline.registerFunction=function(y,S){S in this.registeredFunctions&&g.utils.warn("Overwriting existing registered function: "+S),y.label=S,g.Pipeline.registeredFunctions[y.label]=y},g.Pipeline.warnIfFunctionNotRegistered=function(y){var S=y.label&&y.label in this.registeredFunctions;S||g.utils.warn(`Function is not registered with pipeline. This may cause problems when serialising the index.
`,y)},g.Pipeline.load=function(y){var S=new g.Pipeline;return y.forEach(function(k){var R=g.Pipeline.registeredFunctions[k];if(R)S.add(R);else throw new Error("Cannot load unregistered function: "+k)}),S},g.Pipeline.prototype.add=function(){var y=Array.prototype.slice.call(arguments);y.forEach(function(S){g.Pipeline.warnIfFunctionNotRegistered(S),this._stack.push(S)},this)},g.Pipeline.prototype.after=function(y,S){g.Pipeline.warnIfFunctionNotRegistered(S);var k=this._stack.indexOf(y);if(k==-1)throw new Error("Cannot find existingFn");k=k+1,this._stack.splice(k,0,S)},g.Pipeline.prototype.before=function(y,S){g.Pipeline.warnIfFunctionNotRegistered(S);var k=this._stack.indexOf(y);if(k==-1)throw new Error("Cannot find existingFn");this._stack.splice(k,0,S)},g.Pipeline.prototype.remove=function(y){var S=this._stack.indexOf(y);S!=-1&&this._stack.splice(S,1)},g.Pipeline.prototype.run=function(y){for(var S=this._stack.length,k=0;k<S;k++){for(var R=this._stack[k],F=[],U=0;U<y.length;U++){var Z=R(y[U],U,y);if(!(Z==null||Z===""))if(Array.isArray(Z))for(var ne=0;ne<Z.length;ne++)F.push(Z[ne]);else F.push(Z)}y=F}return y},g.Pipeline.prototype.runString=function(y,S){var k=new g.Token(y,S);return this.run([k]).map(function(R){return R.toString()})},g.Pipeline.prototype.reset=function(){this._stack=[]},g.Pipeline.prototype.toJSON=function(){return this._stack.map(function(y){return g.Pipeline.warnIfFunctionNotRegistered(y),y.label})};/*!
 * lunr.Vector
 * Copyright (C) 2020 Oliver Nightingale
 */g.Vector=function(y){this._magnitude=0,this.elements=y||[]},g.Vector.prototype.positionForIndex=function(y){if(this.elements.length==0)return 0;for(var S=0,k=this.elements.length/2,R=k-S,F=Math.floor(R/2),U=this.elements[F*2];R>1&&(U<y&&(S=F),U>y&&(k=F),U!=y);)R=k-S,F=S+Math.floor(R/2),U=this.elements[F*2];if(U==y||U>y)return F*2;if(U<y)return(F+1)*2},g.Vector.prototype.insert=function(y,S){this.upsert(y,S,function(){throw"duplicate index"})},g.Vector.prototype.upsert=function(y,S,k){this._magnitude=0;var R=this.positionForIndex(y);this.elements[R]==y?this.elements[R+1]=k(this.elements[R+1],S):this.elements.splice(R,0,y,S)},g.Vector.prototype.magnitude=function(){if(this._magnitude)return this._magnitude;for(var y=0,S=this.elements.length,k=1;k<S;k+=2){var R=this.elements[k];y+=R*R}return this._magnitude=Math.sqrt(y)},g.Vector.prototype.dot=function(y){for(var S=0,k=this.elements,R=y.elements,F=k.length,U=R.length,Z=0,ne=0,C=0,D=0;C<F&&D<U;)Z=k[C],ne=R[D],Z<ne?C+=2:Z>ne?D+=2:Z==ne&&(S+=k[C+1]*R[D+1],C+=2,D+=2);return S},g.Vector.prototype.similarity=function(y){return this.dot(y)/this.magnitude()||0},g.Vector.prototype.toArray=function(){for(var y=new Array(this.elements.length/2),S=1,k=0;S<this.elements.length;S+=2,k++)y[k]=this.elements[S];return y},g.Vector.prototype.toJSON=function(){return this.elements};/*!
 * lunr.stemmer
 * Copyright (C) 2020 Oliver Nightingale
 * Includes code from - http://tartarus.org/~martin/PorterStemmer/js.txt
 */g.stemmer=function(){var y={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},S={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},k="[^aeiou]",R="[aeiouy]",F=k+"[^aeiouy]*",U=R+"[aeiou]*",Z="^("+F+")?"+U+F,ne="^("+F+")?"+U+F+"("+U+")?$",C="^("+F+")?"+U+F+U+F,D="^("+F+")?"+R,Re=new RegExp(Z),le=new RegExp(C),lt=new RegExp(ne),qe=new RegExp(D),Ct=/^(.+?)(ss|i)es$/,De=/^(.+?)([^s])s$/,je=/^(.+?)eed$/,Yt=/^(.+?)(ed|ing)$/,Ze=/.$/,Ht=/(at|bl|iz)$/,Si=new RegExp("([^aeiouylsz])\\1$"),N=new RegExp("^"+F+R+"[^aeiouwxy]$"),$i=/^(.+?[^aeiou])y$/,wr=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/,it=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/,ei=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/,Nt=/^(.+?)(s|t)(ion)$/,ji=/^(.+?)e$/,hr=/ll$/,Zi=new RegExp("^"+F+R+"[^aeiouwxy]$"),er=function(me){var K,se,ce,ee,Me,nt,Ei;if(me.length<3)return me;if(ce=me.substr(0,1),ce=="y"&&(me=ce.toUpperCase()+me.substr(1)),ee=Ct,Me=De,ee.test(me)?me=me.replace(ee,"$1$2"):Me.test(me)&&(me=me.replace(Me,"$1$2")),ee=je,Me=Yt,ee.test(me)){var yt=ee.exec(me);ee=Re,ee.test(yt[1])&&(ee=Ze,me=me.replace(ee,""))}else if(Me.test(me)){var yt=Me.exec(me);K=yt[1],Me=qe,Me.test(K)&&(me=K,Me=Ht,nt=Si,Ei=N,Me.test(me)?me=me+"e":nt.test(me)?(ee=Ze,me=me.replace(ee,"")):Ei.test(me)&&(me=me+"e"))}if(ee=$i,ee.test(me)){var yt=ee.exec(me);K=yt[1],me=K+"i"}if(ee=wr,ee.test(me)){var yt=ee.exec(me);K=yt[1],se=yt[2],ee=Re,ee.test(K)&&(me=K+y[se])}if(ee=it,ee.test(me)){var yt=ee.exec(me);K=yt[1],se=yt[2],ee=Re,ee.test(K)&&(me=K+S[se])}if(ee=ei,Me=Nt,ee.test(me)){var yt=ee.exec(me);K=yt[1],ee=le,ee.test(K)&&(me=K)}else if(Me.test(me)){var yt=Me.exec(me);K=yt[1]+yt[2],Me=le,Me.test(K)&&(me=K)}if(ee=ji,ee.test(me)){var yt=ee.exec(me);K=yt[1],ee=le,Me=lt,nt=Zi,(ee.test(K)||Me.test(K)&&!nt.test(K))&&(me=K)}return ee=hr,Me=le,ee.test(me)&&Me.test(me)&&(ee=Ze,me=me.replace(ee,"")),ce=="y"&&(me=ce.toLowerCase()+me.substr(1)),me};return function(cr){return cr.update(er)}}(),g.Pipeline.registerFunction(g.stemmer,"stemmer");/*!
 * lunr.stopWordFilter
 * Copyright (C) 2020 Oliver Nightingale
 */g.generateStopWordFilter=function(y){var S=y.reduce(function(k,R){return k[R]=R,k},{});return function(k){if(k&&S[k.toString()]!==k.toString())return k}},g.stopWordFilter=g.generateStopWordFilter(["a","able","about","across","after","all","almost","also","am","among","an","and","any","are","as","at","be","because","been","but","by","can","cannot","could","dear","did","do","does","either","else","ever","every","for","from","get","got","had","has","have","he","her","hers","him","his","how","however","i","if","in","into","is","it","its","just","least","let","like","likely","may","me","might","most","must","my","neither","no","nor","not","of","off","often","on","only","or","other","our","own","rather","said","say","says","she","should","since","so","some","than","that","the","their","them","then","there","these","they","this","tis","to","too","twas","us","wants","was","we","were","what","when","where","which","while","who","whom","why","will","with","would","yet","you","your"]),g.Pipeline.registerFunction(g.stopWordFilter,"stopWordFilter");/*!
 * lunr.trimmer
 * Copyright (C) 2020 Oliver Nightingale
 */g.trimmer=function(y){return y.update(function(S){return S.replace(/^\W+/,"").replace(/\W+$/,"")})},g.Pipeline.registerFunction(g.trimmer,"trimmer");/*!
 * lunr.TokenSet
 * Copyright (C) 2020 Oliver Nightingale
 */g.TokenSet=function(){this.final=!1,this.edges={},this.id=g.TokenSet._nextId,g.TokenSet._nextId+=1},g.TokenSet._nextId=1,g.TokenSet.fromArray=function(y){for(var S=new g.TokenSet.Builder,k=0,R=y.length;k<R;k++)S.insert(y[k]);return S.finish(),S.root},g.TokenSet.fromClause=function(y){return"editDistance"in y?g.TokenSet.fromFuzzyString(y.term,y.editDistance):g.TokenSet.fromString(y.term)},g.TokenSet.fromFuzzyString=function(y,S){for(var k=new g.TokenSet,R=[{node:k,editsRemaining:S,str:y}];R.length;){var F=R.pop();if(F.str.length>0){var U=F.str.charAt(0),Z;U in F.node.edges?Z=F.node.edges[U]:(Z=new g.TokenSet,F.node.edges[U]=Z),F.str.length==1&&(Z.final=!0),R.push({node:Z,editsRemaining:F.editsRemaining,str:F.str.slice(1)})}if(F.editsRemaining!=0){if("*"in F.node.edges)var ne=F.node.edges["*"];else{var ne=new g.TokenSet;F.node.edges["*"]=ne}if(F.str.length==0&&(ne.final=!0),R.push({node:ne,editsRemaining:F.editsRemaining-1,str:F.str}),F.str.length>1&&R.push({node:F.node,editsRemaining:F.editsRemaining-1,str:F.str.slice(1)}),F.str.length==1&&(F.node.final=!0),F.str.length>=1){if("*"in F.node.edges)var C=F.node.edges["*"];else{var C=new g.TokenSet;F.node.edges["*"]=C}F.str.length==1&&(C.final=!0),R.push({node:C,editsRemaining:F.editsRemaining-1,str:F.str.slice(1)})}if(F.str.length>1){var D=F.str.charAt(0),Re=F.str.charAt(1),le;Re in F.node.edges?le=F.node.edges[Re]:(le=new g.TokenSet,F.node.edges[Re]=le),F.str.length==1&&(le.final=!0),R.push({node:le,editsRemaining:F.editsRemaining-1,str:D+F.str.slice(2)})}}}return k},g.TokenSet.fromString=function(y){for(var S=new g.TokenSet,k=S,R=0,F=y.length;R<F;R++){var U=y[R],Z=R==F-1;if(U=="*")S.edges[U]=S,S.final=Z;else{var ne=new g.TokenSet;ne.final=Z,S.edges[U]=ne,S=ne}}return k},g.TokenSet.prototype.toArray=function(){for(var y=[],S=[{prefix:"",node:this}];S.length;){var k=S.pop(),R=Object.keys(k.node.edges),F=R.length;k.node.final&&(k.prefix.charAt(0),y.push(k.prefix));for(var U=0;U<F;U++){var Z=R[U];S.push({prefix:k.prefix.concat(Z),node:k.node.edges[Z]})}}return y},g.TokenSet.prototype.toString=function(){if(this._str)return this._str;for(var y=this.final?"1":"0",S=Object.keys(this.edges).sort(),k=S.length,R=0;R<k;R++){var F=S[R],U=this.edges[F];y=y+F+U.id}return y},g.TokenSet.prototype.intersect=function(y){for(var S=new g.TokenSet,k=void 0,R=[{qNode:y,output:S,node:this}];R.length;){k=R.pop();for(var F=Object.keys(k.qNode.edges),U=F.length,Z=Object.keys(k.node.edges),ne=Z.length,C=0;C<U;C++)for(var D=F[C],Re=0;Re<ne;Re++){var le=Z[Re];if(le==D||D=="*"){var lt=k.node.edges[le],qe=k.qNode.edges[D],Ct=lt.final&&qe.final,De=void 0;le in k.output.edges?(De=k.output.edges[le],De.final=De.final||Ct):(De=new g.TokenSet,De.final=Ct,k.output.edges[le]=De),R.push({qNode:qe,output:De,node:lt})}}}return S},g.TokenSet.Builder=function(){this.previousWord="",this.root=new g.TokenSet,this.uncheckedNodes=[],this.minimizedNodes={}},g.TokenSet.Builder.prototype.insert=function(y){var S,k=0;if(y<this.previousWord)throw new Error("Out of order word insertion");for(var R=0;R<y.length&&R<this.previousWord.length&&y[R]==this.previousWord[R];R++)k++;this.minimize(k),this.uncheckedNodes.length==0?S=this.root:S=this.uncheckedNodes[this.uncheckedNodes.length-1].child;for(var R=k;R<y.length;R++){var F=new g.TokenSet,U=y[R];S.edges[U]=F,this.uncheckedNodes.push({parent:S,char:U,child:F}),S=F}S.final=!0,this.previousWord=y},g.TokenSet.Builder.prototype.finish=function(){this.minimize(0)},g.TokenSet.Builder.prototype.minimize=function(y){for(var S=this.uncheckedNodes.length-1;S>=y;S--){var k=this.uncheckedNodes[S],R=k.child.toString();R in this.minimizedNodes?k.parent.edges[k.char]=this.minimizedNodes[R]:(k.child._str=R,this.minimizedNodes[R]=k.child),this.uncheckedNodes.pop()}};/*!
 * lunr.Index
 * Copyright (C) 2020 Oliver Nightingale
 */g.Index=function(y){this.invertedIndex=y.invertedIndex,this.fieldVectors=y.fieldVectors,this.tokenSet=y.tokenSet,this.fields=y.fields,this.pipeline=y.pipeline},g.Index.prototype.search=function(y){return this.query(function(S){var k=new g.QueryParser(y,S);k.parse()})},g.Index.prototype.query=function(y){for(var S=new g.Query(this.fields),k=Object.create(null),R=Object.create(null),F=Object.create(null),U=Object.create(null),Z=Object.create(null),ne=0;ne<this.fields.length;ne++)R[this.fields[ne]]=new g.Vector;y.call(S,S);for(var ne=0;ne<S.clauses.length;ne++){var C=S.clauses[ne],D=null,Re=g.Set.empty;C.usePipeline?D=this.pipeline.runString(C.term,{fields:C.fields}):D=[C.term];for(var le=0;le<D.length;le++){var lt=D[le];C.term=lt;var qe=g.TokenSet.fromClause(C),Ct=this.tokenSet.intersect(qe).toArray();if(Ct.length===0&&C.presence===g.Query.presence.REQUIRED){for(var De=0;De<C.fields.length;De++){var je=C.fields[De];U[je]=g.Set.empty}break}for(var Yt=0;Yt<Ct.length;Yt++)for(var Ze=Ct[Yt],Ht=this.invertedIndex[Ze],Si=Ht._index,De=0;De<C.fields.length;De++){var je=C.fields[De],N=Ht[je],$i=Object.keys(N),wr=Ze+"/"+je,it=new g.Set($i);if(C.presence==g.Query.presence.REQUIRED&&(Re=Re.union(it),U[je]===void 0&&(U[je]=g.Set.complete)),C.presence==g.Query.presence.PROHIBITED){Z[je]===void 0&&(Z[je]=g.Set.empty),Z[je]=Z[je].union(it);continue}if(R[je].upsert(Si,C.boost,function(sh,xr){return sh+xr}),!F[wr]){for(var ei=0;ei<$i.length;ei++){var Nt=$i[ei],ji=new g.FieldRef(Nt,je),hr=N[Nt],Zi;(Zi=k[ji])===void 0?k[ji]=new g.MatchData(Ze,je,hr):Zi.add(Ze,je,hr)}F[wr]=!0}}}if(C.presence===g.Query.presence.REQUIRED)for(var De=0;De<C.fields.length;De++){var je=C.fields[De];U[je]=U[je].intersect(Re)}}for(var er=g.Set.complete,cr=g.Set.empty,ne=0;ne<this.fields.length;ne++){var je=this.fields[ne];U[je]&&(er=er.intersect(U[je])),Z[je]&&(cr=cr.union(Z[je]))}var me=Object.keys(k),K=[],se=Object.create(null);if(S.isNegated()){me=Object.keys(this.fieldVectors);for(var ne=0;ne<me.length;ne++){var ji=me[ne],ce=g.FieldRef.fromString(ji);k[ji]=new g.MatchData}}for(var ne=0;ne<me.length;ne++){var ce=g.FieldRef.fromString(me[ne]),ee=ce.docRef;if(er.contains(ee)&&!cr.contains(ee)){var Me=this.fieldVectors[ce],nt=R[ce.fieldName].similarity(Me),Ei;if((Ei=se[ee])!==void 0)Ei.score+=nt,Ei.matchData.combine(k[ce]);else{var yt={ref:ee,score:nt,matchData:k[ce]};se[ee]=yt,K.push(yt)}}}return K.sort(function(Es,Ra){return Ra.score-Es.score})},g.Index.prototype.toJSON=function(){var y=Object.keys(this.invertedIndex).sort().map(function(k){return[k,this.invertedIndex[k]]},this),S=Object.keys(this.fieldVectors).map(function(k){return[k,this.fieldVectors[k].toJSON()]},this);return{version:g.version,fields:this.fields,fieldVectors:S,invertedIndex:y,pipeline:this.pipeline.toJSON()}},g.Index.load=function(y){var S={},k={},R=y.fieldVectors,F=Object.create(null),U=y.invertedIndex,Z=new g.TokenSet.Builder,ne=g.Pipeline.load(y.pipeline);y.version!=g.version&&g.utils.warn("Version mismatch when loading serialised index. Current version of lunr '"+g.version+"' does not match serialized index '"+y.version+"'");for(var C=0;C<R.length;C++){var D=R[C],Re=D[0],le=D[1];k[Re]=new g.Vector(le)}for(var C=0;C<U.length;C++){var D=U[C],lt=D[0],qe=D[1];Z.insert(lt),F[lt]=qe}return Z.finish(),S.fields=y.fields,S.fieldVectors=k,S.invertedIndex=F,S.tokenSet=Z.root,S.pipeline=ne,new g.Index(S)};/*!
 * lunr.Builder
 * Copyright (C) 2020 Oliver Nightingale
 */g.Builder=function(){this._ref="id",this._fields=Object.create(null),this._documents=Object.create(null),this.invertedIndex=Object.create(null),this.fieldTermFrequencies={},this.fieldLengths={},this.tokenizer=g.tokenizer,this.pipeline=new g.Pipeline,this.searchPipeline=new g.Pipeline,this.documentCount=0,this._b=.75,this._k1=1.2,this.termIndex=0,this.metadataWhitelist=[]},g.Builder.prototype.ref=function(y){this._ref=y},g.Builder.prototype.field=function(y,S){if(/\//.test(y))throw new RangeError("Field '"+y+"' contains illegal character '/'");this._fields[y]=S||{}},g.Builder.prototype.b=function(y){y<0?this._b=0:y>1?this._b=1:this._b=y},g.Builder.prototype.k1=function(y){this._k1=y},g.Builder.prototype.add=function(y,S){var k=y[this._ref],R=Object.keys(this._fields);this._documents[k]=S||{},this.documentCount+=1;for(var F=0;F<R.length;F++){var U=R[F],Z=this._fields[U].extractor,ne=Z?Z(y):y[U],C=this.tokenizer(ne,{fields:[U]}),D=this.pipeline.run(C),Re=new g.FieldRef(k,U),le=Object.create(null);this.fieldTermFrequencies[Re]=le,this.fieldLengths[Re]=0,this.fieldLengths[Re]+=D.length;for(var lt=0;lt<D.length;lt++){var qe=D[lt];if(le[qe]==null&&(le[qe]=0),le[qe]+=1,this.invertedIndex[qe]==null){var Ct=Object.create(null);Ct._index=this.termIndex,this.termIndex+=1;for(var De=0;De<R.length;De++)Ct[R[De]]=Object.create(null);this.invertedIndex[qe]=Ct}this.invertedIndex[qe][U][k]==null&&(this.invertedIndex[qe][U][k]=Object.create(null));for(var je=0;je<this.metadataWhitelist.length;je++){var Yt=this.metadataWhitelist[je],Ze=qe.metadata[Yt];this.invertedIndex[qe][U][k][Yt]==null&&(this.invertedIndex[qe][U][k][Yt]=[]),this.invertedIndex[qe][U][k][Yt].push(Ze)}}}},g.Builder.prototype.calculateAverageFieldLengths=function(){for(var y=Object.keys(this.fieldLengths),S=y.length,k={},R={},F=0;F<S;F++){var U=g.FieldRef.fromString(y[F]),Z=U.fieldName;R[Z]||(R[Z]=0),R[Z]+=1,k[Z]||(k[Z]=0),k[Z]+=this.fieldLengths[U]}for(var ne=Object.keys(this._fields),F=0;F<ne.length;F++){var C=ne[F];k[C]=k[C]/R[C]}this.averageFieldLength=k},g.Builder.prototype.createFieldVectors=function(){for(var y={},S=Object.keys(this.fieldTermFrequencies),k=S.length,R=Object.create(null),F=0;F<k;F++){for(var U=g.FieldRef.fromString(S[F]),Z=U.fieldName,ne=this.fieldLengths[U],C=new g.Vector,D=this.fieldTermFrequencies[U],Re=Object.keys(D),le=Re.length,lt=this._fields[Z].boost||1,qe=this._documents[U.docRef].boost||1,Ct=0;Ct<le;Ct++){var De=Re[Ct],je=D[De],Yt=this.invertedIndex[De]._index,Ze,Ht,Si;R[De]===void 0?(Ze=g.idf(this.invertedIndex[De],this.documentCount),R[De]=Ze):Ze=R[De],Ht=Ze*((this._k1+1)*je)/(this._k1*(1-this._b+this._b*(ne/this.averageFieldLength[Z]))+je),Ht*=lt,Ht*=qe,Si=Math.round(Ht*1e3)/1e3,C.insert(Yt,Si)}y[U]=C}this.fieldVectors=y},g.Builder.prototype.createTokenSet=function(){this.tokenSet=g.TokenSet.fromArray(Object.keys(this.invertedIndex).sort())},g.Builder.prototype.build=function(){return this.calculateAverageFieldLengths(),this.createFieldVectors(),this.createTokenSet(),new g.Index({invertedIndex:this.invertedIndex,fieldVectors:this.fieldVectors,tokenSet:this.tokenSet,fields:Object.keys(this._fields),pipeline:this.searchPipeline})},g.Builder.prototype.use=function(y){var S=Array.prototype.slice.call(arguments,1);S.unshift(this),y.apply(this,S)},g.MatchData=function(y,S,k){for(var R=Object.create(null),F=Object.keys(k||{}),U=0;U<F.length;U++){var Z=F[U];R[Z]=k[Z].slice()}this.metadata=Object.create(null),y!==void 0&&(this.metadata[y]=Object.create(null),this.metadata[y][S]=R)},g.MatchData.prototype.combine=function(y){for(var S=Object.keys(y.metadata),k=0;k<S.length;k++){var R=S[k],F=Object.keys(y.metadata[R]);this.metadata[R]==null&&(this.metadata[R]=Object.create(null));for(var U=0;U<F.length;U++){var Z=F[U],ne=Object.keys(y.metadata[R][Z]);this.metadata[R][Z]==null&&(this.metadata[R][Z]=Object.create(null));for(var C=0;C<ne.length;C++){var D=ne[C];this.metadata[R][Z][D]==null?this.metadata[R][Z][D]=y.metadata[R][Z][D]:this.metadata[R][Z][D]=this.metadata[R][Z][D].concat(y.metadata[R][Z][D])}}}},g.MatchData.prototype.add=function(y,S,k){if(!(y in this.metadata)){this.metadata[y]=Object.create(null),this.metadata[y][S]=k;return}if(!(S in this.metadata[y])){this.metadata[y][S]=k;return}for(var R=Object.keys(k),F=0;F<R.length;F++){var U=R[F];U in this.metadata[y][S]?this.metadata[y][S][U]=this.metadata[y][S][U].concat(k[U]):this.metadata[y][S][U]=k[U]}},g.Query=function(y){this.clauses=[],this.allFields=y},g.Query.wildcard=new String("*"),g.Query.wildcard.NONE=0,g.Query.wildcard.LEADING=1,g.Query.wildcard.TRAILING=2,g.Query.presence={OPTIONAL:1,REQUIRED:2,PROHIBITED:3},g.Query.prototype.clause=function(y){return"fields"in y||(y.fields=this.allFields),"boost"in y||(y.boost=1),"usePipeline"in y||(y.usePipeline=!0),"wildcard"in y||(y.wildcard=g.Query.wildcard.NONE),y.wildcard&g.Query.wildcard.LEADING&&y.term.charAt(0)!=g.Query.wildcard&&(y.term="*"+y.term),y.wildcard&g.Query.wildcard.TRAILING&&y.term.slice(-1)!=g.Query.wildcard&&(y.term=""+y.term+"*"),"presence"in y||(y.presence=g.Query.presence.OPTIONAL),this.clauses.push(y),this},g.Query.prototype.isNegated=function(){for(var y=0;y<this.clauses.length;y++)if(this.clauses[y].presence!=g.Query.presence.PROHIBITED)return!1;return!0},g.Query.prototype.term=function(y,S){if(Array.isArray(y))return y.forEach(function(R){this.term(R,g.utils.clone(S))},this),this;var k=S||{};return k.term=y.toString(),this.clause(k),this},g.QueryParseError=function(y,S,k){this.name="QueryParseError",this.message=y,this.start=S,this.end=k},g.QueryParseError.prototype=new Error,g.QueryLexer=function(y){this.lexemes=[],this.str=y,this.length=y.length,this.pos=0,this.start=0,this.escapeCharPositions=[]},g.QueryLexer.prototype.run=function(){for(var y=g.QueryLexer.lexText;y;)y=y(this)},g.QueryLexer.prototype.sliceString=function(){for(var y=[],S=this.start,k=this.pos,R=0;R<this.escapeCharPositions.length;R++)k=this.escapeCharPositions[R],y.push(this.str.slice(S,k)),S=k+1;return y.push(this.str.slice(S,this.pos)),this.escapeCharPositions.length=0,y.join("")},g.QueryLexer.prototype.emit=function(y){this.lexemes.push({type:y,str:this.sliceString(),start:this.start,end:this.pos}),this.start=this.pos},g.QueryLexer.prototype.escapeCharacter=function(){this.escapeCharPositions.push(this.pos-1),this.pos+=1},g.QueryLexer.prototype.next=function(){if(this.pos>=this.length)return g.QueryLexer.EOS;var y=this.str.charAt(this.pos);return this.pos+=1,y},g.QueryLexer.prototype.width=function(){return this.pos-this.start},g.QueryLexer.prototype.ignore=function(){this.start==this.pos&&(this.pos+=1),this.start=this.pos},g.QueryLexer.prototype.backup=function(){this.pos-=1},g.QueryLexer.prototype.acceptDigitRun=function(){var y,S;do y=this.next(),S=y.charCodeAt(0);while(S>47&&S<58);y!=g.QueryLexer.EOS&&this.backup()},g.QueryLexer.prototype.more=function(){return this.pos<this.length},g.QueryLexer.EOS="EOS",g.QueryLexer.FIELD="FIELD",g.QueryLexer.TERM="TERM",g.QueryLexer.EDIT_DISTANCE="EDIT_DISTANCE",g.QueryLexer.BOOST="BOOST",g.QueryLexer.PRESENCE="PRESENCE",g.QueryLexer.lexField=function(y){return y.backup(),y.emit(g.QueryLexer.FIELD),y.ignore(),g.QueryLexer.lexText},g.QueryLexer.lexTerm=function(y){if(y.width()>1&&(y.backup(),y.emit(g.QueryLexer.TERM)),y.ignore(),y.more())return g.QueryLexer.lexText},g.QueryLexer.lexEditDistance=function(y){return y.ignore(),y.acceptDigitRun(),y.emit(g.QueryLexer.EDIT_DISTANCE),g.QueryLexer.lexText},g.QueryLexer.lexBoost=function(y){return y.ignore(),y.acceptDigitRun(),y.emit(g.QueryLexer.BOOST),g.QueryLexer.lexText},g.QueryLexer.lexEOS=function(y){y.width()>0&&y.emit(g.QueryLexer.TERM)},g.QueryLexer.termSeparator=g.tokenizer.separator,g.QueryLexer.lexText=function(y){for(;;){var S=y.next();if(S==g.QueryLexer.EOS)return g.QueryLexer.lexEOS;if(S.charCodeAt(0)==92){y.escapeCharacter();continue}if(S==":")return g.QueryLexer.lexField;if(S=="~")return y.backup(),y.width()>0&&y.emit(g.QueryLexer.TERM),g.QueryLexer.lexEditDistance;if(S=="^")return y.backup(),y.width()>0&&y.emit(g.QueryLexer.TERM),g.QueryLexer.lexBoost;if(S=="+"&&y.width()===1||S=="-"&&y.width()===1)return y.emit(g.QueryLexer.PRESENCE),g.QueryLexer.lexText;if(S.match(g.QueryLexer.termSeparator))return g.QueryLexer.lexTerm}},g.QueryParser=function(y,S){this.lexer=new g.QueryLexer(y),this.query=S,this.currentClause={},this.lexemeIdx=0},g.QueryParser.prototype.parse=function(){this.lexer.run(),this.lexemes=this.lexer.lexemes;for(var y=g.QueryParser.parseClause;y;)y=y(this);return this.query},g.QueryParser.prototype.peekLexeme=function(){return this.lexemes[this.lexemeIdx]},g.QueryParser.prototype.consumeLexeme=function(){var y=this.peekLexeme();return this.lexemeIdx+=1,y},g.QueryParser.prototype.nextClause=function(){var y=this.currentClause;this.query.clause(y),this.currentClause={}},g.QueryParser.parseClause=function(y){var S=y.peekLexeme();if(S!=null)switch(S.type){case g.QueryLexer.PRESENCE:return g.QueryParser.parsePresence;case g.QueryLexer.FIELD:return g.QueryParser.parseField;case g.QueryLexer.TERM:return g.QueryParser.parseTerm;default:var k="expected either a field or a term, found "+S.type;throw S.str.length>=1&&(k+=" with value '"+S.str+"'"),new g.QueryParseError(k,S.start,S.end)}},g.QueryParser.parsePresence=function(y){var S=y.consumeLexeme();if(S!=null){switch(S.str){case"-":y.currentClause.presence=g.Query.presence.PROHIBITED;break;case"+":y.currentClause.presence=g.Query.presence.REQUIRED;break;default:var k="unrecognised presence operator'"+S.str+"'";throw new g.QueryParseError(k,S.start,S.end)}var R=y.peekLexeme();if(R==null){var k="expecting term or field, found nothing";throw new g.QueryParseError(k,S.start,S.end)}switch(R.type){case g.QueryLexer.FIELD:return g.QueryParser.parseField;case g.QueryLexer.TERM:return g.QueryParser.parseTerm;default:var k="expecting term or field, found '"+R.type+"'";throw new g.QueryParseError(k,R.start,R.end)}}},g.QueryParser.parseField=function(y){var S=y.consumeLexeme();if(S!=null){if(y.query.allFields.indexOf(S.str)==-1){var k=y.query.allFields.map(function(U){return"'"+U+"'"}).join(", "),R="unrecognised field '"+S.str+"', possible fields: "+k;throw new g.QueryParseError(R,S.start,S.end)}y.currentClause.fields=[S.str];var F=y.peekLexeme();if(F==null){var R="expecting term, found nothing";throw new g.QueryParseError(R,S.start,S.end)}switch(F.type){case g.QueryLexer.TERM:return g.QueryParser.parseTerm;default:var R="expecting term, found '"+F.type+"'";throw new g.QueryParseError(R,F.start,F.end)}}},g.QueryParser.parseTerm=function(y){var S=y.consumeLexeme();if(S!=null){y.currentClause.term=S.str.toLowerCase(),S.str.indexOf("*")!=-1&&(y.currentClause.usePipeline=!1);var k=y.peekLexeme();if(k==null){y.nextClause();return}switch(k.type){case g.QueryLexer.TERM:return y.nextClause(),g.QueryParser.parseTerm;case g.QueryLexer.FIELD:return y.nextClause(),g.QueryParser.parseField;case g.QueryLexer.EDIT_DISTANCE:return g.QueryParser.parseEditDistance;case g.QueryLexer.BOOST:return g.QueryParser.parseBoost;case g.QueryLexer.PRESENCE:return y.nextClause(),g.QueryParser.parsePresence;default:var R="Unexpected lexeme type '"+k.type+"'";throw new g.QueryParseError(R,k.start,k.end)}}},g.QueryParser.parseEditDistance=function(y){var S=y.consumeLexeme();if(S!=null){var k=parseInt(S.str,10);if(isNaN(k)){var R="edit distance must be numeric";throw new g.QueryParseError(R,S.start,S.end)}y.currentClause.editDistance=k;var F=y.peekLexeme();if(F==null){y.nextClause();return}switch(F.type){case g.QueryLexer.TERM:return y.nextClause(),g.QueryParser.parseTerm;case g.QueryLexer.FIELD:return y.nextClause(),g.QueryParser.parseField;case g.QueryLexer.EDIT_DISTANCE:return g.QueryParser.parseEditDistance;case g.QueryLexer.BOOST:return g.QueryParser.parseBoost;case g.QueryLexer.PRESENCE:return y.nextClause(),g.QueryParser.parsePresence;default:var R="Unexpected lexeme type '"+F.type+"'";throw new g.QueryParseError(R,F.start,F.end)}}},g.QueryParser.parseBoost=function(y){var S=y.consumeLexeme();if(S!=null){var k=parseInt(S.str,10);if(isNaN(k)){var R="boost must be numeric";throw new g.QueryParseError(R,S.start,S.end)}y.currentClause.boost=k;var F=y.peekLexeme();if(F==null){y.nextClause();return}switch(F.type){case g.QueryLexer.TERM:return y.nextClause(),g.QueryParser.parseTerm;case g.QueryLexer.FIELD:return y.nextClause(),g.QueryParser.parseField;case g.QueryLexer.EDIT_DISTANCE:return g.QueryParser.parseEditDistance;case g.QueryLexer.BOOST:return g.QueryParser.parseBoost;case g.QueryLexer.PRESENCE:return y.nextClause(),g.QueryParser.parsePresence;default:var R="Unexpected lexeme type '"+F.type+"'";throw new g.QueryParseError(R,F.start,F.end)}}},function(y,S){L.exports=S()}(this,function(){return g})})()})(zw);var jM=zw.exports;const UM=uM(jM);class DM{constructor(w){this.contentList=w,this.index=this.buildIndex(w)}buildIndex(w){return UM(function(){this.field("abstract"),this.field("content"),this.field("contributor"),this.field("subtitle"),this.field("title"),this.field("url"),this.ref("url"),w.forEach(g=>{this.add(g)})})}search(w){return this.index.search(w).map(y=>this.contentList.find(({url:S})=>S===y.ref))}}window.toggleMenu=()=>{const L=document.getElementById("site-menu"),w=document.querySelector(".side-by-side > .quire-entry__image-wrap > .quire-entry__image"),g=L.getAttribute("aria-expanded");L.classList.toggle("is-expanded",!L.classList.contains("is-expanded")),g==="true"?(w&&w.classList.remove("menu_open"),L.setAttribute("aria-expanded","false")):(w&&w.classList.add("menu_open"),L.setAttribute("aria-expanded","true"))};window.toggleSearch=()=>{let L=document.getElementById("js-search"),w=document.getElementById("js-search-input"),g=L.getAttribute("aria-expanded");L.classList.toggle("is-active",!L.classList.contains("is-active")),g==="true"?L.setAttribute("aria-expanded","false"):(w.focus(),L.setAttribute("aria-expanded","true"))};window.search=()=>{let w=document.getElementById("js-search-input").value,g=window.QUIRE_SEARCH,y=document.getElementById("js-search-results-list"),S=document.getElementById("js-search-results-template");if(w.length>=3){let F=g.search(w);R(F)}function k(){y.innerText=""}function R(F){k(),F.forEach(U=>{let Z=document.importNode(S.content,!0),ne=Z.querySelector(".js-search-results-item"),C=Z.querySelector(".js-search-results-item-title"),D=Z.querySelector(".js-search-results-item-type"),Re=Z.querySelector(".js-search-results-item-length");ne.href=U.url,C.textContent=U.title,D.textContent=U.type,Re.textContent=U.length,y.appendChild(Z)})}};function WM(L){const w=L.target.closest("a"),g=w.hash;w.pathname.includes(window.location.pathname)&&(L.preventDefault(),window.location.hash=g),jp(g)}function HM(){const w='a[href*="#"]'+['[href="#"]','[href="#0"]',".accordion-section__heading-link",".q-figure__modal-link"].map(y=>`:not(${y})`).join("");document.querySelectorAll(w).forEach(y=>{y.addEventListener("click",WM)})}function qM(){document.getElementById("container").classList.remove("no-js"),navigator.userAgent.match(/(iPad|iPhone|iPod)/i),navigator.userAgent.match(/android/i),QM(),HM()}function QM(){const L=document.getElementById("js-search").dataset.searchIndex;if(!L){console.warn("Search data url is undefined");return}fetch(L).then(async w=>{const{ok:g,statusText:y,url:S}=w;if(!g){console.warn(`Search data ${y.toLowerCase()} at ${S}`);return}const k=await w.json();window.QUIRE_SEARCH=new DM(k)})}function VM(L){const w={month:"long"},g=L.getMonth();let y;[4,5,6].includes(g)?y=L.toLocaleDateString("en-US",w).replace(/[^A-Za-z]+/,""):(y=y===8?"Sept":L.toLocaleDateString("en-US",w).slice(0,3),y+=".");const S=L.getDate(),k=L.getFullYear();return[S,y,k].join(" ")}function GM(){const L=document.querySelectorAll(".cite-current-date"),w=VM(new Date);L.forEach(g=>{g.innerHTML=w})}function ZM(L,w){const g=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--gap")),y=L.getBoundingClientRect(),S=w.getBoundingClientRect(),k=S.left-y.left,R=y.right-S.right,F=y.width/2;R>0?L.style.transform=`translateX(-${F+R+g}px)`:k>0&&(L.style.transform=`translateX(-${F-k-g}px)`)}function XM(){let L=document.querySelectorAll(".expandable [aria-expanded]");for(let w=0;w<L.length;w++)L[w].addEventListener("click",g=>{g.stopPropagation(),g.target.getAttribute("aria-expanded")==="false"?g.target.setAttribute("aria-expanded","true"):g.target.setAttribute("aria-expanded","false");let S=g.target.parentNode.querySelector(".quire-citation__content");S&&(S.getAttribute("hidden"),typeof S.getAttribute("hidden")=="string"?S.removeAttribute("hidden"):S.setAttribute("hidden","hidden"),ZM(S,document.documentElement))});document.addEventListener("click",w=>{let g=w.target.parentNode;if(g&&!(g.classList.contains("quire-citation")||g.classList.contains("quire-citation__content"))){let y=document.querySelectorAll(".quire-citation__button"),S=document.querySelectorAll(".quire-citation__content");if(!S)return;for(let k=0;k<S.length;k++){if(!y[k])return;y[k].setAttribute("aria-expanded","false"),S[k].setAttribute("hidden","hidden")}}})}function YM(){GM(),XM()}function KM(){const L=new URL(window.location),w=[...new Set(L.searchParams.keys())];return Object.fromEntries(w.map(g=>[g,L.searchParams.getAll(g).map(decodeURIComponent)]))}qM();window.addEventListener("load",()=>{YM(),jp(window.location.hash);const L=KM();Et.setup(),FM(),window.location.hash&&zp({figureId:window.location.hash.replace(/^#/,""),annotationIds:L["annotation-id"],region:L.region?L.region[0]:null,sequence:{index:L["sequence-index"]?L["sequence-index"][0]:null}})});
//# sourceMappingURL=index-6a5f1c03.js.map
